2026-02-17 12:03:42,932 - __main__ - INFO - üåê API Server Logging Initialized
2026-02-17 12:03:42,933 - __main__ - INFO - üìù Logs saved to: logs/dq_api_20260217_120342.log
2026-02-17 12:03:43,113 - __main__ - INFO - APP_SETTINGS loaded. Audit enabled: True
2026-02-17 12:03:43,114 - __main__ - INFO - ‚úÖ All DQ modules loaded successfully
2026-02-17 12:03:43,115 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:03:43,116 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:03:43,117 - __main__ - INFO - ‚úÖ ErrorLogger and DataQualityAudit initialized
2026-02-17 12:03:43,123 - __main__ - INFO - üöÄ Starting Data Quality Framework API
2026-02-17 12:03:43,124 - __main__ - INFO - üìä Modules available: True
2026-02-17 12:03:43,125 - __main__ - INFO - üîß Config file mode: False
2026-02-17 12:03:43,126 - __main__ - INFO - üìã Available endpoints:
2026-02-17 12:03:43,126 - __main__ - INFO -   GET  /              - API status
2026-02-17 12:03:43,127 - __main__ - INFO -   GET  /api/health    - Health check
2026-02-17 12:03:43,128 - __main__ - INFO -   POST /api/check-single - Single source analysis
2026-02-17 12:03:43,128 - __main__ - INFO -   POST /api/compare   - Source-target comparison
2026-02-17 12:03:43,129 - __main__ - INFO -   GET  /api/compare/{id} - Get comparison results
2026-02-17 12:03:43,129 - __main__ - INFO -   GET  /api/compare/{id}/mismatches - Paginated mismatches
2026-02-17 12:03:43,130 - __main__ - INFO -   GET  /api/compare/{id}/rows/count - Row counts
2026-02-17 12:03:43,131 - __main__ - INFO -   POST /api/upload    - File upload
2026-02-17 12:03:43,131 - __main__ - INFO -   GET  /api/sessions  - List sessions
2026-02-17 12:03:43,132 - __main__ - INFO -   GET  /api/sessions/<id> - Get session data
2026-02-17 12:03:43,133 - __main__ - INFO -   GET  /api/debug-db  - Database debug
2026-02-17 12:03:43,133 - __main__ - INFO - üåç Server starting on 0.0.0.0:5000 (debug=False)
2026-02-17 12:04:22,531 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:04:22,579 - __main__ - INFO - File uploaded: 20260217_120422_SINGLE_SOURCE_10000.csv (csv)
2026-02-17 12:04:22,580 - __main__ - INFO - Completed with status 200 in 0.049s
2026-02-17 12:04:22,776 - __main__ - INFO - POST /api/check-single - Request started
2026-02-17 12:04:22,777 - __main__ - INFO - Single source analysis request received
2026-02-17 12:04:22,778 - __main__ - INFO - Starting analysis for session SINGLE_20260217_120422_913ce1be
2026-02-17 12:04:22,778 - __main__ - INFO - UI Data being passed to dq_unified:
2026-02-17 12:04:22,779 - __main__ - INFO -   source_type: csv
2026-02-17 12:04:22,780 - __main__ - INFO -   file_path: C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_120422_SINGLE_SOURCE_10000.csv
2026-02-17 12:04:22,780 - __main__ - INFO -   sheet_name: None
2026-02-17 12:04:22,781 - __main__ - INFO -   mandatory_fields: all
2026-02-17 12:04:22,782 - dq_unified - INFO - ==================================================
2026-02-17 12:04:22,782 - dq_unified - INFO - RUN_SINGLE_SOURCE_ANALYSIS_UI - START
2026-02-17 12:04:22,782 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:04:22,782 - dq_unified - INFO - UI Data source_type: csv
2026-02-17 12:04:22,783 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-17 12:04:22,783 - dq_unified - INFO - Loading data from CSV...
2026-02-17 12:04:22,784 - dq_unified - INFO - Loading data from CSV
2026-02-17 12:04:22,784 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_120422_SINGLE_SOURCE_10000.csv
2026-02-17 12:04:22,788 - dq_unified - INFO - CSV file has 10,517 rows
2026-02-17 12:04:22,788 - dq_unified - INFO - Loading 10,517 rows from CSV...
2026-02-17 12:04:22,816 - dq_unified - INFO - Loaded 10,517 rows from CSV
2026-02-17 12:04:22,839 - dq_unified - INFO - Memory optimization: 5.0MB -> 2.4MB (Saved: 2.6MB)
2026-02-17 12:04:22,844 - dq_unified - INFO - Loaded 10,517 rows, 9 columns. Memory: 108.5MB total, 2.4MB for dataframe
2026-02-17 12:04:22,844 - dq_unified - INFO - Data loaded: 10,517 rows, 9 columns
2026-02-17 12:04:22,844 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:04:22,844 - dq_unified - INFO - Session ID: SINGLE_20260217_120422
2026-02-17 12:04:22,844 - dq_unified - INFO - Column data types collected: 9 columns
2026-02-17 12:04:22,844 - dq_unified - INFO - ==================================================
2026-02-17 12:04:22,845 - dq_unified - INFO - Starting quality checks...
2026-02-17 12:04:22,845 - dq_unified - INFO - ==================================================
2026-02-17 12:04:22,845 - dq_unified - INFO - 1. Checking for null/empty values...
2026-02-17 12:04:22,845 - dq_unified - INFO - Checking for null/empty values
2026-02-17 12:04:22,846 - dq_unified - INFO - DataFrame shape: (10517, 9)
2026-02-17 12:04:22,846 - dq_unified - INFO - Columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-17 12:04:22,846 - dq_unified - INFO - Data source: CSV: 20260217_120422_SINGLE_SOURCE_10000.csv
2026-02-17 12:04:22,848 - dq_unified - INFO - DataFrame dtypes: {'transaction_id': dtype('O'), 'account_id': dtype('O'), 'customer_email': dtype('O'), 'transaction_date': CategoricalDtype(categories=['1/1/2024', '2024/31/12', '31-12-2024'], ordered=False, categories_dtype=object), 'amount': dtype('O'), 'currency': CategoricalDtype(categories=['USD'], ordered=False, categories_dtype=object), 'country': CategoricalDtype(categories=['US'], ordered=False, categories_dtype=object), 'status': CategoricalDtype(categories=['SUCCESS'], ordered=False, categories_dtype=object), 'remarks': CategoricalDtype(categories=['OK'], ordered=False, categories_dtype=object)}
2026-02-17 12:04:22,848 - dq_unified - INFO - First 2 rows (first 3 columns only):
2026-02-17 12:04:22,848 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': "'AC000001'", 'customer_email': "'user1@bank.com'"}
2026-02-17 12:04:22,850 - dq_unified - INFO -   Row 1: {'transaction_id': "'TXN2'", 'account_id': "'AC000002'", 'customer_email': "'user2@bank.com'"}
2026-02-17 12:04:22,886 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-17 12:04:22,887 - dq_unified - INFO -   Not missing samples: ["'TXN2'", "'TXN3'", "'TXN4'"]
2026-02-17 12:04:22,887 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (0.0%)
2026-02-17 12:04:22,888 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (0.0%)
2026-02-17 12:04:22,888 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260217_120422
2026-02-17 12:04:23,181 - mysql.connector - INFO - package: mysql.connector.plugins
2026-02-17 12:04:23,182 - mysql.connector - INFO - plugin_name: caching_sha2_password
2026-02-17 12:04:23,183 - mysql.connector - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLCachingSHA2PasswordAuthPlugin
2026-02-17 12:04:23,189 - mysql.connector - INFO - package: mysql.connector.plugins
2026-02-17 12:04:23,190 - mysql.connector - INFO - plugin_name: mysql_native_password
2026-02-17 12:04:23,197 - mysql.connector - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2026-02-17 12:04:23,258 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-17 12:04:23,259 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-17 12:04:23,259 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260217_120422
2026-02-17 12:04:23,295 - dq_unified - INFO - Column 'account_id': No missing cells
2026-02-17 12:04:23,332 - dq_unified - INFO - Column 'customer_email': No missing cells
2026-02-17 12:04:23,371 - dq_unified - INFO - Column 'transaction_date': No missing cells
2026-02-17 12:04:23,406 - dq_unified - INFO - Column 'amount': No missing cells
2026-02-17 12:04:23,441 - dq_unified - INFO - Column 'currency': No missing cells
2026-02-17 12:04:23,478 - dq_unified - INFO - Column 'country': No missing cells
2026-02-17 12:04:23,518 - dq_unified - INFO - Column 'status': No missing cells
2026-02-17 12:04:23,559 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-17 12:04:23,560 - dq_unified - INFO -   Not missing samples: ["'OK'", "'OK'", "'OK'"]
2026-02-17 12:04:23,560 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.0%)
2026-02-17 12:04:23,560 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.0%)
2026-02-17 12:04:23,561 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260217_120422
2026-02-17 12:04:23,628 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-17 12:04:23,629 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-17 12:04:23,629 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260217_120422
2026-02-17 12:04:23,630 - dq_unified - INFO - Total missing cells found: 2
2026-02-17 12:04:23,630 - dq_unified - INFO - ============================================================
2026-02-17 12:04:23,631 - dq_unified - INFO - MISSING VALUE SUMMARY
2026-02-17 12:04:23,631 - dq_unified - INFO - ============================================================
2026-02-17 12:04:23,631 - dq_unified - INFO - transaction_id: 1 missing (0.0%)
2026-02-17 12:04:23,631 - dq_unified - INFO - remarks: 1 missing (0.0%)
2026-02-17 12:04:23,632 - dq_unified - INFO - ============================================================
2026-02-17 12:04:23,632 - dq_unified - INFO -    Found 2 empty cells
2026-02-17 12:04:23,632 - dq_unified - INFO - 2. Checking for duplicate rows...
2026-02-17 12:04:23,632 - dq_unified - INFO - Checking for duplicate rows
2026-02-17 12:04:23,633 - dq_unified - INFO - Cleaning data (removing whitespace)...
2026-02-17 12:04:23,634 - dq_unified - INFO - Columns after cleaning: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-17 12:04:23,685 - dq_unified - INFO - Sample of first column after cleaning: 'nan'
2026-02-17 12:04:23,686 - dq_unified - INFO - Sample of row 6 first column: 'TXN6'
2026-02-17 12:04:23,686 - dq_unified - INFO - Total rows to check: 10517
2026-02-17 12:04:23,687 - dq_unified - INFO - Checking first column 'transaction_id' for serial numbers
2026-02-17 12:04:23,687 - dq_unified - INFO - First 5 values: ['nan', 'TXN2', 'TXN3', 'TXN4', 'TXN5']
2026-02-17 12:04:23,687 - dq_unified - INFO -   Row 1: 'nan' ‚Üí nan (numeric)
2026-02-17 12:04:23,688 - dq_unified - INFO -   Row 2: 'TXN2' ‚Üí Not numeric
2026-02-17 12:04:23,688 - dq_unified - INFO -   Row 3: 'TXN3' ‚Üí Not numeric
2026-02-17 12:04:23,688 - dq_unified - INFO - Not enough numeric values to be serial: [nan]
2026-02-17 12:04:23,688 - dq_unified - INFO - Checking duplicates on ALL columns
2026-02-17 12:04:23,689 - dq_unified - INFO - First few rows for comparison:
2026-02-17 12:04:23,689 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': 'AC000001', 'customer_email': 'user1@bank.com'}
2026-02-17 12:04:23,690 - dq_unified - INFO -   Row 1: {'transaction_id': 'TXN2', 'account_id': 'AC000002', 'customer_email': 'user2@bank.com'}
2026-02-17 12:04:23,690 - dq_unified - INFO -   Row 2: {'transaction_id': 'TXN3', 'account_id': 'AC000003', 'customer_email': 'bademail.com'}
2026-02-17 12:04:23,696 - dq_unified - INFO - Duplicate mask found 1034 rows
2026-02-17 12:04:23,697 - dq_unified - INFO - Found 1034 potential duplicate rows
2026-02-17 12:04:23,698 - dq_unified - INFO - Unique duplicate groups: 517
2026-02-17 12:04:23,699 - dq_unified - INFO - Duplicate groups found:
2026-02-17 12:04:23,699 - dq_unified - INFO -   Group sample: Pandas(Index=9483, transaction_id='TXN9484', account_id='AC009484', customer_email='user9484@bank.com', transaction_date='1/1/2024', amount='10483', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-17 12:04:23,700 - dq_unified - INFO -   Group sample: Pandas(Index=9484, transaction_id='TXN9485', account_id='AC009485', customer_email='user9485@bank.com', transaction_date='1/1/2024', amount='10484', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-17 12:04:23,700 - dq_unified - INFO -   Group sample: Pandas(Index=9485, transaction_id='TXN9486', account_id='AC009486', customer_email='user9486@bank.com', transaction_date='1/1/2024', amount='10485', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-17 12:04:23,700 - dq_unified - INFO - Processing 1034 duplicate indices
2026-02-17 12:04:23,722 - dq_unified - INFO - FINAL RESULT: Found 1034 duplicate groups
2026-02-17 12:04:23,723 - dq_error_log - INFO - Starting batch logging for 1034 errors, session: SINGLE_20260217_120422
2026-02-17 12:04:23,873 - dq_error_log - INFO - Batch 1: Successfully logged 500 errors
2026-02-17 12:04:23,997 - dq_error_log - INFO - Batch 2: Successfully logged 500 errors
2026-02-17 12:04:24,067 - dq_error_log - INFO - Batch 3: Successfully logged 34 errors
2026-02-17 12:04:24,068 - dq_error_log - INFO - Progress: 1034/1034 errors processed
2026-02-17 12:04:24,069 - dq_error_log - INFO - COMPLETE: Logged 1034/1034 errors for session SINGLE_20260217_120422
2026-02-17 12:04:24,070 - dq_unified - INFO -    Found 1,034 duplicate rows
2026-02-17 12:04:24,071 - dq_unified - INFO - 3. Checking data formats...
2026-02-17 12:04:24,071 - dq_unified - INFO - Checking data formats
2026-02-17 12:04:24,078 - dq_unified - INFO - Detected customer_email as email type
2026-02-17 12:04:24,078 - dq_unified - WARNING -   Row 3: 'bademail.com...' doesn't match Valid email format (user@domain.com)
2026-02-17 12:04:24,093 - dq_unified - INFO - Detected amount as numeric type
2026-02-17 12:04:24,094 - dq_unified - WARNING -   Row 5: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-17 12:04:24,112 - dq_unified - INFO - Total format issues found: 2
2026-02-17 12:04:24,113 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260217_120422
2026-02-17 12:04:24,180 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-17 12:04:24,181 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-17 12:04:24,181 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260217_120422
2026-02-17 12:04:24,182 - dq_unified - INFO -    Found 2 format issues
2026-02-17 12:04:24,183 - dq_unified - INFO - 4. Checking mandatory fields...
2026-02-17 12:04:24,183 - dq_unified - INFO - Checking mandatory fields
2026-02-17 12:04:24,184 - dq_unified - INFO - Available columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-17 12:04:24,184 - dq_unified - INFO - Checking ALL columns as mandatory: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-17 12:04:24,219 - dq_unified - WARNING - Mandatory field 'transaction_id': 1 missing values (100.0% filled)
2026-02-17 12:04:24,256 - dq_unified - INFO - Mandatory field 'account_id': 100.0% filled
2026-02-17 12:04:24,293 - dq_unified - INFO - Mandatory field 'customer_email': 100.0% filled
2026-02-17 12:04:24,329 - dq_unified - INFO - Mandatory field 'transaction_date': 100.0% filled
2026-02-17 12:04:24,368 - dq_unified - INFO - Mandatory field 'amount': 100.0% filled
2026-02-17 12:04:24,405 - dq_unified - INFO - Mandatory field 'currency': 100.0% filled
2026-02-17 12:04:24,442 - dq_unified - INFO - Mandatory field 'country': 100.0% filled
2026-02-17 12:04:24,477 - dq_unified - INFO - Mandatory field 'status': 100.0% filled
2026-02-17 12:04:24,514 - dq_unified - WARNING - Mandatory field 'remarks': 1 missing values (100.0% filled)
2026-02-17 12:04:24,846 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260217_120422
2026-02-17 12:04:24,914 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-17 12:04:24,915 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-17 12:04:24,916 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260217_120422
2026-02-17 12:04:24,916 - dq_unified - INFO - All columns mandatory: 2 unique rows with missing values
2026-02-17 12:04:24,917 - dq_unified - INFO -    Found 2 missing mandatory values
2026-02-17 12:04:24,917 - dq_unified - INFO - 5. Calculating quality score...
2026-02-17 12:04:24,917 - dq_unified - INFO - Calculating quality score
2026-02-17 12:04:24,918 - dq_unified - INFO - Quality Score Calculation:
2026-02-17 12:04:24,918 - dq_unified - INFO -   Total rows: 10,517
2026-02-17 12:04:24,918 - dq_unified - INFO -   Bad Rows: 1,038
2026-02-17 12:04:24,918 - dq_unified - INFO -   Good rows (no issues): 9,479
2026-02-17 12:04:24,919 - dq_unified - INFO -   Quality Score: 90.13%
2026-02-17 12:04:25,012 - dq_error_log - INFO - Retrieved 200 error logs for session SINGLE_20260217_120422
2026-02-17 12:04:25,084 - dq_error_log - INFO - Retrieved summary: 1040 total errors for session SINGLE_20260217_120422
2026-02-17 12:04:25,086 - dq_unified - INFO - Added 200 error logs to results
2026-02-17 12:04:25,086 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:04:25,087 - dq_audit - INFO - Starting database insertion for single_source...
2026-02-17 12:04:25,173 - dq_audit - INFO - Inserted single_source record with ID: 726
2026-02-17 12:04:25,249 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260217_120422
2026-02-17 12:04:25,251 - dq_unified - INFO - Added 1 audit logs to results
2026-02-17 12:04:25,251 - dq_unified - INFO - Analysis completed successfully for CSV: 20260217_120422_SINGLE_SOURCE_10000.csv
2026-02-17 12:04:25,251 - dq_unified - INFO - Final quality score: 90.13%
2026-02-17 12:04:25,351 - dq_error_log - INFO - Retrieved 200 error logs for session SINGLE_20260217_120422
2026-02-17 12:04:25,431 - dq_error_log - INFO - Retrieved summary: 1040 total errors for session SINGLE_20260217_120422
2026-02-17 12:04:25,504 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260217_120422
2026-02-17 12:04:25,506 - __main__ - INFO - Analysis completed for session SINGLE_20260217_120422
2026-02-17 12:04:25,533 - __main__ - INFO - Completed with status 200 in 2.757s
2026-02-17 12:04:25,586 - __main__ - INFO - GET /api/single/SINGLE_20260217_120422/errors - Request started
2026-02-17 12:04:25,588 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-17 12:04:25,910 - __main__ - INFO - GET /api/single/SINGLE_20260217_120422/errors - Request started
2026-02-17 12:04:25,912 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-17 12:04:43,841 - __main__ - INFO - GET /api/single/SINGLE_20260217_120422/errors - Request started
2026-02-17 12:04:43,843 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-17 12:06:39,945 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:06:39,977 - __main__ - INFO - File uploaded: 20260217_120639_finance10000.csv (csv)
2026-02-17 12:06:39,979 - __main__ - INFO - Completed with status 200 in 0.034s
2026-02-17 12:06:40,211 - __main__ - INFO - POST /api/advanced - Request started
2026-02-17 12:06:40,212 - __main__ - INFO - Advanced checks request received
2026-02-17 12:06:40,213 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-17 12:06:40,214 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-17 12:06:40,214 - __main__ - INFO - Starting advanced checks for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:40,215 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-17 12:06:40,216 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-17 12:06:40,216 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:06:40,216 - dq_unified - INFO - UI Data source_type: csv
2026-02-17 12:06:40,217 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-17 12:06:40,217 - dq_unified - INFO - Loading data from CSV
2026-02-17 12:06:40,217 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_120639_finance10000.csv
2026-02-17 12:06:40,222 - dq_unified - INFO - CSV file has 10,000 rows
2026-02-17 12:06:40,222 - dq_unified - INFO - Loading 10,000 rows from CSV...
2026-02-17 12:06:40,241 - dq_unified - INFO - Loaded 10,000 rows from CSV
2026-02-17 12:06:40,258 - dq_unified - INFO - Memory optimization: 4.1MB -> 2.1MB (Saved: 2.0MB)
2026-02-17 12:06:40,262 - dq_unified - INFO - Loaded 10,000 rows, 10 columns. Memory: 121.7MB total, 2.1MB for dataframe
2026-02-17 12:06:40,263 - dq_advanced - INFO - Data loaded: 10,000 rows, 10 columns from CSV: 20260217_120639_finance10000.csv
2026-02-17 12:06:40,263 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:06:40,330 - dq_error_log - INFO - Database connection successful
2026-02-17 12:06:40,332 - dq_advanced - INFO - Using provided Session ID: ADV_20260217_120640_38587ed4
2026-02-17 12:06:40,332 - dq_advanced - INFO - Starting comprehensive validations on 10,000 rows, 10 columns
2026-02-17 12:06:40,339 - dq_advanced - INFO - Memory: 3429MB available, 0.0004MB/row, Optimal batch: 50000 rows
2026-02-17 12:06:40,339 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-17 12:06:40,339 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-17 12:06:40,343 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-17 12:06:40,345 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 3 patterns
2026-02-17 12:06:40,350 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-17 12:06:40,356 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-17 12:06:40,363 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-17 12:06:40,370 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-17 12:06:40,375 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-17 12:06:40,378 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-17 12:06:40,382 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-17 12:06:40,386 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-17 12:06:42,454 - dq_error_log - INFO - Starting batch logging for 15314 errors, session: ADV_20260217_120640_38587ed4
2026-02-17 12:06:42,578 - dq_error_log - INFO - Batch 1: Successfully logged 500 errors
2026-02-17 12:06:42,714 - dq_error_log - INFO - Batch 2: Successfully logged 500 errors
2026-02-17 12:06:42,854 - dq_error_log - INFO - Batch 3: Successfully logged 500 errors
2026-02-17 12:06:42,988 - dq_error_log - INFO - Batch 4: Successfully logged 500 errors
2026-02-17 12:06:43,121 - dq_error_log - INFO - Batch 5: Successfully logged 500 errors
2026-02-17 12:06:43,290 - dq_error_log - INFO - Batch 6: Successfully logged 500 errors
2026-02-17 12:06:43,433 - dq_error_log - INFO - Batch 7: Successfully logged 500 errors
2026-02-17 12:06:43,561 - dq_error_log - INFO - Batch 8: Successfully logged 500 errors
2026-02-17 12:06:43,693 - dq_error_log - INFO - Batch 9: Successfully logged 500 errors
2026-02-17 12:06:43,826 - dq_error_log - INFO - Batch 10: Successfully logged 500 errors
2026-02-17 12:06:43,828 - dq_error_log - INFO - Progress: 5000/15314 errors processed
2026-02-17 12:06:43,957 - dq_error_log - INFO - Batch 11: Successfully logged 500 errors
2026-02-17 12:06:44,091 - dq_error_log - INFO - Batch 12: Successfully logged 500 errors
2026-02-17 12:06:44,217 - dq_error_log - INFO - Batch 13: Successfully logged 500 errors
2026-02-17 12:06:44,347 - dq_error_log - INFO - Batch 14: Successfully logged 500 errors
2026-02-17 12:06:44,479 - dq_error_log - INFO - Batch 15: Successfully logged 500 errors
2026-02-17 12:06:44,604 - dq_error_log - INFO - Batch 16: Successfully logged 500 errors
2026-02-17 12:06:44,731 - dq_error_log - INFO - Batch 17: Successfully logged 500 errors
2026-02-17 12:06:44,857 - dq_error_log - INFO - Batch 18: Successfully logged 500 errors
2026-02-17 12:06:44,983 - dq_error_log - INFO - Batch 19: Successfully logged 500 errors
2026-02-17 12:06:45,112 - dq_error_log - INFO - Batch 20: Successfully logged 500 errors
2026-02-17 12:06:45,114 - dq_error_log - INFO - Progress: 10000/15314 errors processed
2026-02-17 12:06:45,244 - dq_error_log - INFO - Batch 21: Successfully logged 500 errors
2026-02-17 12:06:45,414 - dq_error_log - INFO - Batch 22: Successfully logged 500 errors
2026-02-17 12:06:45,545 - dq_error_log - INFO - Batch 23: Successfully logged 500 errors
2026-02-17 12:06:45,681 - dq_error_log - INFO - Batch 24: Successfully logged 500 errors
2026-02-17 12:06:45,809 - dq_error_log - INFO - Batch 25: Successfully logged 500 errors
2026-02-17 12:06:46,246 - dq_error_log - INFO - Batch 26: Successfully logged 500 errors
2026-02-17 12:06:46,381 - dq_error_log - INFO - Batch 27: Successfully logged 500 errors
2026-02-17 12:06:46,512 - dq_error_log - INFO - Batch 28: Successfully logged 500 errors
2026-02-17 12:06:46,639 - dq_error_log - INFO - Batch 29: Successfully logged 500 errors
2026-02-17 12:06:46,765 - dq_error_log - INFO - Batch 30: Successfully logged 500 errors
2026-02-17 12:06:46,766 - dq_error_log - INFO - Progress: 15000/15314 errors processed
2026-02-17 12:06:46,874 - dq_error_log - INFO - Batch 31: Successfully logged 314 errors
2026-02-17 12:06:46,875 - dq_error_log - INFO - Progress: 15314/15314 errors processed
2026-02-17 12:06:46,876 - dq_error_log - INFO - COMPLETE: Logged 15314/15314 errors for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:46,877 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:06:46,877 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-17 12:06:46,950 - dq_audit - INFO - Inserted advanced record with ID: 727
2026-02-17 12:06:46,952 - dq_advanced - INFO - Audit record logged with ID: 727
2026-02-17 12:06:47,215 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,331 - dq_error_log - INFO - Retrieved summary: 15314 total errors for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,332 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:06:47,405 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,406 - dq_advanced - INFO - Advanced checks completed for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,650 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,766 - dq_error_log - INFO - Retrieved summary: 15314 total errors for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,844 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,845 - __main__ - INFO - Advanced checks completed for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:47,847 - __main__ - INFO - Completed with status 200 in 7.636s
2026-02-17 12:06:47,912 - __main__ - INFO - GET /api/advanced/ADV_20260217_120640_38587ed4 - Request started
2026-02-17 12:06:50,236 - dq_error_log - INFO - Retrieved 15314 error logs for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:50,247 - __main__ - INFO - Completed with status 200 in 2.335s
2026-02-17 12:06:50,570 - __main__ - INFO - GET /api/advanced/ADV_20260217_120640_38587ed4 - Request started
2026-02-17 12:06:52,750 - dq_error_log - INFO - Retrieved 15314 error logs for session ADV_20260217_120640_38587ed4
2026-02-17 12:06:52,759 - __main__ - INFO - Completed with status 200 in 2.189s
2026-02-17 12:07:55,473 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:07:55,474 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:07:55,475 - __main__ - INFO - Database: Not provided
2026-02-17 12:07:55,475 - __main__ - INFO - Schema: Not provided
2026-02-17 12:07:55,476 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:07:55,476 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:07:55,477 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:07:55,542 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:07:55,543 - __main__ - INFO - Getting databases list...
2026-02-17 12:07:55,544 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-17 12:07:55,570 - database_navigator - INFO - Found 7 databases
2026-02-17 12:07:55,571 - __main__ - INFO - Found 7 databases
2026-02-17 12:07:55,573 - __main__ - INFO - Completed with status 200 in 0.100s
2026-02-17 12:07:57,146 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:07:57,148 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:07:57,149 - __main__ - INFO - Database: dq_checks
2026-02-17 12:07:57,149 - __main__ - INFO - Schema: Not provided
2026-02-17 12:07:57,151 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:07:57,151 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:07:57,152 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:07:57,219 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:07:57,220 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-17 12:07:57,221 - database_navigator - INFO - Found 1 schemas
2026-02-17 12:07:57,222 - __main__ - INFO - Found 1 schemas
2026-02-17 12:07:57,223 - __main__ - INFO - Completed with status 200 in 0.077s
2026-02-17 12:07:59,095 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:07:59,096 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:07:59,097 - __main__ - INFO - Database: dq_checks
2026-02-17 12:07:59,098 - __main__ - INFO - Schema: dq_checks
2026-02-17 12:07:59,100 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:07:59,101 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:07:59,102 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:07:59,170 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:07:59,171 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-17 12:07:59,186 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-17 12:07:59,187 - __main__ - INFO - Found 28 tables
2026-02-17 12:07:59,188 - __main__ - INFO - Completed with status 200 in 0.093s
2026-02-17 12:08:02,194 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:08:02,226 - __main__ - INFO - File uploaded: 20260217_120802_finance10000.csv (csv)
2026-02-17 12:08:02,228 - __main__ - INFO - Completed with status 200 in 0.034s
2026-02-17 12:08:02,549 - __main__ - INFO - POST /api/advanced - Request started
2026-02-17 12:08:02,549 - __main__ - INFO - Advanced checks request received
2026-02-17 12:08:02,550 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-17 12:08:02,551 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-17 12:08:02,551 - __main__ - INFO - Starting advanced checks for session ADV_20260217_120802_510befee
2026-02-17 12:08:02,552 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-17 12:08:02,552 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-17 12:08:02,553 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:08:02,553 - dq_unified - INFO - UI Data source_type: database
2026-02-17 12:08:02,553 - dq_unified - INFO - Using source_type from UI data: database
2026-02-17 12:08:02,553 - dq_unified - INFO - Loading data from DATABASE
2026-02-17 12:08:02,554 - dq_unified - INFO - Loading large database table: advanced10000
2026-02-17 12:08:02,554 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-17 12:08:02,648 - dq_unified - INFO - MySQL table advanced10000 has 10,000 rows
2026-02-17 12:08:02,649 - dq_unified - INFO - Loading 10,000 rows from MySQL...
2026-02-17 12:08:05,013 - dq_unified - INFO - Loaded 10,000 rows from MySQL
2026-02-17 12:08:05,052 - dq_unified - INFO - Memory optimization: 5.5MB -> 3.5MB (Saved: 1.9MB)
2026-02-17 12:08:05,060 - dq_unified - INFO - Loaded 10,000 rows, 10 columns. Memory: 150.2MB total, 3.5MB for dataframe
2026-02-17 12:08:05,061 - dq_advanced - INFO - Data loaded: 10,000 rows, 10 columns from Database: mysql - Table: advanced10000
2026-02-17 12:08:05,061 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:08:05,121 - dq_error_log - INFO - Database connection successful
2026-02-17 12:08:05,123 - dq_advanced - INFO - Using provided Session ID: ADV_20260217_120802_510befee
2026-02-17 12:08:05,123 - dq_advanced - INFO - Starting comprehensive validations on 10,000 rows, 10 columns
2026-02-17 12:08:05,131 - dq_advanced - INFO - Memory: 3322MB available, 0.0005MB/row, Optimal batch: 50000 rows
2026-02-17 12:08:05,131 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-17 12:08:05,132 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-17 12:08:05,139 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-17 12:08:05,146 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 2 patterns
2026-02-17 12:08:05,153 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-17 12:08:05,159 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-17 12:08:05,166 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-17 12:08:05,173 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-17 12:08:05,177 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-17 12:08:05,184 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-17 12:08:05,188 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-17 12:08:05,192 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-17 12:08:07,254 - dq_error_log - INFO - Starting batch logging for 30314 errors, session: ADV_20260217_120802_510befee
2026-02-17 12:08:07,386 - dq_error_log - INFO - Batch 1: Successfully logged 500 errors
2026-02-17 12:08:07,522 - dq_error_log - INFO - Batch 2: Successfully logged 500 errors
2026-02-17 12:08:07,664 - dq_error_log - INFO - Batch 3: Successfully logged 500 errors
2026-02-17 12:08:07,794 - dq_error_log - INFO - Batch 4: Successfully logged 500 errors
2026-02-17 12:08:07,928 - dq_error_log - INFO - Batch 5: Successfully logged 500 errors
2026-02-17 12:08:08,080 - dq_error_log - INFO - Batch 6: Successfully logged 500 errors
2026-02-17 12:08:08,251 - dq_error_log - INFO - Batch 7: Successfully logged 500 errors
2026-02-17 12:08:08,394 - dq_error_log - INFO - Batch 8: Successfully logged 500 errors
2026-02-17 12:08:08,520 - dq_error_log - INFO - Batch 9: Successfully logged 500 errors
2026-02-17 12:08:08,652 - dq_error_log - INFO - Batch 10: Successfully logged 500 errors
2026-02-17 12:08:08,653 - dq_error_log - INFO - Progress: 5000/30314 errors processed
2026-02-17 12:08:08,778 - dq_error_log - INFO - Batch 11: Successfully logged 500 errors
2026-02-17 12:08:08,905 - dq_error_log - INFO - Batch 12: Successfully logged 500 errors
2026-02-17 12:08:09,031 - dq_error_log - INFO - Batch 13: Successfully logged 500 errors
2026-02-17 12:08:09,158 - dq_error_log - INFO - Batch 14: Successfully logged 500 errors
2026-02-17 12:08:09,282 - dq_error_log - INFO - Batch 15: Successfully logged 500 errors
2026-02-17 12:08:09,410 - dq_error_log - INFO - Batch 16: Successfully logged 500 errors
2026-02-17 12:08:09,536 - dq_error_log - INFO - Batch 17: Successfully logged 500 errors
2026-02-17 12:08:09,670 - dq_error_log - INFO - Batch 18: Successfully logged 500 errors
2026-02-17 12:08:09,797 - dq_error_log - INFO - Batch 19: Successfully logged 500 errors
2026-02-17 12:08:09,927 - dq_error_log - INFO - Batch 20: Successfully logged 500 errors
2026-02-17 12:08:09,930 - dq_error_log - INFO - Progress: 10000/30314 errors processed
2026-02-17 12:08:10,057 - dq_error_log - INFO - Batch 21: Successfully logged 500 errors
2026-02-17 12:08:10,189 - dq_error_log - INFO - Batch 22: Successfully logged 500 errors
2026-02-17 12:08:10,372 - dq_error_log - INFO - Batch 23: Successfully logged 500 errors
2026-02-17 12:08:10,507 - dq_error_log - INFO - Batch 24: Successfully logged 500 errors
2026-02-17 12:08:10,640 - dq_error_log - INFO - Batch 25: Successfully logged 500 errors
2026-02-17 12:08:10,785 - dq_error_log - INFO - Batch 26: Successfully logged 500 errors
2026-02-17 12:08:10,919 - dq_error_log - INFO - Batch 27: Successfully logged 500 errors
2026-02-17 12:08:11,050 - dq_error_log - INFO - Batch 28: Successfully logged 500 errors
2026-02-17 12:08:11,178 - dq_error_log - INFO - Batch 29: Successfully logged 500 errors
2026-02-17 12:08:11,301 - dq_error_log - INFO - Batch 30: Successfully logged 500 errors
2026-02-17 12:08:11,303 - dq_error_log - INFO - Progress: 15000/30314 errors processed
2026-02-17 12:08:11,422 - dq_error_log - INFO - Batch 31: Successfully logged 500 errors
2026-02-17 12:08:11,546 - dq_error_log - INFO - Batch 32: Successfully logged 500 errors
2026-02-17 12:08:11,670 - dq_error_log - INFO - Batch 33: Successfully logged 500 errors
2026-02-17 12:08:11,796 - dq_error_log - INFO - Batch 34: Successfully logged 500 errors
2026-02-17 12:08:11,931 - dq_error_log - INFO - Batch 35: Successfully logged 500 errors
2026-02-17 12:08:12,379 - dq_error_log - INFO - Batch 36: Successfully logged 500 errors
2026-02-17 12:08:12,507 - dq_error_log - INFO - Batch 37: Successfully logged 500 errors
2026-02-17 12:08:12,634 - dq_error_log - INFO - Batch 38: Successfully logged 500 errors
2026-02-17 12:08:13,138 - dq_error_log - INFO - Batch 39: Successfully logged 500 errors
2026-02-17 12:08:13,265 - dq_error_log - INFO - Batch 40: Successfully logged 500 errors
2026-02-17 12:08:13,267 - dq_error_log - INFO - Progress: 20000/30314 errors processed
2026-02-17 12:08:13,392 - dq_error_log - INFO - Batch 41: Successfully logged 500 errors
2026-02-17 12:08:13,527 - dq_error_log - INFO - Batch 42: Successfully logged 500 errors
2026-02-17 12:08:13,660 - dq_error_log - INFO - Batch 43: Successfully logged 500 errors
2026-02-17 12:08:13,789 - dq_error_log - INFO - Batch 44: Successfully logged 500 errors
2026-02-17 12:08:14,232 - dq_error_log - INFO - Batch 45: Successfully logged 500 errors
2026-02-17 12:08:14,360 - dq_error_log - INFO - Batch 46: Successfully logged 500 errors
2026-02-17 12:08:14,482 - dq_error_log - INFO - Batch 47: Successfully logged 500 errors
2026-02-17 12:08:14,607 - dq_error_log - INFO - Batch 48: Successfully logged 500 errors
2026-02-17 12:08:14,736 - dq_error_log - INFO - Batch 49: Successfully logged 500 errors
2026-02-17 12:08:14,867 - dq_error_log - INFO - Batch 50: Successfully logged 500 errors
2026-02-17 12:08:14,869 - dq_error_log - INFO - Progress: 25000/30314 errors processed
2026-02-17 12:08:14,991 - dq_error_log - INFO - Batch 51: Successfully logged 500 errors
2026-02-17 12:08:15,115 - dq_error_log - INFO - Batch 52: Successfully logged 500 errors
2026-02-17 12:08:15,550 - dq_error_log - INFO - Batch 53: Successfully logged 500 errors
2026-02-17 12:08:15,685 - dq_error_log - INFO - Batch 54: Successfully logged 500 errors
2026-02-17 12:08:15,898 - dq_error_log - INFO - Batch 55: Successfully logged 500 errors
2026-02-17 12:08:16,035 - dq_error_log - INFO - Batch 56: Successfully logged 500 errors
2026-02-17 12:08:16,165 - dq_error_log - INFO - Batch 57: Successfully logged 500 errors
2026-02-17 12:08:16,287 - dq_error_log - INFO - Batch 58: Successfully logged 500 errors
2026-02-17 12:08:16,425 - dq_error_log - INFO - Batch 59: Successfully logged 500 errors
2026-02-17 12:08:16,558 - dq_error_log - INFO - Batch 60: Successfully logged 500 errors
2026-02-17 12:08:16,560 - dq_error_log - INFO - Progress: 30000/30314 errors processed
2026-02-17 12:08:16,666 - dq_error_log - INFO - Batch 61: Successfully logged 314 errors
2026-02-17 12:08:16,668 - dq_error_log - INFO - Progress: 30314/30314 errors processed
2026-02-17 12:08:16,668 - dq_error_log - INFO - COMPLETE: Logged 30314/30314 errors for session ADV_20260217_120802_510befee
2026-02-17 12:08:16,670 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:08:16,670 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-17 12:08:16,740 - dq_audit - INFO - Inserted advanced record with ID: 728
2026-02-17 12:08:16,740 - dq_advanced - INFO - Audit record logged with ID: 728
2026-02-17 12:08:17,114 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_120802_510befee
2026-02-17 12:08:17,360 - dq_error_log - INFO - Retrieved summary: 30314 total errors for session ADV_20260217_120802_510befee
2026-02-17 12:08:17,362 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:08:17,434 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_120802_510befee
2026-02-17 12:08:17,436 - dq_advanced - INFO - Advanced checks completed for session ADV_20260217_120802_510befee
2026-02-17 12:08:17,793 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_120802_510befee
2026-02-17 12:08:17,960 - dq_error_log - INFO - Retrieved summary: 30314 total errors for session ADV_20260217_120802_510befee
2026-02-17 12:08:18,031 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_120802_510befee
2026-02-17 12:08:18,033 - __main__ - INFO - Advanced checks completed for session ADV_20260217_120802_510befee
2026-02-17 12:08:18,077 - __main__ - INFO - Completed with status 200 in 15.528s
2026-02-17 12:08:18,116 - __main__ - INFO - GET /api/advanced/ADV_20260217_120802_510befee - Request started
2026-02-17 12:08:21,805 - dq_error_log - INFO - Retrieved 30314 error logs for session ADV_20260217_120802_510befee
2026-02-17 12:08:21,818 - __main__ - INFO - Completed with status 200 in 3.703s
2026-02-17 12:09:01,038 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:09:01,040 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:09:01,041 - __main__ - INFO - Database: Not provided
2026-02-17 12:09:01,041 - __main__ - INFO - Schema: Not provided
2026-02-17 12:09:01,042 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:09:01,043 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:09:01,044 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:09:01,113 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:09:01,114 - __main__ - INFO - Getting databases list...
2026-02-17 12:09:01,115 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-17 12:09:01,121 - database_navigator - INFO - Found 7 databases
2026-02-17 12:09:01,122 - __main__ - INFO - Found 7 databases
2026-02-17 12:09:01,123 - __main__ - INFO - Completed with status 200 in 0.085s
2026-02-17 12:09:02,705 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:09:02,706 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:09:02,707 - __main__ - INFO - Database: dq_checks
2026-02-17 12:09:02,708 - __main__ - INFO - Schema: Not provided
2026-02-17 12:09:02,709 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:09:02,709 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:09:02,710 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:09:02,772 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:09:02,772 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-17 12:09:02,774 - database_navigator - INFO - Found 1 schemas
2026-02-17 12:09:02,774 - __main__ - INFO - Found 1 schemas
2026-02-17 12:09:02,776 - __main__ - INFO - Completed with status 200 in 0.071s
2026-02-17 12:09:04,478 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:09:04,481 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:09:04,481 - __main__ - INFO - Database: dq_checks
2026-02-17 12:09:04,482 - __main__ - INFO - Schema: dq_checks
2026-02-17 12:09:04,483 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:09:04,484 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:09:04,484 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:09:04,549 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:09:04,550 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-17 12:09:04,561 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-17 12:09:04,562 - __main__ - INFO - Found 28 tables
2026-02-17 12:09:04,564 - __main__ - INFO - Completed with status 200 in 0.086s
2026-02-17 12:09:10,308 - __main__ - INFO - POST /api/advanced - Request started
2026-02-17 12:09:10,310 - __main__ - INFO - Advanced checks request received
2026-02-17 12:09:10,311 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-17 12:09:10,311 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-17 12:09:10,312 - __main__ - INFO - Starting advanced checks for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:10,313 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-17 12:09:10,313 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-17 12:09:10,314 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:09:10,315 - dq_unified - INFO - UI Data source_type: database
2026-02-17 12:09:10,315 - dq_unified - INFO - Using source_type from UI data: database
2026-02-17 12:09:10,315 - dq_unified - INFO - Loading data from DATABASE
2026-02-17 12:09:10,316 - dq_unified - INFO - Loading large database table: advanced1000
2026-02-17 12:09:10,316 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-17 12:09:10,406 - dq_unified - INFO - MySQL table advanced1000 has 1,000 rows
2026-02-17 12:09:10,408 - dq_unified - INFO - Loading 1,000 rows from MySQL...
2026-02-17 12:09:10,511 - dq_unified - INFO - Loaded 1,000 rows from MySQL
2026-02-17 12:09:10,517 - dq_unified - INFO - Memory optimization: 0.5MB -> 0.4MB (Saved: 0.2MB)
2026-02-17 12:09:10,518 - dq_unified - INFO - Loaded 1,000 rows, 10 columns. Memory: 160.6MB total, 0.4MB for dataframe
2026-02-17 12:09:10,519 - dq_advanced - INFO - Data loaded: 1,000 rows, 10 columns from Database: mysql - Table: advanced1000
2026-02-17 12:09:10,519 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:09:10,586 - dq_error_log - INFO - Database connection successful
2026-02-17 12:09:10,587 - dq_advanced - INFO - Using provided Session ID: ADV_20260217_120910_8be57f0b
2026-02-17 12:09:10,588 - dq_advanced - INFO - Starting comprehensive validations on 1,000 rows, 10 columns
2026-02-17 12:09:10,595 - dq_advanced - INFO - Memory: 3216MB available, 0.0004MB/row, Optimal batch: 50000 rows
2026-02-17 12:09:10,596 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-17 12:09:10,597 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-17 12:09:10,599 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-17 12:09:10,602 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 2 patterns
2026-02-17 12:09:10,604 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-17 12:09:10,606 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-17 12:09:10,609 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-17 12:09:10,611 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-17 12:09:10,613 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-17 12:09:10,616 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-17 12:09:10,618 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-17 12:09:10,620 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-17 12:09:10,822 - dq_error_log - INFO - Starting batch logging for 3075 errors, session: ADV_20260217_120910_8be57f0b
2026-02-17 12:09:10,950 - dq_error_log - INFO - Batch 1: Successfully logged 500 errors
2026-02-17 12:09:11,073 - dq_error_log - INFO - Batch 2: Successfully logged 500 errors
2026-02-17 12:09:11,182 - dq_error_log - INFO - Batch 3: Successfully logged 500 errors
2026-02-17 12:09:11,301 - dq_error_log - INFO - Batch 4: Successfully logged 500 errors
2026-02-17 12:09:11,422 - dq_error_log - INFO - Batch 5: Successfully logged 500 errors
2026-02-17 12:09:11,540 - dq_error_log - INFO - Batch 6: Successfully logged 500 errors
2026-02-17 12:09:11,611 - dq_error_log - INFO - Batch 7: Successfully logged 75 errors
2026-02-17 12:09:11,613 - dq_error_log - INFO - Progress: 3075/3075 errors processed
2026-02-17 12:09:11,613 - dq_error_log - INFO - COMPLETE: Logged 3075/3075 errors for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:11,614 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:09:11,615 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-17 12:09:11,688 - dq_audit - INFO - Inserted advanced record with ID: 729
2026-02-17 12:09:11,689 - dq_advanced - INFO - Audit record logged with ID: 729
2026-02-17 12:09:11,828 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:11,908 - dq_error_log - INFO - Retrieved summary: 3075 total errors for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:11,909 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:09:11,979 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:11,980 - dq_advanced - INFO - Advanced checks completed for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:12,103 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:12,182 - dq_error_log - INFO - Retrieved summary: 3075 total errors for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:12,250 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:12,251 - __main__ - INFO - Advanced checks completed for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:12,258 - __main__ - INFO - Completed with status 200 in 1.950s
2026-02-17 12:09:12,300 - __main__ - INFO - GET /api/advanced/ADV_20260217_120910_8be57f0b - Request started
2026-02-17 12:09:12,724 - dq_error_log - INFO - Retrieved 3075 error logs for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:12,728 - __main__ - INFO - Completed with status 200 in 0.428s
2026-02-17 12:09:13,049 - __main__ - INFO - GET /api/advanced/ADV_20260217_120910_8be57f0b - Request started
2026-02-17 12:09:13,552 - dq_error_log - INFO - Retrieved 3075 error logs for session ADV_20260217_120910_8be57f0b
2026-02-17 12:09:13,555 - __main__ - INFO - Completed with status 200 in 0.506s
2026-02-17 12:12:38,602 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:12:38,603 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:12:38,604 - __main__ - INFO - Database: Not provided
2026-02-17 12:12:38,604 - __main__ - INFO - Schema: Not provided
2026-02-17 12:12:38,605 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:12:38,606 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:12:38,607 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:12:38,675 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:12:38,676 - __main__ - INFO - Getting databases list...
2026-02-17 12:12:38,676 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-17 12:12:38,685 - database_navigator - INFO - Found 7 databases
2026-02-17 12:12:38,686 - __main__ - INFO - Found 7 databases
2026-02-17 12:12:38,688 - __main__ - INFO - Completed with status 200 in 0.086s
2026-02-17 12:12:40,667 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:12:40,669 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:12:40,670 - __main__ - INFO - Database: dq_checks
2026-02-17 12:12:40,670 - __main__ - INFO - Schema: Not provided
2026-02-17 12:12:40,671 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:12:40,672 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:12:40,672 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:12:40,735 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:12:40,736 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-17 12:12:40,737 - database_navigator - INFO - Found 1 schemas
2026-02-17 12:12:40,738 - __main__ - INFO - Found 1 schemas
2026-02-17 12:12:40,739 - __main__ - INFO - Completed with status 200 in 0.072s
2026-02-17 12:12:42,528 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:12:42,529 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:12:42,529 - __main__ - INFO - Database: dq_checks
2026-02-17 12:12:42,530 - __main__ - INFO - Schema: dq_checks
2026-02-17 12:12:42,531 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:12:42,532 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:12:42,533 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:12:42,594 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:12:42,595 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-17 12:12:42,608 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-17 12:12:42,610 - __main__ - INFO - Found 28 tables
2026-02-17 12:12:42,611 - __main__ - INFO - Completed with status 200 in 0.083s
2026-02-17 12:12:46,678 - __main__ - INFO - POST /api/advanced - Request started
2026-02-17 12:12:46,679 - __main__ - INFO - Advanced checks request received
2026-02-17 12:12:46,680 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-17 12:12:46,681 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-17 12:12:46,683 - __main__ - INFO - Starting advanced checks for session ADV_20260217_121246_92753575
2026-02-17 12:12:46,685 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-17 12:12:46,686 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-17 12:12:46,687 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:12:46,687 - dq_unified - INFO - UI Data source_type: database
2026-02-17 12:12:46,688 - dq_unified - INFO - Using source_type from UI data: database
2026-02-17 12:12:46,688 - dq_unified - INFO - Loading data from DATABASE
2026-02-17 12:12:46,689 - dq_unified - INFO - Loading large database table: advanced10000
2026-02-17 12:12:46,689 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-17 12:12:46,765 - dq_unified - INFO - MySQL table advanced10000 has 10,010 rows
2026-02-17 12:12:46,766 - dq_unified - INFO - Loading 10,010 rows from MySQL...
2026-02-17 12:12:47,644 - dq_unified - INFO - Loaded 10,010 rows from MySQL
2026-02-17 12:12:47,678 - dq_unified - INFO - Memory optimization: 5.5MB -> 3.6MB (Saved: 1.9MB)
2026-02-17 12:12:47,685 - dq_unified - INFO - Loaded 10,010 rows, 10 columns. Memory: 167.9MB total, 3.6MB for dataframe
2026-02-17 12:12:47,686 - dq_advanced - INFO - Data loaded: 10,010 rows, 10 columns from Database: mysql - Table: advanced10000
2026-02-17 12:12:47,686 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:12:47,751 - dq_error_log - INFO - Database connection successful
2026-02-17 12:12:47,753 - dq_advanced - INFO - Using provided Session ID: ADV_20260217_121246_92753575
2026-02-17 12:12:47,754 - dq_advanced - INFO - Starting comprehensive validations on 10,010 rows, 10 columns
2026-02-17 12:12:47,761 - dq_advanced - INFO - Memory: 2688MB available, 0.0005MB/row, Optimal batch: 50000 rows
2026-02-17 12:12:47,762 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-17 12:12:47,762 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-17 12:12:47,769 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-17 12:12:47,776 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 2 patterns
2026-02-17 12:12:47,782 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-17 12:12:47,789 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-17 12:12:47,795 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-17 12:12:47,803 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-17 12:12:47,807 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-17 12:12:47,812 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-17 12:12:47,816 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-17 12:12:47,820 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-17 12:12:50,043 - dq_error_log - INFO - Starting batch logging for 30394 errors, session: ADV_20260217_121246_92753575
2026-02-17 12:12:50,176 - dq_error_log - INFO - Batch 1: Successfully logged 500 errors
2026-02-17 12:12:50,283 - dq_error_log - INFO - Batch 2: Successfully logged 500 errors
2026-02-17 12:12:50,411 - dq_error_log - INFO - Batch 3: Successfully logged 500 errors
2026-02-17 12:12:50,614 - dq_error_log - INFO - Batch 4: Successfully logged 500 errors
2026-02-17 12:12:50,738 - dq_error_log - INFO - Batch 5: Successfully logged 500 errors
2026-02-17 12:12:50,864 - dq_error_log - INFO - Batch 6: Successfully logged 500 errors
2026-02-17 12:12:50,972 - dq_error_log - INFO - Batch 7: Successfully logged 500 errors
2026-02-17 12:12:51,101 - dq_error_log - INFO - Batch 8: Successfully logged 500 errors
2026-02-17 12:12:51,221 - dq_error_log - INFO - Batch 9: Successfully logged 500 errors
2026-02-17 12:12:51,327 - dq_error_log - INFO - Batch 10: Successfully logged 500 errors
2026-02-17 12:12:51,328 - dq_error_log - INFO - Progress: 5000/30394 errors processed
2026-02-17 12:12:51,770 - dq_error_log - INFO - Batch 11: Successfully logged 500 errors
2026-02-17 12:12:51,895 - dq_error_log - INFO - Batch 12: Successfully logged 500 errors
2026-02-17 12:12:52,015 - dq_error_log - INFO - Batch 13: Successfully logged 500 errors
2026-02-17 12:12:52,460 - dq_error_log - INFO - Batch 14: Successfully logged 500 errors
2026-02-17 12:12:52,895 - dq_error_log - INFO - Batch 15: Successfully logged 500 errors
2026-02-17 12:12:53,017 - dq_error_log - INFO - Batch 16: Successfully logged 500 errors
2026-02-17 12:12:53,124 - dq_error_log - INFO - Batch 17: Successfully logged 500 errors
2026-02-17 12:12:53,250 - dq_error_log - INFO - Batch 18: Successfully logged 500 errors
2026-02-17 12:12:53,373 - dq_error_log - INFO - Batch 19: Successfully logged 500 errors
2026-02-17 12:12:53,482 - dq_error_log - INFO - Batch 20: Successfully logged 500 errors
2026-02-17 12:12:53,483 - dq_error_log - INFO - Progress: 10000/30394 errors processed
2026-02-17 12:12:53,652 - dq_error_log - INFO - Batch 21: Successfully logged 500 errors
2026-02-17 12:12:53,759 - dq_error_log - INFO - Batch 22: Successfully logged 500 errors
2026-02-17 12:12:53,882 - dq_error_log - INFO - Batch 23: Successfully logged 500 errors
2026-02-17 12:12:54,003 - dq_error_log - INFO - Batch 24: Successfully logged 500 errors
2026-02-17 12:12:54,108 - dq_error_log - INFO - Batch 25: Successfully logged 500 errors
2026-02-17 12:12:54,235 - dq_error_log - INFO - Batch 26: Successfully logged 500 errors
2026-02-17 12:12:54,357 - dq_error_log - INFO - Batch 27: Successfully logged 500 errors
2026-02-17 12:12:54,478 - dq_error_log - INFO - Batch 28: Successfully logged 500 errors
2026-02-17 12:12:54,597 - dq_error_log - INFO - Batch 29: Successfully logged 500 errors
2026-02-17 12:12:54,715 - dq_error_log - INFO - Batch 30: Successfully logged 500 errors
2026-02-17 12:12:54,717 - dq_error_log - INFO - Progress: 15000/30394 errors processed
2026-02-17 12:12:54,837 - dq_error_log - INFO - Batch 31: Successfully logged 500 errors
2026-02-17 12:12:54,949 - dq_error_log - INFO - Batch 32: Successfully logged 500 errors
2026-02-17 12:12:55,089 - dq_error_log - INFO - Batch 33: Successfully logged 500 errors
2026-02-17 12:12:55,231 - dq_error_log - INFO - Batch 34: Successfully logged 500 errors
2026-02-17 12:12:55,367 - dq_error_log - INFO - Batch 35: Successfully logged 500 errors
2026-02-17 12:12:55,501 - dq_error_log - INFO - Batch 36: Successfully logged 500 errors
2026-02-17 12:12:55,705 - dq_error_log - INFO - Batch 37: Successfully logged 500 errors
2026-02-17 12:12:55,844 - dq_error_log - INFO - Batch 38: Successfully logged 500 errors
2026-02-17 12:12:55,982 - dq_error_log - INFO - Batch 39: Successfully logged 500 errors
2026-02-17 12:12:56,116 - dq_error_log - INFO - Batch 40: Successfully logged 500 errors
2026-02-17 12:12:56,119 - dq_error_log - INFO - Progress: 20000/30394 errors processed
2026-02-17 12:12:56,231 - dq_error_log - INFO - Batch 41: Successfully logged 500 errors
2026-02-17 12:12:56,367 - dq_error_log - INFO - Batch 42: Successfully logged 500 errors
2026-02-17 12:12:56,503 - dq_error_log - INFO - Batch 43: Successfully logged 500 errors
2026-02-17 12:12:56,628 - dq_error_log - INFO - Batch 44: Successfully logged 500 errors
2026-02-17 12:12:56,737 - dq_error_log - INFO - Batch 45: Successfully logged 500 errors
2026-02-17 12:12:56,861 - dq_error_log - INFO - Batch 46: Successfully logged 500 errors
2026-02-17 12:12:56,987 - dq_error_log - INFO - Batch 47: Successfully logged 500 errors
2026-02-17 12:12:57,126 - dq_error_log - INFO - Batch 48: Successfully logged 500 errors
2026-02-17 12:12:57,262 - dq_error_log - INFO - Batch 49: Successfully logged 500 errors
2026-02-17 12:12:57,393 - dq_error_log - INFO - Batch 50: Successfully logged 500 errors
2026-02-17 12:12:57,395 - dq_error_log - INFO - Progress: 25000/30394 errors processed
2026-02-17 12:12:57,522 - dq_error_log - INFO - Batch 51: Successfully logged 500 errors
2026-02-17 12:12:57,638 - dq_error_log - INFO - Batch 52: Successfully logged 500 errors
2026-02-17 12:12:57,828 - dq_error_log - INFO - Batch 53: Successfully logged 500 errors
2026-02-17 12:12:57,961 - dq_error_log - INFO - Batch 54: Successfully logged 500 errors
2026-02-17 12:12:58,072 - dq_error_log - INFO - Batch 55: Successfully logged 500 errors
2026-02-17 12:12:58,207 - dq_error_log - INFO - Batch 56: Successfully logged 500 errors
2026-02-17 12:12:58,327 - dq_error_log - INFO - Batch 57: Successfully logged 500 errors
2026-02-17 12:12:58,453 - dq_error_log - INFO - Batch 58: Successfully logged 500 errors
2026-02-17 12:12:58,561 - dq_error_log - INFO - Batch 59: Successfully logged 500 errors
2026-02-17 12:12:58,689 - dq_error_log - INFO - Batch 60: Successfully logged 500 errors
2026-02-17 12:12:58,691 - dq_error_log - INFO - Progress: 30000/30394 errors processed
2026-02-17 12:12:58,805 - dq_error_log - INFO - Batch 61: Successfully logged 394 errors
2026-02-17 12:12:58,807 - dq_error_log - INFO - Progress: 30394/30394 errors processed
2026-02-17 12:12:58,807 - dq_error_log - INFO - COMPLETE: Logged 30394/30394 errors for session ADV_20260217_121246_92753575
2026-02-17 12:12:58,809 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:12:58,809 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-17 12:12:58,888 - dq_audit - INFO - Inserted advanced record with ID: 730
2026-02-17 12:12:58,890 - dq_advanced - INFO - Audit record logged with ID: 730
2026-02-17 12:12:59,255 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_121246_92753575
2026-02-17 12:12:59,554 - dq_error_log - INFO - Retrieved summary: 30394 total errors for session ADV_20260217_121246_92753575
2026-02-17 12:12:59,557 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:12:59,627 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_121246_92753575
2026-02-17 12:12:59,628 - dq_advanced - INFO - Advanced checks completed for session ADV_20260217_121246_92753575
2026-02-17 12:12:59,986 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_121246_92753575
2026-02-17 12:13:00,233 - dq_error_log - INFO - Retrieved summary: 30394 total errors for session ADV_20260217_121246_92753575
2026-02-17 12:13:00,303 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_121246_92753575
2026-02-17 12:13:00,304 - __main__ - INFO - Advanced checks completed for session ADV_20260217_121246_92753575
2026-02-17 12:13:00,353 - __main__ - INFO - Completed with status 200 in 13.675s
2026-02-17 12:13:00,728 - __main__ - INFO - GET /api/advanced/ADV_20260217_121246_92753575 - Request started
2026-02-17 12:13:05,200 - dq_error_log - INFO - Retrieved 30394 error logs for session ADV_20260217_121246_92753575
2026-02-17 12:13:05,226 - __main__ - INFO - Completed with status 200 in 4.498s
2026-02-17 12:13:05,260 - __main__ - INFO - GET /api/advanced/ADV_20260217_121246_92753575 - Request started
2026-02-17 12:13:09,792 - dq_error_log - INFO - Retrieved 30394 error logs for session ADV_20260217_121246_92753575
2026-02-17 12:13:09,806 - __main__ - INFO - Completed with status 200 in 4.546s
2026-02-17 12:14:18,693 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:14:18,694 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:14:18,696 - __main__ - INFO - Database: Not provided
2026-02-17 12:14:18,697 - __main__ - INFO - Schema: Not provided
2026-02-17 12:14:18,697 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:14:18,698 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:14:18,699 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:14:18,763 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:14:18,763 - __main__ - INFO - Getting databases list...
2026-02-17 12:14:18,764 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-17 12:14:18,771 - database_navigator - INFO - Found 7 databases
2026-02-17 12:14:18,772 - __main__ - INFO - Found 7 databases
2026-02-17 12:14:18,774 - __main__ - INFO - Completed with status 200 in 0.082s
2026-02-17 12:14:20,197 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:14:20,198 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:14:20,199 - __main__ - INFO - Database: dq_checks
2026-02-17 12:14:20,200 - __main__ - INFO - Schema: Not provided
2026-02-17 12:14:20,201 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:14:20,202 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:14:20,203 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:14:20,267 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:14:20,269 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-17 12:14:20,270 - database_navigator - INFO - Found 1 schemas
2026-02-17 12:14:20,272 - __main__ - INFO - Found 1 schemas
2026-02-17 12:14:20,273 - __main__ - INFO - Completed with status 200 in 0.076s
2026-02-17 12:14:22,016 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-17 12:14:22,018 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-17 12:14:22,020 - __main__ - INFO - Database: dq_checks
2026-02-17 12:14:22,021 - __main__ - INFO - Schema: dq_checks
2026-02-17 12:14:22,021 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-17 12:14:22,022 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-17 12:14:22,023 - database_navigator - INFO - Connecting to MYSQL...
2026-02-17 12:14:22,089 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-17 12:14:22,090 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-17 12:14:22,104 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-17 12:14:22,106 - __main__ - INFO - Found 28 tables
2026-02-17 12:14:22,107 - __main__ - INFO - Completed with status 200 in 0.092s
2026-02-17 12:14:24,357 - __main__ - INFO - POST /api/advanced - Request started
2026-02-17 12:14:24,358 - __main__ - INFO - Advanced checks request received
2026-02-17 12:14:24,359 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-17 12:14:24,360 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-17 12:14:24,361 - __main__ - INFO - Starting advanced checks for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:24,362 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-17 12:14:24,362 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-17 12:14:24,362 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:14:24,363 - dq_unified - INFO - UI Data source_type: database
2026-02-17 12:14:24,363 - dq_unified - INFO - Using source_type from UI data: database
2026-02-17 12:14:24,363 - dq_unified - INFO - Loading data from DATABASE
2026-02-17 12:14:24,363 - dq_unified - INFO - Loading large database table: advanced10000
2026-02-17 12:14:24,364 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-17 12:14:24,433 - dq_unified - INFO - MySQL table advanced10000 has 10,020 rows
2026-02-17 12:14:24,435 - dq_unified - INFO - Loading 10,020 rows from MySQL...
2026-02-17 12:14:25,354 - dq_unified - INFO - Loaded 10,020 rows from MySQL
2026-02-17 12:14:25,395 - dq_unified - INFO - Memory optimization: 5.5MB -> 3.6MB (Saved: 1.9MB)
2026-02-17 12:14:25,404 - dq_unified - INFO - Loaded 10,020 rows, 10 columns. Memory: 182.4MB total, 3.6MB for dataframe
2026-02-17 12:14:25,405 - dq_advanced - INFO - Data loaded: 10,020 rows, 10 columns from Database: mysql - Table: advanced10000
2026-02-17 12:14:25,405 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:14:25,473 - dq_error_log - INFO - Database connection successful
2026-02-17 12:14:25,475 - dq_advanced - INFO - Using provided Session ID: ADV_20260217_121424_c55d2387
2026-02-17 12:14:25,475 - dq_advanced - INFO - Starting comprehensive validations on 10,020 rows, 10 columns
2026-02-17 12:14:25,482 - dq_advanced - INFO - Memory: 2746MB available, 0.0005MB/row, Optimal batch: 50000 rows
2026-02-17 12:14:25,484 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-17 12:14:25,484 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-17 12:14:25,492 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-17 12:14:25,499 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 2 patterns
2026-02-17 12:14:25,506 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-17 12:14:25,512 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-17 12:14:25,519 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-17 12:14:25,527 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-17 12:14:25,532 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-17 12:14:25,538 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-17 12:14:25,542 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-17 12:14:25,547 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-17 12:14:27,632 - dq_error_log - INFO - Starting batch logging for 30394 errors, session: ADV_20260217_121424_c55d2387
2026-02-17 12:14:27,741 - dq_error_log - INFO - Batch 1: Successfully logged 500 errors
2026-02-17 12:14:27,847 - dq_error_log - INFO - Batch 2: Successfully logged 500 errors
2026-02-17 12:14:27,967 - dq_error_log - INFO - Batch 3: Successfully logged 500 errors
2026-02-17 12:14:28,073 - dq_error_log - INFO - Batch 4: Successfully logged 500 errors
2026-02-17 12:14:28,202 - dq_error_log - INFO - Batch 5: Successfully logged 500 errors
2026-02-17 12:14:28,316 - dq_error_log - INFO - Batch 6: Successfully logged 500 errors
2026-02-17 12:14:28,427 - dq_error_log - INFO - Batch 7: Successfully logged 500 errors
2026-02-17 12:14:28,606 - dq_error_log - INFO - Batch 8: Successfully logged 500 errors
2026-02-17 12:14:28,716 - dq_error_log - INFO - Batch 9: Successfully logged 500 errors
2026-02-17 12:14:28,837 - dq_error_log - INFO - Batch 10: Successfully logged 500 errors
2026-02-17 12:14:28,838 - dq_error_log - INFO - Progress: 5000/30394 errors processed
2026-02-17 12:14:29,281 - dq_error_log - INFO - Batch 11: Successfully logged 500 errors
2026-02-17 12:14:29,405 - dq_error_log - INFO - Batch 12: Successfully logged 500 errors
2026-02-17 12:14:29,512 - dq_error_log - INFO - Batch 13: Successfully logged 500 errors
2026-02-17 12:14:29,631 - dq_error_log - INFO - Batch 14: Successfully logged 500 errors
2026-02-17 12:14:29,740 - dq_error_log - INFO - Batch 15: Successfully logged 500 errors
2026-02-17 12:14:29,846 - dq_error_log - INFO - Batch 16: Successfully logged 500 errors
2026-02-17 12:14:29,969 - dq_error_log - INFO - Batch 17: Successfully logged 500 errors
2026-02-17 12:14:30,077 - dq_error_log - INFO - Batch 18: Successfully logged 500 errors
2026-02-17 12:14:30,202 - dq_error_log - INFO - Batch 19: Successfully logged 500 errors
2026-02-17 12:14:30,317 - dq_error_log - INFO - Batch 20: Successfully logged 500 errors
2026-02-17 12:14:30,318 - dq_error_log - INFO - Progress: 10000/30394 errors processed
2026-02-17 12:14:30,445 - dq_error_log - INFO - Batch 21: Successfully logged 500 errors
2026-02-17 12:14:30,553 - dq_error_log - INFO - Batch 22: Successfully logged 500 errors
2026-02-17 12:14:30,975 - dq_error_log - INFO - Batch 23: Successfully logged 500 errors
2026-02-17 12:14:31,180 - dq_error_log - INFO - Batch 24: Successfully logged 500 errors
2026-02-17 12:14:31,292 - dq_error_log - INFO - Batch 25: Successfully logged 500 errors
2026-02-17 12:14:31,424 - dq_error_log - INFO - Batch 26: Successfully logged 500 errors
2026-02-17 12:14:31,531 - dq_error_log - INFO - Batch 27: Successfully logged 500 errors
2026-02-17 12:14:31,654 - dq_error_log - INFO - Batch 28: Successfully logged 500 errors
2026-02-17 12:14:32,091 - dq_error_log - INFO - Batch 29: Successfully logged 500 errors
2026-02-17 12:14:32,194 - dq_error_log - INFO - Batch 30: Successfully logged 500 errors
2026-02-17 12:14:32,196 - dq_error_log - INFO - Progress: 15000/30394 errors processed
2026-02-17 12:14:32,623 - dq_error_log - INFO - Batch 31: Successfully logged 500 errors
2026-02-17 12:14:32,730 - dq_error_log - INFO - Batch 32: Successfully logged 500 errors
2026-02-17 12:14:32,837 - dq_error_log - INFO - Batch 33: Successfully logged 500 errors
2026-02-17 12:14:32,970 - dq_error_log - INFO - Batch 34: Successfully logged 500 errors
2026-02-17 12:14:33,083 - dq_error_log - INFO - Batch 35: Successfully logged 500 errors
2026-02-17 12:14:33,216 - dq_error_log - INFO - Batch 36: Successfully logged 500 errors
2026-02-17 12:14:33,326 - dq_error_log - INFO - Batch 37: Successfully logged 500 errors
2026-02-17 12:14:33,465 - dq_error_log - INFO - Batch 38: Successfully logged 500 errors
2026-02-17 12:14:33,584 - dq_error_log - INFO - Batch 39: Successfully logged 500 errors
2026-02-17 12:14:33,772 - dq_error_log - INFO - Batch 40: Successfully logged 500 errors
2026-02-17 12:14:33,774 - dq_error_log - INFO - Progress: 20000/30394 errors processed
2026-02-17 12:14:33,884 - dq_error_log - INFO - Batch 41: Successfully logged 500 errors
2026-02-17 12:14:34,009 - dq_error_log - INFO - Batch 42: Successfully logged 500 errors
2026-02-17 12:14:34,122 - dq_error_log - INFO - Batch 43: Successfully logged 500 errors
2026-02-17 12:14:34,237 - dq_error_log - INFO - Batch 44: Successfully logged 500 errors
2026-02-17 12:14:34,365 - dq_error_log - INFO - Batch 45: Successfully logged 500 errors
2026-02-17 12:14:34,476 - dq_error_log - INFO - Batch 46: Successfully logged 500 errors
2026-02-17 12:14:34,605 - dq_error_log - INFO - Batch 47: Successfully logged 500 errors
2026-02-17 12:14:34,719 - dq_error_log - INFO - Batch 48: Successfully logged 500 errors
2026-02-17 12:14:34,824 - dq_error_log - INFO - Batch 49: Successfully logged 500 errors
2026-02-17 12:14:34,952 - dq_error_log - INFO - Batch 50: Successfully logged 500 errors
2026-02-17 12:14:34,953 - dq_error_log - INFO - Progress: 25000/30394 errors processed
2026-02-17 12:14:35,068 - dq_error_log - INFO - Batch 51: Successfully logged 500 errors
2026-02-17 12:14:35,189 - dq_error_log - INFO - Batch 52: Successfully logged 500 errors
2026-02-17 12:14:35,297 - dq_error_log - INFO - Batch 53: Successfully logged 500 errors
2026-02-17 12:14:35,408 - dq_error_log - INFO - Batch 54: Successfully logged 500 errors
2026-02-17 12:14:35,543 - dq_error_log - INFO - Batch 55: Successfully logged 500 errors
2026-02-17 12:14:35,660 - dq_error_log - INFO - Batch 56: Successfully logged 500 errors
2026-02-17 12:14:35,832 - dq_error_log - INFO - Batch 57: Successfully logged 500 errors
2026-02-17 12:14:36,264 - dq_error_log - INFO - Batch 58: Successfully logged 500 errors
2026-02-17 12:14:36,404 - dq_error_log - INFO - Batch 59: Successfully logged 500 errors
2026-02-17 12:14:36,523 - dq_error_log - INFO - Batch 60: Successfully logged 500 errors
2026-02-17 12:14:36,525 - dq_error_log - INFO - Progress: 30000/30394 errors processed
2026-02-17 12:14:36,655 - dq_error_log - INFO - Batch 61: Successfully logged 394 errors
2026-02-17 12:14:36,656 - dq_error_log - INFO - Progress: 30394/30394 errors processed
2026-02-17 12:14:36,657 - dq_error_log - INFO - COMPLETE: Logged 30394/30394 errors for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:36,658 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:14:36,658 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-17 12:14:36,728 - dq_audit - INFO - Inserted advanced record with ID: 731
2026-02-17 12:14:36,730 - dq_advanced - INFO - Audit record logged with ID: 731
2026-02-17 12:14:37,012 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:37,259 - dq_error_log - INFO - Retrieved summary: 30394 total errors for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:37,261 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:14:37,333 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:37,334 - dq_advanced - INFO - Advanced checks completed for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:37,740 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:38,057 - dq_error_log - INFO - Retrieved summary: 30394 total errors for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:38,135 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:38,137 - __main__ - INFO - Advanced checks completed for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:38,185 - __main__ - INFO - Completed with status 200 in 13.828s
2026-02-17 12:14:38,593 - __main__ - INFO - GET /api/advanced/ADV_20260217_121424_c55d2387 - Request started
2026-02-17 12:14:42,694 - dq_error_log - INFO - Retrieved 30394 error logs for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:42,709 - __main__ - INFO - Completed with status 200 in 4.116s
2026-02-17 12:14:42,719 - __main__ - INFO - GET /api/advanced/ADV_20260217_121424_c55d2387 - Request started
2026-02-17 12:14:45,929 - dq_error_log - INFO - Retrieved 30394 error logs for session ADV_20260217_121424_c55d2387
2026-02-17 12:14:45,946 - __main__ - INFO - Completed with status 200 in 3.227s
2026-02-17 12:15:44,109 - __main__ - INFO - POST /api/advanced - Request started
2026-02-17 12:15:44,110 - __main__ - INFO - Advanced checks request received
2026-02-17 12:15:44,111 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-17 12:15:44,112 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-17 12:15:44,113 - __main__ - INFO - Starting advanced checks for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:44,113 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-17 12:15:44,114 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-17 12:15:44,114 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:15:44,114 - dq_unified - INFO - UI Data source_type: database
2026-02-17 12:15:44,115 - dq_unified - INFO - Using source_type from UI data: database
2026-02-17 12:15:44,115 - dq_unified - INFO - Loading data from DATABASE
2026-02-17 12:15:44,115 - dq_unified - INFO - Loading large database table: advanced10000
2026-02-17 12:15:44,115 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-17 12:15:44,181 - dq_unified - INFO - MySQL table advanced10000 has 10,060 rows
2026-02-17 12:15:44,181 - dq_unified - INFO - Loading 10,060 rows from MySQL...
2026-02-17 12:15:45,035 - dq_unified - INFO - Loaded 10,060 rows from MySQL
2026-02-17 12:15:45,070 - dq_unified - INFO - Memory optimization: 5.5MB -> 3.6MB (Saved: 1.9MB)
2026-02-17 12:15:45,078 - dq_unified - INFO - Loaded 10,060 rows, 10 columns. Memory: 196.6MB total, 3.6MB for dataframe
2026-02-17 12:15:45,078 - dq_advanced - INFO - Data loaded: 10,060 rows, 10 columns from Database: mysql - Table: advanced10000
2026-02-17 12:15:45,079 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:15:45,138 - dq_error_log - INFO - Database connection successful
2026-02-17 12:15:45,140 - dq_advanced - INFO - Using provided Session ID: ADV_20260217_121544_f8be7511
2026-02-17 12:15:45,140 - dq_advanced - INFO - Starting comprehensive validations on 10,060 rows, 10 columns
2026-02-17 12:15:45,148 - dq_advanced - INFO - Memory: 2806MB available, 0.0005MB/row, Optimal batch: 50000 rows
2026-02-17 12:15:45,148 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-17 12:15:45,149 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-17 12:15:45,155 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-17 12:15:45,164 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 2 patterns
2026-02-17 12:15:45,171 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-17 12:15:45,178 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-17 12:15:45,185 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-17 12:15:45,192 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-17 12:15:45,196 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-17 12:15:45,202 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-17 12:15:45,206 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-17 12:15:45,210 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-17 12:15:47,290 - dq_error_log - INFO - Starting batch logging for 30394 errors, session: ADV_20260217_121544_f8be7511
2026-02-17 12:15:47,412 - dq_error_log - INFO - Batch 1: Successfully logged 500 errors
2026-02-17 12:15:47,535 - dq_error_log - INFO - Batch 2: Successfully logged 500 errors
2026-02-17 12:15:47,661 - dq_error_log - INFO - Batch 3: Successfully logged 500 errors
2026-02-17 12:15:47,786 - dq_error_log - INFO - Batch 4: Successfully logged 500 errors
2026-02-17 12:15:47,918 - dq_error_log - INFO - Batch 5: Successfully logged 500 errors
2026-02-17 12:15:48,061 - dq_error_log - INFO - Batch 6: Successfully logged 500 errors
2026-02-17 12:15:48,188 - dq_error_log - INFO - Batch 7: Successfully logged 500 errors
2026-02-17 12:15:48,313 - dq_error_log - INFO - Batch 8: Successfully logged 500 errors
2026-02-17 12:15:48,436 - dq_error_log - INFO - Batch 9: Successfully logged 500 errors
2026-02-17 12:15:48,559 - dq_error_log - INFO - Batch 10: Successfully logged 500 errors
2026-02-17 12:15:48,561 - dq_error_log - INFO - Progress: 5000/30394 errors processed
2026-02-17 12:15:48,742 - dq_error_log - INFO - Batch 11: Successfully logged 500 errors
2026-02-17 12:15:48,873 - dq_error_log - INFO - Batch 12: Successfully logged 500 errors
2026-02-17 12:15:49,003 - dq_error_log - INFO - Batch 13: Successfully logged 500 errors
2026-02-17 12:15:49,132 - dq_error_log - INFO - Batch 14: Successfully logged 500 errors
2026-02-17 12:15:49,270 - dq_error_log - INFO - Batch 15: Successfully logged 500 errors
2026-02-17 12:15:49,374 - dq_error_log - INFO - Batch 16: Successfully logged 500 errors
2026-02-17 12:15:49,496 - dq_error_log - INFO - Batch 17: Successfully logged 500 errors
2026-02-17 12:15:49,625 - dq_error_log - INFO - Batch 18: Successfully logged 500 errors
2026-02-17 12:15:49,766 - dq_error_log - INFO - Batch 19: Successfully logged 500 errors
2026-02-17 12:15:50,206 - dq_error_log - INFO - Batch 20: Successfully logged 500 errors
2026-02-17 12:15:50,208 - dq_error_log - INFO - Progress: 10000/30394 errors processed
2026-02-17 12:15:50,640 - dq_error_log - INFO - Batch 21: Successfully logged 500 errors
2026-02-17 12:15:50,764 - dq_error_log - INFO - Batch 22: Successfully logged 500 errors
2026-02-17 12:15:50,888 - dq_error_log - INFO - Batch 23: Successfully logged 500 errors
2026-02-17 12:15:51,014 - dq_error_log - INFO - Batch 24: Successfully logged 500 errors
2026-02-17 12:15:51,146 - dq_error_log - INFO - Batch 25: Successfully logged 500 errors
2026-02-17 12:15:51,267 - dq_error_log - INFO - Batch 26: Successfully logged 500 errors
2026-02-17 12:15:51,451 - dq_error_log - INFO - Batch 27: Successfully logged 500 errors
2026-02-17 12:15:51,572 - dq_error_log - INFO - Batch 28: Successfully logged 500 errors
2026-02-17 12:15:52,000 - dq_error_log - INFO - Batch 29: Successfully logged 500 errors
2026-02-17 12:15:52,105 - dq_error_log - INFO - Batch 30: Successfully logged 500 errors
2026-02-17 12:15:52,107 - dq_error_log - INFO - Progress: 15000/30394 errors processed
2026-02-17 12:15:52,221 - dq_error_log - INFO - Batch 31: Successfully logged 500 errors
2026-02-17 12:15:52,645 - dq_error_log - INFO - Batch 32: Successfully logged 500 errors
2026-02-17 12:15:52,763 - dq_error_log - INFO - Batch 33: Successfully logged 500 errors
2026-02-17 12:15:52,887 - dq_error_log - INFO - Batch 34: Successfully logged 500 errors
2026-02-17 12:15:53,015 - dq_error_log - INFO - Batch 35: Successfully logged 500 errors
2026-02-17 12:15:53,145 - dq_error_log - INFO - Batch 36: Successfully logged 500 errors
2026-02-17 12:15:53,278 - dq_error_log - INFO - Batch 37: Successfully logged 500 errors
2026-02-17 12:15:53,408 - dq_error_log - INFO - Batch 38: Successfully logged 500 errors
2026-02-17 12:15:53,536 - dq_error_log - INFO - Batch 39: Successfully logged 500 errors
2026-02-17 12:15:53,651 - dq_error_log - INFO - Batch 40: Successfully logged 500 errors
2026-02-17 12:15:53,653 - dq_error_log - INFO - Progress: 20000/30394 errors processed
2026-02-17 12:15:53,789 - dq_error_log - INFO - Batch 41: Successfully logged 500 errors
2026-02-17 12:15:53,913 - dq_error_log - INFO - Batch 42: Successfully logged 500 errors
2026-02-17 12:15:54,038 - dq_error_log - INFO - Batch 43: Successfully logged 500 errors
2026-02-17 12:15:54,208 - dq_error_log - INFO - Batch 44: Successfully logged 500 errors
2026-02-17 12:15:54,331 - dq_error_log - INFO - Batch 45: Successfully logged 500 errors
2026-02-17 12:15:54,451 - dq_error_log - INFO - Batch 46: Successfully logged 500 errors
2026-02-17 12:15:54,571 - dq_error_log - INFO - Batch 47: Successfully logged 500 errors
2026-02-17 12:15:54,695 - dq_error_log - INFO - Batch 48: Successfully logged 500 errors
2026-02-17 12:15:54,824 - dq_error_log - INFO - Batch 49: Successfully logged 500 errors
2026-02-17 12:15:54,948 - dq_error_log - INFO - Batch 50: Successfully logged 500 errors
2026-02-17 12:15:54,949 - dq_error_log - INFO - Progress: 25000/30394 errors processed
2026-02-17 12:15:55,075 - dq_error_log - INFO - Batch 51: Successfully logged 500 errors
2026-02-17 12:15:55,199 - dq_error_log - INFO - Batch 52: Successfully logged 500 errors
2026-02-17 12:15:55,311 - dq_error_log - INFO - Batch 53: Successfully logged 500 errors
2026-02-17 12:15:55,435 - dq_error_log - INFO - Batch 54: Successfully logged 500 errors
2026-02-17 12:15:55,554 - dq_error_log - INFO - Batch 55: Successfully logged 500 errors
2026-02-17 12:15:55,677 - dq_error_log - INFO - Batch 56: Successfully logged 500 errors
2026-02-17 12:15:55,810 - dq_error_log - INFO - Batch 57: Successfully logged 500 errors
2026-02-17 12:15:55,936 - dq_error_log - INFO - Batch 58: Successfully logged 500 errors
2026-02-17 12:15:56,062 - dq_error_log - INFO - Batch 59: Successfully logged 500 errors
2026-02-17 12:15:56,265 - dq_error_log - INFO - Batch 60: Successfully logged 500 errors
2026-02-17 12:15:56,267 - dq_error_log - INFO - Progress: 30000/30394 errors processed
2026-02-17 12:15:56,384 - dq_error_log - INFO - Batch 61: Successfully logged 394 errors
2026-02-17 12:15:56,386 - dq_error_log - INFO - Progress: 30394/30394 errors processed
2026-02-17 12:15:56,386 - dq_error_log - INFO - COMPLETE: Logged 30394/30394 errors for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:56,388 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:15:56,389 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-17 12:15:56,459 - dq_audit - INFO - Inserted advanced record with ID: 732
2026-02-17 12:15:56,461 - dq_advanced - INFO - Audit record logged with ID: 732
2026-02-17 12:15:56,855 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,096 - dq_error_log - INFO - Retrieved summary: 30394 total errors for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,098 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:15:57,172 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,174 - dq_advanced - INFO - Advanced checks completed for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,538 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,773 - dq_error_log - INFO - Retrieved summary: 30394 total errors for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,844 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,845 - __main__ - INFO - Advanced checks completed for session ADV_20260217_121544_f8be7511
2026-02-17 12:15:57,897 - __main__ - INFO - Completed with status 200 in 13.788s
2026-02-17 12:15:57,940 - __main__ - INFO - GET /api/advanced/ADV_20260217_121544_f8be7511 - Request started
2026-02-17 12:16:01,262 - dq_error_log - INFO - Retrieved 30394 error logs for session ADV_20260217_121544_f8be7511
2026-02-17 12:16:01,277 - __main__ - INFO - Completed with status 200 in 3.338s
2026-02-17 12:17:31,940 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:17:31,955 - __main__ - INFO - File uploaded: 20260217_121731_source15.csv (csv)
2026-02-17 12:17:31,956 - __main__ - INFO - Completed with status 200 in 0.016s
2026-02-17 12:17:32,208 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:17:32,220 - __main__ - INFO - File uploaded: 20260217_121732_source15.csv (csv)
2026-02-17 12:17:32,222 - __main__ - INFO - Completed with status 200 in 0.014s
2026-02-17 12:17:32,283 - __main__ - INFO - POST /api/compare - Request started
2026-02-17 12:17:32,284 - __main__ - INFO - Comparison request - Source: csv, Target: csv
2026-02-17 12:17:32,285 - __main__ - INFO - Comparison analysis request received
2026-02-17 12:17:32,286 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_121731_source15.csv'}
2026-02-17 12:17:32,286 - __main__ - INFO - Starting comparison for session CMP_20260217_121732
2026-02-17 12:17:32,287 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-17 12:17:32,287 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-17 12:17:32,288 - dq_comparison - INFO - 
==================================================
2026-02-17 12:17:32,288 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-17 12:17:32,288 - dq_comparison - INFO - ==================================================
2026-02-17 12:17:32,289 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-17 12:17:32,289 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_121731_source15.csv
2026-02-17 12:17:32,293 - dq_comparison - INFO - SOURCE CSV loaded: 15 rows, 8 columns
2026-02-17 12:17:32,293 - dq_comparison - INFO - 
==================================================
2026-02-17 12:17:32,293 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-17 12:17:32,294 - dq_comparison - INFO - ==================================================
2026-02-17 12:17:32,294 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-17 12:17:32,294 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_121732_source15.csv
2026-02-17 12:17:32,298 - dq_comparison - INFO - TARGET CSV loaded: 15 rows, 8 columns
2026-02-17 12:17:32,298 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-17 12:17:32,298 - dq_comparison - INFO - Target data loaded: 15 rows, 8 columns
2026-02-17 12:17:32,299 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-17 12:17:32,299 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:17:32,299 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:17:32,299 - dq_comparison - INFO - Common columns lowercased: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:17:32,300 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-17 12:17:32,300 - dq_comparison - INFO - User column selection input: all
2026-02-17 12:17:32,300 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-17 12:17:32,300 - dq_comparison - INFO - Selected 8 columns for comparison: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type']...
2026-02-17 12:17:32,301 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-17 12:17:32,301 - dq_comparison - INFO - Report details - Source: CSV: 20260217_121731_source15.csv, Target: CSV: 20260217_121732_source15.csv, Selected columns: 8
2026-02-17 12:17:32,301 - dq_comparison - INFO - Initializing Error Logger...
2026-02-17 12:17:32,301 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:17:32,378 - dq_error_log - INFO - Database connection successful
2026-02-17 12:17:32,380 - dq_comparison - INFO - Session ID: CMP_20260217_121732
2026-02-17 12:17:32,381 - dq_comparison - INFO - ‚úÖ Row counts match: 15 rows
2026-02-17 12:17:32,381 - dq_comparison - INFO - Comparing column structures...
2026-02-17 12:17:32,382 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-17 12:17:32,383 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-17 12:17:32,383 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-17 12:17:32,387 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-17 12:17:32,389 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-17 12:17:32,390 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-17 12:17:32,390 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-17 12:17:32,395 - dq_comparison - INFO - Table metadata comparison complete. Match: True
2026-02-17 12:17:32,396 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-17 12:17:32,464 - dq_comparison - INFO - Starting comparison of 30 total rows...
2026-02-17 12:17:32,465 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-17 12:17:32,465 - dq_comparison - INFO - Column: transaction_date
2026-02-17 12:17:32,466 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-17 12:17:32,466 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-17 12:17:32,467 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-17 12:17:32,468 - dq_comparison - INFO -   Match: True
2026-02-17 12:17:32,468 - dq_comparison - INFO - Column: status
2026-02-17 12:17:32,469 - dq_comparison - INFO -   Source type: <class 'str'>, value: COMPLETED
2026-02-17 12:17:32,469 - dq_comparison - INFO -   Target type: <class 'str'>, value: COMPLETED
2026-02-17 12:17:32,470 - dq_comparison - INFO -   Normalized: 'completed' vs 'completed'
2026-02-17 12:17:32,470 - dq_comparison - INFO -   Match: True
2026-02-17 12:17:32,470 - dq_comparison - INFO - Column: transaction_id
2026-02-17 12:17:32,470 - dq_comparison - INFO -   Source type: <class 'str'>, value: TXN0000001
2026-02-17 12:17:32,470 - dq_comparison - INFO -   Target type: <class 'str'>, value: TXN0000001
2026-02-17 12:17:32,470 - dq_comparison - INFO -   Normalized: 'txn0000001' vs 'txn0000001'
2026-02-17 12:17:32,472 - dq_comparison - INFO -   Match: True
2026-02-17 12:17:32,472 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:17:32,472 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:17:32,473 - dq_comparison - INFO - Selected columns for comparison: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:17:32,473 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-17 12:17:32,473 - dq_comparison - INFO - Source columns: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:17:32,473 - dq_comparison - INFO - Target columns: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:17:32,474 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-17 12:17:32,475 - dq_comparison - INFO -    Hashing source data: 10.0% complete (3/30 rows)
2026-02-17 12:17:32,478 - dq_comparison - INFO -    Hashing source data: 20.0% complete (6/30 rows)
2026-02-17 12:17:32,480 - dq_comparison - INFO -    Hashing source data: 30.0% complete (9/30 rows)
2026-02-17 12:17:32,481 - dq_comparison - INFO -    Hashing source data: 40.0% complete (12/30 rows)
2026-02-17 12:17:32,483 - dq_comparison - INFO -    Hashing source data: 50.0% complete (15/30 rows)
2026-02-17 12:17:32,484 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-17 12:17:32,484 - dq_comparison - INFO - Hash 1: 5c968743a5ee267c... (sample row 0)
2026-02-17 12:17:32,484 - dq_comparison - INFO - Hash 2: 11b1eaa2a1fdd85b... (sample row 1)
2026-02-17 12:17:32,485 - dq_comparison - INFO - Hash 3: 89453097548893a0... (sample row 2)
2026-02-17 12:17:32,485 - dq_comparison - INFO - Generating hashes for target data (15 rows)...
2026-02-17 12:17:32,486 - dq_comparison - INFO -    Hashing target data: 60.0% complete (18/30 rows)
2026-02-17 12:17:32,488 - dq_comparison - INFO -    Hashing target data: 70.0% complete (21/30 rows)
2026-02-17 12:17:32,489 - dq_comparison - INFO -    Hashing target data: 80.0% complete (24/30 rows)
2026-02-17 12:17:32,491 - dq_comparison - INFO -    Hashing target data: 90.0% complete (27/30 rows)
2026-02-17 12:17:32,493 - dq_comparison - INFO -    Hashing target data: 100.0% complete (30/30 rows)
2026-02-17 12:17:32,494 - dq_comparison - INFO - 
======================================================================
2026-02-17 12:17:32,494 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-17 12:17:32,495 - dq_comparison - INFO - ======================================================================
2026-02-17 12:17:32,495 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-17 12:17:32,496 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:17:32,496 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-17 12:17:32,497 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-17 12:17:32,497 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,497 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:17:32,498 - dq_comparison - INFO -   Source: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:17:32,498 - dq_comparison - INFO -   Target: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:17:32,498 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,498 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-17 12:17:32,499 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-17 12:17:32,499 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-17 12:17:32,499 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,500 - dq_comparison - INFO - Column 'source_system' ‚Üí 'source_system':
2026-02-17 12:17:32,500 - dq_comparison - INFO -   Source: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:17:32,500 - dq_comparison - INFO -   Target: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:17:32,500 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,500 - dq_comparison - INFO - Column 'transaction_type' ‚Üí 'transaction_type':
2026-02-17 12:17:32,501 - dq_comparison - INFO -   Source: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:17:32,501 - dq_comparison - INFO -   Target: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:17:32,501 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,501 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-17 12:17:32,502 - dq_comparison - INFO - Source hash string start: 2024-02-01|completed|txn0000001...
2026-02-17 12:17:32,503 - dq_comparison - INFO - Target hash string start: 2024-02-01|completed|txn0000001...
2026-02-17 12:17:32,503 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:17:32,503 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-17 12:17:32,505 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:17:32,505 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-17 12:17:32,506 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-17 12:17:32,506 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,506 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:17:32,507 - dq_comparison - INFO -   Source: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:17:32,508 - dq_comparison - INFO -   Target: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:17:32,508 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,508 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-17 12:17:32,508 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-17 12:17:32,509 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-17 12:17:32,509 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,509 - dq_comparison - INFO - Column 'source_system' ‚Üí 'source_system':
2026-02-17 12:17:32,509 - dq_comparison - INFO -   Source: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:17:32,509 - dq_comparison - INFO -   Target: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:17:32,509 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,511 - dq_comparison - INFO - Column 'transaction_type' ‚Üí 'transaction_type':
2026-02-17 12:17:32,511 - dq_comparison - INFO -   Source: 'DEBIT' (type: str) ‚Üí 'debit'
2026-02-17 12:17:32,511 - dq_comparison - INFO -   Target: 'DEBIT' (type: str) ‚Üí 'debit'
2026-02-17 12:17:32,511 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,511 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-17 12:17:32,512 - dq_comparison - INFO - Source hash string start: 2024-03-01|completed|txn0000002...
2026-02-17 12:17:32,512 - dq_comparison - INFO - Target hash string start: 2024-03-01|completed|txn0000002...
2026-02-17 12:17:32,513 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:17:32,513 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-17 12:17:32,515 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:17:32,515 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-17 12:17:32,516 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-17 12:17:32,516 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,516 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:17:32,517 - dq_comparison - INFO -   Source: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:17:32,517 - dq_comparison - INFO -   Target: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:17:32,517 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,517 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-17 12:17:32,518 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-17 12:17:32,518 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-17 12:17:32,518 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,519 - dq_comparison - INFO - Column 'source_system' ‚Üí 'source_system':
2026-02-17 12:17:32,519 - dq_comparison - INFO -   Source: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:17:32,519 - dq_comparison - INFO -   Target: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:17:32,519 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,520 - dq_comparison - INFO - Column 'transaction_type' ‚Üí 'transaction_type':
2026-02-17 12:17:32,520 - dq_comparison - INFO -   Source: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:17:32,520 - dq_comparison - INFO -   Target: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:17:32,521 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:17:32,521 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-17 12:17:32,521 - dq_comparison - INFO - Source hash string start: 2024-04-01|completed|txn0000003...
2026-02-17 12:17:32,521 - dq_comparison - INFO - Target hash string start: 2024-04-01|completed|txn0000003...
2026-02-17 12:17:32,523 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:17:32,523 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-17 12:17:32,523 - dq_comparison - INFO - Column 1: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-02-17 12:17:32,524 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='1/2/2024'
2026-02-17 12:17:32,524 - dq_comparison - INFO - Column 2: 'status' (object) ‚Üî 'status' (object)
2026-02-17 12:17:32,524 - dq_comparison - INFO -   Sample: Source='COMPLETED', Target='COMPLETED'
2026-02-17 12:17:32,525 - dq_comparison - INFO - Column 3: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-17 12:17:32,525 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-17 12:17:32,525 - dq_comparison - INFO - Column 4: 'source_system' (object) ‚Üî 'source_system' (object)
2026-02-17 12:17:32,525 - dq_comparison - INFO -   Sample: Source='ERP_CORE', Target='ERP_CORE'
2026-02-17 12:17:32,525 - dq_comparison - INFO - Column 5: 'transaction_type' (object) ‚Üî 'transaction_type' (object)
2026-02-17 12:17:32,525 - dq_comparison - INFO -   Sample: Source='CREDIT', Target='CREDIT'
2026-02-17 12:17:32,525 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-17 12:17:32,527 - dq_comparison - INFO - Found 0 total mismatches
2026-02-17 12:17:32,527 - dq_comparison - INFO - Will process detailed comparisons for first 0 rows
2026-02-17 12:17:32,527 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-17 12:17:32,528 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-17 12:17:32,528 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 15
2026-02-17 12:17:32,528 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 15
2026-02-17 12:17:32,529 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 15
2026-02-17 12:17:32,529 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 0
2026-02-17 12:17:32,529 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 0
2026-02-17 12:17:32,530 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-17 12:17:32,530 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-17 12:17:32,531 - dq_comparison - INFO -   Common rows: 15
2026-02-17 12:17:32,531 - dq_comparison - INFO -   Unique to source: 0
2026-02-17 12:17:32,531 - dq_comparison - INFO -   Unique to target: 0
2026-02-17 12:17:32,531 - dq_comparison - INFO -   Value mismatches: 0
2026-02-17 12:17:32,532 - dq_comparison - INFO -   Missing rows: 0
2026-02-17 12:17:32,532 - dq_comparison - INFO -   Extra rows: 0
2026-02-17 12:17:32,532 - dq_comparison - INFO - Returning enhanced mismatch structure with 0 detailed mismatches
2026-02-17 12:17:32,532 - dq_comparison - INFO - New structure: 0 detailed mismatches
2026-02-17 12:17:32,534 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-17 12:17:32,546 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-17 12:17:32,547 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-17 12:17:32,621 - dq_error_log - INFO - Retrieved 0 error logs for session CMP_20260217_121732
2026-02-17 12:17:32,622 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-17 12:17:32,623 - dq_comparison - INFO -   Source rows: 15
2026-02-17 12:17:32,623 - dq_comparison - INFO -   Common rows (matched): 15
2026-02-17 12:17:32,623 - dq_comparison - INFO -   Calculation: (15 / 15) * 100 = 100.00%
2026-02-17 12:17:32,624 - dq_comparison - INFO -   Explanation: 15 matched rows out of 15 total source rows
2026-02-17 12:17:32,624 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-17 12:17:32,624 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-17 12:17:32,624 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:17:32,625 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260217_121732
2026-02-17 12:17:32,625 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-17 12:17:32,702 - dq_audit - INFO - Inserted comparison record with ID: 733
2026-02-17 12:17:32,703 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 733)
2026-02-17 12:17:32,775 - dq_error_log - INFO - Retrieved 0 error logs for session CMP_20260217_121732
2026-02-17 12:17:32,847 - dq_error_log - INFO - Retrieved summary: 0 total errors for session CMP_20260217_121732
2026-02-17 12:17:32,848 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:17:32,924 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_121732
2026-02-17 12:17:32,926 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-17 12:17:32,926 - dq_comparison - INFO -    Session ID: CMP_20260217_121732
2026-02-17 12:17:32,926 - dq_comparison - INFO -    DQ Score (Simple %): 100.00%
2026-02-17 12:17:32,927 - dq_comparison - INFO -    Source rows: 15
2026-02-17 12:17:32,928 - dq_comparison - INFO -    Matched rows: 15
2026-02-17 12:17:32,928 - dq_comparison - INFO -    Calculation: (15 / 15) * 100
2026-02-17 12:17:32,929 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-17 12:17:33,003 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_121732
2026-02-17 12:17:33,072 - dq_error_log - INFO - Retrieved 0 error logs for session CMP_20260217_121732
2026-02-17 12:17:33,137 - dq_error_log - INFO - Retrieved summary: 0 total errors for session CMP_20260217_121732
2026-02-17 12:17:33,139 - __main__ - INFO - Completed with status 200 in 0.857s
2026-02-17 12:17:33,237 - __main__ - INFO - GET /api/compare/CMP_20260217_121732/mismatches - Request started
2026-02-17 12:17:33,379 - __main__ - INFO - Completed with status 200 in 0.142s
2026-02-17 12:17:33,701 - __main__ - INFO - GET /api/compare/CMP_20260217_121732/mismatches - Request started
2026-02-17 12:17:33,840 - __main__ - INFO - Completed with status 200 in 0.139s
2026-02-17 12:18:47,935 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:18:47,991 - __main__ - INFO - File uploaded: 20260217_121847_comparison_medium_source15k.csv (csv)
2026-02-17 12:18:47,992 - __main__ - INFO - Completed with status 200 in 0.057s
2026-02-17 12:18:48,318 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:18:48,420 - __main__ - INFO - File uploaded: 20260217_121848_comparison_medium_target10k.xlsx (excel)
2026-02-17 12:18:48,421 - __main__ - INFO - Completed with status 200 in 0.104s
2026-02-17 12:18:48,585 - __main__ - INFO - POST /api/compare - Request started
2026-02-17 12:18:48,585 - __main__ - INFO - Comparison request - Source: csv, Target: excel
2026-02-17 12:18:48,586 - __main__ - INFO - Comparison analysis request received
2026-02-17 12:18:48,587 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_121847_comparison_medium_source15k.csv'}
2026-02-17 12:18:48,587 - __main__ - INFO - Starting comparison for session CMP_20260217_121848
2026-02-17 12:18:48,588 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-17 12:18:48,588 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-17 12:18:48,588 - dq_comparison - INFO - 
==================================================
2026-02-17 12:18:48,589 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-17 12:18:48,589 - dq_comparison - INFO - ==================================================
2026-02-17 12:18:48,589 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-17 12:18:48,589 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_121847_comparison_medium_source15k.csv
2026-02-17 12:18:48,626 - dq_comparison - INFO - SOURCE CSV loaded: 15,000 rows, 16 columns
2026-02-17 12:18:48,626 - dq_comparison - INFO - 
==================================================
2026-02-17 12:18:48,627 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-17 12:18:48,627 - dq_comparison - INFO - ==================================================
2026-02-17 12:18:48,627 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-17 12:18:48,628 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_121848_comparison_medium_target10k.xlsx'}
2026-02-17 12:18:48,628 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-17 12:18:48,628 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_121848_comparison_medium_target10k.xlsx
2026-02-17 12:18:51,408 - dq_comparison - INFO - TARGET Excel loaded: 10,000 rows, 16 columns
2026-02-17 12:18:51,408 - dq_comparison - INFO - Source data loaded: 15000 rows, 16 columns
2026-02-17 12:18:51,409 - dq_comparison - INFO - Target data loaded: 10000 rows, 16 columns
2026-02-17 12:18:51,409 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-17 12:18:51,409 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:18:51,410 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:18:51,410 - dq_comparison - INFO - Common columns lowercased: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:18:51,410 - dq_comparison - INFO - Found 16 common columns between source and target (case-insensitive)
2026-02-17 12:18:51,411 - dq_comparison - INFO - User column selection input: all
2026-02-17 12:18:51,411 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-17 12:18:51,411 - dq_comparison - INFO - Selected 16 columns for comparison: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category']...
2026-02-17 12:18:51,412 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-17 12:18:51,412 - dq_comparison - INFO - Report details - Source: CSV: 20260217_121847_comparison_medium_source15k.csv, Target: Excel: 20260217_121848_comparison_medium_target10k.xlsx (comparison_medium_target10k), Selected columns: 16
2026-02-17 12:18:51,412 - dq_comparison - INFO - Initializing Error Logger...
2026-02-17 12:18:51,412 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:18:51,476 - dq_error_log - INFO - Database connection successful
2026-02-17 12:18:51,478 - dq_comparison - INFO - Session ID: CMP_20260217_121851
2026-02-17 12:18:51,478 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15,000, Target=10,000, Difference=5,000
2026-02-17 12:18:51,479 - dq_comparison - WARNING -    Missing in target: 5,000 rows
2026-02-17 12:18:51,479 - dq_comparison - INFO - Comparing column structures...
2026-02-17 12:18:51,480 - dq_comparison - WARNING - Found 4 incompatible data type mismatches
2026-02-17 12:18:51,480 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-17 12:18:51,480 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-17 12:18:51,481 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-17 12:18:51,518 - dq_comparison - INFO - Auto-detected common key fields: ['reference_code', 'transaction_id']
2026-02-17 12:18:51,522 - dq_comparison - INFO - Primary key validation passed for fields: ['reference_code', 'transaction_id']
2026-02-17 12:18:51,523 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-17 12:18:51,523 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-17 12:18:51,620 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-17 12:18:51,621 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-17 12:18:51,623 - dq_comparison - INFO - Starting comparison of 25,000 total rows...
2026-02-17 12:18:51,624 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-17 12:18:51,624 - dq_comparison - INFO - Column: transaction_date
2026-02-17 12:18:51,624 - dq_comparison - INFO -   Source type: <class 'str'>, value: 2024-01-01
2026-02-17 12:18:51,625 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-01 00:00:00
2026-02-17 12:18:51,626 - dq_comparison - INFO -   Normalized: '2024-01-01' vs '2024-01-01'
2026-02-17 12:18:51,627 - dq_comparison - INFO -   Match: True
2026-02-17 12:18:51,627 - dq_comparison - INFO - Column: status
2026-02-17 12:18:51,628 - dq_comparison - INFO -   Source type: <class 'str'>, value: SUCCESS
2026-02-17 12:18:51,628 - dq_comparison - INFO -   Target type: <class 'str'>, value: SUCCESS
2026-02-17 12:18:51,628 - dq_comparison - INFO -   Normalized: 'success' vs 'success'
2026-02-17 12:18:51,629 - dq_comparison - INFO -   Match: True
2026-02-17 12:18:51,629 - dq_comparison - INFO - Column: balance_after
2026-02-17 12:18:51,629 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 45408.36
2026-02-17 12:18:51,630 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 45428.36
2026-02-17 12:18:51,630 - dq_comparison - INFO -   Normalized: '45408.36' vs '45428.36'
2026-02-17 12:18:51,630 - dq_comparison - INFO -   Match: False
2026-02-17 12:18:51,631 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:18:51,631 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:18:51,631 - dq_comparison - INFO - Selected columns for comparison: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:18:51,632 - dq_comparison - INFO - Using 16 common columns for hash comparison
2026-02-17 12:18:51,632 - dq_comparison - INFO - Source columns: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:18:51,632 - dq_comparison - INFO - Target columns: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:18:51,633 - dq_comparison - INFO - Generating hashes for source data (15000 rows)...
2026-02-17 12:18:54,677 - dq_comparison - INFO -    Hashing source data: 10.0% complete (2,500/25,000 rows)
2026-02-17 12:18:57,797 - dq_comparison - INFO -    Hashing source data: 20.0% complete (5,000/25,000 rows)
2026-02-17 12:19:00,882 - dq_comparison - INFO -    Hashing source data: 30.0% complete (7,500/25,000 rows)
2026-02-17 12:19:03,967 - dq_comparison - INFO -    Hashing source data: 40.0% complete (10,000/25,000 rows)
2026-02-17 12:19:07,154 - dq_comparison - INFO -    Hashing source data: 50.0% complete (12,500/25,000 rows)
2026-02-17 12:19:10,228 - dq_comparison - INFO -    Hashing source data: 60.0% complete (15,000/25,000 rows)
2026-02-17 12:19:10,230 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-17 12:19:10,232 - dq_comparison - INFO - Hash 1: fc35f151425c3062... (sample row 0)
2026-02-17 12:19:10,232 - dq_comparison - INFO - Hash 2: c8ab863f364c784b... (sample row 1)
2026-02-17 12:19:10,233 - dq_comparison - INFO - Hash 3: 3010ff8e91cc7651... (sample row 2)
2026-02-17 12:19:10,233 - dq_comparison - INFO - Generating hashes for target data (10000 rows)...
2026-02-17 12:19:13,657 - dq_comparison - INFO -    Hashing target data: 70.0% complete (17,500/25,000 rows)
2026-02-17 12:19:17,112 - dq_comparison - INFO -    Hashing target data: 80.0% complete (20,000/25,000 rows)
2026-02-17 12:19:20,594 - dq_comparison - INFO -    Hashing target data: 90.0% complete (22,500/25,000 rows)
2026-02-17 12:19:25,562 - dq_comparison - INFO -    Hashing target data: 100.0% complete (25,000/25,000 rows)
2026-02-17 12:19:25,565 - dq_comparison - INFO - 
======================================================================
2026-02-17 12:19:25,566 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-17 12:19:25,566 - dq_comparison - INFO - ======================================================================
2026-02-17 12:19:25,566 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-17 12:19:25,570 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:19:25,573 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:19:25,574 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:19:25,575 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,577 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:19:25,578 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:19:25,580 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:19:25,582 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,584 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:19:25,585 - dq_comparison - INFO -   Source: '45408.36' (type: float64) ‚Üí '45408.36'
2026-02-17 12:19:25,586 - dq_comparison - INFO -   Target: '45428.36' (type: float64) ‚Üí '45428.36'
2026-02-17 12:19:25,588 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-17 12:19:25,589 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:19:25,591 - dq_comparison - INFO -   Source: 'DE' (type: str) ‚Üí 'de'
2026-02-17 12:19:25,592 - dq_comparison - INFO -   Target: 'DE' (type: str) ‚Üí 'de'
2026-02-17 12:19:25,593 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,594 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:19:25,594 - dq_comparison - INFO -   Source: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:19:25,595 - dq_comparison - INFO -   Target: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:19:25,596 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,597 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-17 12:19:25,600 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|45408.36...
2026-02-17 12:19:25,602 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|45428.36...
2026-02-17 12:19:25,604 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-17 12:19:25,606 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-17 12:19:25,610 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:19:25,612 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:19:25,613 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:19:25,615 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,615 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:19:25,616 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:19:25,616 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:19:25,617 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,618 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:19:25,619 - dq_comparison - INFO -   Source: '45689.68' (type: float64) ‚Üí '45689.68'
2026-02-17 12:19:25,623 - dq_comparison - INFO -   Target: '45649.68' (type: float64) ‚Üí '45649.68'
2026-02-17 12:19:25,624 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-17 12:19:25,624 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:19:25,625 - dq_comparison - INFO -   Source: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:19:25,625 - dq_comparison - INFO -   Target: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:19:25,626 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,627 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:19:25,627 - dq_comparison - INFO -   Source: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:19:25,628 - dq_comparison - INFO -   Target: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:19:25,628 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,628 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-17 12:19:25,630 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|45689.68...
2026-02-17 12:19:25,631 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|45649.68...
2026-02-17 12:19:25,631 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-17 12:19:25,632 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-17 12:19:25,633 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:19:25,635 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:19:25,636 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:19:25,637 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,637 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:19:25,638 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:19:25,638 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:19:25,638 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,639 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:19:25,639 - dq_comparison - INFO -   Source: '45185.19' (type: float64) ‚Üí '45185.19'
2026-02-17 12:19:25,640 - dq_comparison - INFO -   Target: '45185.19' (type: float64) ‚Üí '45185.19'
2026-02-17 12:19:25,640 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,641 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:19:25,642 - dq_comparison - INFO -   Source: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:19:25,642 - dq_comparison - INFO -   Target: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:19:25,643 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,643 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:19:25,644 - dq_comparison - INFO -   Source: 'Electronics' (type: str) ‚Üí 'electronics'
2026-02-17 12:19:25,644 - dq_comparison - INFO -   Target: 'Electronics' (type: str) ‚Üí 'electronics'
2026-02-17 12:19:25,645 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:19:25,645 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-17 12:19:25,647 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|45185.19...
2026-02-17 12:19:25,647 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|45185.19...
2026-02-17 12:19:25,648 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:19:25,649 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-17 12:19:25,649 - dq_comparison - INFO - Column 1: 'transaction_date' (object) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-17 12:19:25,650 - dq_comparison - INFO -   Sample: Source='2024-01-01', Target='2024-01-01 00:00:00'
2026-02-17 12:19:25,651 - dq_comparison - INFO - Column 2: 'status' (object) ‚Üî 'status' (object)
2026-02-17 12:19:25,652 - dq_comparison - INFO -   Sample: Source='SUCCESS', Target='SUCCESS'
2026-02-17 12:19:25,654 - dq_comparison - INFO - Column 3: 'balance_after' (float64) ‚Üî 'balance_after' (float64)
2026-02-17 12:19:25,655 - dq_comparison - INFO -   Sample: Source='45408.36', Target='45428.36'
2026-02-17 12:19:25,655 - dq_comparison - INFO - Column 4: 'country' (object) ‚Üî 'country' (object)
2026-02-17 12:19:25,656 - dq_comparison - INFO -   Sample: Source='DE', Target='DE'
2026-02-17 12:19:25,657 - dq_comparison - INFO - Column 5: 'merchant_category' (object) ‚Üî 'merchant_category' (object)
2026-02-17 12:19:25,658 - dq_comparison - INFO -   Sample: Source='Transport', Target='Transport'
2026-02-17 12:19:25,658 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-17 12:19:25,663 - dq_comparison - INFO - Found 5,004 total mismatches
2026-02-17 12:19:25,664 - dq_comparison - INFO - Will process detailed comparisons for first 5,000 rows
2026-02-17 12:20:01,662 - dq_comparison - INFO - Progress: 500/5,000 rows (36.0s)
2026-02-17 12:20:35,900 - dq_comparison - INFO - Progress: 1,000/5,000 rows (70.2s)
2026-02-17 12:21:08,935 - dq_comparison - INFO - Progress: 1,500/5,000 rows (103.3s)
2026-02-17 12:21:40,743 - dq_comparison - INFO - Progress: 2,000/5,000 rows (135.1s)
2026-02-17 12:22:10,816 - dq_comparison - INFO - Progress: 2,500/5,000 rows (165.2s)
2026-02-17 12:22:41,379 - dq_comparison - INFO - Progress: 3,000/5,000 rows (195.7s)
2026-02-17 12:23:20,959 - dq_comparison - INFO - Progress: 3,500/5,000 rows (235.3s)
2026-02-17 12:23:59,265 - dq_comparison - INFO - Progress: 4,000/5,000 rows (273.6s)
2026-02-17 12:24:36,819 - dq_comparison - INFO - Progress: 4,500/5,000 rows (311.2s)
2026-02-17 12:25:17,659 - dq_comparison - INFO - Progress: 5,000/5,000 rows (352.0s)
2026-02-17 12:25:17,739 - dq_comparison - INFO - 
================================================================================
2026-02-17 12:25:17,740 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-17 12:25:17,740 - dq_comparison - INFO -   Total mismatches found: 5000
2026-02-17 12:25:17,741 - dq_comparison - INFO -   Detailed comparisons logged: 5000
2026-02-17 12:25:17,741 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-17 12:25:17,741 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-17 12:25:17,742 - dq_comparison - INFO -   Use API to retrieve all 5000 mismatches
2026-02-17 12:25:17,742 - dq_comparison - INFO - ================================================================================
2026-02-17 12:25:17,748 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-17 12:25:17,749 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15000
2026-02-17 12:25:17,749 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 10000
2026-02-17 12:25:17,750 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 9998
2026-02-17 12:25:17,750 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 9,998
2026-02-17 12:25:17,751 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 5,002
2026-02-17 12:25:17,751 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-17 12:25:17,757 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-17 12:25:17,758 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-17 12:25:17,758 - dq_comparison - INFO -   Common rows: 9,998
2026-02-17 12:25:17,758 - dq_comparison - INFO -   Unique to source: 5,002
2026-02-17 12:25:17,759 - dq_comparison - INFO -   Unique to target: 2
2026-02-17 12:25:17,759 - dq_comparison - INFO -   Value mismatches: 80064
2026-02-17 12:25:17,759 - dq_comparison - INFO -   Missing rows: 5,002
2026-02-17 12:25:17,759 - dq_comparison - INFO -   Extra rows: 2
2026-02-17 12:25:17,760 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260217_121847_comparison_medium_source15k.csv) vs Excel (20260217_121848_comparison_medium_target10k.xlsx (comparison_medium_target10k))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
2     | 2          | transaction_date: 2024-01-01             | transaction_date: 2024-01-01 00:00:00   
3     | 2          | transaction_date: 2024-01-01             | transaction_date: 2024-01-01 00:00:00   
10002 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10003 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10004 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10005 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10006 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10007 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10008 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10009 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 5000 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-17 12:25:17,761 - dq_comparison - INFO - Returning enhanced mismatch structure with 5000 detailed mismatches
2026-02-17 12:25:17,783 - dq_comparison - INFO - New structure: 100 detailed mismatches
2026-02-17 12:25:17,784 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-17 12:25:46,217 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-17 12:25:46,241 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-17 12:25:46,538 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260217_121851
2026-02-17 12:25:46,539 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-17 12:25:46,539 - dq_comparison - INFO -   Source rows: 15000
2026-02-17 12:25:46,540 - dq_comparison - INFO -   Common rows (matched): 9998
2026-02-17 12:25:46,540 - dq_comparison - INFO -   Calculation: (9998 / 15000) * 100 = 66.65%
2026-02-17 12:25:46,540 - dq_comparison - INFO -   Explanation: 9998 matched rows out of 15000 total source rows
2026-02-17 12:25:46,541 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-17 12:25:46,541 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-17 12:25:46,541 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:25:46,542 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260217_121851
2026-02-17 12:25:46,542 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-17 12:25:46,619 - dq_audit - INFO - Inserted comparison record with ID: 734
2026-02-17 12:25:46,621 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 734)
2026-02-17 12:25:46,804 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260217_121851
2026-02-17 12:25:46,909 - dq_error_log - INFO - Retrieved summary: 5000 total errors for session CMP_20260217_121851
2026-02-17 12:25:46,910 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:25:46,987 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_121851
2026-02-17 12:25:46,988 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-17 12:25:46,989 - dq_comparison - INFO -    Session ID: CMP_20260217_121851
2026-02-17 12:25:46,989 - dq_comparison - INFO -    DQ Score (Simple %): 66.65%
2026-02-17 12:25:46,989 - dq_comparison - INFO -    Source rows: 15000
2026-02-17 12:25:46,990 - dq_comparison - INFO -    Matched rows: 9998
2026-02-17 12:25:46,990 - dq_comparison - INFO -    Calculation: (9998 / 15000) * 100
2026-02-17 12:25:46,990 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-17 12:25:47,065 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_121851
2026-02-17 12:25:47,341 - dq_error_log - INFO - Retrieved 200 error logs for session CMP_20260217_121851
2026-02-17 12:25:47,437 - dq_error_log - INFO - Retrieved summary: 5000 total errors for session CMP_20260217_121851
2026-02-17 12:25:47,455 - __main__ - INFO - Completed with status 200 in 418.870s
2026-02-17 12:25:47,826 - __main__ - INFO - GET /api/compare/CMP_20260217_121848/mismatches - Request started
2026-02-17 12:25:47,955 - __main__ - INFO - Completed with status 200 in 0.129s
2026-02-17 12:25:48,078 - __main__ - INFO - GET /api/compare/CMP_20260217_121848/mismatches - Request started
2026-02-17 12:25:48,204 - __main__ - INFO - Completed with status 200 in 0.126s
2026-02-17 12:29:44,983 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:29:44,995 - __main__ - INFO - File uploaded: 20260217_122944_comparison_small_source15.csv (csv)
2026-02-17 12:29:44,996 - __main__ - INFO - Completed with status 200 in 0.013s
2026-02-17 12:29:45,322 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:29:45,357 - __main__ - INFO - File uploaded: 20260217_122945_comparison_small_target13.xlsx (excel)
2026-02-17 12:29:45,358 - __main__ - INFO - Completed with status 200 in 0.037s
2026-02-17 12:29:45,591 - __main__ - INFO - POST /api/compare - Request started
2026-02-17 12:29:45,591 - __main__ - INFO - Comparison request - Source: csv, Target: excel
2026-02-17 12:29:45,592 - __main__ - INFO - Comparison analysis request received
2026-02-17 12:29:45,593 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_122944_comparison_small_source15.csv'}
2026-02-17 12:29:45,593 - __main__ - INFO - Starting comparison for session CMP_20260217_122945
2026-02-17 12:29:45,595 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-17 12:29:45,596 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-17 12:29:45,597 - dq_comparison - INFO - 
==================================================
2026-02-17 12:29:45,597 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-17 12:29:45,598 - dq_comparison - INFO - ==================================================
2026-02-17 12:29:45,599 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-17 12:29:45,599 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_122944_comparison_small_source15.csv
2026-02-17 12:29:45,603 - dq_comparison - INFO - SOURCE CSV loaded: 15 rows, 16 columns
2026-02-17 12:29:45,604 - dq_comparison - INFO - 
==================================================
2026-02-17 12:29:45,604 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-17 12:29:45,605 - dq_comparison - INFO - ==================================================
2026-02-17 12:29:45,605 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-17 12:29:45,605 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_122945_comparison_small_target13.xlsx'}
2026-02-17 12:29:45,606 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-17 12:29:45,606 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_122945_comparison_small_target13.xlsx
2026-02-17 12:29:45,633 - dq_comparison - INFO - TARGET Excel loaded: 13 rows, 16 columns
2026-02-17 12:29:45,634 - dq_comparison - INFO - Source data loaded: 15 rows, 16 columns
2026-02-17 12:29:45,634 - dq_comparison - INFO - Target data loaded: 13 rows, 16 columns
2026-02-17 12:29:45,634 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-17 12:29:45,635 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:29:45,635 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:29:45,635 - dq_comparison - INFO - Common columns lowercased: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:29:45,636 - dq_comparison - INFO - Found 16 common columns between source and target (case-insensitive)
2026-02-17 12:29:45,636 - dq_comparison - INFO - User column selection input: all
2026-02-17 12:29:45,637 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-17 12:29:45,637 - dq_comparison - INFO - Selected 16 columns for comparison: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category']...
2026-02-17 12:29:45,637 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-17 12:29:45,638 - dq_comparison - INFO - Report details - Source: CSV: 20260217_122944_comparison_small_source15.csv, Target: Excel: 20260217_122945_comparison_small_target13.xlsx (comparison_small_target13), Selected columns: 16
2026-02-17 12:29:45,638 - dq_comparison - INFO - Initializing Error Logger...
2026-02-17 12:29:45,638 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:29:45,709 - dq_error_log - INFO - Database connection successful
2026-02-17 12:29:45,710 - dq_comparison - INFO - Session ID: CMP_20260217_122945
2026-02-17 12:29:45,711 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-17 12:29:45,711 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-17 12:29:45,712 - dq_comparison - INFO - Comparing column structures...
2026-02-17 12:29:45,712 - dq_comparison - WARNING - Found 4 incompatible data type mismatches
2026-02-17 12:29:45,713 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-17 12:29:45,713 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-17 12:29:45,713 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-17 12:29:45,718 - dq_comparison - INFO - Auto-detected common key fields: ['amount', 'balance_after', 'reference_code', 'transaction_id']
2026-02-17 12:29:45,720 - dq_comparison - INFO - Primary key validation passed for fields: ['amount', 'balance_after', 'reference_code', 'transaction_id']
2026-02-17 12:29:45,721 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-17 12:29:45,721 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-17 12:29:45,729 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-17 12:29:45,729 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-17 12:29:45,731 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-17 12:29:45,731 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-17 12:29:45,732 - dq_comparison - INFO - Column: transaction_date
2026-02-17 12:29:45,732 - dq_comparison - INFO -   Source type: <class 'str'>, value: 2024-01-01
2026-02-17 12:29:45,732 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-01 00:00:00
2026-02-17 12:29:45,733 - dq_comparison - INFO -   Normalized: '2024-01-01' vs '2024-01-01'
2026-02-17 12:29:45,734 - dq_comparison - INFO -   Match: True
2026-02-17 12:29:45,734 - dq_comparison - INFO - Column: status
2026-02-17 12:29:45,734 - dq_comparison - INFO -   Source type: <class 'str'>, value: SUCCESS
2026-02-17 12:29:45,734 - dq_comparison - INFO -   Target type: <class 'str'>, value: SUCCESS
2026-02-17 12:29:45,735 - dq_comparison - INFO -   Normalized: 'success' vs 'success'
2026-02-17 12:29:45,735 - dq_comparison - INFO -   Match: True
2026-02-17 12:29:45,736 - dq_comparison - INFO - Column: balance_after
2026-02-17 12:29:45,736 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 54897.93
2026-02-17 12:29:45,736 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 54897.93
2026-02-17 12:29:45,737 - dq_comparison - INFO -   Normalized: '54897.93' vs '54897.93'
2026-02-17 12:29:45,737 - dq_comparison - INFO -   Match: True
2026-02-17 12:29:45,737 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:29:45,738 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:29:45,738 - dq_comparison - INFO - Selected columns for comparison: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:29:45,738 - dq_comparison - INFO - Using 16 common columns for hash comparison
2026-02-17 12:29:45,739 - dq_comparison - INFO - Source columns: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:29:45,739 - dq_comparison - INFO - Target columns: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:29:45,739 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-17 12:29:45,742 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-17 12:29:45,746 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-17 12:29:45,750 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-17 12:29:45,755 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-17 12:29:45,759 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-17 12:29:45,761 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-17 12:29:45,762 - dq_comparison - INFO - Hash 1: e7d3109865e98118... (sample row 0)
2026-02-17 12:29:45,762 - dq_comparison - INFO - Hash 2: b7fb522723ba7127... (sample row 1)
2026-02-17 12:29:45,762 - dq_comparison - INFO - Hash 3: c79bfcd48796ffae... (sample row 2)
2026-02-17 12:29:45,763 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-17 12:29:45,766 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-17 12:29:45,771 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-17 12:29:45,776 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-17 12:29:45,780 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-17 12:29:45,783 - dq_comparison - INFO - 
======================================================================
2026-02-17 12:29:45,784 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-17 12:29:45,784 - dq_comparison - INFO - ======================================================================
2026-02-17 12:29:45,785 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-17 12:29:45,786 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:29:45,787 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:29:45,788 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:29:45,788 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,789 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:29:45,789 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:29:45,789 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:29:45,789 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,790 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:29:45,790 - dq_comparison - INFO -   Source: '54897.93' (type: float64) ‚Üí '54897.93'
2026-02-17 12:29:45,790 - dq_comparison - INFO -   Target: '54897.93' (type: float64) ‚Üí '54897.93'
2026-02-17 12:29:45,791 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,791 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:29:45,791 - dq_comparison - INFO -   Source: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:29:45,791 - dq_comparison - INFO -   Target: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:29:45,792 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,792 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:29:45,792 - dq_comparison - INFO -   Source: 'Electronics' (type: str) ‚Üí 'electronics'
2026-02-17 12:29:45,793 - dq_comparison - INFO -   Target: 'Electronics' (type: str) ‚Üí 'electronics'
2026-02-17 12:29:45,793 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,793 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-17 12:29:45,794 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|54897.93...
2026-02-17 12:29:45,795 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|54897.93...
2026-02-17 12:29:45,795 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:29:45,795 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-17 12:29:45,796 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:29:45,797 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:29:45,797 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:29:45,797 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,798 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:29:45,798 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:29:45,798 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:29:45,798 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,798 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:29:45,800 - dq_comparison - INFO -   Source: '56858.35' (type: float64) ‚Üí '56858.35'
2026-02-17 12:29:45,801 - dq_comparison - INFO -   Target: '56858.35' (type: float64) ‚Üí '56858.35'
2026-02-17 12:29:45,801 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,801 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:29:45,802 - dq_comparison - INFO -   Source: 'US' (type: str) ‚Üí 'us'
2026-02-17 12:29:45,802 - dq_comparison - INFO -   Target: 'US' (type: str) ‚Üí 'us'
2026-02-17 12:29:45,802 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,803 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:29:45,803 - dq_comparison - INFO -   Source: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:29:45,803 - dq_comparison - INFO -   Target: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:29:45,803 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,804 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-17 12:29:45,805 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|56858.35...
2026-02-17 12:29:45,805 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|56858.35...
2026-02-17 12:29:45,805 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:29:45,806 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-17 12:29:45,807 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:29:45,807 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:29:45,808 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:29:45,808 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,808 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:29:45,809 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:29:45,809 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:29:45,809 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,809 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:29:45,810 - dq_comparison - INFO -   Source: '52542.18' (type: float64) ‚Üí '52542.18'
2026-02-17 12:29:45,810 - dq_comparison - INFO -   Target: '52542.18' (type: float64) ‚Üí '52542.18'
2026-02-17 12:29:45,810 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,811 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:29:45,811 - dq_comparison - INFO -   Source: 'US' (type: str) ‚Üí 'us'
2026-02-17 12:29:45,811 - dq_comparison - INFO -   Target: 'US' (type: str) ‚Üí 'us'
2026-02-17 12:29:45,811 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,812 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:29:45,812 - dq_comparison - INFO -   Source: 'Food' (type: str) ‚Üí 'food'
2026-02-17 12:29:45,812 - dq_comparison - INFO -   Target: 'Food' (type: str) ‚Üí 'food'
2026-02-17 12:29:45,813 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:29:45,813 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-17 12:29:45,814 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|52542.18...
2026-02-17 12:29:45,814 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|52542.18...
2026-02-17 12:29:45,815 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:29:45,815 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-17 12:29:45,815 - dq_comparison - INFO - Column 1: 'transaction_date' (object) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-17 12:29:45,815 - dq_comparison - INFO -   Sample: Source='2024-01-01', Target='2024-01-01 00:00:00'
2026-02-17 12:29:45,816 - dq_comparison - INFO - Column 2: 'status' (object) ‚Üî 'status' (object)
2026-02-17 12:29:45,816 - dq_comparison - INFO -   Sample: Source='SUCCESS', Target='SUCCESS'
2026-02-17 12:29:45,817 - dq_comparison - INFO - Column 3: 'balance_after' (float64) ‚Üî 'balance_after' (float64)
2026-02-17 12:29:45,817 - dq_comparison - INFO -   Sample: Source='54897.93', Target='54897.93'
2026-02-17 12:29:45,817 - dq_comparison - INFO - Column 4: 'country' (object) ‚Üî 'country' (object)
2026-02-17 12:29:45,818 - dq_comparison - INFO -   Sample: Source='IN', Target='IN'
2026-02-17 12:29:45,818 - dq_comparison - INFO - Column 5: 'merchant_category' (object) ‚Üî 'merchant_category' (object)
2026-02-17 12:29:45,818 - dq_comparison - INFO -   Sample: Source='Electronics', Target='Electronics'
2026-02-17 12:29:45,818 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-17 12:29:45,819 - dq_comparison - INFO - Found 6 total mismatches
2026-02-17 12:29:45,819 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-17 12:29:46,107 - dq_comparison - INFO - 
================================================================================
2026-02-17 12:29:46,108 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-17 12:29:46,108 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-17 12:29:46,108 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-17 12:29:46,108 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-17 12:29:46,110 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-17 12:29:46,110 - dq_comparison - INFO - ================================================================================
2026-02-17 12:29:46,110 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-17 12:29:46,110 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-17 12:29:46,111 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-17 12:29:46,111 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-17 12:29:46,111 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-17 12:29:46,111 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-17 12:29:46,112 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-17 12:29:46,113 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-17 12:29:46,114 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-17 12:29:46,114 - dq_comparison - INFO -   Common rows: 11
2026-02-17 12:29:46,114 - dq_comparison - INFO -   Unique to source: 4
2026-02-17 12:29:46,115 - dq_comparison - INFO -   Unique to target: 2
2026-02-17 12:29:46,115 - dq_comparison - INFO -   Value mismatches: 96
2026-02-17 12:29:46,115 - dq_comparison - INFO -   Missing rows: 4
2026-02-17 12:29:46,116 - dq_comparison - INFO -   Extra rows: 2
2026-02-17 12:29:46,116 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260217_122944_comparison_small_source15.csv) vs Excel (20260217_122945_comparison_small_target13.xlsx (comparison_small_target13))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | transaction_date: 2024-01-01             | transaction_date: 2024-01-01 00:00:00   
14    | 2          | transaction_date: 2024-01-01             | transaction_date: 2024-01-01 00:00:00   
15    | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
16    | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-17 12:29:46,116 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-17 12:29:46,117 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-17 12:29:46,117 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-17 12:29:46,161 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-17 12:29:46,163 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-17 12:29:46,237 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260217_122945
2026-02-17 12:29:46,239 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-17 12:29:46,239 - dq_comparison - INFO -   Source rows: 15
2026-02-17 12:29:46,240 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-17 12:29:46,240 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-17 12:29:46,240 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-17 12:29:46,241 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-17 12:29:46,241 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-17 12:29:46,241 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:29:46,241 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260217_122945
2026-02-17 12:29:46,242 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-17 12:29:46,313 - dq_audit - INFO - Inserted comparison record with ID: 735
2026-02-17 12:29:46,314 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 735)
2026-02-17 12:29:46,384 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260217_122945
2026-02-17 12:29:46,453 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260217_122945
2026-02-17 12:29:46,454 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:29:46,527 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_122945
2026-02-17 12:29:46,528 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-17 12:29:46,529 - dq_comparison - INFO -    Session ID: CMP_20260217_122945
2026-02-17 12:29:46,529 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-17 12:29:46,529 - dq_comparison - INFO -    Source rows: 15
2026-02-17 12:29:46,529 - dq_comparison - INFO -    Matched rows: 11
2026-02-17 12:29:46,530 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-17 12:29:46,530 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-17 12:29:46,603 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_122945
2026-02-17 12:29:46,676 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260217_122945
2026-02-17 12:29:46,751 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260217_122945
2026-02-17 12:29:46,754 - __main__ - INFO - Completed with status 200 in 1.163s
2026-02-17 12:29:46,786 - __main__ - INFO - GET /api/compare/CMP_20260217_122945/mismatches - Request started
2026-02-17 12:29:46,932 - __main__ - INFO - Completed with status 200 in 0.146s
2026-02-17 12:29:47,261 - __main__ - INFO - GET /api/compare/CMP_20260217_122945/mismatches - Request started
2026-02-17 12:29:47,402 - __main__ - INFO - Completed with status 200 in 0.141s
2026-02-17 12:30:27,414 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:30:27,487 - __main__ - INFO - File uploaded: 20260217_123027_comparison_medium_source15k.csv (csv)
2026-02-17 12:30:27,488 - __main__ - INFO - Completed with status 200 in 0.074s
2026-02-17 12:30:27,676 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:30:27,776 - __main__ - INFO - File uploaded: 20260217_123027_comparison_medium_target10k.xlsx (excel)
2026-02-17 12:30:27,776 - __main__ - INFO - Completed with status 200 in 0.101s
2026-02-17 12:30:27,830 - __main__ - INFO - POST /api/compare - Request started
2026-02-17 12:30:27,830 - __main__ - INFO - Comparison request - Source: csv, Target: excel
2026-02-17 12:30:27,831 - __main__ - INFO - Comparison analysis request received
2026-02-17 12:30:27,832 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_123027_comparison_medium_source15k.csv'}
2026-02-17 12:30:27,832 - __main__ - INFO - Starting comparison for session CMP_20260217_123027
2026-02-17 12:30:27,833 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-17 12:30:27,833 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-17 12:30:27,834 - dq_comparison - INFO - 
==================================================
2026-02-17 12:30:27,834 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-17 12:30:27,834 - dq_comparison - INFO - ==================================================
2026-02-17 12:30:27,835 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-17 12:30:27,835 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_123027_comparison_medium_source15k.csv
2026-02-17 12:30:27,874 - dq_comparison - INFO - SOURCE CSV loaded: 15,000 rows, 16 columns
2026-02-17 12:30:27,875 - dq_comparison - INFO - 
==================================================
2026-02-17 12:30:27,875 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-17 12:30:27,876 - dq_comparison - INFO - ==================================================
2026-02-17 12:30:27,876 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-17 12:30:27,876 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_123027_comparison_medium_target10k.xlsx'}
2026-02-17 12:30:27,876 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-17 12:30:27,877 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_123027_comparison_medium_target10k.xlsx
2026-02-17 12:30:28,917 - dq_comparison - INFO - TARGET Excel loaded: 10,000 rows, 16 columns
2026-02-17 12:30:28,918 - dq_comparison - INFO - Source data loaded: 15000 rows, 16 columns
2026-02-17 12:30:28,918 - dq_comparison - INFO - Target data loaded: 10000 rows, 16 columns
2026-02-17 12:30:28,919 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-17 12:30:28,919 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:30:28,919 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:30:28,920 - dq_comparison - INFO - Common columns lowercased: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:30:28,920 - dq_comparison - INFO - Found 16 common columns between source and target (case-insensitive)
2026-02-17 12:30:28,921 - dq_comparison - INFO - User column selection input: all
2026-02-17 12:30:28,921 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-17 12:30:28,921 - dq_comparison - INFO - Selected 16 columns for comparison: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category']...
2026-02-17 12:30:28,921 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-17 12:30:28,922 - dq_comparison - INFO - Report details - Source: CSV: 20260217_123027_comparison_medium_source15k.csv, Target: Excel: 20260217_123027_comparison_medium_target10k.xlsx (comparison_medium_target10k), Selected columns: 16
2026-02-17 12:30:28,922 - dq_comparison - INFO - Initializing Error Logger...
2026-02-17 12:30:28,922 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:30:28,986 - dq_error_log - INFO - Database connection successful
2026-02-17 12:30:28,987 - dq_comparison - INFO - Session ID: CMP_20260217_123028
2026-02-17 12:30:28,988 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15,000, Target=10,000, Difference=5,000
2026-02-17 12:30:28,988 - dq_comparison - WARNING -    Missing in target: 5,000 rows
2026-02-17 12:30:28,988 - dq_comparison - INFO - Comparing column structures...
2026-02-17 12:30:28,989 - dq_comparison - WARNING - Found 4 incompatible data type mismatches
2026-02-17 12:30:28,989 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-17 12:30:28,989 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-17 12:30:28,989 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-17 12:30:29,028 - dq_comparison - INFO - Auto-detected common key fields: ['reference_code', 'transaction_id']
2026-02-17 12:30:29,035 - dq_comparison - INFO - Primary key validation passed for fields: ['reference_code', 'transaction_id']
2026-02-17 12:30:29,037 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-17 12:30:29,037 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-17 12:30:29,135 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-17 12:30:29,135 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-17 12:30:29,138 - dq_comparison - INFO - Starting comparison of 25,000 total rows...
2026-02-17 12:30:29,138 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-17 12:30:29,139 - dq_comparison - INFO - Column: transaction_date
2026-02-17 12:30:29,140 - dq_comparison - INFO -   Source type: <class 'str'>, value: 2024-01-01
2026-02-17 12:30:29,140 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-01 00:00:00
2026-02-17 12:30:29,142 - dq_comparison - INFO -   Normalized: '2024-01-01' vs '2024-01-01'
2026-02-17 12:30:29,142 - dq_comparison - INFO -   Match: True
2026-02-17 12:30:29,143 - dq_comparison - INFO - Column: status
2026-02-17 12:30:29,143 - dq_comparison - INFO -   Source type: <class 'str'>, value: SUCCESS
2026-02-17 12:30:29,143 - dq_comparison - INFO -   Target type: <class 'str'>, value: SUCCESS
2026-02-17 12:30:29,144 - dq_comparison - INFO -   Normalized: 'success' vs 'success'
2026-02-17 12:30:29,144 - dq_comparison - INFO -   Match: True
2026-02-17 12:30:29,144 - dq_comparison - INFO - Column: balance_after
2026-02-17 12:30:29,144 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 45408.36
2026-02-17 12:30:29,145 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 45428.36
2026-02-17 12:30:29,145 - dq_comparison - INFO -   Normalized: '45408.36' vs '45428.36'
2026-02-17 12:30:29,145 - dq_comparison - INFO -   Match: False
2026-02-17 12:30:29,147 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:30:29,147 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-02-17 12:30:29,147 - dq_comparison - INFO - Selected columns for comparison: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:30:29,148 - dq_comparison - INFO - Using 16 common columns for hash comparison
2026-02-17 12:30:29,148 - dq_comparison - INFO - Source columns: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:30:29,148 - dq_comparison - INFO - Target columns: ['transaction_date', 'status', 'balance_after', 'country', 'merchant_category', 'transaction_id', 'updated_at', 'transaction_type', 'posting_date', 'created_at', 'amount', 'currency', 'reference_code', 'customer_id', 'account_id', 'merchant_name']
2026-02-17 12:30:29,149 - dq_comparison - INFO - Generating hashes for source data (15000 rows)...
2026-02-17 12:30:34,067 - dq_comparison - INFO -    Hashing source data: 10.0% complete (2,500/25,000 rows)
2026-02-17 12:30:37,297 - dq_comparison - INFO -    Hashing source data: 20.0% complete (5,000/25,000 rows)
2026-02-17 12:30:40,420 - dq_comparison - INFO -    Hashing source data: 30.0% complete (7,500/25,000 rows)
2026-02-17 12:30:43,555 - dq_comparison - INFO -    Hashing source data: 40.0% complete (10,000/25,000 rows)
2026-02-17 12:30:46,666 - dq_comparison - INFO -    Hashing source data: 50.0% complete (12,500/25,000 rows)
2026-02-17 12:30:49,757 - dq_comparison - INFO -    Hashing source data: 60.0% complete (15,000/25,000 rows)
2026-02-17 12:30:49,759 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-17 12:30:49,760 - dq_comparison - INFO - Hash 1: fc35f151425c3062... (sample row 0)
2026-02-17 12:30:49,760 - dq_comparison - INFO - Hash 2: c8ab863f364c784b... (sample row 1)
2026-02-17 12:30:49,761 - dq_comparison - INFO - Hash 3: 3010ff8e91cc7651... (sample row 2)
2026-02-17 12:30:49,761 - dq_comparison - INFO - Generating hashes for target data (10000 rows)...
2026-02-17 12:30:53,212 - dq_comparison - INFO -    Hashing target data: 70.0% complete (17,500/25,000 rows)
2026-02-17 12:30:57,073 - dq_comparison - INFO -    Hashing target data: 80.0% complete (20,000/25,000 rows)
2026-02-17 12:31:01,035 - dq_comparison - INFO -    Hashing target data: 90.0% complete (22,500/25,000 rows)
2026-02-17 12:31:04,555 - dq_comparison - INFO -    Hashing target data: 100.0% complete (25,000/25,000 rows)
2026-02-17 12:31:04,557 - dq_comparison - INFO - 
======================================================================
2026-02-17 12:31:04,557 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-17 12:31:04,558 - dq_comparison - INFO - ======================================================================
2026-02-17 12:31:04,558 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-17 12:31:04,559 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:31:04,560 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:31:04,560 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:31:04,560 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,561 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:31:04,561 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:31:04,561 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:31:04,562 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,562 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:31:04,563 - dq_comparison - INFO -   Source: '45408.36' (type: float64) ‚Üí '45408.36'
2026-02-17 12:31:04,563 - dq_comparison - INFO -   Target: '45428.36' (type: float64) ‚Üí '45428.36'
2026-02-17 12:31:04,563 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-17 12:31:04,563 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:31:04,564 - dq_comparison - INFO -   Source: 'DE' (type: str) ‚Üí 'de'
2026-02-17 12:31:04,564 - dq_comparison - INFO -   Target: 'DE' (type: str) ‚Üí 'de'
2026-02-17 12:31:04,564 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,565 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:31:04,565 - dq_comparison - INFO -   Source: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:31:04,565 - dq_comparison - INFO -   Target: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:31:04,566 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,566 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-17 12:31:04,567 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|45408.36...
2026-02-17 12:31:04,568 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|45428.36...
2026-02-17 12:31:04,568 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-17 12:31:04,568 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-17 12:31:04,569 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:31:04,570 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:31:04,570 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:31:04,571 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,571 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:31:04,571 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:31:04,572 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:31:04,572 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,572 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:31:04,573 - dq_comparison - INFO -   Source: '45689.68' (type: float64) ‚Üí '45689.68'
2026-02-17 12:31:04,573 - dq_comparison - INFO -   Target: '45649.68' (type: float64) ‚Üí '45649.68'
2026-02-17 12:31:04,573 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-17 12:31:04,574 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:31:04,574 - dq_comparison - INFO -   Source: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:31:04,574 - dq_comparison - INFO -   Target: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:31:04,574 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,575 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:31:04,575 - dq_comparison - INFO -   Source: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:31:04,575 - dq_comparison - INFO -   Target: 'Transport' (type: str) ‚Üí 'transport'
2026-02-17 12:31:04,576 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,576 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-17 12:31:04,577 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|45689.68...
2026-02-17 12:31:04,577 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|45649.68...
2026-02-17 12:31:04,578 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-17 12:31:04,578 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-17 12:31:04,579 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:31:04,579 - dq_comparison - INFO -   Source: '2024-01-01' (type: str) ‚Üí '2024-01-01'
2026-02-17 12:31:04,580 - dq_comparison - INFO -   Target: '2024-01-01 00:00:00' (type: Timestamp) ‚Üí '2024-01-01'
2026-02-17 12:31:04,580 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,581 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:31:04,581 - dq_comparison - INFO -   Source: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:31:04,581 - dq_comparison - INFO -   Target: 'SUCCESS' (type: str) ‚Üí 'success'
2026-02-17 12:31:04,581 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,582 - dq_comparison - INFO - Column 'balance_after' ‚Üí 'balance_after':
2026-02-17 12:31:04,582 - dq_comparison - INFO -   Source: '45185.19' (type: float64) ‚Üí '45185.19'
2026-02-17 12:31:04,583 - dq_comparison - INFO -   Target: '45185.19' (type: float64) ‚Üí '45185.19'
2026-02-17 12:31:04,583 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,583 - dq_comparison - INFO - Column 'country' ‚Üí 'country':
2026-02-17 12:31:04,584 - dq_comparison - INFO -   Source: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:31:04,584 - dq_comparison - INFO -   Target: 'IN' (type: str) ‚Üí 'in'
2026-02-17 12:31:04,584 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,585 - dq_comparison - INFO - Column 'merchant_category' ‚Üí 'merchant_category':
2026-02-17 12:31:04,585 - dq_comparison - INFO -   Source: 'Electronics' (type: str) ‚Üí 'electronics'
2026-02-17 12:31:04,585 - dq_comparison - INFO -   Target: 'Electronics' (type: str) ‚Üí 'electronics'
2026-02-17 12:31:04,585 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:31:04,586 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-17 12:31:04,587 - dq_comparison - INFO - Source hash string start: 2024-01-01|success|45185.19...
2026-02-17 12:31:04,587 - dq_comparison - INFO - Target hash string start: 2024-01-01|success|45185.19...
2026-02-17 12:31:04,587 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:31:04,588 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-17 12:31:04,588 - dq_comparison - INFO - Column 1: 'transaction_date' (object) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-17 12:31:04,588 - dq_comparison - INFO -   Sample: Source='2024-01-01', Target='2024-01-01 00:00:00'
2026-02-17 12:31:04,589 - dq_comparison - INFO - Column 2: 'status' (object) ‚Üî 'status' (object)
2026-02-17 12:31:04,589 - dq_comparison - INFO -   Sample: Source='SUCCESS', Target='SUCCESS'
2026-02-17 12:31:04,589 - dq_comparison - INFO - Column 3: 'balance_after' (float64) ‚Üî 'balance_after' (float64)
2026-02-17 12:31:04,590 - dq_comparison - INFO -   Sample: Source='45408.36', Target='45428.36'
2026-02-17 12:31:04,590 - dq_comparison - INFO - Column 4: 'country' (object) ‚Üî 'country' (object)
2026-02-17 12:31:04,590 - dq_comparison - INFO -   Sample: Source='DE', Target='DE'
2026-02-17 12:31:04,591 - dq_comparison - INFO - Column 5: 'merchant_category' (object) ‚Üî 'merchant_category' (object)
2026-02-17 12:31:04,591 - dq_comparison - INFO -   Sample: Source='Transport', Target='Transport'
2026-02-17 12:31:04,591 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-17 12:31:04,594 - dq_comparison - INFO - Found 5,004 total mismatches
2026-02-17 12:31:04,594 - dq_comparison - INFO - Will process detailed comparisons for first 5,000 rows
2026-02-17 12:31:33,581 - dq_comparison - INFO - Progress: 500/5,000 rows (29.0s)
2026-02-17 12:32:02,371 - dq_comparison - INFO - Progress: 1,000/5,000 rows (57.8s)
2026-02-17 12:32:31,499 - dq_comparison - INFO - Progress: 1,500/5,000 rows (86.9s)
2026-02-17 12:33:00,635 - dq_comparison - INFO - Progress: 2,000/5,000 rows (116.0s)
2026-02-17 12:33:32,500 - dq_comparison - INFO - Progress: 2,500/5,000 rows (147.9s)
2026-02-17 12:34:04,469 - dq_comparison - INFO - Progress: 3,000/5,000 rows (179.9s)
2026-02-17 12:34:39,886 - dq_comparison - INFO - Progress: 3,500/5,000 rows (215.3s)
2026-02-17 12:35:17,846 - dq_comparison - INFO - Progress: 4,000/5,000 rows (253.3s)
2026-02-17 12:35:54,946 - dq_comparison - INFO - Progress: 4,500/5,000 rows (290.4s)
2026-02-17 12:36:28,282 - dq_comparison - INFO - Progress: 5,000/5,000 rows (323.7s)
2026-02-17 12:36:28,355 - dq_comparison - INFO - 
================================================================================
2026-02-17 12:36:28,356 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-17 12:36:28,356 - dq_comparison - INFO -   Total mismatches found: 5000
2026-02-17 12:36:28,356 - dq_comparison - INFO -   Detailed comparisons logged: 5000
2026-02-17 12:36:28,357 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-17 12:36:28,357 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-17 12:36:28,357 - dq_comparison - INFO -   Use API to retrieve all 5000 mismatches
2026-02-17 12:36:28,358 - dq_comparison - INFO - ================================================================================
2026-02-17 12:36:28,363 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-17 12:36:28,364 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15000
2026-02-17 12:36:28,365 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 10000
2026-02-17 12:36:28,365 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 9998
2026-02-17 12:36:28,366 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 9,998
2026-02-17 12:36:28,366 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 5,002
2026-02-17 12:36:28,366 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-17 12:36:28,373 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-17 12:36:28,373 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-17 12:36:28,374 - dq_comparison - INFO -   Common rows: 9,998
2026-02-17 12:36:28,374 - dq_comparison - INFO -   Unique to source: 5,002
2026-02-17 12:36:28,374 - dq_comparison - INFO -   Unique to target: 2
2026-02-17 12:36:28,375 - dq_comparison - INFO -   Value mismatches: 80064
2026-02-17 12:36:28,375 - dq_comparison - INFO -   Missing rows: 5,002
2026-02-17 12:36:28,375 - dq_comparison - INFO -   Extra rows: 2
2026-02-17 12:36:28,376 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260217_123027_comparison_medium_source15k.csv) vs Excel (20260217_123027_comparison_medium_target10k.xlsx (comparison_medium_target10k))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
2     | 2          | transaction_date: 2024-01-01             | transaction_date: 2024-01-01 00:00:00   
3     | 2          | transaction_date: 2024-01-01             | transaction_date: 2024-01-01 00:00:00   
10002 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10003 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10004 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10005 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10006 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10007 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10008 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
10009 | 16         | transaction_date: 2024-01-01             | transaction_date: NULL                  
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 5000 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-17 12:36:28,376 - dq_comparison - INFO - Returning enhanced mismatch structure with 5000 detailed mismatches
2026-02-17 12:36:28,395 - dq_comparison - INFO - New structure: 100 detailed mismatches
2026-02-17 12:36:28,396 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-17 12:36:58,022 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-17 12:36:58,047 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-17 12:36:58,262 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260217_123028
2026-02-17 12:36:58,263 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-17 12:36:58,264 - dq_comparison - INFO -   Source rows: 15000
2026-02-17 12:36:58,264 - dq_comparison - INFO -   Common rows (matched): 9998
2026-02-17 12:36:58,266 - dq_comparison - INFO -   Calculation: (9998 / 15000) * 100 = 66.65%
2026-02-17 12:36:58,266 - dq_comparison - INFO -   Explanation: 9998 matched rows out of 15000 total source rows
2026-02-17 12:36:58,267 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-17 12:36:58,267 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-17 12:36:58,267 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:36:58,267 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260217_123028
2026-02-17 12:36:58,267 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-17 12:36:58,332 - dq_audit - INFO - Inserted comparison record with ID: 736
2026-02-17 12:36:58,333 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 736)
2026-02-17 12:36:58,522 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260217_123028
2026-02-17 12:36:58,617 - dq_error_log - INFO - Retrieved summary: 5000 total errors for session CMP_20260217_123028
2026-02-17 12:36:58,618 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:36:58,673 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_123028
2026-02-17 12:36:58,674 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-17 12:36:58,674 - dq_comparison - INFO -    Session ID: CMP_20260217_123028
2026-02-17 12:36:58,675 - dq_comparison - INFO -    DQ Score (Simple %): 66.65%
2026-02-17 12:36:58,675 - dq_comparison - INFO -    Source rows: 15000
2026-02-17 12:36:58,675 - dq_comparison - INFO -    Matched rows: 9998
2026-02-17 12:36:58,675 - dq_comparison - INFO -    Calculation: (9998 / 15000) * 100
2026-02-17 12:36:58,676 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-17 12:36:58,737 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_123028
2026-02-17 12:36:58,957 - dq_error_log - INFO - Retrieved 200 error logs for session CMP_20260217_123028
2026-02-17 12:36:59,052 - dq_error_log - INFO - Retrieved summary: 5000 total errors for session CMP_20260217_123028
2026-02-17 12:36:59,073 - __main__ - INFO - Completed with status 200 in 391.243s
2026-02-17 12:36:59,459 - __main__ - INFO - GET /api/compare/CMP_20260217_123027/mismatches - Request started
2026-02-17 12:36:59,597 - __main__ - INFO - Completed with status 200 in 0.138s
2026-02-17 12:36:59,703 - __main__ - INFO - GET /api/compare/CMP_20260217_123027/mismatches - Request started
2026-02-17 12:36:59,828 - __main__ - INFO - Completed with status 200 in 0.125s
2026-02-17 12:48:33,986 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:48:34,008 - __main__ - INFO - File uploaded: 20260217_124833_source1000.csv (csv)
2026-02-17 12:48:34,009 - __main__ - INFO - Completed with status 200 in 0.022s
2026-02-17 12:48:34,253 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:48:34,267 - __main__ - INFO - File uploaded: 20260217_124834_target900.csv (csv)
2026-02-17 12:48:34,268 - __main__ - INFO - Completed with status 200 in 0.015s
2026-02-17 12:48:34,343 - __main__ - INFO - POST /api/compare - Request started
2026-02-17 12:48:34,344 - __main__ - INFO - Comparison request - Source: csv, Target: csv
2026-02-17 12:48:34,345 - __main__ - INFO - Comparison analysis request received
2026-02-17 12:48:34,346 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_124833_source1000.csv'}
2026-02-17 12:48:34,346 - __main__ - INFO - Starting comparison for session CMP_20260217_124834
2026-02-17 12:48:34,347 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-17 12:48:34,348 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-17 12:48:34,348 - dq_comparison - INFO - 
==================================================
2026-02-17 12:48:34,348 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-17 12:48:34,348 - dq_comparison - INFO - ==================================================
2026-02-17 12:48:34,349 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-17 12:48:34,349 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_124833_source1000.csv
2026-02-17 12:48:34,354 - dq_comparison - INFO - SOURCE CSV loaded: 1,000 rows, 8 columns
2026-02-17 12:48:34,355 - dq_comparison - INFO - 
==================================================
2026-02-17 12:48:34,355 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-17 12:48:34,355 - dq_comparison - INFO - ==================================================
2026-02-17 12:48:34,355 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-17 12:48:34,356 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_124834_target900.csv
2026-02-17 12:48:34,360 - dq_comparison - INFO - TARGET CSV loaded: 900 rows, 8 columns
2026-02-17 12:48:34,360 - dq_comparison - INFO - Source data loaded: 1000 rows, 8 columns
2026-02-17 12:48:34,361 - dq_comparison - INFO - Target data loaded: 900 rows, 8 columns
2026-02-17 12:48:34,361 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-17 12:48:34,361 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:48:34,362 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:48:34,362 - dq_comparison - INFO - Common columns lowercased: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:48:34,362 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-17 12:48:34,362 - dq_comparison - INFO - User column selection input: all
2026-02-17 12:48:34,363 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-17 12:48:34,363 - dq_comparison - INFO - Selected 8 columns for comparison: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type']...
2026-02-17 12:48:34,363 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-17 12:48:34,364 - dq_comparison - INFO - Report details - Source: CSV: 20260217_124833_source1000.csv, Target: CSV: 20260217_124834_target900.csv, Selected columns: 8
2026-02-17 12:48:34,364 - dq_comparison - INFO - Initializing Error Logger...
2026-02-17 12:48:34,364 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:48:34,432 - dq_error_log - INFO - Database connection successful
2026-02-17 12:48:34,434 - dq_comparison - INFO - Session ID: CMP_20260217_124834
2026-02-17 12:48:34,434 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=1,000, Target=900, Difference=100
2026-02-17 12:48:34,434 - dq_comparison - WARNING -    Missing in target: 100 rows
2026-02-17 12:48:34,435 - dq_comparison - INFO - Comparing column structures...
2026-02-17 12:48:34,435 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-17 12:48:34,436 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-17 12:48:34,436 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-17 12:48:34,440 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-17 12:48:34,442 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-17 12:48:34,443 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-17 12:48:34,443 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-17 12:48:34,451 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-17 12:48:34,452 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-17 12:48:34,458 - dq_comparison - INFO - Starting comparison of 1,900 total rows...
2026-02-17 12:48:34,458 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-17 12:48:34,458 - dq_comparison - INFO - Column: transaction_date
2026-02-17 12:48:34,459 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-17 12:48:34,459 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-17 12:48:34,460 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-17 12:48:34,461 - dq_comparison - INFO -   Match: True
2026-02-17 12:48:34,462 - dq_comparison - INFO - Column: status
2026-02-17 12:48:34,462 - dq_comparison - INFO -   Source type: <class 'str'>, value: COMPLETED
2026-02-17 12:48:34,462 - dq_comparison - INFO -   Target type: <class 'str'>, value: COMPLETED
2026-02-17 12:48:34,463 - dq_comparison - INFO -   Normalized: 'completed' vs 'completed'
2026-02-17 12:48:34,463 - dq_comparison - INFO -   Match: True
2026-02-17 12:48:34,464 - dq_comparison - INFO - Column: transaction_id
2026-02-17 12:48:34,464 - dq_comparison - INFO -   Source type: <class 'str'>, value: TXN0000001
2026-02-17 12:48:34,464 - dq_comparison - INFO -   Target type: <class 'str'>, value: TXN0000001
2026-02-17 12:48:34,465 - dq_comparison - INFO -   Normalized: 'txn0000001' vs 'txn0000001'
2026-02-17 12:48:34,465 - dq_comparison - INFO -   Match: True
2026-02-17 12:48:34,465 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:48:34,466 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-17 12:48:34,466 - dq_comparison - INFO - Selected columns for comparison: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:48:34,466 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-17 12:48:34,466 - dq_comparison - INFO - Source columns: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:48:34,467 - dq_comparison - INFO - Target columns: ['transaction_date', 'status', 'transaction_id', 'source_system', 'transaction_type', 'amount', 'currency', 'account_id']
2026-02-17 12:48:34,467 - dq_comparison - INFO - Generating hashes for source data (1000 rows)...
2026-02-17 12:48:34,535 - dq_comparison - INFO -    Hashing source data: 10.0% complete (190/1,900 rows)
2026-02-17 12:48:34,607 - dq_comparison - INFO -    Hashing source data: 20.0% complete (380/1,900 rows)
2026-02-17 12:48:34,677 - dq_comparison - INFO -    Hashing source data: 30.0% complete (570/1,900 rows)
2026-02-17 12:48:34,752 - dq_comparison - INFO -    Hashing source data: 40.0% complete (760/1,900 rows)
2026-02-17 12:48:34,834 - dq_comparison - INFO -    Hashing source data: 50.0% complete (950/1,900 rows)
2026-02-17 12:48:34,857 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-17 12:48:34,858 - dq_comparison - INFO - Hash 1: 5c968743a5ee267c... (sample row 0)
2026-02-17 12:48:34,859 - dq_comparison - INFO - Hash 2: 11b1eaa2a1fdd85b... (sample row 1)
2026-02-17 12:48:34,859 - dq_comparison - INFO - Hash 3: 89453097548893a0... (sample row 2)
2026-02-17 12:48:34,859 - dq_comparison - INFO - Generating hashes for target data (900 rows)...
2026-02-17 12:48:34,913 - dq_comparison - INFO -    Hashing target data: 60.0% complete (1,140/1,900 rows)
2026-02-17 12:48:34,986 - dq_comparison - INFO -    Hashing target data: 70.0% complete (1,330/1,900 rows)
2026-02-17 12:48:35,058 - dq_comparison - INFO -    Hashing target data: 80.0% complete (1,520/1,900 rows)
2026-02-17 12:48:35,134 - dq_comparison - INFO -    Hashing target data: 90.0% complete (1,710/1,900 rows)
2026-02-17 12:48:35,208 - dq_comparison - INFO -    Hashing target data: 100.0% complete (1,900/1,900 rows)
2026-02-17 12:48:35,209 - dq_comparison - INFO - 
======================================================================
2026-02-17 12:48:35,209 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-17 12:48:35,210 - dq_comparison - INFO - ======================================================================
2026-02-17 12:48:35,210 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-17 12:48:35,211 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:48:35,211 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-17 12:48:35,211 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-17 12:48:35,212 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,212 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:48:35,212 - dq_comparison - INFO -   Source: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:48:35,213 - dq_comparison - INFO -   Target: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:48:35,213 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,213 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-17 12:48:35,214 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-17 12:48:35,214 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-17 12:48:35,215 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,215 - dq_comparison - INFO - Column 'source_system' ‚Üí 'source_system':
2026-02-17 12:48:35,215 - dq_comparison - INFO -   Source: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:48:35,216 - dq_comparison - INFO -   Target: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:48:35,216 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,216 - dq_comparison - INFO - Column 'transaction_type' ‚Üí 'transaction_type':
2026-02-17 12:48:35,217 - dq_comparison - INFO -   Source: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:48:35,217 - dq_comparison - INFO -   Target: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:48:35,217 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,218 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-17 12:48:35,219 - dq_comparison - INFO - Source hash string start: 2024-02-01|completed|txn0000001...
2026-02-17 12:48:35,219 - dq_comparison - INFO - Target hash string start: 2024-02-01|completed|txn0000001...
2026-02-17 12:48:35,220 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:48:35,220 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-17 12:48:35,221 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:48:35,221 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-17 12:48:35,222 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-17 12:48:35,222 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,222 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:48:35,223 - dq_comparison - INFO -   Source: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:48:35,223 - dq_comparison - INFO -   Target: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:48:35,223 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,223 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-17 12:48:35,224 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-17 12:48:35,224 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-17 12:48:35,224 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,225 - dq_comparison - INFO - Column 'source_system' ‚Üí 'source_system':
2026-02-17 12:48:35,225 - dq_comparison - INFO -   Source: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:48:35,225 - dq_comparison - INFO -   Target: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:48:35,225 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,226 - dq_comparison - INFO - Column 'transaction_type' ‚Üí 'transaction_type':
2026-02-17 12:48:35,226 - dq_comparison - INFO -   Source: 'DEBIT' (type: str) ‚Üí 'debit'
2026-02-17 12:48:35,226 - dq_comparison - INFO -   Target: 'DEBIT' (type: str) ‚Üí 'debit'
2026-02-17 12:48:35,226 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,227 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-17 12:48:35,228 - dq_comparison - INFO - Source hash string start: 2024-03-01|completed|txn0000002...
2026-02-17 12:48:35,228 - dq_comparison - INFO - Target hash string start: 2024-03-01|completed|txn0000002...
2026-02-17 12:48:35,228 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:48:35,229 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-17 12:48:35,230 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-17 12:48:35,230 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-17 12:48:35,231 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-17 12:48:35,231 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,231 - dq_comparison - INFO - Column 'status' ‚Üí 'status':
2026-02-17 12:48:35,231 - dq_comparison - INFO -   Source: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:48:35,232 - dq_comparison - INFO -   Target: 'COMPLETED' (type: str) ‚Üí 'completed'
2026-02-17 12:48:35,232 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,232 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-17 12:48:35,233 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-17 12:48:35,233 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-17 12:48:35,233 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,234 - dq_comparison - INFO - Column 'source_system' ‚Üí 'source_system':
2026-02-17 12:48:35,234 - dq_comparison - INFO -   Source: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:48:35,234 - dq_comparison - INFO -   Target: 'ERP_CORE' (type: str) ‚Üí 'erp_core'
2026-02-17 12:48:35,234 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,235 - dq_comparison - INFO - Column 'transaction_type' ‚Üí 'transaction_type':
2026-02-17 12:48:35,235 - dq_comparison - INFO -   Source: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:48:35,236 - dq_comparison - INFO -   Target: 'CREDIT' (type: str) ‚Üí 'credit'
2026-02-17 12:48:35,236 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-17 12:48:35,236 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-17 12:48:35,237 - dq_comparison - INFO - Source hash string start: 2024-04-01|completed|txn0000003...
2026-02-17 12:48:35,238 - dq_comparison - INFO - Target hash string start: 2024-04-01|completed|txn0000003...
2026-02-17 12:48:35,238 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-17 12:48:35,238 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-17 12:48:35,238 - dq_comparison - INFO - Column 1: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-02-17 12:48:35,239 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='1/2/2024'
2026-02-17 12:48:35,239 - dq_comparison - INFO - Column 2: 'status' (object) ‚Üî 'status' (object)
2026-02-17 12:48:35,239 - dq_comparison - INFO -   Sample: Source='COMPLETED', Target='COMPLETED'
2026-02-17 12:48:35,240 - dq_comparison - INFO - Column 3: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-17 12:48:35,240 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-17 12:48:35,240 - dq_comparison - INFO - Column 4: 'source_system' (object) ‚Üî 'source_system' (object)
2026-02-17 12:48:35,241 - dq_comparison - INFO -   Sample: Source='ERP_CORE', Target='ERP_CORE'
2026-02-17 12:48:35,241 - dq_comparison - INFO - Column 5: 'transaction_type' (object) ‚Üî 'transaction_type' (object)
2026-02-17 12:48:35,241 - dq_comparison - INFO -   Sample: Source='CREDIT', Target='CREDIT'
2026-02-17 12:48:35,241 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-17 12:48:35,242 - dq_comparison - INFO - Found 104 total mismatches
2026-02-17 12:48:35,242 - dq_comparison - INFO - Will process detailed comparisons for first 104 rows
2026-02-17 12:48:42,548 - dq_comparison - INFO - 
================================================================================
2026-02-17 12:48:42,549 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-17 12:48:42,549 - dq_comparison - INFO -   Total mismatches found: 102
2026-02-17 12:48:42,550 - dq_comparison - INFO -   Detailed comparisons logged: 102
2026-02-17 12:48:42,550 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-17 12:48:42,550 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-17 12:48:42,550 - dq_comparison - INFO -   Use API to retrieve all 102 mismatches
2026-02-17 12:48:42,551 - dq_comparison - INFO - ================================================================================
2026-02-17 12:48:42,551 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-17 12:48:42,551 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 1000
2026-02-17 12:48:42,552 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 900
2026-02-17 12:48:42,552 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 898
2026-02-17 12:48:42,552 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 898
2026-02-17 12:48:42,553 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 102
2026-02-17 12:48:42,553 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-17 12:48:42,554 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-17 12:48:42,555 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-17 12:48:42,555 - dq_comparison - INFO -   Common rows: 898
2026-02-17 12:48:42,555 - dq_comparison - INFO -   Unique to source: 102
2026-02-17 12:48:42,555 - dq_comparison - INFO -   Unique to target: 2
2026-02-17 12:48:42,556 - dq_comparison - INFO -   Value mismatches: 832
2026-02-17 12:48:42,556 - dq_comparison - INFO -   Missing rows: 102
2026-02-17 12:48:42,556 - dq_comparison - INFO -   Extra rows: 2
2026-02-17 12:48:42,556 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260217_124833_source1000.csv) vs CSV (20260217_124834_target900.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
900   | 2          | transaction_date: 6/18/2026              | transaction_date: 6/18/2026             
901   | 2          | transaction_date: 6/19/2026              | transaction_date: 6/19/2026             
902   | 8          | transaction_date: 6/20/2026              | transaction_date: NULL                  
903   | 8          | transaction_date: 6/21/2026              | transaction_date: NULL                  
904   | 8          | transaction_date: 6/22/2026              | transaction_date: NULL                  
905   | 8          | transaction_date: 6/23/2026              | transaction_date: NULL                  
906   | 8          | transaction_date: 6/24/2026              | transaction_date: NULL                  
907   | 8          | transaction_date: 6/25/2026              | transaction_date: NULL                  
908   | 8          | transaction_date: 6/26/2026              | transaction_date: NULL                  
909   | 8          | transaction_date: 6/27/2026              | transaction_date: NULL                  
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 102 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-17 12:48:42,557 - dq_comparison - INFO - Returning enhanced mismatch structure with 102 detailed mismatches
2026-02-17 12:48:42,558 - dq_comparison - INFO - New structure: 100 detailed mismatches
2026-02-17 12:48:42,558 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-17 12:48:43,103 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-17 12:48:43,105 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-17 12:48:43,207 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260217_124834
2026-02-17 12:48:43,209 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-17 12:48:43,209 - dq_comparison - INFO -   Source rows: 1000
2026-02-17 12:48:43,209 - dq_comparison - INFO -   Common rows (matched): 898
2026-02-17 12:48:43,210 - dq_comparison - INFO -   Calculation: (898 / 1000) * 100 = 89.80%
2026-02-17 12:48:43,210 - dq_comparison - INFO -   Explanation: 898 matched rows out of 1000 total source rows
2026-02-17 12:48:43,210 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-17 12:48:43,211 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-17 12:48:43,211 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:48:43,211 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260217_124834
2026-02-17 12:48:43,211 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-17 12:48:43,280 - dq_audit - INFO - Inserted comparison record with ID: 737
2026-02-17 12:48:43,282 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 737)
2026-02-17 12:48:43,361 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260217_124834
2026-02-17 12:48:43,426 - dq_error_log - INFO - Retrieved summary: 102 total errors for session CMP_20260217_124834
2026-02-17 12:48:43,427 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:48:43,490 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_124834
2026-02-17 12:48:43,491 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-17 12:48:43,493 - dq_comparison - INFO -    Session ID: CMP_20260217_124834
2026-02-17 12:48:43,493 - dq_comparison - INFO -    DQ Score (Simple %): 89.80%
2026-02-17 12:48:43,493 - dq_comparison - INFO -    Source rows: 1000
2026-02-17 12:48:43,493 - dq_comparison - INFO -    Matched rows: 898
2026-02-17 12:48:43,493 - dq_comparison - INFO -    Calculation: (898 / 1000) * 100
2026-02-17 12:48:43,493 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-17 12:48:43,552 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260217_124834
2026-02-17 12:48:43,628 - dq_error_log - INFO - Retrieved 102 error logs for session CMP_20260217_124834
2026-02-17 12:48:43,690 - dq_error_log - INFO - Retrieved summary: 102 total errors for session CMP_20260217_124834
2026-02-17 12:48:43,698 - __main__ - INFO - Completed with status 200 in 9.356s
2026-02-17 12:48:43,730 - __main__ - INFO - GET /api/compare/CMP_20260217_124834/mismatches - Request started
2026-02-17 12:48:43,883 - __main__ - INFO - Completed with status 200 in 0.153s
2026-02-17 12:48:44,209 - __main__ - INFO - GET /api/compare/CMP_20260217_124834/mismatches - Request started
2026-02-17 12:48:44,352 - __main__ - INFO - Completed with status 200 in 0.142s
2026-02-17 12:49:30,595 - __main__ - INFO - POST /api/upload - Request started
2026-02-17 12:49:30,606 - __main__ - INFO - File uploaded: 20260217_124930_rulse.csv (csv)
2026-02-17 12:49:30,606 - __main__ - INFO - Completed with status 200 in 0.012s
2026-02-17 12:49:30,852 - __main__ - INFO - GET /api/rules - Request started
2026-02-17 12:49:30,853 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:49:30,854 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:49:30,963 - dq_rules - INFO - Retrieved 14 business rules
2026-02-17 12:49:30,965 - __main__ - INFO - Completed with status 200 in 0.113s
2026-02-17 12:49:30,974 - __main__ - INFO - GET /api/rules - Request started
2026-02-17 12:49:30,975 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:49:30,975 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:49:31,058 - dq_rules - INFO - Retrieved 14 business rules
2026-02-17 12:49:31,059 - __main__ - INFO - Completed with status 200 in 0.085s
2026-02-17 12:49:47,220 - __main__ - INFO - POST /api/rules/execute - Request started
2026-02-17 12:49:47,221 - dq_rules - INFO - Starting business rules analysis in UI/API mode
2026-02-17 12:49:47,301 - dq_rules - INFO - Business rules tables created/verified successfully
2026-02-17 12:49:47,302 - dq_rules - INFO - Loading data for rules analysis
2026-02-17 12:49:47,302 - dq_unified - INFO - Prompting user for data source type
2026-02-17 12:49:47,303 - dq_unified - INFO - UI Data source_type: csv
2026-02-17 12:49:47,303 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-17 12:49:47,304 - dq_unified - INFO - Loading data from CSV
2026-02-17 12:49:47,304 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/Data_Quality_Framework/uploads/20260217_124930_rulse.csv
2026-02-17 12:49:47,306 - dq_unified - INFO - CSV file has 20 rows
2026-02-17 12:49:47,306 - dq_unified - INFO - Loading 20 rows from CSV...
2026-02-17 12:49:47,309 - dq_unified - INFO - Loaded 20 rows from CSV
2026-02-17 12:49:47,312 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-17 12:49:47,313 - dq_unified - INFO - Loaded 20 rows, 11 columns. Memory: 238.7MB total, 0.0MB for dataframe
2026-02-17 12:49:47,313 - dq_rules - INFO - Data loaded: 20 rows, 11 columns from CSV: 20260217_124930_rulse.csv
2026-02-17 12:49:47,314 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:49:47,314 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:49:47,319 - dq_rules - INFO - BusinessRuleEngine session set to: RULES_20260217_124947_3266
2026-02-17 12:49:47,320 - dq_rules - INFO - Session ID: RULES_20260217_124947_3266
2026-02-17 12:49:47,389 - dq_rules - INFO - Retrieved 14 business rules
2026-02-17 12:49:47,389 - dq_rules - INFO - Executing specific rules: [88]
2026-02-17 12:49:47,390 - dq_rules - INFO - Executing rule: salaryvalidation (threshold)
2026-02-17 12:49:47,467 - dq_rules - INFO - Logged 1 rule executions to database
2026-02-17 12:49:47,468 - dq_error_log - INFO - Starting batch logging for 19 errors, session: RULES_20260217_124947_3266
2026-02-17 12:49:47,540 - dq_error_log - INFO - Batch 1: Successfully logged 19 errors
2026-02-17 12:49:47,541 - dq_error_log - INFO - Progress: 19/19 errors processed
2026-02-17 12:49:47,542 - dq_error_log - INFO - COMPLETE: Logged 19/19 errors for session RULES_20260217_124947_3266
2026-02-17 12:49:47,616 - dq_rules - INFO - Inserted 19 into dq_rule_violations
2026-02-17 12:49:47,618 - dq_rules - INFO - Logged 19 rule violations to error logs
2026-02-17 12:49:47,618 - dq_rules - INFO - Rule execution completed: 1 rules, 19 violations, DQ Score: 5.0%
2026-02-17 12:49:47,618 - dq_audit - INFO - Starting database insertion for business_rules...
2026-02-17 12:49:47,684 - dq_audit - INFO - Inserted business_rules record with ID: 738
2026-02-17 12:49:47,685 - dq_rules - INFO - Audit record logged for business rules session: RULES_20260217_124947_3266
2026-02-17 12:49:47,751 - dq_error_log - INFO - Retrieved 19 error logs for session RULES_20260217_124947_3266
2026-02-17 12:49:47,811 - dq_error_log - INFO - Retrieved summary: 19 total errors for session RULES_20260217_124947_3266
2026-02-17 12:49:47,875 - dq_audit - INFO - Retrieved 1 audit logs for session RULES_20260217_124947_3266
2026-02-17 12:49:47,876 - dq_rules - INFO - Business rules analysis completed for session RULES_20260217_124947_3266
2026-02-17 12:49:47,879 - __main__ - INFO - Completed with status 200 in 0.659s
2026-02-17 12:49:47,888 - __main__ - INFO - GET /api/rules/violations/RULES_20260217_124947_3266 - Request started
2026-02-17 12:49:47,888 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-17 12:49:47,889 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-17 12:49:47,971 - __main__ - INFO - Completed with status 200 in 0.083s
