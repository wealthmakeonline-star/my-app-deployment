2026-01-16 18:38:06,468 - __main__ - INFO - üåê API Server Logging Initialized
2026-01-16 18:38:06,469 - __main__ - INFO - üìù Logs saved to: logs/dq_api_20260116_183806.log
2026-01-16 18:38:06,534 - dq_rules - WARNING - Could not load config from database: name 'get_db_connection' is not defined
2026-01-16 18:38:06,539 - __main__ - INFO - APP_SETTINGS loaded. Audit enabled: True
2026-01-16 18:38:06,539 - __main__ - INFO - ‚úÖ All DQ modules loaded successfully
2026-01-16 18:38:06,543 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-01-16 18:38:06,543 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-16 18:38:06,545 - __main__ - INFO - ‚úÖ ErrorLogger and DataQualityAudit initialized
2026-01-16 18:38:06,573 - __main__ - INFO - üöÄ Starting Data Quality Framework API
2026-01-16 18:38:06,574 - __main__ - INFO - üìä Modules available: True
2026-01-16 18:38:06,575 - __main__ - INFO - üîß Config file mode: False
2026-01-16 18:38:06,577 - __main__ - INFO - üìã Available endpoints:
2026-01-16 18:38:06,577 - __main__ - INFO -   GET  /              - API status
2026-01-16 18:38:06,578 - __main__ - INFO -   GET  /api/health    - Health check
2026-01-16 18:38:06,579 - __main__ - INFO -   POST /api/check-single - Single source analysis
2026-01-16 18:38:06,579 - __main__ - INFO -   POST /api/compare   - Source-target comparison
2026-01-16 18:38:06,580 - __main__ - INFO -   GET  /api/compare/{id} - Get comparison results
2026-01-16 18:38:06,582 - __main__ - INFO -   GET  /api/compare/{id}/mismatches - Paginated mismatches
2026-01-16 18:38:06,583 - __main__ - INFO -   GET  /api/compare/{id}/rows/source_only - Source-only rows
2026-01-16 18:38:06,584 - __main__ - INFO -   GET  /api/compare/{id}/rows/target_only - Target-only rows
2026-01-16 18:38:06,585 - __main__ - INFO -   GET  /api/compare/{id}/rows/count - Row counts
2026-01-16 18:38:06,586 - __main__ - INFO -   POST /api/upload    - File upload
2026-01-16 18:38:06,588 - __main__ - INFO -   GET  /api/sessions  - List sessions
2026-01-16 18:38:06,589 - __main__ - INFO -   GET  /api/sessions/<id> - Get session data
2026-01-16 18:38:06,590 - __main__ - INFO -   GET  /api/debug-db  - Database debug
2026-01-16 18:38:06,591 - __main__ - INFO - üåç Server starting on 0.0.0.0:5000 (debug=False)
2026-01-16 18:38:42,854 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-16 18:38:42,856 - __main__ - INFO - Getting database hierarchy for postgresql
2026-01-16 18:38:42,859 - __main__ - INFO - Database: Not provided
2026-01-16 18:38:42,860 - __main__ - INFO - Schema: Not provided
2026-01-16 18:38:42,862 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-16 18:38:42,863 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-01-16 18:38:42,864 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-16 18:38:42,865 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-16 18:38:42,865 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-01-16 18:38:43,031 - database_navigator - INFO - Connection object created: <connection object at 0x00000240CFA6F010; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-01-16 18:38:43,032 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-01-16 18:38:43,033 - __main__ - INFO - Getting databases list...
2026-01-16 18:38:43,033 - database_navigator - INFO - get_databases() called. db_type: postgresql, connection exists: True
2026-01-16 18:38:43,045 - database_navigator - INFO - Raw rows: [('dq_checks',), ('finewise-testdb',), ('postgres',)]
2026-01-16 18:38:43,046 - database_navigator - INFO - Found 3 databases
2026-01-16 18:38:43,046 - __main__ - INFO - Found 3 databases
2026-01-16 18:38:43,048 - __main__ - INFO - Completed with status 200 in 0.194s
2026-01-16 18:38:46,194 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-16 18:38:46,196 - __main__ - INFO - Getting database hierarchy for postgresql
2026-01-16 18:38:46,199 - __main__ - INFO - Database: dq_checks
2026-01-16 18:38:46,202 - __main__ - INFO - Schema: Not provided
2026-01-16 18:38:46,207 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-16 18:38:46,209 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-01-16 18:38:46,212 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-16 18:38:46,214 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-16 18:38:46,215 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-01-16 18:38:46,486 - database_navigator - INFO - Connection object created: <connection object at 0x00000240CFA6E680; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-01-16 18:38:46,487 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-01-16 18:38:46,489 - __main__ - INFO - Getting schemas for database: dq_checks
2026-01-16 18:38:46,494 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-01-16 18:38:46,495 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-16 18:38:46,497 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-16 18:38:46,498 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-01-16 18:38:46,667 - database_navigator - INFO - Connection object created: <connection object at 0x00000240CFA6EF00; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-01-16 18:38:46,668 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-01-16 18:38:46,696 - database_navigator - INFO - Found 4 schemas
2026-01-16 18:38:46,698 - __main__ - INFO - Found 4 schemas
2026-01-16 18:38:46,700 - __main__ - INFO - Completed with status 200 in 0.507s
2026-01-16 18:38:47,753 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-16 18:38:47,755 - __main__ - INFO - Getting database hierarchy for postgresql
2026-01-16 18:38:47,766 - __main__ - INFO - Database: dq_checks
2026-01-16 18:38:47,775 - __main__ - INFO - Schema: public
2026-01-16 18:38:47,776 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-16 18:38:47,782 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-01-16 18:38:47,784 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-16 18:38:47,785 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-16 18:38:47,786 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-01-16 18:38:47,965 - database_navigator - INFO - Connection object created: <connection object at 0x00000240CFA6EF00; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-01-16 18:38:47,967 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-01-16 18:38:47,968 - __main__ - INFO - Getting tables for database: dq_checks, schema: public
2026-01-16 18:38:47,970 - database_navigator - INFO - Ensuring connection to database: dq_checks for table list
2026-01-16 18:38:47,971 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-01-16 18:38:47,973 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-16 18:38:47,974 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-16 18:38:47,976 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-01-16 18:38:48,148 - database_navigator - INFO - Connection object created: <connection object at 0x00000240CFA6F120; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-01-16 18:38:48,150 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-01-16 18:38:48,152 - database_navigator - INFO - Connected to database: dq_checks, schema: public
2026-01-16 18:38:48,195 - database_navigator - INFO - Found 4 tables in dq_checks.public: ['customers', 'customers_bkp', 'employee', 'stg_transactions']
2026-01-16 18:38:48,196 - database_navigator - INFO - Found 4 tables in schema 'public'
2026-01-16 18:38:48,197 - __main__ - INFO - Found 4 tables
2026-01-16 18:38:48,201 - __main__ - INFO - Completed with status 200 in 0.448s
2026-01-16 18:38:56,763 - __main__ - INFO - POST /api/upload - Request started
2026-01-16 18:38:57,208 - __main__ - INFO - File uploaded: 20260116_183856_Target_data_100k.xlsx (excel)
2026-01-16 18:38:57,209 - __main__ - INFO - Completed with status 200 in 0.446s
2026-01-16 18:38:57,222 - __main__ - INFO - POST /api/compare - Request started
2026-01-16 18:38:57,223 - __main__ - INFO - Comparison request - Source: database, Target: excel
2026-01-16 18:38:57,227 - __main__ - INFO - Comparison analysis request received
2026-01-16 18:38:57,228 - __main__ - INFO - DEBUG source_data from flat: {'source_type': 'database', 'dbType': 'PostgreSQL', 'host': 'localhost', 'port': '5432', 'database': 'dq_checks', 'schema': 'public', 'table': 'employee', 'user': 'postgres', 'password': 'postgres', 'serviceName': '', 'db_type': 'postgresql', 'target_source_type': 'excel', 'target_file_path': 'uploads\\20260116_183856_Target_data_100k.xlsx', 'target_sheet_name': 'Sheet1', 'selected_columns': 'all'}
2026-01-16 18:38:57,229 - __main__ - INFO - Starting comparison for session CMP_20260116_183857
2026-01-16 18:38:57,232 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-01-16 18:38:57,233 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-01-16 18:38:57,233 - dq_comparison - INFO - 
==================================================
2026-01-16 18:38:57,234 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-01-16 18:38:57,235 - dq_comparison - INFO - ==================================================
2026-01-16 18:38:57,235 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-01-16 18:38:57,236 - dq_comparison - INFO - ----------------------------------------
2026-01-16 18:38:57,238 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-01-16 18:38:57,238 - dq_unified - INFO - Loading data from DATABASE
2026-01-16 18:38:57,239 - dq_unified - INFO - Loading large database table: employee
2026-01-16 18:38:57,241 - dq_unified - INFO - Normalized DB config with schema: public
2026-01-16 18:38:57,408 - dq_unified - INFO - PostgreSQL table public.employee has 89,999 rows
2026-01-16 18:38:57,409 - dq_unified - INFO - Loading 89,999 rows from PostgreSQL...
2026-01-16 18:38:57,765 - dq_unified - INFO - Loaded 89,999 rows from PostgreSQL
2026-01-16 18:38:58,453 - dq_unified - INFO - Memory optimization: 60.9MB -> 25.8MB (Saved: 35.1MB)
2026-01-16 18:38:58,454 - dq_unified - INFO - Standardizing data types...
2026-01-16 18:38:59,422 - dq_unified - INFO - Data type standardization complete
2026-01-16 18:38:59,518 - dq_unified - INFO - Loaded 89,999 rows, 12 columns. Memory: 187.9MB total, 18.9MB for dataframe
2026-01-16 18:38:59,519 - dq_comparison - INFO - SOURCE database loaded: 89,999 rows, 12 columns
2026-01-16 18:38:59,519 - dq_comparison - INFO - 
==================================================
2026-01-16 18:38:59,520 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-01-16 18:38:59,521 - dq_comparison - INFO - ==================================================
2026-01-16 18:38:59,522 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-01-16 18:38:59,522 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'file_path': 'uploads\\20260116_183856_Target_data_100k.xlsx', 'sheet_name': 'Sheet1', 'target_file_path': 'uploads\\20260116_183856_Target_data_100k.xlsx'}
2026-01-16 18:38:59,523 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-01-16 18:38:59,524 - dq_comparison - INFO - DEBUG Found file_path in ui_data: uploads\20260116_183856_Target_data_100k.xlsx
2026-01-16 18:39:07,006 - dq_comparison - ERROR - Error loading TARGET Excel: Worksheet named 'Sheet1' not found
2026-01-16 18:39:07,022 - dq_comparison - ERROR - Traceback (most recent call last):
  File "C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Data_Quality_Framework\dq_comparison.py", line 374, in load_excel_source
    df = pd.read_excel(file_path, sheet_name=sheet_name)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
           ^^^^^^^^^
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named 'Sheet1' not found

2026-01-16 18:39:07,023 - dq_comparison - ERROR - Failed to load source or target data
2026-01-16 18:39:07,040 - __main__ - WARNING - Comparison completed with errors: Failed to load source or target data
2026-01-16 18:39:07,041 - __main__ - INFO - Completed with status 200 in 9.819s
2026-01-16 18:45:22,732 - __main__ - INFO - POST /api/compare - Request started
2026-01-16 18:45:22,734 - __main__ - INFO - Comparison request - Source: database, Target: excel
2026-01-16 18:45:22,736 - __main__ - INFO - Comparison analysis request received
2026-01-16 18:45:22,737 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'postgresql', 'host': 'localhost', 'port': 5432, 'database': 'dq_checks', 'table': 'employee', 'user': 'postgres', 'password': 'postgres'}
2026-01-16 18:45:22,739 - __main__ - INFO - Starting comparison for session CMP_20260116_184522
2026-01-16 18:45:22,739 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-01-16 18:45:22,741 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-01-16 18:45:22,743 - dq_comparison - INFO - 
==================================================
2026-01-16 18:45:22,744 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-01-16 18:45:22,746 - dq_comparison - INFO - ==================================================
2026-01-16 18:45:22,748 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-01-16 18:45:22,749 - dq_comparison - INFO - ----------------------------------------
2026-01-16 18:45:22,751 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-01-16 18:45:22,752 - dq_unified - INFO - Loading data from DATABASE
2026-01-16 18:45:22,753 - dq_unified - INFO - Loading large database table: employee
2026-01-16 18:45:22,754 - dq_unified - INFO - Normalized DB config with schema: public
2026-01-16 18:45:22,922 - dq_unified - INFO - PostgreSQL table public.employee has 89,999 rows
2026-01-16 18:45:22,923 - dq_unified - INFO - Loading 89,999 rows from PostgreSQL...
2026-01-16 18:45:23,471 - dq_unified - INFO - Loaded 89,999 rows from PostgreSQL
2026-01-16 18:45:24,944 - dq_unified - INFO - Memory optimization: 60.9MB -> 25.8MB (Saved: 35.1MB)
2026-01-16 18:45:24,946 - dq_unified - INFO - Standardizing data types...
2026-01-16 18:45:26,216 - dq_unified - INFO - Data type standardization complete
2026-01-16 18:45:26,326 - dq_unified - INFO - Loaded 89,999 rows, 12 columns. Memory: 238.3MB total, 18.9MB for dataframe
2026-01-16 18:45:26,327 - dq_comparison - INFO - SOURCE database loaded: 89,999 rows, 12 columns
2026-01-16 18:45:26,328 - dq_comparison - INFO - 
==================================================
2026-01-16 18:45:26,329 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-01-16 18:45:26,329 - dq_comparison - INFO - ==================================================
2026-01-16 18:45:26,330 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-01-16 18:45:26,331 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:\\\\Users\\\\003160\\\\OneDrive - wisseninfotech.com\\\\Documents\\\\DQ-Checks-Shashi\\\\Test_data\\\\Target_data_100k.xlsx'}
2026-01-16 18:45:26,332 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-01-16 18:45:26,333 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:\\Users\\003160\\OneDrive - wisseninfotech.com\\Documents\\DQ-Checks-Shashi\\Test_data\\Target_data_100k.xlsx
2026-01-16 18:45:26,337 - dq_comparison - ERROR - Error loading TARGET Excel: [Errno 13] Permission denied: 'C:\\\\Users\\\\003160\\\\OneDrive - wisseninfotech.com\\\\Documents\\\\DQ-Checks-Shashi\\\\Test_data\\\\Target_data_100k.xlsx'
2026-01-16 18:45:26,349 - dq_comparison - ERROR - Traceback (most recent call last):
  File "C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Data_Quality_Framework\dq_comparison.py", line 330, in load_excel_source
    excel_file = pd.ExcelFile(file_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\003160\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'C:\\\\Users\\\\003160\\\\OneDrive - wisseninfotech.com\\\\Documents\\\\DQ-Checks-Shashi\\\\Test_data\\\\Target_data_100k.xlsx'

2026-01-16 18:45:26,349 - dq_comparison - ERROR - Failed to load source or target data
2026-01-16 18:45:26,368 - __main__ - WARNING - Comparison completed with errors: Failed to load source or target data
2026-01-16 18:45:26,370 - __main__ - INFO - Completed with status 200 in 3.638s
2026-01-16 18:46:48,333 - __main__ - INFO - POST /api/upload - Request started
2026-01-16 18:46:48,752 - __main__ - INFO - File uploaded: 20260116_184648_source_data_90k.xlsx (excel)
2026-01-16 18:46:48,753 - __main__ - INFO - Completed with status 200 in 0.420s
2026-01-16 18:46:48,775 - __main__ - INFO - POST /api/upload - Request started
2026-01-16 18:46:48,918 - __main__ - INFO - File uploaded: 20260116_184648_Target_data_100k.csv (csv)
2026-01-16 18:46:48,919 - __main__ - INFO - Completed with status 200 in 0.144s
2026-01-16 18:46:48,938 - __main__ - INFO - POST /api/compare - Request started
2026-01-16 18:46:48,940 - __main__ - INFO - Comparison request - Source: excel, Target: csv
2026-01-16 18:46:48,941 - __main__ - INFO - Comparison analysis request received
2026-01-16 18:46:48,942 - __main__ - INFO - DEBUG source_data from flat: {'source_type': 'excel', 'file_path': 'uploads\\20260116_184648_source_data_90k.xlsx', 'target_source_type': 'csv', 'target_file_path': 'uploads\\20260116_184648_Target_data_100k.csv', 'target_sheet_name': 'Sheet1', 'selected_columns': 'all'}
2026-01-16 18:46:48,944 - __main__ - INFO - Starting comparison for session CMP_20260116_184648
2026-01-16 18:46:48,946 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-01-16 18:46:48,946 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-01-16 18:46:48,947 - dq_comparison - INFO - 
==================================================
2026-01-16 18:46:48,947 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-01-16 18:46:48,948 - dq_comparison - INFO - ==================================================
2026-01-16 18:46:48,949 - dq_comparison - INFO - DEBUG load_excel_source called for SOURCE
2026-01-16 18:46:48,949 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'file_path': 'uploads\\20260116_184648_source_data_90k.xlsx', 'source_file_path': 'uploads\\20260116_184648_source_data_90k.xlsx', 'sheet_name': None}
2026-01-16 18:46:48,950 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-01-16 18:46:48,951 - dq_comparison - INFO - DEBUG Found file_path in ui_data: uploads\20260116_184648_source_data_90k.xlsx
2026-01-16 18:47:01,935 - dq_comparison - INFO - SOURCE Excel loaded: 89,999 rows, 12 columns
2026-01-16 18:47:01,936 - dq_comparison - INFO - 
==================================================
2026-01-16 18:47:01,937 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-01-16 18:47:01,938 - dq_comparison - INFO - ==================================================
2026-01-16 18:47:01,939 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-01-16 18:47:01,940 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': uploads\20260116_184648_Target_data_100k.csv
2026-01-16 18:47:02,240 - dq_comparison - INFO - TARGET CSV loaded: 100,500 rows, 12 columns
2026-01-16 18:47:02,240 - dq_comparison - INFO - Source data loaded: 89999 rows, 12 columns
2026-01-16 18:47:02,242 - dq_comparison - INFO - Target data loaded: 100500 rows, 12 columns
2026-01-16 18:47:02,243 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-01-16 18:47:02,243 - dq_comparison - INFO - Source columns (original): ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-01-16 18:47:02,245 - dq_comparison - INFO - Target columns (original): ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-01-16 18:47:02,245 - dq_comparison - INFO - Common columns lowercased: ['description', 'id', 'transaction_id', 'amount', 'transaction_date', 'quantity', 'status', 'email', 'customer_name', 'phone', 'age', 'customer_id']
2026-01-16 18:47:02,246 - dq_comparison - INFO - Found 12 common columns between source and target (case-insensitive)
2026-01-16 18:47:02,247 - dq_comparison - INFO - User column selection input: all
2026-01-16 18:47:02,248 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-01-16 18:47:02,249 - dq_comparison - INFO - Selected 12 columns for comparison: ['description', 'id', 'transaction_id', 'amount', 'transaction_date']...
2026-01-16 18:47:02,250 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-01-16 18:47:02,251 - dq_comparison - INFO - Report details - Source: Excel: 20260116_184648_source_data_90k.xlsx (source_data_90k), Target: CSV: 20260116_184648_Target_data_100k.csv, Selected columns: 12
2026-01-16 18:47:02,252 - dq_comparison - INFO - Initializing Error Logger...
2026-01-16 18:47:02,252 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-01-16 18:47:02,417 - dq_error_log - INFO - Database connection successful
2026-01-16 18:47:02,420 - dq_comparison - INFO - Session ID: CMP_20260116_184702
2026-01-16 18:47:02,420 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=89,999, Target=100,500, Difference=10,501
2026-01-16 18:47:02,422 - dq_comparison - WARNING -    Extra in target: 10,501 rows
2026-01-16 18:47:02,422 - dq_comparison - INFO - Comparing column structures...
2026-01-16 18:47:02,424 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-01-16 18:47:02,424 - dq_comparison - INFO - Validating primary key/unique fields...
2026-01-16 18:47:02,426 - dq_comparison - INFO - Checking key fields: ['id', 'customer_id']
2026-01-16 18:47:02,441 - dq_comparison - WARNING - Field 'id' has duplicates in source: 406 rows
2026-01-16 18:47:02,442 - dq_comparison - WARNING - Field 'id' has duplicates in target: 500 rows
2026-01-16 18:47:02,475 - dq_comparison - WARNING - Field 'customer_id' has duplicates in source: 804 rows
2026-01-16 18:47:02,476 - dq_comparison - WARNING - Field 'customer_id' has duplicates in target: 1000 rows
2026-01-16 18:47:02,477 - dq_comparison - INFO - Primary key validation complete. Passed: False
2026-01-16 18:47:02,533 - dq_comparison - INFO - Comparing table-level metadata...
2026-01-16 18:47:04,644 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-01-16 18:47:04,661 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-01-16 18:47:04,699 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-01-16 18:47:04,700 - dq_comparison - INFO - Column: description
2026-01-16 18:47:04,701 - dq_comparison - INFO -   Source type: <class 'str'>, value: Text with& ampersands
2026-01-16 18:47:04,702 - dq_comparison - INFO -   Target type: <class 'str'>, value: Text with& ampersands
2026-01-16 18:47:04,703 - dq_comparison - INFO -   Normalized: 'text with& ampersands' vs 'text with& ampersands'
2026-01-16 18:47:04,704 - dq_comparison - INFO -   Match: True
2026-01-16 18:47:04,705 - dq_comparison - INFO - Column: id
2026-01-16 18:47:04,705 - dq_comparison - INFO -   Source type: <class 'numpy.int64'>, value: 78303
2026-01-16 18:47:04,706 - dq_comparison - INFO -   Target type: <class 'numpy.int64'>, value: 78303
2026-01-16 18:47:04,707 - dq_comparison - INFO -   Normalized: '78303' vs '78303'
2026-01-16 18:47:04,707 - dq_comparison - INFO -   Match: True
2026-01-16 18:47:04,709 - dq_comparison - INFO - Column: transaction_id
2026-01-16 18:47:04,709 - dq_comparison - INFO -   Source type: <class 'str'>, value: TX00078303
2026-01-16 18:47:04,710 - dq_comparison - INFO -   Target type: <class 'str'>, value: TX00078303
2026-01-16 18:47:04,711 - dq_comparison - INFO -   Normalized: 'TX00078303' vs 'TX00078303'
2026-01-16 18:47:04,711 - dq_comparison - INFO -   Match: True
2026-01-16 18:47:04,711 - dq_comparison - INFO - Source DF columns: ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-01-16 18:47:04,713 - dq_comparison - INFO - Target DF columns: ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-01-16 18:47:04,714 - dq_comparison - INFO - Selected columns for comparison: ['description', 'id', 'transaction_id', 'amount', 'transaction_date', 'quantity', 'status', 'email', 'customer_name', 'phone', 'age', 'customer_id']
2026-01-16 18:47:04,714 - dq_comparison - INFO - Using 12 common columns for hash comparison
2026-01-16 18:47:04,715 - dq_comparison - INFO - Source columns: ['description', 'id', 'transaction_id', 'amount', 'transaction_date', 'quantity', 'status', 'email', 'customer_name', 'phone', 'age', 'customer_id']
2026-01-16 18:47:04,716 - dq_comparison - INFO - Target columns: ['description', 'id', 'transaction_id', 'amount', 'transaction_date', 'quantity', 'status', 'email', 'customer_name', 'phone', 'age', 'customer_id']
2026-01-16 18:47:04,716 - dq_comparison - INFO - Generating hashes for source data (89999 rows)...
2026-01-16 18:47:27,243 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-01-16 18:47:27,250 - dq_comparison - INFO - Hash 1: a190f748ad28e5da... (sample row 0)
2026-01-16 18:47:27,252 - dq_comparison - INFO - Hash 2: 3f8efa92586c414c... (sample row 1)
2026-01-16 18:47:27,253 - dq_comparison - INFO - Hash 3: 7ae73b79c08cbd90... (sample row 2)
2026-01-16 18:47:27,254 - dq_comparison - INFO - Generating hashes for target data (100500 rows)...
2026-01-16 18:48:29,747 - dq_comparison - INFO - 
======================================================================
2026-01-16 18:48:29,748 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-01-16 18:48:29,750 - dq_comparison - INFO - ======================================================================
2026-01-16 18:48:29,751 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-01-16 18:48:29,758 - dq_comparison - INFO - Column 'description' ‚Üí 'description':
2026-01-16 18:48:29,759 - dq_comparison - INFO -   Source: 'Text with& ampersands' (type: str) ‚Üí 'text with& ampersands'
2026-01-16 18:48:29,760 - dq_comparison - INFO -   Target: 'Text with& ampersands' (type: str) ‚Üí 'text with& ampersands'
2026-01-16 18:48:29,762 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,763 - dq_comparison - INFO - Column 'id' ‚Üí 'id':
2026-01-16 18:48:29,765 - dq_comparison - INFO -   Source: '78303' (type: int64) ‚Üí '78303'
2026-01-16 18:48:29,766 - dq_comparison - INFO -   Target: '78303' (type: int64) ‚Üí '78303'
2026-01-16 18:48:29,768 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,770 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-01-16 18:48:29,771 - dq_comparison - INFO -   Source: 'TX00078303' (type: str) ‚Üí 'TX00078303'
2026-01-16 18:48:29,773 - dq_comparison - INFO -   Target: 'TX00078303' (type: str) ‚Üí 'TX00078303'
2026-01-16 18:48:29,774 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,776 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-01-16 18:48:29,777 - dq_comparison - INFO -   Source: '8653.56' (type: float64) ‚Üí '8653.56'
2026-01-16 18:48:29,778 - dq_comparison - INFO -   Target: '8653.56' (type: float64) ‚Üí '8653.56'
2026-01-16 18:48:29,780 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,782 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-01-16 18:48:29,783 - dq_comparison - INFO -   Source: '2023-10-04 00:00:00' (type: datetime) ‚Üí '2023-10-04'
2026-01-16 18:48:29,785 - dq_comparison - INFO -   Target: '04/10/2023' (type: str) ‚Üí '2023-04-10'
2026-01-16 18:48:29,786 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-01-16 18:48:29,788 - dq_comparison - INFO -   ‚ö†Ô∏è DATE MISMATCH DETECTED!
2026-01-16 18:48:29,789 - dq_comparison - INFO -     Source appears to be: 2023-10-04 00:00:00
2026-01-16 18:48:29,790 - dq_comparison - INFO -     Target appears to be (timestamp): 04/10/2023
2026-01-16 18:48:29,792 - dq_comparison - INFO - 
Hash components for Row 0:
2026-01-16 18:48:29,793 - dq_comparison - INFO - Source hash string start: text with& ampersands|78303|TX00078303...
2026-01-16 18:48:29,795 - dq_comparison - INFO - Target hash string start: text with& ampersands|78303|TX00078303...
2026-01-16 18:48:29,796 - dq_comparison - INFO - Same? ‚úÖ YES
2026-01-16 18:48:29,798 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-01-16 18:48:29,800 - dq_comparison - INFO - Column 'description' ‚Üí 'description':
2026-01-16 18:48:29,801 - dq_comparison - INFO -   Source: 'Text with. periods' (type: str) ‚Üí 'text with. periods'
2026-01-16 18:48:29,802 - dq_comparison - INFO -   Target: 'Text with. periods' (type: str) ‚Üí 'text with. periods'
2026-01-16 18:48:29,803 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,805 - dq_comparison - INFO - Column 'id' ‚Üí 'id':
2026-01-16 18:48:29,806 - dq_comparison - INFO -   Source: '66465' (type: int64) ‚Üí '66465'
2026-01-16 18:48:29,807 - dq_comparison - INFO -   Target: '66465' (type: int64) ‚Üí '66465'
2026-01-16 18:48:29,808 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,810 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-01-16 18:48:29,811 - dq_comparison - INFO -   Source: 'TX00066465' (type: str) ‚Üí 'TX00066465'
2026-01-16 18:48:29,812 - dq_comparison - INFO -   Target: 'TX00066465' (type: str) ‚Üí 'TX00066465'
2026-01-16 18:48:29,813 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,814 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-01-16 18:48:29,816 - dq_comparison - INFO -   Source: '1948.44' (type: float64) ‚Üí '1948.44'
2026-01-16 18:48:29,817 - dq_comparison - INFO -   Target: '1948.44' (type: float64) ‚Üí '1948.44'
2026-01-16 18:48:29,819 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,821 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-01-16 18:48:29,822 - dq_comparison - INFO -   Source: '2023-07-04 00:00:00' (type: datetime) ‚Üí '2023-07-04'
2026-01-16 18:48:29,823 - dq_comparison - INFO -   Target: '2023-07-04' (type: str) ‚Üí '2023-07-04'
2026-01-16 18:48:29,824 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,826 - dq_comparison - INFO - 
Hash components for Row 1:
2026-01-16 18:48:29,828 - dq_comparison - INFO - Source hash string start: text with. periods|66465|TX00066465...
2026-01-16 18:48:29,829 - dq_comparison - INFO - Target hash string start: text with. periods|66465|TX00066465...
2026-01-16 18:48:29,831 - dq_comparison - INFO - Same? ‚úÖ YES
2026-01-16 18:48:29,832 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-01-16 18:48:29,835 - dq_comparison - INFO - Column 'description' ‚Üí 'description':
2026-01-16 18:48:29,836 - dq_comparison - INFO -   Source: 'Text with{braces}' (type: str) ‚Üí 'text with{braces}'
2026-01-16 18:48:29,837 - dq_comparison - INFO -   Target: 'Text with{braces}' (type: str) ‚Üí 'text with{braces}'
2026-01-16 18:48:29,839 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,840 - dq_comparison - INFO - Column 'id' ‚Üí 'id':
2026-01-16 18:48:29,841 - dq_comparison - INFO -   Source: '93228' (type: int64) ‚Üí '93228'
2026-01-16 18:48:29,843 - dq_comparison - INFO -   Target: '93228' (type: int64) ‚Üí '93228'
2026-01-16 18:48:29,844 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,845 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-01-16 18:48:29,846 - dq_comparison - INFO -   Source: 'TX00093228' (type: str) ‚Üí 'TX00093228'
2026-01-16 18:48:29,848 - dq_comparison - INFO -   Target: 'TX00093228' (type: str) ‚Üí 'TX00093228'
2026-01-16 18:48:29,849 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,850 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-01-16 18:48:29,851 - dq_comparison - INFO -   Source: '237.49' (type: float64) ‚Üí '237.49'
2026-01-16 18:48:29,853 - dq_comparison - INFO -   Target: '237.49' (type: float64) ‚Üí '237.49'
2026-01-16 18:48:29,854 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,856 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-01-16 18:48:29,857 - dq_comparison - INFO -   Source: '2023-03-10 00:00:00' (type: datetime) ‚Üí '2023-03-10'
2026-01-16 18:48:29,858 - dq_comparison - INFO -   Target: '2023/03/10' (type: str) ‚Üí '2023-03-10'
2026-01-16 18:48:29,860 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-01-16 18:48:29,861 - dq_comparison - INFO - 
Hash components for Row 2:
2026-01-16 18:48:29,863 - dq_comparison - INFO - Source hash string start: text with{braces}|93228|TX00093228...
2026-01-16 18:48:29,864 - dq_comparison - INFO - Target hash string start: text with{braces}|93228|TX00093228...
2026-01-16 18:48:29,866 - dq_comparison - INFO - Same? ‚úÖ YES
2026-01-16 18:48:29,867 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-01-16 18:48:29,868 - dq_comparison - INFO - Column 1: 'description' (object) ‚Üî 'description' (object)
2026-01-16 18:48:29,870 - dq_comparison - INFO -   Sample: Source='Text with& ampersands', Target='Text with& ampersands'
2026-01-16 18:48:29,871 - dq_comparison - INFO - Column 2: 'id' (int64) ‚Üî 'id' (int64)
2026-01-16 18:48:29,873 - dq_comparison - INFO -   Sample: Source='78303', Target='78303'
2026-01-16 18:48:29,874 - dq_comparison - INFO - Column 3: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-01-16 18:48:29,875 - dq_comparison - INFO -   Sample: Source='TX00078303', Target='TX00078303'
2026-01-16 18:48:29,876 - dq_comparison - INFO - Column 4: 'amount' (float64) ‚Üî 'amount' (float64)
2026-01-16 18:48:29,878 - dq_comparison - INFO -   Sample: Source='8653.56', Target='8653.56'
2026-01-16 18:48:29,879 - dq_comparison - INFO - Column 5: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-01-16 18:48:29,880 - dq_comparison - INFO -   Sample: Source='2023-10-04 00:00:00', Target='04/10/2023'
2026-01-16 18:48:29,882 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-01-16 18:48:29,942 - dq_comparison - INFO - Found 36,543 total mismatches
2026-01-16 18:48:29,943 - dq_comparison - INFO - Will process detailed comparisons for first 5,000 rows
2026-01-16 18:48:40,873 - dq_comparison - INFO - Progress: 500/5,000 rows (11.0s)
2026-01-16 18:48:51,465 - dq_comparison - INFO - Progress: 1,000/5,000 rows (21.6s)
2026-01-16 18:49:02,197 - dq_comparison - INFO - Progress: 1,500/5,000 rows (32.3s)
2026-01-16 18:49:12,855 - dq_comparison - INFO - Progress: 2,000/5,000 rows (43.0s)
2026-01-16 18:49:23,473 - dq_comparison - INFO - Progress: 2,500/5,000 rows (53.6s)
2026-01-16 18:49:34,160 - dq_comparison - INFO - Progress: 3,000/5,000 rows (64.3s)
2026-01-16 18:49:44,677 - dq_comparison - INFO - Progress: 3,500/5,000 rows (74.8s)
2026-01-16 18:49:55,133 - dq_comparison - INFO - Progress: 4,000/5,000 rows (85.2s)
2026-01-16 18:50:05,531 - dq_comparison - INFO - Progress: 4,500/5,000 rows (95.6s)
2026-01-16 18:50:15,912 - dq_comparison - INFO - Progress: 5,000/5,000 rows (106.0s)
2026-01-16 18:50:15,996 - dq_comparison - INFO - 
================================================================================
2026-01-16 18:50:15,998 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-01-16 18:50:16,000 - dq_comparison - INFO -   Total mismatches found: 5000
2026-01-16 18:50:16,001 - dq_comparison - INFO -   Detailed comparisons logged: 5000
2026-01-16 18:50:16,002 - dq_comparison - INFO -   First 10 rows displayed above
2026-01-16 18:50:16,004 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-01-16 18:50:16,006 - dq_comparison - INFO -   Use API to retrieve all 5000 mismatches
2026-01-16 18:50:16,007 - dq_comparison - INFO - ================================================================================
2026-01-16 18:50:16,112 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-01-16 18:50:16,113 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 89796
2026-01-16 18:50:16,114 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 100250
2026-01-16 18:50:16,116 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 76784
2026-01-16 18:50:16,117 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 76,958
2026-01-16 18:50:16,119 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 13,041
2026-01-16 18:50:16,120 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 23,542
2026-01-16 18:50:16,226 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-01-16 18:50:16,227 - dq_comparison - INFO - Returning counts for simple scoring:
2026-01-16 18:50:16,229 - dq_comparison - INFO -   Common rows: 76,958
2026-01-16 18:50:16,231 - dq_comparison - INFO -   Unique to source: 13,041
2026-01-16 18:50:16,232 - dq_comparison - INFO -   Unique to target: 23,542
2026-01-16 18:50:16,234 - dq_comparison - INFO -   Value mismatches: 438996
2026-01-16 18:50:16,235 - dq_comparison - INFO -   Missing rows: 13,041
2026-01-16 18:50:16,236 - dq_comparison - INFO -   Extra rows: 23,542
2026-01-16 18:50:16,251 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Excel (20260116_184648_source_data_90k.xlsx (source_data_90k)) vs CSV (20260116_184648_Target_data_100k.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
2     | 1          | description: Text with& ampersands       | description: Text with& ampersands      
5     | 1          | description: Normal text without issues  | description: Normal text without issues 
7     | 1          | description: Text with<angle brackets>   | description: Text with<angle brackets>  
10    | 1          | description: Text with trailing spaces   | description: Text with trailing spaces  
11    | 1          | description: Text with(parentheses)      | description: Text with(parentheses)     
18    | 1          | description: Text with%percent signs     | description: Text with%percent signs    
19    | 1          | description: Text with"quotes"           | description: Text with"quotes"          
22    | 1          | description: Text with, commas           | description: Text with, commas          
39    | 2          | description: Text with[brackets]         | description: Text with[brackets]        
44    | 1          | description: Text with|pipes             | description: Text with|pipes            
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 5000 mismatched rows. Use API for complete data.
========================================================================================================================
2026-01-16 18:50:16,252 - dq_comparison - INFO - Returning enhanced mismatch structure with 5000 detailed mismatches
2026-01-16 18:50:16,343 - dq_comparison - INFO - New structure: 100 detailed mismatches
2026-01-16 18:50:16,346 - dq_comparison - INFO - Analyzing data quality metrics...
2026-01-16 18:51:05,232 - dq_comparison - INFO - Null values - Source: 7439 (0.69%), Target: 8315 (0.69%)
2026-01-16 18:51:05,903 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 203, Target: 250
2026-01-16 18:51:06,223 - dq_comparison - INFO - Source duplicate samples: ['Row 169', 'Row 383', 'Row 639']
2026-01-16 18:51:06,693 - dq_comparison - INFO - Target duplicate samples: ['Row 169', 'Row 383', 'Row 639']
2026-01-16 18:51:06,983 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260116_184702
2026-01-16 18:51:06,986 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-01-16 18:51:06,988 - dq_comparison - INFO -   Source rows: 89999
2026-01-16 18:51:06,994 - dq_comparison - INFO -   Common rows (matched): 76958
2026-01-16 18:51:07,009 - dq_comparison - INFO -   Calculation: (76958 / 89999) * 100 = 85.51%
2026-01-16 18:51:07,011 - dq_comparison - INFO -   Explanation: 76958 matched rows out of 89999 total source rows
2026-01-16 18:51:07,020 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-01-16 18:51:07,029 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-01-16 18:51:07,031 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-16 18:51:07,033 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260116_184702
2026-01-16 18:51:07,035 - dq_audit - INFO - Starting database insertion for comparison...
2026-01-16 18:51:07,059 - dq_audit - INFO - Inserted comparison record with ID: 728
2026-01-16 18:51:07,061 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 728)
2026-01-16 18:51:07,192 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260116_184702
2026-01-16 18:51:07,270 - dq_error_log - INFO - Retrieved summary: 5006 total errors for session CMP_20260116_184702
2026-01-16 18:51:07,272 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-16 18:51:07,297 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260116_184702
2026-01-16 18:51:07,299 - dq_comparison - INFO - 
üîç Final results verification:
2026-01-16 18:51:07,300 - dq_comparison - INFO -    Session ID: CMP_20260116_184702
2026-01-16 18:51:07,302 - dq_comparison - INFO -    DQ Score (Simple %): 85.51%
2026-01-16 18:51:07,304 - dq_comparison - INFO -    Source rows: 89999
2026-01-16 18:51:07,306 - dq_comparison - INFO -    Matched rows: 76958
2026-01-16 18:51:07,307 - dq_comparison - INFO -    Calculation: (76958 / 89999) * 100
2026-01-16 18:51:07,310 - dq_comparison - INFO - Comparison analysis completed successfully
2026-01-16 18:51:07,360 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260116_184702
2026-01-16 18:51:07,497 - dq_error_log - INFO - Retrieved 200 error logs for session CMP_20260116_184702
2026-01-16 18:51:07,561 - dq_error_log - INFO - Retrieved summary: 5006 total errors for session CMP_20260116_184702
2026-01-16 18:51:07,563 - __main__ - INFO - Comparison completed for session CMP_20260116_184648
2026-01-16 18:51:07,610 - __main__ - INFO - Completed with status 200 in 258.672s
