2025-12-22 15:36:33,682 - root - INFO - ðŸ”§ CLI Mode Logging Initialized
2025-12-22 15:36:33,682 - root - INFO - ðŸ“ CLI logs will be saved to: logs/dq_framework_20251222_153633.log
2025-12-22 15:36:33,682 - __main__ - INFO - ðŸš€ UNIVERSAL DATA QUALITY FRAMEWORK INITIALIZED
2025-12-22 15:36:34,192 - __main__ - INFO - User session started at: 2025-12-22 15:36:34.192750
2025-12-22 15:36:34,192 - __main__ - INFO - Displaying main menu options to user
2025-12-22 15:36:36,013 - __main__ - INFO - User selected option: 4
2025-12-22 15:36:36,014 - __main__ - INFO - Starting Business Rules Engine module
2025-12-22 15:36:36,016 - dq_rules - INFO - STARTING BUSINESS RULES VALIDATION
2025-12-22 15:36:36,018 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 15:36:36,018 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 15:36:37,784 - dq_unified - INFO - User selected source type: 1
2025-12-22 15:36:58,203 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 15:36:58,204 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 15:36:58,205 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 15:36:58,205 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 15:36:58,214 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 15:36:58,218 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 15:36:58,219 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 90.7MB total, 0.0MB for dataframe
2025-12-22 15:36:58,221 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 15:36:58,221 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 15:36:58,221 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 15:37:01,957 - dq_rules - INFO - User selected rule type: 6
2025-12-22 15:37:01,958 - dq_rules - INFO - CREATING COMPREHENSIVE RULE SET
2025-12-22 15:37:01,962 - dq_rules - INFO - THRESHOLD RULES SETUP
2025-12-22 15:37:01,963 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary']
2025-12-22 15:37:08,616 - dq_rules - INFO - Creating threshold rule for: Salary
2025-12-22 15:37:08,619 - dq_rules - INFO - Current stats - Min: 45000.00, Max: 70000.00, Median: 53000.00
2025-12-22 15:37:10,679 - dq_rules - INFO - Created: Salary should be above median value (53000.00)
2025-12-22 15:37:10,682 - dq_rules - INFO - PATTERN RULES SETUP
2025-12-22 15:37:10,683 - dq_rules - INFO - Available string columns: ['CustomerName', 'Email', 'JoinDate', 'PostalCode', 'City', 'State']
2025-12-22 15:37:29,405 - dq_rules - INFO - Created pattern rule for Email
2025-12-22 15:37:29,408 - dq_rules - INFO - RANGE RULES SETUP
2025-12-22 15:37:29,409 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary']
2025-12-22 15:37:39,817 - dq_rules - INFO - Creating range rule for: Salary
2025-12-22 15:37:39,819 - dq_rules - INFO - Current range - Min: 45000.00, Max: 70000.00
2025-12-22 15:37:41,989 - dq_rules - INFO - Created: Salary should be between 45000.00 and 70000.00
2025-12-22 15:37:41,991 - dq_rules - INFO - NULL CHECK RULES SETUP
2025-12-22 15:37:43,882 - dq_rules - INFO - Checking for columns with null values...
2025-12-22 15:37:43,883 - dq_rules - INFO - Found 1 null values in 'CustomerName'
2025-12-22 15:37:43,884 - dq_rules - INFO - Created null check rule for CustomerName
2025-12-22 15:37:43,885 - dq_rules - INFO - Found 1 null values in 'Email'
2025-12-22 15:37:43,886 - dq_rules - INFO - Created null check rule for Email
2025-12-22 15:37:43,887 - dq_rules - INFO - Found 2 null values in 'Salary'
2025-12-22 15:37:43,887 - dq_rules - INFO - Created null check rule for Salary
2025-12-22 15:37:43,888 - dq_rules - INFO - Found 1 null values in 'Department'
2025-12-22 15:37:43,889 - dq_rules - INFO - Created null check rule for Department
2025-12-22 15:37:43,889 - dq_rules - INFO - Found 1 null values in 'State'
2025-12-22 15:37:43,891 - dq_rules - INFO - Created null check rule for State
2025-12-22 15:37:43,892 - dq_rules - INFO - KPI THRESHOLD RULES SETUP
2025-12-22 15:37:50,279 - dq_rules - INFO - Current row count: 15
2025-12-22 15:38:01,874 - dq_rules - INFO - Storing KPI history for: row_count
2025-12-22 15:38:01,876 - dq_rules - INFO - Storing KPI history for: row_count
2025-12-22 15:38:01,876 - dq_rules - INFO - Connecting to database: dq_checks at localhost
2025-12-22 15:38:02,306 - dq_rules - INFO - Database connection successful!
2025-12-22 15:38:02,306 - dq_rules - INFO - Checking kpi_history table structure...
2025-12-22 15:38:02,315 - dq_rules - INFO - kpi_history table exists, checking structure...
2025-12-22 15:38:02,319 - dq_rules - INFO - Current columns in kpi_history: ['id', 'session_id', 'kpi_name', 'kpi_value', 'threshold_value', 'check_timestamp', 'created_at']
2025-12-22 15:38:02,320 - dq_rules - INFO - Table has correct schema, using existing table
2025-12-22 15:38:02,320 - dq_rules - INFO - Inserting KPI: row_count = 15.0 for session RULES_20251222_153658
2025-12-22 15:38:02,325 - dq_rules - INFO - âœ… KPI history stored successfully for: row_count (ID: 6)
2025-12-22 15:38:02,325 - dq_rules - INFO - Created KPI rule: KPI: Total row count | Percentage threshold: 10.0% | Max growth: 30.0%
2025-12-22 15:38:02,329 - dq_rules - INFO - Created comprehensive rule set with 9 rules
2025-12-22 15:38:02,330 - dq_rules - INFO - Defined 9 business rules
2025-12-22 15:38:02,331 - dq_rules - INFO - EXECUTING 9 BUSINESS RULES
2025-12-22 15:38:02,332 - dq_rules - INFO - Executing rule: Salary should be above median value (53000.00)
2025-12-22 15:38:02,332 - dq_rules - INFO - Executing threshold rule: Salary should be above median value (53000.00)
2025-12-22 15:38:02,334 - dq_rules - INFO - Threshold rule 'Salary should be above median value (53000.00)': 6 violations found
2025-12-22 15:38:02,350 - dq_error_log - INFO - Batch logged 6 errors for session RULES_20251222_153658
2025-12-22 15:38:02,350 - dq_rules - WARNING - 6 violations found
2025-12-22 15:38:02,363 - dq_rules - INFO - Rule 'Salary should be above median value (53000.00)' completed with status: FAIL
2025-12-22 15:38:02,363 - dq_rules - INFO - Executing rule: Email should be in valid email format
2025-12-22 15:38:02,364 - dq_rules - INFO - Executing pattern rule: Email should be in valid email format
2025-12-22 15:38:02,366 - dq_rules - INFO - Pattern rule 'Email should be in valid email format': 3 pattern violations found
2025-12-22 15:38:02,383 - dq_error_log - INFO - Batch logged 3 errors for session RULES_20251222_153658
2025-12-22 15:38:02,384 - dq_rules - WARNING - 3 pattern violations found
2025-12-22 15:38:02,387 - dq_rules - INFO - Rule 'Email should be in valid email format' completed with status: FAIL
2025-12-22 15:38:02,391 - dq_rules - INFO - Executing rule: Salary should be between 45000.00 and 70000.00
2025-12-22 15:38:02,392 - dq_rules - INFO - Executing range rule: Salary should be between 45000.00 and 70000.00
2025-12-22 15:38:02,393 - dq_rules - INFO - Range rule 'Salary should be between 45000.00 and 70000.00': 0 range violations found
2025-12-22 15:38:02,393 - dq_rules - INFO - No range violations found
2025-12-22 15:38:02,395 - dq_rules - INFO - Rule 'Salary should be between 45000.00 and 70000.00' completed with status: PASS
2025-12-22 15:38:02,396 - dq_rules - INFO - Executing rule: CustomerName should have no null values (currently 1 nulls)
2025-12-22 15:38:02,396 - dq_rules - INFO - Executing threshold rule: CustomerName should have no null values (currently 1 nulls)
2025-12-22 15:38:02,398 - dq_rules - INFO - Threshold rule 'CustomerName should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 15:38:02,399 - dq_rules - INFO - No violations found
2025-12-22 15:38:02,399 - dq_rules - INFO - Rule 'CustomerName should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 15:38:02,401 - dq_rules - INFO - Executing rule: Email should have no null values (currently 1 nulls)
2025-12-22 15:38:02,401 - dq_rules - INFO - Executing threshold rule: Email should have no null values (currently 1 nulls)
2025-12-22 15:38:02,402 - dq_rules - INFO - Threshold rule 'Email should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 15:38:02,403 - dq_rules - INFO - No violations found
2025-12-22 15:38:02,407 - dq_rules - INFO - Rule 'Email should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 15:38:02,408 - dq_rules - INFO - Executing rule: Salary should have no null values (currently 2 nulls)
2025-12-22 15:38:02,409 - dq_rules - INFO - Executing threshold rule: Salary should have no null values (currently 2 nulls)
2025-12-22 15:38:02,410 - dq_rules - INFO - Threshold rule 'Salary should have no null values (currently 2 nulls)': 0 violations found
2025-12-22 15:38:02,410 - dq_rules - INFO - No violations found
2025-12-22 15:38:02,411 - dq_rules - INFO - Rule 'Salary should have no null values (currently 2 nulls)' completed with status: PASS
2025-12-22 15:38:02,412 - dq_rules - INFO - Executing rule: Department should have no null values (currently 1 nulls)
2025-12-22 15:38:02,413 - dq_rules - INFO - Executing threshold rule: Department should have no null values (currently 1 nulls)
2025-12-22 15:38:02,414 - dq_rules - INFO - Threshold rule 'Department should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 15:38:02,414 - dq_rules - INFO - No violations found
2025-12-22 15:38:02,416 - dq_rules - INFO - Rule 'Department should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 15:38:02,417 - dq_rules - INFO - Executing rule: State should have no null values (currently 1 nulls)
2025-12-22 15:38:02,417 - dq_rules - INFO - Executing threshold rule: State should have no null values (currently 1 nulls)
2025-12-22 15:38:02,418 - dq_rules - INFO - Threshold rule 'State should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 15:38:02,419 - dq_rules - INFO - No violations found
2025-12-22 15:38:02,423 - dq_rules - INFO - Rule 'State should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 15:38:02,424 - dq_rules - INFO - Executing rule: KPI: Total row count | Percentage threshold: 10.0% | Max growth: 30.0%
2025-12-22 15:38:02,424 - dq_rules - INFO - Executing KPI threshold rule: KPI: Total row count | Percentage threshold: 10.0% | Max growth: 30.0%
2025-12-22 15:38:02,438 - dq_rules - INFO - Growth Analysis: Previous value: 15.00 (2025-12-18 15:36:13), Current value: 15.00, Growth rate: 0.0%, Max allowed: 30.0%
2025-12-22 15:38:02,438 - dq_rules - INFO - KPI within acceptable limits. Current value: 15.00, Threshold: 16.50
2025-12-22 15:38:02,440 - dq_rules - INFO - Rule 'KPI: Total row count | Percentage threshold: 10.0% | Max growth: 30.0%' completed with status: PASS
2025-12-22 15:38:02,440 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 9
2025-12-22 15:38:02,441 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 15:38:02,441 - dq_rules - INFO - Report for: CSV: sample_data.csv, Records: 15, Columns: 10
2025-12-22 15:38:02,445 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 15:38:02,463 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 15:38:02,486 - dq_audit - INFO - Inserted rules record with ID: 208
2025-12-22 15:38:02,487 - dq_audit - INFO - Inserted rules record with ID: 208
2025-12-22 15:38:02,493 - dq_rules - INFO - Audit record logged with ID: 208
2025-12-22 15:38:02,504 - dq_rules - INFO - RULES SUMMARY: Total Rules: 9, Passed: 7, Failed: 2, Errors: 0, Total Violations: 9
2025-12-22 15:38:02,528 - dq_error_log - INFO - Retrieved 9 errors for session RULES_20251222_153658
2025-12-22 15:38:02,562 - dq_rules - INFO - ERROR LOGGING: Session ID: RULES_20251222_153658, Total errors logged: 9
2025-12-22 15:53:06,312 - __main__ - INFO - Business Rules Engine completed successfully
2025-12-22 15:53:06,317 - __main__ - INFO - Displaying main menu options to user
2025-12-22 15:53:08,668 - __main__ - INFO - User selected option: 6
2025-12-22 15:53:08,670 - __main__ - INFO - User session ended. Duration: 0:16:34.476351
2025-12-22 15:53:08,673 - __main__ - INFO - ðŸ‘‹ Thank you for using Universal Data Quality Framework!
