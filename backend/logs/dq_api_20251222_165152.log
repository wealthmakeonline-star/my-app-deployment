2025-12-22 16:51:52,734 - root - INFO - üåê API Server Logging Initialized
2025-12-22 16:51:53,018 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:51:53,018 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:51:53,025 - root - INFO - Starting Data Quality API on 0.0.0.0:5000 (debug=False)
2025-12-22 16:51:53,025 - root - INFO - DQ modules available: True
2025-12-22 16:51:53,025 - root - INFO - Config file mode: False
2025-12-22 16:51:53,026 - root - INFO - Database config: localhost/dq_checks
2025-12-22 16:51:53,969 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.1.185.54:5000
2025-12-22 16:51:53,969 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-12-22 16:52:07,234 - root - INFO - Business rules request received: dict_keys(['source_type', 'file_path', 'rule_type', 'threshold_column', 'threshold_operator', 'threshold_value'])
2025-12-22 16:52:07,234 - root - INFO - Starting business rules validation for session RULES_20251222_165207_bb423efe
2025-12-22 16:52:07,234 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 16:52:07,234 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2025-12-22 16:52:07,234 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:07,235 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type']
2025-12-22 16:52:07,235 - dq_rules - INFO - File path in UI data: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:07,235 - dq_rules - INFO - ===============================
2025-12-22 16:52:07,235 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 16:52:07,235 - dq_unified - INFO - User selected source type: 1
2025-12-22 16:52:07,235 - dq_rules - INFO - Source type: csv, Source config: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:07,235 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 16:52:07,236 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:07,238 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 16:52:07,238 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 16:52:07,247 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 16:52:07,251 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 16:52:07,251 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 100.4MB total, 0.0MB for dataframe
2025-12-22 16:52:07,252 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2025-12-22 16:52:07,252 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:52:07,252 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 16:52:07,252 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 16:52:07,252 - dq_rules - INFO - User selected rule type: 1
2025-12-22 16:52:07,253 - dq_rules - INFO - CREATING THRESHOLD RULE
2025-12-22 16:52:07,253 - dq_rules - INFO - === DEBUG create_threshold_rule ===
2025-12-22 16:52:07,253 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:07,253 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type']
2025-12-22 16:52:07,253 - dq_rules - INFO -   threshold_column: NOT FOUND
2025-12-22 16:52:07,253 - dq_rules - INFO -   pattern_column: NOT FOUND
2025-12-22 16:52:07,253 - dq_rules - INFO -   range_column: NOT FOUND
2025-12-22 16:52:07,253 - dq_rules - INFO -   kpi_threshold_value: NOT FOUND
2025-12-22 16:52:07,253 - dq_rules - INFO -   pattern_columns: NOT FOUND
2025-12-22 16:52:07,253 - dq_rules - INFO -   rule_type: 1
2025-12-22 16:52:07,253 - dq_rules - INFO - ===================
2025-12-22 16:52:07,253 - dq_rules - INFO - Auto-selected first numeric column: Phone
2025-12-22 16:52:07,253 - dq_rules - INFO - Using default operator: >
2025-12-22 16:52:07,254 - dq_rules - INFO - Using default threshold value: 0
2025-12-22 16:52:07,254 - dq_rules - INFO - Threshold rule created: Phone > 0
2025-12-22 16:52:07,254 - dq_rules - INFO - Defined 1 business rules
2025-12-22 16:52:07,254 - dq_rules - INFO - EXECUTING 1 BUSINESS RULES
2025-12-22 16:52:07,255 - dq_rules - INFO - Executing rule: Phone > 0
2025-12-22 16:52:07,255 - dq_rules - INFO - Executing threshold rule: Phone > 0
2025-12-22 16:52:07,256 - dq_rules - INFO - Threshold rule 'Phone > 0': 15 violations found
2025-12-22 16:52:07,405 - dq_error_log - INFO - Batch logged 15 errors for session RULES_20251222_165207
2025-12-22 16:52:07,406 - dq_rules - WARNING - 15 violations found
2025-12-22 16:52:07,414 - dq_rules - INFO - Rule 'Phone > 0' completed with status: FAIL
2025-12-22 16:52:07,414 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 15
2025-12-22 16:52:07,415 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 16:52:07,415 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:07,444 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 16:52:07,460 - dq_audit - INFO - Inserted rules record with ID: 218
2025-12-22 16:52:07,460 - dq_audit - INFO - Inserted rules record with ID: 218
2025-12-22 16:52:07,463 - dq_rules - INFO - Audit record logged with ID: 218
2025-12-22 16:52:07,463 - dq_rules - INFO - Returning JSON report for API, Session: RULES_20251222_165207
2025-12-22 16:52:07,484 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:07,513 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:07,565 - root - INFO - Completed business rules validation for session RULES_20251222_165207_bb423efe
2025-12-22 16:52:07,566 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 16:52:07] "POST /api/rules HTTP/1.1" 200 -
2025-12-22 16:52:10,619 - root - INFO - Business rules request received: dict_keys(['source_type', 'file_path', 'rule_type', 'pattern_column', 'pattern_type', 'pattern_columns'])
2025-12-22 16:52:10,620 - root - INFO - Starting business rules validation for session RULES_20251222_165210_2de362bd
2025-12-22 16:52:10,620 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 16:52:10,620 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2025-12-22 16:52:10,620 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:10,620 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type']
2025-12-22 16:52:10,620 - dq_rules - INFO - File path in UI data: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:10,620 - dq_rules - INFO - ===============================
2025-12-22 16:52:10,620 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 16:52:10,620 - dq_unified - INFO - User selected source type: 1
2025-12-22 16:52:10,620 - dq_rules - INFO - Source type: csv, Source config: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:10,620 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 16:52:10,624 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:10,626 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 16:52:10,626 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 16:52:10,631 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 16:52:10,636 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 16:52:10,636 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 107.9MB total, 0.0MB for dataframe
2025-12-22 16:52:10,637 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2025-12-22 16:52:10,639 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:52:10,639 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 16:52:10,639 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 16:52:10,640 - dq_rules - INFO - User selected rule type: 2
2025-12-22 16:52:10,640 - dq_rules - INFO - CREATING PATTERN RULE
2025-12-22 16:52:10,640 - dq_rules - INFO - Auto-selected first string column: CustomerName
2025-12-22 16:52:10,640 - dq_rules - INFO - Pattern rule created: CustomerName must match email pattern
2025-12-22 16:52:10,640 - dq_rules - INFO - Defined 1 business rules
2025-12-22 16:52:10,641 - dq_rules - INFO - EXECUTING 1 BUSINESS RULES
2025-12-22 16:52:10,642 - dq_rules - INFO - Executing rule: CustomerName must match email pattern
2025-12-22 16:52:10,642 - dq_rules - INFO - Executing pattern rule: CustomerName must match email pattern
2025-12-22 16:52:10,643 - dq_rules - INFO - Pattern rule 'CustomerName must match email pattern': 15 pattern violations found
2025-12-22 16:52:10,661 - dq_error_log - INFO - Batch logged 15 errors for session RULES_20251222_165210
2025-12-22 16:52:10,662 - dq_rules - WARNING - 15 pattern violations found
2025-12-22 16:52:10,667 - dq_rules - INFO - Rule 'CustomerName must match email pattern' completed with status: FAIL
2025-12-22 16:52:10,667 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 15
2025-12-22 16:52:10,668 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 16:52:10,668 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:10,675 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 16:52:10,692 - dq_audit - INFO - Inserted rules record with ID: 219
2025-12-22 16:52:10,692 - dq_audit - INFO - Inserted rules record with ID: 219
2025-12-22 16:52:10,695 - dq_rules - INFO - Audit record logged with ID: 219
2025-12-22 16:52:10,695 - dq_rules - INFO - Returning JSON report for API, Session: RULES_20251222_165210
2025-12-22 16:52:10,723 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:10,754 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:10,819 - root - INFO - Completed business rules validation for session RULES_20251222_165210_2de362bd
2025-12-22 16:52:10,820 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 16:52:10] "POST /api/rules HTTP/1.1" 200 -
2025-12-22 16:52:13,876 - root - INFO - Business rules request received: dict_keys(['source_type', 'file_path', 'rule_type', 'range_column', 'range_min', 'range_max'])
2025-12-22 16:52:13,876 - root - INFO - Starting business rules validation for session RULES_20251222_165213_82a24b49
2025-12-22 16:52:13,876 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 16:52:13,876 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2025-12-22 16:52:13,876 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:13,876 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type']
2025-12-22 16:52:13,876 - dq_rules - INFO - File path in UI data: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:13,876 - dq_rules - INFO - ===============================
2025-12-22 16:52:13,876 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 16:52:13,876 - dq_unified - INFO - User selected source type: 1
2025-12-22 16:52:13,876 - dq_rules - INFO - Source type: csv, Source config: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:13,876 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 16:52:13,880 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:13,883 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 16:52:13,883 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 16:52:13,887 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 16:52:13,891 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 16:52:13,892 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 108.2MB total, 0.0MB for dataframe
2025-12-22 16:52:13,895 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2025-12-22 16:52:13,895 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:52:13,895 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 16:52:13,895 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 16:52:13,896 - dq_rules - INFO - User selected rule type: 3
2025-12-22 16:52:13,896 - dq_rules - INFO - CREATING RANGE RULE
2025-12-22 16:52:13,897 - dq_rules - INFO - Auto-selected first numeric column: Phone
2025-12-22 16:52:13,897 - dq_rules - INFO - Using column minimum: 1112222
2025-12-22 16:52:13,897 - dq_rules - INFO - Using column maximum: 9998887777
2025-12-22 16:52:13,897 - dq_rules - INFO - Range rule created: Phone between 1112222 and 9998887777
2025-12-22 16:52:13,897 - dq_rules - INFO - Defined 1 business rules
2025-12-22 16:52:13,898 - dq_rules - INFO - EXECUTING 1 BUSINESS RULES
2025-12-22 16:52:13,899 - dq_rules - INFO - Executing rule: Phone between 1112222 and 9998887777
2025-12-22 16:52:13,899 - dq_rules - INFO - Executing range rule: Phone between 1112222 and 9998887777
2025-12-22 16:52:13,900 - dq_rules - INFO - Range rule 'Phone between 1112222 and 9998887777': 0 range violations found
2025-12-22 16:52:13,900 - dq_rules - INFO - No range violations found
2025-12-22 16:52:13,901 - dq_rules - INFO - Rule 'Phone between 1112222 and 9998887777' completed with status: PASS
2025-12-22 16:52:13,901 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 0
2025-12-22 16:52:13,902 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 16:52:13,902 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:13,913 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 16:52:13,928 - dq_audit - INFO - Inserted rules record with ID: 220
2025-12-22 16:52:13,928 - dq_audit - INFO - Inserted rules record with ID: 220
2025-12-22 16:52:13,931 - dq_rules - INFO - Audit record logged with ID: 220
2025-12-22 16:52:13,931 - dq_rules - INFO - Returning JSON report for API, Session: RULES_20251222_165213
2025-12-22 16:52:13,954 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:13,983 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:14,057 - root - INFO - Completed business rules validation for session RULES_20251222_165213_82a24b49
2025-12-22 16:52:14,057 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 16:52:14] "POST /api/rules HTTP/1.1" 200 -
2025-12-22 16:52:17,105 - root - INFO - Business rules request received: dict_keys(['source_type', 'file_path', 'rule_type', 'kpi_type', 'kpi_threshold_type', 'kpi_threshold_value'])
2025-12-22 16:52:17,105 - root - INFO - Starting business rules validation for session RULES_20251222_165217_f41a13b9
2025-12-22 16:52:17,105 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 16:52:17,105 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2025-12-22 16:52:17,107 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:17,107 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type']
2025-12-22 16:52:17,107 - dq_rules - INFO - File path in UI data: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:17,107 - dq_rules - INFO - ===============================
2025-12-22 16:52:17,107 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 16:52:17,107 - dq_unified - INFO - User selected source type: 1
2025-12-22 16:52:17,107 - dq_rules - INFO - Source type: csv, Source config: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:17,107 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 16:52:17,110 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:17,113 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 16:52:17,114 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 16:52:17,117 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 16:52:17,123 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 16:52:17,124 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 108.2MB total, 0.0MB for dataframe
2025-12-22 16:52:17,126 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2025-12-22 16:52:17,126 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:52:17,126 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 16:52:17,126 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 16:52:17,127 - dq_rules - INFO - User selected rule type: 4
2025-12-22 16:52:17,127 - dq_rules - INFO - CREATING KPI THRESHOLD RULE
2025-12-22 16:52:17,127 - dq_rules - INFO - Using default KPI type: 1 (Row Count)
2025-12-22 16:52:17,127 - dq_rules - INFO - Current row count: 15
2025-12-22 16:52:17,127 - dq_rules - INFO - Using default threshold type: absolute
2025-12-22 16:52:17,127 - dq_rules - INFO - Using default threshold value: 16.5 (10% above current)
2025-12-22 16:52:17,127 - dq_rules - INFO - Using default growth check: False
2025-12-22 16:52:17,127 - dq_rules - INFO - KPI Rule created: {'type': 'kpi_threshold', 'kpi_name': 'row_count', 'kpi_description': 'Total row count', 'current_value': 15, 'threshold_type': 'absolute', 'threshold_value': 16.5, 'threshold_description': 'Absolute threshold: 16.5', 'enable_growth_check': False, 'growth_threshold': None, 'description': 'KPI: Total row count | Absolute threshold: 16.5'}
2025-12-22 16:52:17,127 - dq_rules - INFO - KPI Name: row_count, Current Value: 15, Threshold: 16.5
2025-12-22 16:52:17,127 - dq_rules - INFO - Storing KPI history for: row_count
2025-12-22 16:52:17,128 - dq_rules - INFO - Storing KPI history for: row_count
2025-12-22 16:52:17,128 - dq_rules - INFO - Connecting to database: dq_checks at localhost
2025-12-22 16:52:17,141 - dq_rules - INFO - Database connection successful!
2025-12-22 16:52:17,141 - dq_rules - INFO - Checking kpi_history table structure...
2025-12-22 16:52:17,143 - dq_rules - INFO - kpi_history table exists, checking structure...
2025-12-22 16:52:17,146 - dq_rules - INFO - Current columns in kpi_history: ['id', 'session_id', 'kpi_name', 'kpi_value', 'threshold_value', 'check_timestamp', 'created_at']
2025-12-22 16:52:17,146 - dq_rules - INFO - Table has correct schema, using existing table
2025-12-22 16:52:17,146 - dq_rules - INFO - Inserting KPI: row_count = 15.0 for session RULES_20251222_165217
2025-12-22 16:52:17,149 - dq_rules - INFO - ‚úÖ KPI history stored successfully for: row_count (ID: 7)
2025-12-22 16:52:17,149 - dq_rules - INFO - KPI rule created: KPI: Total row count | Absolute threshold: 16.5
2025-12-22 16:52:17,149 - dq_rules - INFO - Defined 1 business rules
2025-12-22 16:52:17,149 - dq_rules - INFO - EXECUTING 1 BUSINESS RULES
2025-12-22 16:52:17,155 - dq_rules - INFO - Executing rule: KPI: Total row count | Absolute threshold: 16.5
2025-12-22 16:52:17,155 - dq_rules - INFO - Executing KPI threshold rule: KPI: Total row count | Absolute threshold: 16.5
2025-12-22 16:52:17,155 - dq_rules - INFO - KPI within acceptable limits. Current value: 15.00, Threshold: 16.50
2025-12-22 16:52:17,156 - dq_rules - INFO - Rule 'KPI: Total row count | Absolute threshold: 16.5' completed with status: PASS
2025-12-22 16:52:17,156 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 0
2025-12-22 16:52:17,157 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 16:52:17,157 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:17,164 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 16:52:17,179 - dq_audit - INFO - Inserted rules record with ID: 221
2025-12-22 16:52:17,179 - dq_audit - INFO - Inserted rules record with ID: 221
2025-12-22 16:52:17,181 - dq_rules - INFO - Audit record logged with ID: 221
2025-12-22 16:52:17,181 - dq_rules - INFO - Returning JSON report for API, Session: RULES_20251222_165217
2025-12-22 16:52:17,209 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:17,241 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:17,295 - root - INFO - Completed business rules validation for session RULES_20251222_165217_f41a13b9
2025-12-22 16:52:17,296 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 16:52:17] "POST /api/rules HTTP/1.1" 200 -
2025-12-22 16:52:20,353 - root - INFO - Business rules request received: dict_keys(['source_type', 'file_path', 'rule_type', 'create_threshold', 'create_pattern', 'create_range', 'create_null_checks', 'create_kpi'])
2025-12-22 16:52:20,353 - root - INFO - Starting business rules validation for session RULES_20251222_165220_19db6d3b
2025-12-22 16:52:20,353 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 16:52:20,353 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2025-12-22 16:52:20,353 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:20,353 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type']
2025-12-22 16:52:20,353 - dq_rules - INFO - File path in UI data: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:20,353 - dq_rules - INFO - ===============================
2025-12-22 16:52:20,353 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 16:52:20,353 - dq_unified - INFO - User selected source type: 1
2025-12-22 16:52:20,353 - dq_rules - INFO - Source type: csv, Source config: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:20,353 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 16:52:20,354 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:20,357 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 16:52:20,357 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 16:52:20,360 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 16:52:20,365 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 16:52:20,366 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 108.2MB total, 0.0MB for dataframe
2025-12-22 16:52:20,367 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2025-12-22 16:52:20,372 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:52:20,374 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 16:52:20,374 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 16:52:20,374 - dq_rules - INFO - User selected rule type: 6
2025-12-22 16:52:20,374 - dq_rules - INFO - CREATING COMPREHENSIVE RULE SET
2025-12-22 16:52:20,376 - dq_rules - INFO - THRESHOLD RULES SETUP
2025-12-22 16:52:20,376 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary']
2025-12-22 16:52:20,377 - dq_rules - INFO - Using default create_threshold: n
2025-12-22 16:52:20,377 - dq_rules - INFO - PATTERN RULES SETUP
2025-12-22 16:52:20,378 - dq_rules - INFO - Available string columns: ['CustomerName', 'Email', 'JoinDate', 'PostalCode', 'City', 'State']
2025-12-22 16:52:20,378 - dq_rules - INFO - Using default create_pattern: n
2025-12-22 16:52:20,379 - dq_rules - INFO - RANGE RULES SETUP
2025-12-22 16:52:20,379 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary']
2025-12-22 16:52:20,379 - dq_rules - INFO - Using default create_range: n
2025-12-22 16:52:20,380 - dq_rules - INFO - NULL CHECK RULES SETUP
2025-12-22 16:52:20,380 - dq_rules - INFO - Using default create_null_checks: y
2025-12-22 16:52:20,380 - dq_rules - INFO - Checking for columns with null values...
2025-12-22 16:52:20,381 - dq_rules - INFO - Found 1 null values in 'CustomerName'
2025-12-22 16:52:20,381 - dq_rules - INFO - Created null check rule for CustomerName
2025-12-22 16:52:20,381 - dq_rules - INFO - Found 1 null values in 'Email'
2025-12-22 16:52:20,385 - dq_rules - INFO - Created null check rule for Email
2025-12-22 16:52:20,386 - dq_rules - INFO - Found 2 null values in 'Salary'
2025-12-22 16:52:20,386 - dq_rules - INFO - Created null check rule for Salary
2025-12-22 16:52:20,386 - dq_rules - INFO - Found 1 null values in 'Department'
2025-12-22 16:52:20,386 - dq_rules - INFO - Created null check rule for Department
2025-12-22 16:52:20,387 - dq_rules - INFO - Found 1 null values in 'State'
2025-12-22 16:52:20,387 - dq_rules - INFO - Created null check rule for State
2025-12-22 16:52:20,388 - dq_rules - INFO - KPI THRESHOLD RULES SETUP
2025-12-22 16:52:20,389 - dq_rules - INFO - Using default create_kpi: n
2025-12-22 16:52:20,389 - dq_rules - INFO - Created comprehensive rule set with 5 rules
2025-12-22 16:52:20,391 - dq_rules - INFO - Defined 5 business rules
2025-12-22 16:52:20,391 - dq_rules - INFO - EXECUTING 5 BUSINESS RULES
2025-12-22 16:52:20,392 - dq_rules - INFO - Executing rule: CustomerName should have no null values (currently 1 nulls)
2025-12-22 16:52:20,393 - dq_rules - INFO - Executing threshold rule: CustomerName should have no null values (currently 1 nulls)
2025-12-22 16:52:20,393 - dq_rules - INFO - Threshold rule 'CustomerName should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:20,394 - dq_rules - INFO - No violations found
2025-12-22 16:52:20,394 - dq_rules - INFO - Rule 'CustomerName should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:20,395 - dq_rules - INFO - Executing rule: Email should have no null values (currently 1 nulls)
2025-12-22 16:52:20,395 - dq_rules - INFO - Executing threshold rule: Email should have no null values (currently 1 nulls)
2025-12-22 16:52:20,395 - dq_rules - INFO - Threshold rule 'Email should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:20,395 - dq_rules - INFO - No violations found
2025-12-22 16:52:20,396 - dq_rules - INFO - Rule 'Email should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:20,396 - dq_rules - INFO - Executing rule: Salary should have no null values (currently 2 nulls)
2025-12-22 16:52:20,396 - dq_rules - INFO - Executing threshold rule: Salary should have no null values (currently 2 nulls)
2025-12-22 16:52:20,397 - dq_rules - INFO - Threshold rule 'Salary should have no null values (currently 2 nulls)': 0 violations found
2025-12-22 16:52:20,397 - dq_rules - INFO - No violations found
2025-12-22 16:52:20,397 - dq_rules - INFO - Rule 'Salary should have no null values (currently 2 nulls)' completed with status: PASS
2025-12-22 16:52:20,400 - dq_rules - INFO - Executing rule: Department should have no null values (currently 1 nulls)
2025-12-22 16:52:20,400 - dq_rules - INFO - Executing threshold rule: Department should have no null values (currently 1 nulls)
2025-12-22 16:52:20,401 - dq_rules - INFO - Threshold rule 'Department should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:20,401 - dq_rules - INFO - No violations found
2025-12-22 16:52:20,402 - dq_rules - INFO - Rule 'Department should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:20,402 - dq_rules - INFO - Executing rule: State should have no null values (currently 1 nulls)
2025-12-22 16:52:20,402 - dq_rules - INFO - Executing threshold rule: State should have no null values (currently 1 nulls)
2025-12-22 16:52:20,403 - dq_rules - INFO - Threshold rule 'State should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:20,403 - dq_rules - INFO - No violations found
2025-12-22 16:52:20,403 - dq_rules - INFO - Rule 'State should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:20,403 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 0
2025-12-22 16:52:20,404 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 16:52:20,404 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:20,412 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 16:52:20,427 - dq_audit - INFO - Inserted rules record with ID: 222
2025-12-22 16:52:20,427 - dq_audit - INFO - Inserted rules record with ID: 222
2025-12-22 16:52:20,431 - dq_rules - INFO - Audit record logged with ID: 222
2025-12-22 16:52:20,431 - dq_rules - INFO - Returning JSON report for API, Session: RULES_20251222_165220
2025-12-22 16:52:20,453 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:20,481 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:20,526 - root - INFO - Completed business rules validation for session RULES_20251222_165220_19db6d3b
2025-12-22 16:52:20,527 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 16:52:20] "POST /api/rules HTTP/1.1" 200 -
2025-12-22 16:52:23,566 - root - INFO - Business rules request received: dict_keys(['source_type', 'file_path', 'rule_type', 'create_threshold', 'threshold_columns', 'threshold_type_sales', 'threshold_type_age', 'create_pattern', 'pattern_choice', 'pattern_columns', 'create_range', 'range_columns', 'range_type_age', 'min_val_age', 'max_val_age', 'range_type_sales', 'create_null_checks', 'create_kpi', 'kpi_type', 'threshold_type', 'threshold_value', 'enable_growth_check'])
2025-12-22 16:52:23,566 - root - INFO - Starting business rules validation for session RULES_20251222_165223_d52570f8
2025-12-22 16:52:23,566 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 16:52:23,567 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2025-12-22 16:52:23,567 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:23,567 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type']
2025-12-22 16:52:23,567 - dq_rules - INFO - File path in UI data: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:23,567 - dq_rules - INFO - ===============================
2025-12-22 16:52:23,567 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 16:52:23,567 - dq_unified - INFO - User selected source type: 1
2025-12-22 16:52:23,567 - dq_rules - INFO - Source type: csv, Source config: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:23,567 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 16:52:23,570 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:23,572 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 16:52:23,572 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 16:52:23,577 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 16:52:23,581 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 16:52:23,582 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 108.2MB total, 0.0MB for dataframe
2025-12-22 16:52:23,583 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2025-12-22 16:52:23,584 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:52:23,585 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 16:52:23,585 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 16:52:23,585 - dq_rules - INFO - User selected rule type: 6
2025-12-22 16:52:23,585 - dq_rules - INFO - CREATING COMPREHENSIVE RULE SET
2025-12-22 16:52:23,588 - dq_rules - INFO - THRESHOLD RULES SETUP
2025-12-22 16:52:23,589 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary']
2025-12-22 16:52:23,589 - dq_rules - INFO - Using default create_threshold: n
2025-12-22 16:52:23,591 - dq_rules - INFO - PATTERN RULES SETUP
2025-12-22 16:52:23,591 - dq_rules - INFO - Available string columns: ['CustomerName', 'Email', 'JoinDate', 'PostalCode', 'City', 'State']
2025-12-22 16:52:23,592 - dq_rules - INFO - Using default create_pattern: n
2025-12-22 16:52:23,592 - dq_rules - INFO - RANGE RULES SETUP
2025-12-22 16:52:23,592 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary']
2025-12-22 16:52:23,593 - dq_rules - INFO - Using default create_range: n
2025-12-22 16:52:23,593 - dq_rules - INFO - NULL CHECK RULES SETUP
2025-12-22 16:52:23,593 - dq_rules - INFO - Using default create_null_checks: y
2025-12-22 16:52:23,593 - dq_rules - INFO - Checking for columns with null values...
2025-12-22 16:52:23,594 - dq_rules - INFO - Found 1 null values in 'CustomerName'
2025-12-22 16:52:23,594 - dq_rules - INFO - Created null check rule for CustomerName
2025-12-22 16:52:23,594 - dq_rules - INFO - Found 1 null values in 'Email'
2025-12-22 16:52:23,594 - dq_rules - INFO - Created null check rule for Email
2025-12-22 16:52:23,595 - dq_rules - INFO - Found 2 null values in 'Salary'
2025-12-22 16:52:23,597 - dq_rules - INFO - Created null check rule for Salary
2025-12-22 16:52:23,598 - dq_rules - INFO - Found 1 null values in 'Department'
2025-12-22 16:52:23,598 - dq_rules - INFO - Created null check rule for Department
2025-12-22 16:52:23,598 - dq_rules - INFO - Found 1 null values in 'State'
2025-12-22 16:52:23,599 - dq_rules - INFO - Created null check rule for State
2025-12-22 16:52:23,599 - dq_rules - INFO - KPI THRESHOLD RULES SETUP
2025-12-22 16:52:23,600 - dq_rules - INFO - Using default create_kpi: n
2025-12-22 16:52:23,600 - dq_rules - INFO - Created comprehensive rule set with 5 rules
2025-12-22 16:52:23,600 - dq_rules - INFO - Defined 5 business rules
2025-12-22 16:52:23,600 - dq_rules - INFO - EXECUTING 5 BUSINESS RULES
2025-12-22 16:52:23,602 - dq_rules - INFO - Executing rule: CustomerName should have no null values (currently 1 nulls)
2025-12-22 16:52:23,602 - dq_rules - INFO - Executing threshold rule: CustomerName should have no null values (currently 1 nulls)
2025-12-22 16:52:23,602 - dq_rules - INFO - Threshold rule 'CustomerName should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:23,603 - dq_rules - INFO - No violations found
2025-12-22 16:52:23,604 - dq_rules - INFO - Rule 'CustomerName should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:23,604 - dq_rules - INFO - Executing rule: Email should have no null values (currently 1 nulls)
2025-12-22 16:52:23,604 - dq_rules - INFO - Executing threshold rule: Email should have no null values (currently 1 nulls)
2025-12-22 16:52:23,605 - dq_rules - INFO - Threshold rule 'Email should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:23,606 - dq_rules - INFO - No violations found
2025-12-22 16:52:23,607 - dq_rules - INFO - Rule 'Email should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:23,608 - dq_rules - INFO - Executing rule: Salary should have no null values (currently 2 nulls)
2025-12-22 16:52:23,608 - dq_rules - INFO - Executing threshold rule: Salary should have no null values (currently 2 nulls)
2025-12-22 16:52:23,609 - dq_rules - INFO - Threshold rule 'Salary should have no null values (currently 2 nulls)': 0 violations found
2025-12-22 16:52:23,609 - dq_rules - INFO - No violations found
2025-12-22 16:52:23,610 - dq_rules - INFO - Rule 'Salary should have no null values (currently 2 nulls)' completed with status: PASS
2025-12-22 16:52:23,613 - dq_rules - INFO - Executing rule: Department should have no null values (currently 1 nulls)
2025-12-22 16:52:23,613 - dq_rules - INFO - Executing threshold rule: Department should have no null values (currently 1 nulls)
2025-12-22 16:52:23,614 - dq_rules - INFO - Threshold rule 'Department should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:23,614 - dq_rules - INFO - No violations found
2025-12-22 16:52:23,615 - dq_rules - INFO - Rule 'Department should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:23,615 - dq_rules - INFO - Executing rule: State should have no null values (currently 1 nulls)
2025-12-22 16:52:23,615 - dq_rules - INFO - Executing threshold rule: State should have no null values (currently 1 nulls)
2025-12-22 16:52:23,616 - dq_rules - INFO - Threshold rule 'State should have no null values (currently 1 nulls)': 0 violations found
2025-12-22 16:52:23,616 - dq_rules - INFO - No violations found
2025-12-22 16:52:23,617 - dq_rules - INFO - Rule 'State should have no null values (currently 1 nulls)' completed with status: PASS
2025-12-22 16:52:23,617 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 0
2025-12-22 16:52:23,618 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 16:52:23,618 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:23,628 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 16:52:23,644 - dq_audit - INFO - Inserted rules record with ID: 223
2025-12-22 16:52:23,644 - dq_audit - INFO - Inserted rules record with ID: 223
2025-12-22 16:52:23,647 - dq_rules - INFO - Audit record logged with ID: 223
2025-12-22 16:52:23,648 - dq_rules - INFO - Returning JSON report for API, Session: RULES_20251222_165223
2025-12-22 16:52:23,674 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:23,699 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:23,750 - root - INFO - Completed business rules validation for session RULES_20251222_165223_d52570f8
2025-12-22 16:52:23,750 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 16:52:23] "POST /api/rules HTTP/1.1" 200 -
2025-12-22 16:52:26,813 - root - INFO - Business rules request received: dict_keys(['source_type', 'file_path', 'rule_type', 'threshold_column', 'threshold_operator', 'threshold_value', 'run_text_comparison', 'actual_column', 'expected_column'])
2025-12-22 16:52:26,814 - root - INFO - Starting business rules validation for session RULES_20251222_165226_f013014a
2025-12-22 16:52:26,814 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2025-12-22 16:52:26,814 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2025-12-22 16:52:26,814 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:26,814 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type', 'run_text_comparison', 'actual_column', 'expected_column']
2025-12-22 16:52:26,814 - dq_rules - INFO - File path in UI data: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:26,814 - dq_rules - INFO - ===============================
2025-12-22 16:52:26,814 - dq_unified - INFO - PROMPTING USER FOR DATA SOURCE TYPE
2025-12-22 16:52:26,814 - dq_unified - INFO - User selected source type: 1
2025-12-22 16:52:26,814 - dq_rules - INFO - Source type: csv, Source config: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:26,814 - dq_unified - INFO - LOADING DATA FROM CSV
2025-12-22 16:52:26,817 - dq_unified - INFO - Loading large CSV: C:\Users\003160\OneDrive - wisseninfotech.com\Documents\DQ-Checks-Shashi\Test_data\sample_data.csv
2025-12-22 16:52:26,819 - dq_unified - INFO - CSV file has 15 rows
2025-12-22 16:52:26,820 - dq_unified - INFO - Loading 15 rows from CSV...
2025-12-22 16:52:26,824 - dq_unified - INFO - Loaded 15 rows from CSV
2025-12-22 16:52:26,828 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2025-12-22 16:52:26,828 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 108.2MB total, 0.0MB for dataframe
2025-12-22 16:52:26,829 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2025-12-22 16:52:26,830 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 16:52:26,830 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2025-12-22 16:52:26,830 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2025-12-22 16:52:26,831 - dq_rules - INFO - User selected rule type: 1
2025-12-22 16:52:26,831 - dq_rules - INFO - CREATING THRESHOLD RULE
2025-12-22 16:52:26,831 - dq_rules - INFO - === DEBUG create_threshold_rule ===
2025-12-22 16:52:26,831 - dq_rules - INFO - UI data type: <class 'dict'>
2025-12-22 16:52:26,831 - dq_rules - INFO - UI data keys: ['analysis_type', 'source_type', 'file_path', 'rule_type', 'run_text_comparison', 'actual_column', 'expected_column']
2025-12-22 16:52:26,831 - dq_rules - INFO -   threshold_column: NOT FOUND
2025-12-22 16:52:26,831 - dq_rules - INFO -   pattern_column: NOT FOUND
2025-12-22 16:52:26,831 - dq_rules - INFO -   range_column: NOT FOUND
2025-12-22 16:52:26,831 - dq_rules - INFO -   kpi_threshold_value: NOT FOUND
2025-12-22 16:52:26,831 - dq_rules - INFO -   pattern_columns: NOT FOUND
2025-12-22 16:52:26,831 - dq_rules - INFO -   rule_type: 1
2025-12-22 16:52:26,831 - dq_rules - INFO - ===================
2025-12-22 16:52:26,832 - dq_rules - INFO - Auto-selected first numeric column: Phone
2025-12-22 16:52:26,832 - dq_rules - INFO - Using default operator: >
2025-12-22 16:52:26,832 - dq_rules - INFO - Using default threshold value: 0
2025-12-22 16:52:26,832 - dq_rules - INFO - Threshold rule created: Phone > 0
2025-12-22 16:52:26,832 - dq_rules - INFO - Defined 1 business rules
2025-12-22 16:52:26,832 - dq_rules - INFO - EXECUTING 1 BUSINESS RULES
2025-12-22 16:52:26,834 - dq_rules - INFO - Executing rule: Phone > 0
2025-12-22 16:52:26,834 - dq_rules - INFO - Executing threshold rule: Phone > 0
2025-12-22 16:52:26,834 - dq_rules - INFO - Threshold rule 'Phone > 0': 15 violations found
2025-12-22 16:52:26,851 - dq_error_log - INFO - Batch logged 15 errors for session RULES_20251222_165226
2025-12-22 16:52:26,851 - dq_rules - WARNING - 15 violations found
2025-12-22 16:52:26,855 - dq_rules - INFO - Rule 'Phone > 0' completed with status: FAIL
2025-12-22 16:52:26,855 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 15
2025-12-22 16:52:26,855 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2025-12-22 16:52:26,855 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:26,867 - dq_audit - INFO - Starting database insertion for rules...
2025-12-22 16:52:26,881 - dq_audit - INFO - Inserted rules record with ID: 224
2025-12-22 16:52:26,881 - dq_audit - INFO - Inserted rules record with ID: 224
2025-12-22 16:52:26,884 - dq_rules - INFO - Audit record logged with ID: 224
2025-12-22 16:52:26,884 - dq_rules - INFO - Returning JSON report for API, Session: RULES_20251222_165226
2025-12-22 16:52:26,907 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:26,934 - dq_rules - INFO - RUNNING SEPARATE TEXT COMPARISON
2025-12-22 16:52:26,935 - dq_rules - INFO - DATA SUMMARY: Actual column: 'CustomerName', Expected column: 'Email', Total rows: 15
2025-12-22 16:52:26,939 - dq_rules - INFO - Executing row-by-row text comparison: Text comparison: 'CustomerName' contains 'Email' (row-by-row)
2025-12-22 16:52:26,939 - dq_rules - INFO - COMPARISON DETAILS: Actual column: 'CustomerName', Expected column: 'Email', Total rows to check: 15
2025-12-22 16:52:27,092 - dq_rules - WARNING - 13 text comparison violations found
2025-12-22 16:52:27,093 - dq_rules - INFO - SUMMARY STATISTICS: Total rows checked: 15, Valid comparisons: 13, Skipped (null/empty): 2, Violations: 13, Success rate: 0.0%
2025-12-22 16:52:27,093 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 16:52:27,141 - root - INFO - Completed business rules validation for session RULES_20251222_165226_f013014a
2025-12-22 16:52:27,142 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 16:52:27] "POST /api/rules HTTP/1.1" 200 -
2025-12-22 17:14:37,720 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 17:14:37] "GET /api/health HTTP/1.1" 200 -
2025-12-22 17:14:39,770 - root - INFO - Comparison analysis request received: dict_keys(['source_type', 'source_file_path', 'target_source_type', 'target_file_path', 'selected_columns'])
2025-12-22 17:14:39,774 - root - INFO - Starting comparison for session CMP_20251222_171439
2025-12-22 17:14:39,774 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2025-12-22 17:14:39,785 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2025-12-22 17:14:39,785 - dq_comparison - INFO - Found 10 common columns between source and target (case-insensitive)
2025-12-22 17:14:39,785 - dq_comparison - INFO - User column selection input: all
2025-12-22 17:14:39,785 - dq_comparison - INFO - User selected ALL common columns for comparison
2025-12-22 17:14:39,785 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2025-12-22 17:14:39,785 - dq_comparison - INFO - Report details - Source: CSV: sample_data.csv, Target: CSV: sample_data.csv, Selected columns: 10
2025-12-22 17:14:39,785 - dq_comparison - INFO - Initializing Error Logger...
2025-12-22 17:14:39,785 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2025-12-22 17:14:39,807 - dq_error_log - INFO - Database connection successful
2025-12-22 17:14:39,807 - dq_comparison - INFO - Session ID: CMP_20251222_171439
2025-12-22 17:14:39,808 - dq_comparison - INFO - FIRST CHECK: ROW COUNT COMPARISON
2025-12-22 17:14:39,808 - dq_comparison - INFO - Source rows: 15, Target rows: 15
2025-12-22 17:14:39,808 - dq_comparison - INFO - ‚úÖ Row counts match perfectly
2025-12-22 17:14:39,808 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2025-12-22 17:14:39,809 - dq_comparison - INFO - Using 10 common columns for hash comparison
2025-12-22 17:14:39,809 - dq_comparison - INFO - Source columns: ['Salary', 'JoinDate', 'PostalCode', 'City', 'Country', 'State', 'Department', 'Phone', 'Email', 'CustomerName']
2025-12-22 17:14:39,809 - dq_comparison - INFO - Target columns: ['Salary', 'JoinDate', 'PostalCode', 'City', 'Country', 'State', 'Department', 'Phone', 'Email', 'CustomerName']
2025-12-22 17:14:39,809 - dq_comparison - INFO - Generating hashes for source data...
2025-12-22 17:14:39,816 - dq_comparison - INFO - Generating hashes for target data...
2025-12-22 17:14:39,819 - dq_comparison - INFO - Hash-based Comparison Results:
2025-12-22 17:14:39,820 - dq_comparison - INFO -   ‚Ä¢ Common rows: 14
2025-12-22 17:14:39,820 - dq_comparison - INFO -   ‚Ä¢ Rows only in source: 0
2025-12-22 17:14:39,820 - dq_comparison - INFO -   ‚Ä¢ Rows only in target: 0
2025-12-22 17:14:39,820 - dq_comparison - INFO - ‚ÑπÔ∏è  No row-level errors to log (all rows matched by hash)
2025-12-22 17:14:39,820 - dq_comparison - INFO - PERFORMING DETAILED COLUMN-BY-COLUMN COMPARISON...
2025-12-22 17:14:39,820 - dq_comparison - INFO - Will compare 15 rows (min of source:15 and target:15)
2025-12-22 17:14:39,829 - dq_comparison - INFO - Found 0 column value mismatches across all rows
2025-12-22 17:14:39,830 - dq_comparison - INFO - Analyzing data quality metrics...
2025-12-22 17:14:39,847 - dq_comparison - INFO - Null values - Source: 6 (4.00%), Target: 6 (4.00%)
2025-12-22 17:14:39,852 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 1, Target: 1
2025-12-22 17:14:39,853 - dq_comparison - INFO - Source duplicate samples: ['Row 2', 'Row 7']
2025-12-22 17:14:39,854 - dq_comparison - INFO - Target duplicate samples: ['Row 2', 'Row 7']
2025-12-22 17:14:39,867 - dq_error_log - INFO - Retrieved 0 errors for session CMP_20251222_171439
2025-12-22 17:14:39,876 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 17:14:39,898 - dq_audit - INFO - Starting database insertion for comparison...
2025-12-22 17:14:39,921 - dq_audit - INFO - Inserted comparison record with ID: 225
2025-12-22 17:14:39,921 - dq_audit - INFO - Inserted comparison record with ID: 225
2025-12-22 17:14:39,968 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 17:14:40,040 - dq_comparison - INFO - Comparison analysis completed successfully
2025-12-22 17:14:40,040 - dq_audit - INFO - Audit class initialized with database: dq_checks
2025-12-22 17:14:40,125 - root - INFO - Completed comparison for session CMP_20251222_171439
2025-12-22 17:14:40,127 - werkzeug - INFO - 127.0.0.1 - - [22/Dec/2025 17:14:40] "POST /api/compare HTTP/1.1" 200 -
