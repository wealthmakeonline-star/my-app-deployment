2026-01-17 23:17:33,233 - __main__ - INFO - üåê API Server Logging Initialized
2026-01-17 23:17:33,235 - __main__ - INFO - üìù Logs saved to: logs/dq_api_20260117_231733.log
2026-01-17 23:17:33,293 - dq_rules - WARNING - Could not load config from database: name 'get_db_connection' is not defined
2026-01-17 23:17:33,297 - __main__ - INFO - APP_SETTINGS loaded. Audit enabled: True
2026-01-17 23:17:33,298 - __main__ - INFO - ‚úÖ All DQ modules loaded successfully
2026-01-17 23:17:33,302 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-01-17 23:17:33,303 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-17 23:17:33,305 - __main__ - INFO - ‚úÖ ErrorLogger and DataQualityAudit initialized
2026-01-17 23:17:33,327 - __main__ - INFO - üöÄ Starting Data Quality Framework API
2026-01-17 23:17:33,328 - __main__ - INFO - üìä Modules available: True
2026-01-17 23:17:33,329 - __main__ - INFO - üîß Config file mode: False
2026-01-17 23:17:33,330 - __main__ - INFO - üìã Available endpoints:
2026-01-17 23:17:33,330 - __main__ - INFO -   GET  /              - API status
2026-01-17 23:17:33,331 - __main__ - INFO -   GET  /api/health    - Health check
2026-01-17 23:17:33,332 - __main__ - INFO -   POST /api/check-single - Single source analysis
2026-01-17 23:17:33,333 - __main__ - INFO -   POST /api/compare   - Source-target comparison
2026-01-17 23:17:33,333 - __main__ - INFO -   GET  /api/compare/{id} - Get comparison results
2026-01-17 23:17:33,334 - __main__ - INFO -   GET  /api/compare/{id}/mismatches - Paginated mismatches
2026-01-17 23:17:33,334 - __main__ - INFO -   GET  /api/compare/{id}/rows/source_only - Source-only rows
2026-01-17 23:17:33,336 - __main__ - INFO -   GET  /api/compare/{id}/rows/target_only - Target-only rows
2026-01-17 23:17:33,336 - __main__ - INFO -   GET  /api/compare/{id}/rows/count - Row counts
2026-01-17 23:17:33,337 - __main__ - INFO -   POST /api/upload    - File upload
2026-01-17 23:17:33,338 - __main__ - INFO -   GET  /api/sessions  - List sessions
2026-01-17 23:17:33,339 - __main__ - INFO -   GET  /api/sessions/<id> - Get session data
2026-01-17 23:17:33,340 - __main__ - INFO -   GET  /api/debug-db  - Database debug
2026-01-17 23:17:33,340 - __main__ - INFO - üåç Server starting on 0.0.0.0:5000 (debug=False)
2026-01-17 23:18:54,020 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-17 23:18:54,021 - __main__ - INFO - Getting database hierarchy for mysql
2026-01-17 23:18:54,022 - __main__ - INFO - Database: Not provided
2026-01-17 23:18:54,023 - __main__ - INFO - Schema: Not provided
2026-01-17 23:18:54,024 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-17 23:18:54,025 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-01-17 23:18:54,025 - database_navigator - INFO - Connecting to MYSQL...
2026-01-17 23:18:54,138 - database_navigator - INFO - Successfully connected to MYSQL!
2026-01-17 23:18:54,139 - __main__ - INFO - Getting databases list...
2026-01-17 23:18:54,140 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-01-17 23:18:54,144 - database_navigator - INFO - Found 13 databases
2026-01-17 23:18:54,145 - __main__ - INFO - Found 13 databases
2026-01-17 23:18:54,146 - __main__ - INFO - Completed with status 200 in 0.125s
2026-01-17 23:18:57,121 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-17 23:18:57,123 - __main__ - INFO - Getting database hierarchy for mysql
2026-01-17 23:18:57,125 - __main__ - INFO - Database: dq_checks
2026-01-17 23:18:57,126 - __main__ - INFO - Schema: Not provided
2026-01-17 23:18:57,128 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-17 23:18:57,130 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-01-17 23:18:57,131 - database_navigator - INFO - Connecting to MYSQL...
2026-01-17 23:18:57,142 - database_navigator - INFO - Successfully connected to MYSQL!
2026-01-17 23:18:57,143 - __main__ - INFO - Getting schemas for database: dq_checks
2026-01-17 23:18:57,144 - database_navigator - INFO - Found 1 schemas
2026-01-17 23:18:57,145 - __main__ - INFO - Found 1 schemas
2026-01-17 23:18:57,148 - __main__ - INFO - Completed with status 200 in 0.026s
2026-01-17 23:18:59,585 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-17 23:18:59,586 - __main__ - INFO - Getting database hierarchy for mysql
2026-01-17 23:18:59,588 - __main__ - INFO - Database: dq_checks
2026-01-17 23:18:59,589 - __main__ - INFO - Schema: dq_checks
2026-01-17 23:18:59,590 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-17 23:18:59,591 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-01-17 23:18:59,592 - database_navigator - INFO - Connecting to MYSQL...
2026-01-17 23:18:59,602 - database_navigator - INFO - Successfully connected to MYSQL!
2026-01-17 23:18:59,603 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-01-17 23:18:59,608 - database_navigator - INFO - Found 18 tables in schema 'dq_checks'
2026-01-17 23:18:59,608 - __main__ - INFO - Found 18 tables
2026-01-17 23:18:59,610 - __main__ - INFO - Completed with status 200 in 0.024s
2026-01-17 23:19:04,491 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-17 23:19:04,491 - __main__ - INFO - Getting database hierarchy for postgresql
2026-01-17 23:19:04,493 - __main__ - INFO - Database: Not provided
2026-01-17 23:19:04,495 - __main__ - INFO - Schema: Not provided
2026-01-17 23:19:04,497 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-17 23:19:04,498 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-01-17 23:19:04,499 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-17 23:19:04,500 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-17 23:19:04,501 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-01-17 23:19:04,619 - database_navigator - INFO - Connection object created: <connection object at 0x000001C1915B6CE0; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-01-17 23:19:04,620 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-01-17 23:19:04,622 - __main__ - INFO - Getting databases list...
2026-01-17 23:19:04,624 - database_navigator - INFO - get_databases() called. db_type: postgresql, connection exists: True
2026-01-17 23:19:04,631 - database_navigator - INFO - Raw rows: [('dq_checks',), ('finewise-testdb',), ('postgres',)]
2026-01-17 23:19:04,632 - database_navigator - INFO - Found 3 databases
2026-01-17 23:19:04,633 - __main__ - INFO - Found 3 databases
2026-01-17 23:19:04,634 - __main__ - INFO - Completed with status 200 in 0.143s
2026-01-17 23:19:07,822 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-17 23:19:07,822 - __main__ - INFO - Getting database hierarchy for postgresql
2026-01-17 23:19:07,824 - __main__ - INFO - Database: dq_checks
2026-01-17 23:19:07,826 - __main__ - INFO - Schema: Not provided
2026-01-17 23:19:07,827 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-17 23:19:07,828 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-01-17 23:19:07,829 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-17 23:19:07,831 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-17 23:19:07,832 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-01-17 23:19:07,962 - database_navigator - INFO - Connection object created: <connection object at 0x000001C1915B6CE0; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-01-17 23:19:07,963 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-01-17 23:19:07,964 - __main__ - INFO - Getting schemas for database: dq_checks
2026-01-17 23:19:07,966 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-01-17 23:19:07,967 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-17 23:19:07,968 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-17 23:19:07,969 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-01-17 23:19:08,086 - database_navigator - INFO - Connection object created: <connection object at 0x000001C1915B7560; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-01-17 23:19:08,087 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-01-17 23:19:08,101 - database_navigator - INFO - Found 4 schemas
2026-01-17 23:19:08,102 - __main__ - INFO - Found 4 schemas
2026-01-17 23:19:08,103 - __main__ - INFO - Completed with status 200 in 0.281s
2026-01-17 23:19:09,618 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-01-17 23:19:09,619 - __main__ - INFO - Getting database hierarchy for postgresql
2026-01-17 23:19:09,620 - __main__ - INFO - Database: dq_checks
2026-01-17 23:19:09,621 - __main__ - INFO - Schema: public
2026-01-17 23:19:09,623 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-17 23:19:09,624 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-01-17 23:19:09,625 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-17 23:19:09,626 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-17 23:19:09,626 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-01-17 23:19:09,732 - database_navigator - INFO - Connection object created: <connection object at 0x000001C1915B7560; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-01-17 23:19:09,734 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-01-17 23:19:09,735 - __main__ - INFO - Getting tables for database: dq_checks, schema: public
2026-01-17 23:19:09,737 - database_navigator - INFO - Ensuring connection to database: dq_checks for table list
2026-01-17 23:19:09,739 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-01-17 23:19:09,740 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-01-17 23:19:09,741 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-17 23:19:09,742 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-01-17 23:19:09,857 - database_navigator - INFO - Connection object created: <connection object at 0x000001C1915B7780; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-01-17 23:19:09,858 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-01-17 23:19:09,859 - database_navigator - INFO - Connected to database: dq_checks, schema: public
2026-01-17 23:19:09,887 - database_navigator - INFO - Found 5 tables in dq_checks.public: ['comparison_small_target13', 'customers', 'customers_bkp', 'employee', 'stg_transactions']
2026-01-17 23:19:09,887 - database_navigator - INFO - Found 5 tables in schema 'public'
2026-01-17 23:19:09,888 - __main__ - INFO - Found 5 tables
2026-01-17 23:19:09,889 - __main__ - INFO - Completed with status 200 in 0.271s
2026-01-17 23:19:14,705 - __main__ - INFO - POST /api/compare - Request started
2026-01-17 23:19:14,706 - __main__ - INFO - Comparison request - Source: database, Target: database
2026-01-17 23:19:14,708 - __main__ - INFO - Comparison analysis request received
2026-01-17 23:19:14,710 - __main__ - INFO - DEBUG source_data from flat: {'source_type': 'database', 'dbType': 'MySQL', 'host': 'localhost', 'port': '3306', 'database': 'dq_checks', 'schema': 'dq_checks', 'table': 'comparison_small_source15', 'user': 'root', 'password': 'root', 'serviceName': '', 'db_type': 'mysql', 'target_source_type': 'database', 'target_db_type': 'postgresql', 'target_host': 'localhost', 'target_port': 5432, 'target_database': 'dq_checks', 'target_table': 'comparison_small_target13', 'target_user': 'postgres', 'target_password': 'postgres', 'target_schema': 'public', 'selected_columns': 'all'}
2026-01-17 23:19:14,710 - __main__ - INFO - Starting comparison for session CMP_20260117_231914
2026-01-17 23:19:14,711 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-01-17 23:19:14,712 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-01-17 23:19:14,713 - dq_comparison - INFO - 
==================================================
2026-01-17 23:19:14,714 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-01-17 23:19:14,714 - dq_comparison - INFO - ==================================================
2026-01-17 23:19:14,715 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-01-17 23:19:14,716 - dq_comparison - INFO - ----------------------------------------
2026-01-17 23:19:14,716 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-01-17 23:19:14,717 - dq_unified - INFO - Loading data from DATABASE
2026-01-17 23:19:14,717 - dq_unified - INFO - Loading large database table: comparison_small_source15
2026-01-17 23:19:14,718 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-01-17 23:19:14,728 - dq_unified - INFO - MySQL table comparison_small_source15 has 15 rows
2026-01-17 23:19:14,730 - dq_unified - INFO - Loading 15 rows from MySQL...
2026-01-17 23:19:15,166 - dq_unified - INFO - Loaded 15 rows from MySQL
2026-01-17 23:19:15,177 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-01-17 23:19:15,178 - dq_unified - INFO - Loaded 15 rows, 16 columns. Memory: 126.0MB total, 0.0MB for dataframe
2026-01-17 23:19:15,178 - dq_comparison - INFO - SOURCE database loaded: 15 rows, 16 columns
2026-01-17 23:19:15,179 - dq_comparison - INFO - 
==================================================
2026-01-17 23:19:15,179 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-01-17 23:19:15,180 - dq_comparison - INFO - ==================================================
2026-01-17 23:19:15,181 - dq_comparison - INFO - 
üóÑÔ∏è TARGET DATABASE CONFIGURATION
2026-01-17 23:19:15,181 - dq_comparison - INFO - ----------------------------------------
2026-01-17 23:19:15,182 - dq_comparison - INFO - UI mode: Using provided database configuration for TARGET
2026-01-17 23:19:15,183 - dq_unified - INFO - Loading data from DATABASE
2026-01-17 23:19:15,183 - dq_unified - INFO - Loading large database table: comparison_small_target13
2026-01-17 23:19:15,183 - dq_unified - INFO - Normalized DB config with schema: public
2026-01-17 23:19:15,309 - dq_unified - INFO - PostgreSQL table public.comparison_small_target13 has 13 rows
2026-01-17 23:19:15,309 - dq_unified - INFO - Loading 13 rows from PostgreSQL...
2026-01-17 23:19:15,313 - dq_unified - INFO - Loaded 13 rows from PostgreSQL
2026-01-17 23:19:15,320 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-01-17 23:19:15,321 - dq_unified - INFO - Loaded 13 rows, 16 columns. Memory: 126.2MB total, 0.0MB for dataframe
2026-01-17 23:19:15,322 - dq_comparison - INFO - TARGET database loaded: 13 rows, 16 columns
2026-01-17 23:19:15,323 - dq_comparison - INFO - Source data loaded: 15 rows, 16 columns
2026-01-17 23:19:15,323 - dq_comparison - INFO - Target data loaded: 13 rows, 16 columns
2026-01-17 23:19:15,324 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-01-17 23:19:15,324 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-01-17 23:19:15,325 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-01-17 23:19:15,325 - dq_comparison - INFO - Common columns lowercased: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date', 'transaction_type', 'currency', 'amount', 'balance_after', 'status', 'merchant_name', 'merchant_category', 'country', 'reference_code', 'created_at', 'updated_at']
2026-01-17 23:19:15,326 - dq_comparison - INFO - Found 16 common columns between source and target (case-insensitive)
2026-01-17 23:19:15,326 - dq_comparison - INFO - User column selection input: all
2026-01-17 23:19:15,328 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-01-17 23:19:15,328 - dq_comparison - INFO - Selected 16 columns for comparison: ['transaction_id', 'account_id', 'customer_id', 'transaction_date', 'posting_date']...
2026-01-17 23:19:15,329 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-01-17 23:19:15,329 - dq_comparison - INFO - Report details - Source: Database: mysql - dq_checks.comparison_small_source15, Target: Database: postgresql - dq_checks.comparison_small_target13, Selected columns: 16
2026-01-17 23:19:15,329 - dq_comparison - INFO - Initializing Error Logger...
2026-01-17 23:19:15,330 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-01-17 23:19:15,343 - dq_error_log - INFO - Database connection successful
2026-01-17 23:19:15,344 - dq_comparison - INFO - Session ID: CMP_20260117_231915
2026-01-17 23:19:15,345 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-01-17 23:19:15,345 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-01-17 23:19:15,346 - dq_comparison - INFO - Comparing column structures...
2026-01-17 23:19:15,347 - dq_comparison - WARNING - Found 2 incompatible data type mismatches
2026-01-17 23:19:15,348 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-01-17 23:19:15,348 - dq_comparison - INFO - Validating primary key/unique fields...
2026-01-17 23:19:15,349 - dq_comparison - INFO - Checking key fields: ['transaction_id', 'customer_id', 'reference_code']
2026-01-17 23:19:15,352 - dq_comparison - WARNING - Field 'customer_id' has duplicates in source: 15 rows
2026-01-17 23:19:15,353 - dq_comparison - WARNING - Field 'customer_id' has duplicates in target: 13 rows
2026-01-17 23:19:15,355 - dq_comparison - INFO - Primary key validation complete. Passed: False
2026-01-17 23:19:15,385 - dq_comparison - INFO - Comparing table-level metadata...
2026-01-17 23:19:15,402 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-01-17 23:19:15,416 - dq_comparison - INFO - üß† SMART COMPARISON WITH AUTO-DETECTED STRATEGY
2026-01-17 23:19:15,419 - dq_comparison - INFO - Detected comparison strategy: key_based
2026-01-17 23:19:15,420 - dq_comparison - INFO - Strategy details: {'key_columns': ['transaction_id', 'reference_code']}
2026-01-17 23:19:15,424 - dq_comparison - INFO - Matched 13 row pairs
2026-01-17 23:19:15,425 - dq_comparison - INFO - Source-only rows: 2
2026-01-17 23:19:15,425 - dq_comparison - INFO - Target-only rows: 0
2026-01-17 23:19:15,432 - dq_comparison - INFO - 
üéØ SMART COMPARISON RESULTS (key_based):
2026-01-17 23:19:15,432 - dq_comparison - INFO -    Strategy: Match rows using key column(s): ['transaction_id', 'reference_code']
2026-01-17 23:19:15,433 - dq_comparison - INFO -    Total source rows: 15
2026-01-17 23:19:15,433 - dq_comparison - INFO -    Total target rows: 13
2026-01-17 23:19:15,434 - dq_comparison - INFO -    Matched row pairs: 13
2026-01-17 23:19:15,435 - dq_comparison - INFO -    Perfect matches: 11
2026-01-17 23:19:15,435 - dq_comparison - INFO -    Value mismatches: 2
2026-01-17 23:19:15,436 - dq_comparison - INFO -    Source-only rows: 2
2026-01-17 23:19:15,436 - dq_comparison - INFO -    Target-only rows: 0
2026-01-17 23:19:15,437 - dq_comparison - INFO -    Match percentage: 73.33%
2026-01-17 23:19:15,437 - dq_comparison - INFO -    Assessment: FAIR
2026-01-17 23:19:15,438 - dq_comparison - INFO - New structure: 2 detailed mismatches
2026-01-17 23:19:15,439 - dq_comparison - INFO - Analyzing data quality metrics...
2026-01-17 23:19:15,452 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-01-17 23:19:15,455 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-01-17 23:19:15,466 - dq_error_log - INFO - Retrieved 3 error logs for session CMP_20260117_231915
2026-01-17 23:19:15,467 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-01-17 23:19:15,467 - dq_comparison - INFO -   Source rows: 15
2026-01-17 23:19:15,468 - dq_comparison - INFO -   Common rows (matched): 11
2026-01-17 23:19:15,469 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-01-17 23:19:15,470 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-01-17 23:19:15,470 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-01-17 23:19:15,472 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-01-17 23:19:15,474 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-17 23:19:15,475 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260117_231915
2026-01-17 23:19:15,475 - dq_audit - INFO - Starting database insertion for comparison...
2026-01-17 23:19:15,492 - dq_audit - INFO - Inserted comparison record with ID: 775
2026-01-17 23:19:15,492 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 775)
2026-01-17 23:19:15,503 - dq_error_log - INFO - Retrieved 3 error logs for session CMP_20260117_231915
2026-01-17 23:19:15,514 - dq_error_log - INFO - Retrieved summary: 3 total errors for session CMP_20260117_231915
2026-01-17 23:19:15,514 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-17 23:19:15,528 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260117_231915
2026-01-17 23:19:15,528 - dq_comparison - INFO - 
üîç Final results verification:
2026-01-17 23:19:15,529 - dq_comparison - INFO -    Session ID: CMP_20260117_231915
2026-01-17 23:19:15,529 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-01-17 23:19:15,530 - dq_comparison - INFO -    Source rows: 15
2026-01-17 23:19:15,530 - dq_comparison - INFO -    Matched rows: 11
2026-01-17 23:19:15,530 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-01-17 23:19:15,531 - dq_comparison - INFO - Comparison analysis completed successfully
2026-01-17 23:19:15,544 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260117_231915
2026-01-17 23:19:15,557 - dq_error_log - INFO - Retrieved 3 error logs for session CMP_20260117_231915
2026-01-17 23:19:15,569 - dq_error_log - INFO - Retrieved summary: 3 total errors for session CMP_20260117_231915
2026-01-17 23:19:15,570 - __main__ - INFO - Comparison completed for session CMP_20260117_231914
2026-01-17 23:19:15,574 - __main__ - INFO - Completed with status 200 in 0.869s
