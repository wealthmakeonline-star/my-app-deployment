2026-01-11 15:38:22,337 - root - INFO - CLI Mode Logging Initialized
2026-01-11 15:38:22,338 - root - INFO - CLI logs will be saved to: logs/dq_framework_20260111_153822.log
2026-01-11 15:38:22,338 - __main__ - INFO - ðŸš€ UNIVERSAL DATA QUALITY FRAMEWORK INITIALIZED
2026-01-11 15:38:22,339 - __main__ - INFO - Starting system resource check
2026-01-11 15:38:22,343 - __main__ - INFO - Total RAM: 15.7 GB
2026-01-11 15:38:22,344 - __main__ - INFO - Available RAM: 3.4 GB
2026-01-11 15:38:22,344 - __main__ - INFO - Memory used: 78.4%
2026-01-11 15:38:22,345 - __main__ - INFO - Memory status: OK
2026-01-11 15:38:22,346 - __main__ - INFO - Free disk space: 260.1 GB
2026-01-11 15:38:22,346 - __main__ - INFO - Disk used: 45.4%
2026-01-11 15:38:22,346 - __main__ - INFO - Disk space: OK
2026-01-11 15:38:22,847 - __main__ - INFO - CPU cores: 8
2026-01-11 15:38:22,847 - __main__ - INFO - CPU usage: 11.8%
2026-01-11 15:38:22,848 - __main__ - INFO - Python version: 3.12.4
2026-01-11 15:38:22,848 - __main__ - INFO - System platform: win32
2026-01-11 15:38:22,849 - __main__ - INFO - User session started at: 2026-01-11 15:38:22.849633
2026-01-11 15:38:22,849 - __main__ - INFO - Displaying main menu options to user
2026-01-11 15:38:24,079 - __main__ - INFO - User selected option: 4
2026-01-11 15:38:24,080 - __main__ - INFO - Starting Business Rules Engine module
2026-01-11 15:38:24,083 - dq_rules - INFO - STARTING BUSINESS RULES VALIDATION
2026-01-11 15:38:37,580 - dq_rules - INFO - Running quick test of dq_rules functionality
2026-01-11 15:38:37,593 - dq_rules - INFO - Column analysis completed for 6 columns
2026-01-11 15:38:37,594 - dq_rules - INFO - Generated 10 rule suggestions based on column analysis
2026-01-11 15:38:37,739 - dq_rules - INFO - Quick test completed: 5 passed, 0 failed
2026-01-11 15:38:50,335 - dq_rules - INFO - Starting complete DQ pipeline
2026-01-11 15:38:50,347 - dq_rules - WARNING - Could not create index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_session_check ON dq_error_logs(session_id, check_type)' at line 1
2026-01-11 15:38:50,347 - dq_rules - WARNING - Could not create index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_error_type ON dq_error_logs(error_type)' at line 1
2026-01-11 15:38:50,348 - dq_rules - WARNING - Could not create index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_timestamp ON dq_error_logs(check_timestamp)' at line 1
2026-01-11 15:38:50,349 - dq_rules - WARNING - Could not create index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_column_name ON dq_error_logs(column_name)' at line 1
2026-01-11 15:38:50,350 - dq_rules - WARNING - Could not create audit index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_audit_session ON dq_audit_log(session_id, check_type)' at line 1
2026-01-11 15:38:50,350 - dq_rules - WARNING - Could not create audit index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_audit_timestamp ON dq_audit_log(check_timestamp)' at line 1
2026-01-11 15:38:50,350 - dq_rules - WARNING - Could not create audit index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_audit_score ON dq_audit_log(overall_score)' at line 1
2026-01-11 15:38:50,350 - dq_rules - WARNING - Could not create rule index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_rule_active ON dq_rules_metadata(is_active, rule_type)' at line 1
2026-01-11 15:38:50,351 - dq_rules - WARNING - Could not create rule index: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_rule_category ON dq_rules_metadata(rule_category, is_active)' at line 1
2026-01-11 15:38:50,351 - dq_rules - INFO - Database optimization completed
2026-01-11 15:38:50,352 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2026-01-11 15:38:50,352 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2026-01-11 15:38:50,352 - dq_rules - INFO - UI data type: <class 'NoneType'>
2026-01-11 15:38:50,353 - dq_rules - INFO - ===============================
2026-01-11 15:38:50,353 - dq_rules - INFO - Prompting user for data source type for rules
2026-01-11 15:39:18,774 - dq_rules - INFO - User selected source type: 1
2026-01-11 15:39:44,999 - dq_rules - INFO - Source type: csv, Source config: C:/Users/003160/OneDrive - wisseninfotech.com/Documents/DQ-Checks-Shashi/Test_data/sample_data.csv
2026-01-11 15:39:45,000 - dq_unified - INFO - Loading data from CSV
2026-01-11 15:39:45,001 - dq_unified - INFO - Loading large CSV: C:/Users/003160/OneDrive - wisseninfotech.com/Documents/DQ-Checks-Shashi/Test_data/sample_data.csv
2026-01-11 15:39:45,005 - dq_unified - INFO - CSV file has 15 rows
2026-01-11 15:39:45,006 - dq_unified - INFO - Loading 15 rows from CSV...
2026-01-11 15:39:45,012 - dq_unified - INFO - Loaded 15 rows from CSV
2026-01-11 15:39:45,016 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-01-11 15:39:45,017 - dq_unified - INFO - Standardizing data types...
2026-01-11 15:39:45,019 - dq_unified - INFO - Data type standardization complete
2026-01-11 15:39:45,020 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 104.4MB total, 0.0MB for dataframe
2026-01-11 15:39:45,020 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2026-01-11 15:39:45,022 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-01-11 15:39:45,022 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2026-01-11 15:39:45,022 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2026-01-11 15:39:45,023 - dq_rules - INFO - Available columns: ['CustomerName', 'Email', 'Phone', 'Salary', 'Department', 'JoinDate', 'PostalCode', 'City', 'Country', 'State']
2026-01-11 15:39:51,337 - dq_rules - INFO - Loading rules from metadata database...
2026-01-11 15:39:51,367 - dq_rules - INFO - Loaded 0 rules from metadata
2026-01-11 15:40:01,439 - dq_rules - INFO - User selected rule type: 6
2026-01-11 15:40:01,440 - dq_rules - INFO - CREATING COMPREHENSIVE RULE SET
2026-01-11 15:40:01,445 - dq_rules - INFO - THRESHOLD RULES SETUP
2026-01-11 15:40:01,446 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary', 'PostalCode']
2026-01-11 15:40:33,125 - dq_rules - INFO - Creating threshold rule for: Phone
2026-01-11 15:40:33,126 - dq_rules - INFO - Current stats - Min: 1112222.00, Max: 9998887777.00, Median: 4445556666.00
2026-01-11 15:41:38,687 - dq_rules - INFO - Creating threshold rule for: Salary
2026-01-11 15:41:38,689 - dq_rules - INFO - Current stats - Min: 45000.00, Max: 70000.00, Median: 53000.00
2026-01-11 15:41:41,967 - dq_rules - INFO - Created: Salary should be above median value (53000.00)
2026-01-11 15:41:41,971 - dq_rules - INFO - PATTERN RULES SETUP
2026-01-11 15:41:41,971 - dq_rules - INFO - Available string columns: ['CustomerName', 'Email', 'JoinDate', 'City', 'State']
2026-01-11 15:42:01,417 - dq_rules - INFO - Created pattern rule for Email
2026-01-11 15:42:01,419 - dq_rules - INFO - RANGE RULES SETUP
2026-01-11 15:42:01,420 - dq_rules - INFO - Available numeric columns: ['Phone', 'Salary', 'PostalCode']
2026-01-11 15:42:06,865 - dq_rules - INFO - NULL CHECK RULES SETUP
2026-01-11 15:42:11,785 - dq_rules - INFO - Checking for columns with null values...
2026-01-11 15:42:11,786 - dq_rules - INFO - Found 1 null values in 'CustomerName'
2026-01-11 15:42:11,787 - dq_rules - INFO - Created null check rule for CustomerName
2026-01-11 15:42:11,788 - dq_rules - INFO - Found 1 null values in 'Email'
2026-01-11 15:42:11,788 - dq_rules - INFO - Created null check rule for Email
2026-01-11 15:42:11,789 - dq_rules - INFO - Found 2 null values in 'Salary'
2026-01-11 15:42:11,790 - dq_rules - INFO - Created null check rule for Salary
2026-01-11 15:42:11,790 - dq_rules - INFO - Found 1 null values in 'Department'
2026-01-11 15:42:11,791 - dq_rules - INFO - Created null check rule for Department
2026-01-11 15:42:11,792 - dq_rules - INFO - Found 1 null values in 'PostalCode'
2026-01-11 15:42:11,792 - dq_rules - INFO - Created null check rule for PostalCode
2026-01-11 15:42:11,794 - dq_rules - INFO - Found 1 null values in 'State'
2026-01-11 15:42:11,794 - dq_rules - INFO - Created null check rule for State
2026-01-11 15:42:11,795 - dq_rules - INFO - KPI THRESHOLD RULES SETUP
2026-01-11 15:42:21,929 - dq_rules - INFO - Current row count: 15
2026-01-11 15:42:38,575 - dq_rules - INFO - Storing KPI history for: row_count
2026-01-11 15:42:38,577 - dq_rules - INFO - Storing KPI history for: row_count
2026-01-11 15:42:38,577 - dq_rules - INFO - Connecting to database: dq_checks at localhost
2026-01-11 15:42:38,585 - dq_rules - INFO - Database connection successful!
2026-01-11 15:42:38,585 - dq_rules - INFO - Checking kpi_history table structure...
2026-01-11 15:42:38,598 - dq_rules - INFO - kpi_history table exists, checking structure...
2026-01-11 15:42:38,604 - dq_rules - INFO - Current columns in kpi_history: ['id', 'session_id', 'kpi_name', 'kpi_value', 'threshold_value', 'check_timestamp', 'created_at']
2026-01-11 15:42:38,604 - dq_rules - INFO - Table has correct schema, using existing table
2026-01-11 15:42:38,604 - dq_rules - INFO - Inserting KPI: row_count = 15.0 for session DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,609 - dq_rules - INFO - âœ… KPI history stored successfully for: row_count (ID: 13)
2026-01-11 15:42:38,610 - dq_rules - INFO - Created KPI rule: KPI: Total row count | Percentage threshold: 10.0% | Max growth: 30.0%
2026-01-11 15:42:38,610 - dq_rules - INFO - Created comprehensive rule set with 8 rules
2026-01-11 15:42:38,611 - dq_rules - INFO - Defined 8 business rules
2026-01-11 15:42:38,612 - dq_rules - INFO - EXECUTING 8 BUSINESS RULES
2026-01-11 15:42:38,613 - dq_rules - INFO - Executing rule: Salary should be above median value (53000.00)
2026-01-11 15:42:38,614 - dq_rules - INFO - Safe executing rule: Salary should be above median value (53000.00) (threshold)
2026-01-11 15:42:38,614 - dq_rules - INFO - Executing threshold rule: Salary should be above median value (53000.00)
2026-01-11 15:42:38,615 - dq_rules - INFO - Threshold rule 'Salary should be above median value (53000.00)': 6 violations found
2026-01-11 15:42:38,616 - dq_error_log - INFO - Starting batch logging for 6 errors, session: DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,630 - dq_error_log - INFO - Batch 1: Successfully logged 6 errors
2026-01-11 15:42:38,631 - dq_error_log - INFO - Progress: 6/6 errors processed
2026-01-11 15:42:38,631 - dq_error_log - INFO - COMPLETE: Logged 6/6 errors for session DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,631 - dq_rules - WARNING - 6 violations found
2026-01-11 15:42:38,641 - dq_rules - INFO - Rule 'Salary should be above median value (53000.00)' completed with status: FAIL
2026-01-11 15:42:38,642 - dq_rules - INFO - Executing rule: Email should be in valid email format
2026-01-11 15:42:38,642 - dq_rules - INFO - Safe executing rule: Email should be in valid email format (pattern)
2026-01-11 15:42:38,642 - dq_rules - INFO - Executing pattern rule: Email should be in valid email format
2026-01-11 15:42:38,644 - dq_rules - INFO - Pattern rule 'Email should be in valid email format': 3 pattern violations found
2026-01-11 15:42:38,645 - dq_error_log - INFO - Starting batch logging for 3 errors, session: DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,658 - dq_error_log - INFO - Batch 1: Successfully logged 3 errors
2026-01-11 15:42:38,658 - dq_error_log - INFO - Progress: 3/3 errors processed
2026-01-11 15:42:38,658 - dq_error_log - INFO - COMPLETE: Logged 3/3 errors for session DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,659 - dq_rules - WARNING - 3 pattern violations found
2026-01-11 15:42:38,662 - dq_rules - INFO - Rule 'Email should be in valid email format' completed with status: FAIL
2026-01-11 15:42:38,663 - dq_rules - INFO - Executing rule: CustomerName should have no null values (currently 1 nulls)
2026-01-11 15:42:38,663 - dq_rules - INFO - Safe executing rule: CustomerName should have no null values (currently 1 nulls) (threshold)
2026-01-11 15:42:38,663 - dq_rules - INFO - Executing threshold rule: CustomerName should have no null values (currently 1 nulls)
2026-01-11 15:42:38,663 - dq_rules - INFO - Threshold rule 'CustomerName should have no null values (currently 1 nulls)': 0 violations found
2026-01-11 15:42:38,663 - dq_rules - INFO - No violations found
2026-01-11 15:42:38,665 - dq_rules - INFO - Rule 'CustomerName should have no null values (currently 1 nulls)' completed with status: PASS
2026-01-11 15:42:38,666 - dq_rules - INFO - Executing rule: Email should have no null values (currently 1 nulls)
2026-01-11 15:42:38,666 - dq_rules - INFO - Safe executing rule: Email should have no null values (currently 1 nulls) (threshold)
2026-01-11 15:42:38,666 - dq_rules - INFO - Executing threshold rule: Email should have no null values (currently 1 nulls)
2026-01-11 15:42:38,666 - dq_rules - INFO - Threshold rule 'Email should have no null values (currently 1 nulls)': 0 violations found
2026-01-11 15:42:38,667 - dq_rules - INFO - No violations found
2026-01-11 15:42:38,668 - dq_rules - INFO - Rule 'Email should have no null values (currently 1 nulls)' completed with status: PASS
2026-01-11 15:42:38,669 - dq_rules - INFO - Executing rule: Salary should have no null values (currently 2 nulls)
2026-01-11 15:42:38,669 - dq_rules - INFO - Safe executing rule: Salary should have no null values (currently 2 nulls) (threshold)
2026-01-11 15:42:38,669 - dq_rules - INFO - Executing threshold rule: Salary should have no null values (currently 2 nulls)
2026-01-11 15:42:38,670 - dq_rules - INFO - Threshold rule 'Salary should have no null values (currently 2 nulls)': 0 violations found
2026-01-11 15:42:38,674 - dq_rules - INFO - No violations found
2026-01-11 15:42:38,675 - dq_rules - INFO - Rule 'Salary should have no null values (currently 2 nulls)' completed with status: PASS
2026-01-11 15:42:38,676 - dq_rules - INFO - Executing rule: Department should have no null values (currently 1 nulls)
2026-01-11 15:42:38,676 - dq_rules - INFO - Safe executing rule: Department should have no null values (currently 1 nulls) (threshold)
2026-01-11 15:42:38,677 - dq_rules - INFO - Executing threshold rule: Department should have no null values (currently 1 nulls)
2026-01-11 15:42:38,677 - dq_rules - INFO - Threshold rule 'Department should have no null values (currently 1 nulls)': 0 violations found
2026-01-11 15:42:38,678 - dq_rules - INFO - No violations found
2026-01-11 15:42:38,679 - dq_rules - INFO - Rule 'Department should have no null values (currently 1 nulls)' completed with status: PASS
2026-01-11 15:42:38,679 - dq_rules - INFO - Executing rule: PostalCode should have no null values (currently 1 nulls)
2026-01-11 15:42:38,680 - dq_rules - INFO - Safe executing rule: PostalCode should have no null values (currently 1 nulls) (threshold)
2026-01-11 15:42:38,680 - dq_rules - INFO - Executing threshold rule: PostalCode should have no null values (currently 1 nulls)
2026-01-11 15:42:38,680 - dq_rules - INFO - Threshold rule 'PostalCode should have no null values (currently 1 nulls)': 0 violations found
2026-01-11 15:42:38,681 - dq_rules - INFO - No violations found
2026-01-11 15:42:38,682 - dq_rules - INFO - Rule 'PostalCode should have no null values (currently 1 nulls)' completed with status: PASS
2026-01-11 15:42:38,682 - dq_rules - INFO - Executing rule: State should have no null values (currently 1 nulls)
2026-01-11 15:42:38,683 - dq_rules - INFO - Safe executing rule: State should have no null values (currently 1 nulls) (threshold)
2026-01-11 15:42:38,683 - dq_rules - INFO - Executing threshold rule: State should have no null values (currently 1 nulls)
2026-01-11 15:42:38,683 - dq_rules - INFO - Threshold rule 'State should have no null values (currently 1 nulls)': 0 violations found
2026-01-11 15:42:38,683 - dq_rules - INFO - No violations found
2026-01-11 15:42:38,688 - dq_rules - INFO - Rule 'State should have no null values (currently 1 nulls)' completed with status: PASS
2026-01-11 15:42:38,688 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 9
2026-01-11 15:42:38,689 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2026-01-11 15:42:38,689 - dq_rules - INFO - Report for: CSV: sample_data.csv, Records: 15, Columns: 10
2026-01-11 15:42:38,700 - dq_error_log - INFO - Retrieved 9 errors for session DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,701 - dq_rules - INFO - DQ Score Calculation: Total=15, Bad=7, Good=8, Score=53.33%, Grade=F
2026-01-11 15:42:38,706 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-11 15:42:38,706 - dq_audit - INFO - Starting database insertion for rules...
2026-01-11 15:42:38,721 - dq_audit - INFO - Inserted rules record with ID: 617
2026-01-11 15:42:38,722 - dq_rules - INFO - Audit record logged with ID: 617
2026-01-11 15:42:38,728 - dq_rules - INFO - RULES SUMMARY: Total Rules: 8, Passed: 6, Failed: 2, Errors: 0, Total Violations: 9
2026-01-11 15:42:38,747 - dq_error_log - INFO - Retrieved 9 errors for session DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,773 - dq_rules - INFO - ERROR LOGGING: Session ID: DQ_PIPELINE_20260111_153945, Total errors logged: 9
2026-01-11 15:42:38,776 - dq_rules - INFO - Complete DQ pipeline completed for session: DQ_PIPELINE_20260111_153945
2026-01-11 15:42:38,782 - __main__ - INFO - Business Rules Engine completed successfully
2026-01-11 15:42:38,783 - __main__ - INFO - Displaying main menu options to user
2026-01-11 15:57:26,920 - __main__ - INFO - User selected option: 6
2026-01-11 15:57:26,922 - __main__ - INFO - User session ended. Duration: 0:19:04.073071
2026-01-11 15:57:26,924 - __main__ - INFO - ðŸ‘‹ Thank you for using Universal Data Quality Framework!
