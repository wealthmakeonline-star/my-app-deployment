2026-02-14 14:43:37,087 - __main__ - INFO - üåê API Server Logging Initialized
2026-02-14 14:43:37,095 - __main__ - INFO - üìù Logs saved to: logs/dq_api_20260214_144337.log
2026-02-14 14:43:37,740 - __main__ - INFO - APP_SETTINGS loaded. Audit enabled: True
2026-02-14 14:43:37,741 - __main__ - INFO - ‚úÖ All DQ modules loaded successfully
2026-02-14 14:43:37,747 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 14:43:37,748 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 14:43:37,748 - __main__ - INFO - ‚úÖ ErrorLogger and DataQualityAudit initialized
2026-02-14 14:43:37,758 - __main__ - INFO - üöÄ Starting Data Quality Framework API
2026-02-14 14:43:37,759 - __main__ - INFO - üìä Modules available: True
2026-02-14 14:43:37,760 - __main__ - INFO - üîß Config file mode: False
2026-02-14 14:43:37,761 - __main__ - INFO - üìã Available endpoints:
2026-02-14 14:43:37,762 - __main__ - INFO -   GET  /              - API status
2026-02-14 14:43:37,763 - __main__ - INFO -   GET  /api/health    - Health check
2026-02-14 14:43:37,763 - __main__ - INFO -   POST /api/check-single - Single source analysis
2026-02-14 14:43:37,764 - __main__ - INFO -   POST /api/compare   - Source-target comparison
2026-02-14 14:43:37,764 - __main__ - INFO -   GET  /api/compare/{id} - Get comparison results
2026-02-14 14:43:37,765 - __main__ - INFO -   GET  /api/compare/{id}/mismatches - Paginated mismatches
2026-02-14 14:43:37,765 - __main__ - INFO -   GET  /api/compare/{id}/rows/count - Row counts
2026-02-14 14:43:37,766 - __main__ - INFO -   POST /api/upload    - File upload
2026-02-14 14:43:37,766 - __main__ - INFO -   GET  /api/sessions  - List sessions
2026-02-14 14:43:37,767 - __main__ - INFO -   GET  /api/sessions/<id> - Get session data
2026-02-14 14:43:37,767 - __main__ - INFO -   GET  /api/debug-db  - Database debug
2026-02-14 14:43:37,768 - __main__ - INFO - üåç Server starting on 0.0.0.0:5000 (debug=False)
2026-02-14 14:44:32,703 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 14:44:32,726 - __main__ - INFO - File uploaded: 20260214_144432_SINGLE_SOURCE_15.csv (csv)
2026-02-14 14:44:32,730 - __main__ - INFO - Completed with status 200 in 0.027s
2026-02-14 14:44:32,935 - __main__ - INFO - POST /api/check-single - Request started
2026-02-14 14:44:32,937 - __main__ - INFO - Single source analysis request received
2026-02-14 14:44:32,938 - __main__ - INFO - Starting analysis for session SINGLE_20260214_144432_b21782b7
2026-02-14 14:44:32,941 - __main__ - INFO - UI Data being passed to dq_unified:
2026-02-14 14:44:32,943 - __main__ - INFO -   source_type: csv
2026-02-14 14:44:32,944 - __main__ - INFO -   file_path: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_144432_SINGLE_SOURCE_15.csv
2026-02-14 14:44:32,946 - __main__ - INFO -   sheet_name: None
2026-02-14 14:44:32,949 - __main__ - INFO -   mandatory_fields: all
2026-02-14 14:44:32,950 - dq_unified - INFO - ==================================================
2026-02-14 14:44:32,954 - dq_unified - INFO - RUN_SINGLE_SOURCE_ANALYSIS_UI - START
2026-02-14 14:44:32,956 - dq_unified - INFO - Prompting user for data source type
2026-02-14 14:44:32,958 - dq_unified - INFO - UI Data source_type: csv
2026-02-14 14:44:32,960 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-14 14:44:32,962 - dq_unified - INFO - Loading data from CSV...
2026-02-14 14:44:32,963 - dq_unified - INFO - Loading data from CSV
2026-02-14 14:44:32,964 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_144432_SINGLE_SOURCE_15.csv
2026-02-14 14:44:32,968 - dq_unified - INFO - CSV file has 27 rows
2026-02-14 14:44:32,973 - dq_unified - INFO - Loading 27 rows from CSV...
2026-02-14 14:44:33,007 - dq_unified - INFO - Loaded 27 rows from CSV
2026-02-14 14:44:33,032 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 14:44:33,036 - dq_unified - INFO - Loaded 27 rows, 9 columns. Memory: 107.8MB total, 0.0MB for dataframe
2026-02-14 14:44:33,037 - dq_unified - INFO - Data loaded: 27 rows, 9 columns
2026-02-14 14:44:33,039 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 14:44:33,040 - dq_unified - INFO - Session ID: SINGLE_20260214_144433
2026-02-14 14:44:33,041 - dq_unified - INFO - Column data types collected: 9 columns
2026-02-14 14:44:33,042 - dq_unified - INFO - ==================================================
2026-02-14 14:44:33,043 - dq_unified - INFO - Starting quality checks...
2026-02-14 14:44:33,044 - dq_unified - INFO - ==================================================
2026-02-14 14:44:33,045 - dq_unified - INFO - 1. Checking for null/empty values...
2026-02-14 14:44:33,046 - dq_unified - INFO - Checking for null/empty values
2026-02-14 14:44:33,047 - dq_unified - INFO - DataFrame shape: (27, 9)
2026-02-14 14:44:33,049 - dq_unified - INFO - Columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 14:44:33,050 - dq_unified - INFO - Data source: CSV: 20260214_144432_SINGLE_SOURCE_15.csv
2026-02-14 14:44:33,051 - dq_unified - INFO - DataFrame dtypes: {'transaction_id': dtype('O'), 'account_id': dtype('O'), 'customer_email': dtype('O'), 'transaction_date': CategoricalDtype(categories=['1/1/2024', '2024/31/12', '31-12-2024'], ordered=False, categories_dtype=object), 'amount': dtype('O'), 'currency': CategoricalDtype(categories=['USD'], ordered=False, categories_dtype=object), 'country': CategoricalDtype(categories=['US'], ordered=False, categories_dtype=object), 'status': CategoricalDtype(categories=['SUCCESS'], ordered=False, categories_dtype=object), 'remarks': CategoricalDtype(categories=['OK'], ordered=False, categories_dtype=object)}
2026-02-14 14:44:33,053 - dq_unified - INFO - First 2 rows (first 3 columns only):
2026-02-14 14:44:33,057 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': "'AC000001'", 'customer_email': "'user1@bank.com'"}
2026-02-14 14:44:33,059 - dq_unified - INFO -   Row 1: {'transaction_id': "'TXN2'", 'account_id': "'AC000002'", 'customer_email': "'user2@bank.com'"}
2026-02-14 14:44:33,084 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 14:44:33,086 - dq_unified - INFO -   Not missing samples: ["'TXN2'", "'TXN3'", "'TXN4'"]
2026-02-14 14:44:33,087 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (3.7%)
2026-02-14 14:44:33,088 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (3.7%)
2026-02-14 14:44:33,091 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_144433
2026-02-14 14:44:33,844 - mysql.connector - INFO - package: mysql.connector.plugins
2026-02-14 14:44:33,846 - mysql.connector - INFO - plugin_name: caching_sha2_password
2026-02-14 14:44:33,848 - mysql.connector - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLCachingSHA2PasswordAuthPlugin
2026-02-14 14:44:33,850 - mysql.connector - INFO - package: mysql.connector.plugins
2026-02-14 14:44:33,851 - mysql.connector - INFO - plugin_name: mysql_native_password
2026-02-14 14:44:33,863 - mysql.connector - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2026-02-14 14:44:33,879 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 14:44:33,884 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 14:44:33,885 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_144433
2026-02-14 14:44:33,901 - dq_unified - INFO - Column 'account_id': No missing cells
2026-02-14 14:44:33,913 - dq_unified - INFO - Column 'customer_email': No missing cells
2026-02-14 14:44:33,928 - dq_unified - INFO - Column 'transaction_date': No missing cells
2026-02-14 14:44:33,941 - dq_unified - INFO - Column 'amount': No missing cells
2026-02-14 14:44:33,953 - dq_unified - INFO - Column 'currency': No missing cells
2026-02-14 14:44:33,967 - dq_unified - INFO - Column 'country': No missing cells
2026-02-14 14:44:33,977 - dq_unified - INFO - Column 'status': No missing cells
2026-02-14 14:44:33,992 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 14:44:33,993 - dq_unified - INFO -   Not missing samples: ["'OK'", "'OK'", "'OK'"]
2026-02-14 14:44:33,994 - dq_unified - WARNING - Column 'remarks': 1 missing cells (3.7%)
2026-02-14 14:44:33,995 - dq_unified - WARNING - Column 'remarks': 1 missing cells (3.7%)
2026-02-14 14:44:34,001 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_144433
2026-02-14 14:44:34,129 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 14:44:34,131 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 14:44:34,132 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_144433
2026-02-14 14:44:34,133 - dq_unified - INFO - Total missing cells found: 2
2026-02-14 14:44:34,134 - dq_unified - INFO - ============================================================
2026-02-14 14:44:34,134 - dq_unified - INFO - MISSING VALUE SUMMARY
2026-02-14 14:44:34,134 - dq_unified - INFO - ============================================================
2026-02-14 14:44:34,136 - dq_unified - INFO - transaction_id: 1 missing (3.7%)
2026-02-14 14:44:34,137 - dq_unified - INFO - remarks: 1 missing (3.7%)
2026-02-14 14:44:34,137 - dq_unified - INFO - ============================================================
2026-02-14 14:44:34,138 - dq_unified - INFO -    Found 2 empty cells
2026-02-14 14:44:34,138 - dq_unified - INFO - 2. Checking for duplicate rows...
2026-02-14 14:44:34,139 - dq_unified - INFO - Checking for duplicate rows
2026-02-14 14:44:34,139 - dq_unified - INFO - Cleaning data (removing whitespace)...
2026-02-14 14:44:34,141 - dq_unified - INFO - Columns after cleaning: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 14:44:34,148 - dq_unified - INFO - Sample of first column after cleaning: 'nan'
2026-02-14 14:44:34,149 - dq_unified - INFO - Sample of row 6 first column: 'TXN6'
2026-02-14 14:44:34,149 - dq_unified - INFO - Total rows to check: 27
2026-02-14 14:44:34,150 - dq_unified - INFO - Checking first column 'transaction_id' for serial numbers
2026-02-14 14:44:34,150 - dq_unified - INFO - First 5 values: ['nan', 'TXN2', 'TXN3', 'TXN4', 'TXN5']
2026-02-14 14:44:34,151 - dq_unified - INFO -   Row 1: 'nan' ‚Üí nan (numeric)
2026-02-14 14:44:34,152 - dq_unified - INFO -   Row 2: 'TXN2' ‚Üí Not numeric
2026-02-14 14:44:34,153 - dq_unified - INFO -   Row 3: 'TXN3' ‚Üí Not numeric
2026-02-14 14:44:34,153 - dq_unified - INFO - Not enough numeric values to be serial: [nan]
2026-02-14 14:44:34,154 - dq_unified - INFO - Checking duplicates on ALL columns
2026-02-14 14:44:34,154 - dq_unified - INFO - First few rows for comparison:
2026-02-14 14:44:34,155 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': 'AC000001', 'customer_email': 'user1@bank.com'}
2026-02-14 14:44:34,156 - dq_unified - INFO -   Row 1: {'transaction_id': 'TXN2', 'account_id': 'AC000002', 'customer_email': 'user2@bank.com'}
2026-02-14 14:44:34,157 - dq_unified - INFO -   Row 2: {'transaction_id': 'TXN3', 'account_id': 'AC000003', 'customer_email': 'bademail.com'}
2026-02-14 14:44:34,163 - dq_unified - INFO - Duplicate mask found 24 rows
2026-02-14 14:44:34,164 - dq_unified - INFO - Found 24 potential duplicate rows
2026-02-14 14:44:34,165 - dq_unified - INFO - Unique duplicate groups: 12
2026-02-14 14:44:34,166 - dq_unified - INFO - Duplicate groups found:
2026-02-14 14:44:34,168 - dq_unified - INFO -   Group sample: Pandas(Index=3, transaction_id='TXN4', account_id='AC000004', customer_email='user4@bank.com', transaction_date='2024/31/12', amount='1003', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 14:44:34,169 - dq_unified - INFO -   Group sample: Pandas(Index=4, transaction_id='TXN5', account_id='AC000005', customer_email='user5@bank.com', transaction_date='1/1/2024', amount='12,000$', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 14:44:34,170 - dq_unified - INFO -   Group sample: Pandas(Index=5, transaction_id='TXN6', account_id='AC000006', customer_email='user6@bank.com', transaction_date='31-12-2024', amount='1005', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 14:44:34,171 - dq_unified - INFO - Processing 24 duplicate indices
2026-02-14 14:44:34,172 - dq_unified - INFO - FINAL RESULT: Found 24 duplicate groups
2026-02-14 14:44:34,173 - dq_error_log - INFO - Starting batch logging for 24 errors, session: SINGLE_20260214_144433
2026-02-14 14:44:34,288 - dq_error_log - INFO - Batch 1: Successfully logged 24 errors
2026-02-14 14:44:34,290 - dq_error_log - INFO - Progress: 24/24 errors processed
2026-02-14 14:44:34,291 - dq_error_log - INFO - COMPLETE: Logged 24/24 errors for session SINGLE_20260214_144433
2026-02-14 14:44:34,292 - dq_unified - INFO -    Found 24 duplicate rows
2026-02-14 14:44:34,292 - dq_unified - INFO - 3. Checking data formats...
2026-02-14 14:44:34,294 - dq_unified - INFO - Checking data formats
2026-02-14 14:44:34,300 - dq_unified - INFO - Detected customer_email as email type
2026-02-14 14:44:34,301 - dq_unified - WARNING -   Row 3: 'bademail.com...' doesn't match Valid email format (user@domain.com)
2026-02-14 14:44:34,304 - dq_unified - INFO - Detected amount as numeric type
2026-02-14 14:44:34,305 - dq_unified - WARNING -   Row 5: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 14:44:34,305 - dq_unified - WARNING -   Row 17: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 14:44:34,314 - dq_unified - INFO - Total format issues found: 3
2026-02-14 14:44:34,315 - dq_error_log - INFO - Starting batch logging for 3 errors, session: SINGLE_20260214_144433
2026-02-14 14:44:34,417 - dq_error_log - INFO - Batch 1: Successfully logged 3 errors
2026-02-14 14:44:34,421 - dq_error_log - INFO - Progress: 3/3 errors processed
2026-02-14 14:44:34,423 - dq_error_log - INFO - COMPLETE: Logged 3/3 errors for session SINGLE_20260214_144433
2026-02-14 14:44:34,424 - dq_unified - INFO -    Found 3 format issues
2026-02-14 14:44:34,425 - dq_unified - INFO - 4. Checking mandatory fields...
2026-02-14 14:44:34,426 - dq_unified - INFO - Checking mandatory fields
2026-02-14 14:44:34,427 - dq_unified - INFO - Available columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 14:44:34,428 - dq_unified - INFO - Checking ALL columns as mandatory: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 14:44:34,437 - dq_unified - WARNING - Mandatory field 'transaction_id': 1 missing values (96.3% filled)
2026-02-14 14:44:34,446 - dq_unified - INFO - Mandatory field 'account_id': 100.0% filled
2026-02-14 14:44:34,456 - dq_unified - INFO - Mandatory field 'customer_email': 100.0% filled
2026-02-14 14:44:34,469 - dq_unified - INFO - Mandatory field 'transaction_date': 100.0% filled
2026-02-14 14:44:34,478 - dq_unified - INFO - Mandatory field 'amount': 100.0% filled
2026-02-14 14:44:34,490 - dq_unified - INFO - Mandatory field 'currency': 100.0% filled
2026-02-14 14:44:34,500 - dq_unified - INFO - Mandatory field 'country': 100.0% filled
2026-02-14 14:44:34,508 - dq_unified - INFO - Mandatory field 'status': 100.0% filled
2026-02-14 14:44:34,518 - dq_unified - WARNING - Mandatory field 'remarks': 1 missing values (96.3% filled)
2026-02-14 14:44:34,600 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_144433
2026-02-14 14:44:34,703 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 14:44:34,705 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 14:44:34,706 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_144433
2026-02-14 14:44:34,707 - dq_unified - INFO - All columns mandatory: 2 unique rows with missing values
2026-02-14 14:44:34,708 - dq_unified - INFO -    Found 2 missing mandatory values
2026-02-14 14:44:34,708 - dq_unified - INFO - 5. Calculating quality score...
2026-02-14 14:44:34,709 - dq_unified - INFO - Calculating quality score
2026-02-14 14:44:34,709 - dq_unified - INFO - Quality Score Calculation:
2026-02-14 14:44:34,710 - dq_unified - INFO -   Total rows: 27
2026-02-14 14:44:34,710 - dq_unified - INFO -   Bad Rows: 27
2026-02-14 14:44:34,711 - dq_unified - INFO -   Good rows (no issues): 0
2026-02-14 14:44:34,712 - dq_unified - INFO -   Quality Score: 0.0%
2026-02-14 14:44:34,823 - dq_error_log - INFO - Retrieved 31 error logs for session SINGLE_20260214_144433
2026-02-14 14:44:34,945 - dq_error_log - INFO - Retrieved summary: 31 total errors for session SINGLE_20260214_144433
2026-02-14 14:44:34,950 - dq_unified - INFO - Added 31 error logs to results
2026-02-14 14:44:34,951 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 14:44:34,952 - dq_audit - INFO - Starting database insertion for single_source...
2026-02-14 14:44:35,101 - dq_audit - INFO - Inserted single_source record with ID: 555
2026-02-14 14:44:35,228 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_144433
2026-02-14 14:44:35,231 - dq_unified - INFO - Added 1 audit logs to results
2026-02-14 14:44:35,233 - dq_unified - INFO - Analysis completed successfully for CSV: 20260214_144432_SINGLE_SOURCE_15.csv
2026-02-14 14:44:35,233 - dq_unified - INFO - Final quality score: 0.0%
2026-02-14 14:44:35,352 - dq_error_log - INFO - Retrieved 31 error logs for session SINGLE_20260214_144433
2026-02-14 14:44:35,475 - dq_error_log - INFO - Retrieved summary: 31 total errors for session SINGLE_20260214_144433
2026-02-14 14:44:35,609 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_144433
2026-02-14 14:44:35,615 - __main__ - INFO - Analysis completed for session SINGLE_20260214_144433
2026-02-14 14:44:35,626 - __main__ - INFO - Completed with status 200 in 2.690s
2026-02-14 14:44:35,773 - __main__ - INFO - GET /api/single/SINGLE_20260214_144433/errors - Request started
2026-02-14 14:44:35,780 - __main__ - INFO - Completed with status 500 in 0.007s
2026-02-14 14:44:36,108 - __main__ - INFO - GET /api/single/SINGLE_20260214_144433/errors - Request started
2026-02-14 14:44:36,109 - __main__ - INFO - Completed with status 500 in 0.001s
2026-02-14 14:44:40,020 - __main__ - INFO - GET /api/single/SINGLE_20260214_144433/errors - Request started
2026-02-14 14:44:40,021 - __main__ - INFO - Completed with status 500 in 0.001s
2026-02-14 14:44:40,724 - __main__ - INFO - GET /api/single/SINGLE_20260214_144433/errors - Request started
2026-02-14 14:44:40,725 - __main__ - INFO - Completed with status 500 in 0.001s
