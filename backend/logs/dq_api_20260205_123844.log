2026-02-05 12:38:44,480 - __main__ - INFO - üåê API Server Logging Initialized
2026-02-05 12:38:44,481 - __main__ - INFO - üìù Logs saved to: logs/dq_api_20260205_123844.log
2026-02-05 12:38:44,557 - __main__ - INFO - APP_SETTINGS loaded. Audit enabled: True
2026-02-05 12:38:44,558 - __main__ - INFO - ‚úÖ All DQ modules loaded successfully
2026-02-05 12:38:44,560 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-05 12:38:44,561 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-05 12:38:44,561 - __main__ - INFO - ‚úÖ ErrorLogger and DataQualityAudit initialized
2026-02-05 12:38:44,570 - __main__ - INFO - üöÄ Starting Data Quality Framework API
2026-02-05 12:38:44,571 - __main__ - INFO - üìä Modules available: True
2026-02-05 12:38:44,572 - __main__ - INFO - üîß Config file mode: False
2026-02-05 12:38:44,573 - __main__ - INFO - üìã Available endpoints:
2026-02-05 12:38:44,573 - __main__ - INFO -   GET  /              - API status
2026-02-05 12:38:44,573 - __main__ - INFO -   GET  /api/health    - Health check
2026-02-05 12:38:44,574 - __main__ - INFO -   POST /api/check-single - Single source analysis
2026-02-05 12:38:44,574 - __main__ - INFO -   POST /api/compare   - Source-target comparison
2026-02-05 12:38:44,575 - __main__ - INFO -   GET  /api/compare/{id} - Get comparison results
2026-02-05 12:38:44,576 - __main__ - INFO -   GET  /api/compare/{id}/mismatches - Paginated mismatches
2026-02-05 12:38:44,576 - __main__ - INFO -   GET  /api/compare/{id}/rows/count - Row counts
2026-02-05 12:38:44,577 - __main__ - INFO -   POST /api/upload    - File upload
2026-02-05 12:38:44,578 - __main__ - INFO -   GET  /api/sessions  - List sessions
2026-02-05 12:38:44,578 - __main__ - INFO -   GET  /api/sessions/<id> - Get session data
2026-02-05 12:38:44,578 - __main__ - INFO -   GET  /api/debug-db  - Database debug
2026-02-05 12:38:44,579 - __main__ - INFO - üåç Server starting on 0.0.0.0:5000 (debug=False)
2026-02-05 12:40:16,124 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-05 12:40:16,124 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-05 12:40:16,125 - __main__ - INFO - Database: Not provided
2026-02-05 12:40:16,126 - __main__ - INFO - Schema: Not provided
2026-02-05 12:40:16,127 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-05 12:40:16,127 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-05 12:40:16,128 - database_navigator - INFO - Connecting to MYSQL...
2026-02-05 12:40:16,373 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-05 12:40:16,373 - __main__ - INFO - Getting databases list...
2026-02-05 12:40:16,374 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-05 12:40:16,428 - database_navigator - INFO - Found 13 databases
2026-02-05 12:40:16,428 - __main__ - INFO - Found 13 databases
2026-02-05 12:40:16,430 - __main__ - INFO - Completed with status 200 in 0.307s
2026-02-05 12:40:19,846 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-05 12:40:19,849 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-05 12:40:19,850 - __main__ - INFO - Database: dq_checks
2026-02-05 12:40:19,850 - __main__ - INFO - Schema: Not provided
2026-02-05 12:40:19,851 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-05 12:40:19,854 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-05 12:40:19,855 - database_navigator - INFO - Connecting to MYSQL...
2026-02-05 12:40:19,871 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-05 12:40:19,872 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-05 12:40:19,873 - database_navigator - INFO - Found 1 schemas
2026-02-05 12:40:19,874 - __main__ - INFO - Found 1 schemas
2026-02-05 12:40:19,875 - __main__ - INFO - Completed with status 200 in 0.029s
2026-02-05 12:40:22,316 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-05 12:40:22,317 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-05 12:40:22,318 - __main__ - INFO - Database: dq_checks
2026-02-05 12:40:22,320 - __main__ - INFO - Schema: dq_checks
2026-02-05 12:40:22,320 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-05 12:40:22,321 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-05 12:40:22,321 - database_navigator - INFO - Connecting to MYSQL...
2026-02-05 12:40:22,332 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-05 12:40:22,333 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-05 12:40:22,351 - database_navigator - INFO - Found 10 tables in schema 'dq_checks'
2026-02-05 12:40:22,351 - __main__ - INFO - Found 10 tables
2026-02-05 12:40:22,352 - __main__ - INFO - Completed with status 200 in 0.036s
2026-02-05 12:41:04,718 - __main__ - INFO - POST /api/upload - Request started
2026-02-05 12:41:05,147 - __main__ - INFO - File uploaded: 20260205_124104_Target_data_100k.xlsx (excel)
2026-02-05 12:41:05,148 - __main__ - INFO - Completed with status 200 in 0.430s
2026-02-05 12:41:05,473 - __main__ - INFO - POST /api/compare - Request started
2026-02-05 12:41:05,474 - __main__ - INFO - Comparison request - Source: database, Target: excel
2026-02-05 12:41:05,475 - __main__ - INFO - Comparison analysis request received
2026-02-05 12:41:05,477 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'mysql', 'host': 'localhost', 'port': 3306, 'database': 'dq_checks', 'table': 'employee', 'user': 'root', 'password': 'root'}
2026-02-05 12:41:05,478 - __main__ - INFO - Starting comparison for session CMP_20260205_124105
2026-02-05 12:41:05,478 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-05 12:41:05,479 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-05 12:41:05,480 - dq_comparison - INFO - 
==================================================
2026-02-05 12:41:05,480 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-05 12:41:05,480 - dq_comparison - INFO - ==================================================
2026-02-05 12:41:05,482 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-02-05 12:41:05,482 - dq_comparison - INFO - ----------------------------------------
2026-02-05 12:41:05,483 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-02-05 12:41:05,483 - dq_unified - INFO - Loading data from DATABASE
2026-02-05 12:41:05,484 - dq_unified - INFO - Loading large database table: employee
2026-02-05 12:41:05,484 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-05 12:41:05,593 - dq_unified - INFO - MySQL table employee has 89,999 rows
2026-02-05 12:41:05,594 - dq_unified - INFO - Loading 89,999 rows from MySQL...
2026-02-05 12:41:07,240 - dq_unified - INFO - Loaded 89,999 rows from MySQL
2026-02-05 12:41:08,220 - dq_unified - INFO - Memory optimization: 60.7MB -> 25.7MB (Saved: 35.0MB)
2026-02-05 12:41:08,378 - dq_unified - INFO - Loaded 89,999 rows, 12 columns. Memory: 205.1MB total, 25.7MB for dataframe
2026-02-05 12:41:08,379 - dq_comparison - INFO - SOURCE database loaded: 89,999 rows, 12 columns
2026-02-05 12:41:08,379 - dq_comparison - INFO - 
==================================================
2026-02-05 12:41:08,380 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-05 12:41:08,381 - dq_comparison - INFO - ==================================================
2026-02-05 12:41:08,381 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-05 12:41:08,384 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'uploads\\20260205_124104_Target_data_100k.xlsx'}
2026-02-05 12:41:08,384 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-05 12:41:08,384 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: uploads\20260205_124104_Target_data_100k.xlsx
2026-02-05 12:41:27,826 - dq_comparison - INFO - TARGET Excel loaded: 100,500 rows, 12 columns
2026-02-05 12:41:27,827 - dq_comparison - INFO - Source data loaded: 89999 rows, 12 columns
2026-02-05 12:41:27,828 - dq_comparison - INFO - Target data loaded: 100500 rows, 12 columns
2026-02-05 12:41:27,829 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-05 12:41:27,829 - dq_comparison - INFO - Source columns (original): ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-02-05 12:41:27,830 - dq_comparison - INFO - Target columns (original): ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-02-05 12:41:27,831 - dq_comparison - INFO - Common columns lowercased: ['phone', 'transaction_date', 'email', 'description', 'amount', 'status', 'customer_id', 'customer_name', 'age', 'quantity', 'id', 'transaction_id']
2026-02-05 12:41:27,831 - dq_comparison - INFO - Found 12 common columns between source and target (case-insensitive)
2026-02-05 12:41:27,832 - dq_comparison - INFO - User column selection input: all
2026-02-05 12:41:27,832 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-05 12:41:27,834 - dq_comparison - INFO - Selected 12 columns for comparison: ['phone', 'transaction_date', 'email', 'description', 'amount']...
2026-02-05 12:41:27,835 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-05 12:41:27,835 - dq_comparison - INFO - Report details - Source: Database: mysql - dq_checks.employee, Target: Excel: 20260205_124104_Target_data_100k.xlsx (Target_data_100k), Selected columns: 12
2026-02-05 12:41:27,836 - dq_comparison - INFO - Initializing Error Logger...
2026-02-05 12:41:27,836 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-05 12:41:27,856 - dq_error_log - INFO - Database connection successful
2026-02-05 12:41:27,857 - dq_comparison - INFO - Session ID: CMP_20260205_124127
2026-02-05 12:41:27,858 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=89,999, Target=100,500, Difference=10,501
2026-02-05 12:41:27,859 - dq_comparison - WARNING -    Extra in target: 10,501 rows
2026-02-05 12:41:27,860 - dq_comparison - INFO - Comparing column structures...
2026-02-05 12:41:27,861 - dq_comparison - WARNING - Found 12 incompatible data type mismatches
2026-02-05 12:41:27,861 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-05 12:41:27,863 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-05 12:41:27,864 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-05 12:41:28,372 - dq_comparison - INFO - No common key fields auto-detected
2026-02-05 12:41:28,374 - dq_comparison - INFO - No key fields identified for validation
2026-02-05 12:41:28,375 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-05 12:41:30,880 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-05 12:41:30,881 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-05 12:41:30,954 - dq_comparison - INFO - Starting comparison of 190,499 total rows...
2026-02-05 12:41:30,956 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-05 12:41:30,957 - dq_comparison - INFO - Column: phone
2026-02-05 12:41:30,959 - dq_comparison - INFO -   Source type: <class 'str'>, value: 212-127-8383
2026-02-05 12:41:30,960 - dq_comparison - INFO -   Target type: <class 'str'>, value: 212-127-8383
2026-02-05 12:41:30,965 - dq_comparison - INFO -   Normalized: '2121278383' vs '2121278383'
2026-02-05 12:41:30,966 - dq_comparison - INFO -   Match: True
2026-02-05 12:41:30,967 - dq_comparison - INFO - Column: transaction_date
2026-02-05 12:41:30,969 - dq_comparison - INFO -   Source type: <class 'str'>, value: 04-10-2023
2026-02-05 12:41:30,970 - dq_comparison - INFO -   Target type: <class 'datetime.datetime'>, value: 2023-10-04 00:00:00
2026-02-05 12:41:31,013 - dq_comparison - INFO -   Normalized: '2023-10-04' vs '2023-04-10'
2026-02-05 12:41:31,014 - dq_comparison - INFO -   Match: False
2026-02-05 12:41:31,015 - dq_comparison - INFO - Column: email
2026-02-05 12:41:31,016 - dq_comparison - INFO -   Source type: <class 'str'>, value: david.jones@company
2026-02-05 12:41:31,017 - dq_comparison - INFO -   Target type: <class 'str'>, value: david.jones@company.com
2026-02-05 12:41:31,018 - dq_comparison - INFO -   Normalized: 'david.jones@company' vs 'david.jones@company.com'
2026-02-05 12:41:31,019 - dq_comparison - INFO -   Match: False
2026-02-05 12:41:31,021 - dq_comparison - INFO - Source DF columns: ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-02-05 12:41:31,022 - dq_comparison - INFO - Target DF columns: ['id', 'customer_id', 'transaction_id', 'customer_name', 'email', 'phone', 'transaction_date', 'amount', 'quantity', 'age', 'status', 'description']
2026-02-05 12:41:31,023 - dq_comparison - INFO - Selected columns for comparison: ['phone', 'transaction_date', 'email', 'description', 'amount', 'status', 'customer_id', 'customer_name', 'age', 'quantity', 'id', 'transaction_id']
2026-02-05 12:41:31,024 - dq_comparison - INFO - Using 12 common columns for hash comparison
2026-02-05 12:41:31,025 - dq_comparison - INFO - Source columns: ['phone', 'transaction_date', 'email', 'description', 'amount', 'status', 'customer_id', 'customer_name', 'age', 'quantity', 'id', 'transaction_id']
2026-02-05 12:41:31,027 - dq_comparison - INFO - Target columns: ['phone', 'transaction_date', 'email', 'description', 'amount', 'status', 'customer_id', 'customer_name', 'age', 'quantity', 'id', 'transaction_id']
2026-02-05 12:41:31,028 - dq_comparison - INFO - Generating hashes for source data (89999 rows)...
2026-02-05 12:42:03,286 - dq_comparison - INFO -    Hashing source data: 10.0% complete (19,050/190,499 rows)
2026-02-05 12:42:30,465 - dq_comparison - INFO -    Hashing source data: 20.0% complete (38,100/190,499 rows)
2026-02-05 12:42:47,672 - dq_comparison - INFO -    Hashing source data: 26.2% complete (50,000/190,499 rows)
2026-02-05 12:43:20,349 - dq_comparison - INFO -    Hashing source data: 36.2% complete (69,050/190,499 rows)
2026-02-05 12:43:53,890 - dq_comparison - INFO -    Hashing source data: 46.2% complete (88,100/190,499 rows)
2026-02-05 12:43:57,307 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-05 12:43:57,315 - dq_comparison - INFO - Hash 1: 9e5c74e88c38e309... (sample row 0)
2026-02-05 12:43:57,319 - dq_comparison - INFO - Hash 2: 98a527a581008664... (sample row 1)
2026-02-05 12:43:57,320 - dq_comparison - INFO - Hash 3: 84bf37982f525d95... (sample row 2)
2026-02-05 12:43:57,321 - dq_comparison - INFO - Generating hashes for target data (100500 rows)...
2026-02-05 12:44:19,574 - dq_comparison - INFO -    Hashing target data: 52.5% complete (100,000/190,499 rows)
2026-02-05 12:44:58,353 - dq_comparison - INFO -    Hashing target data: 62.5% complete (119,050/190,499 rows)
2026-02-05 12:45:33,021 - dq_comparison - INFO -    Hashing target data: 72.5% complete (138,100/190,499 rows)
2026-02-05 12:46:00,927 - dq_comparison - INFO -    Hashing target data: 78.7% complete (150,000/190,499 rows)
2026-02-05 12:46:37,457 - dq_comparison - INFO -    Hashing target data: 88.7% complete (169,050/190,499 rows)
2026-02-05 12:47:11,199 - dq_comparison - INFO -    Hashing target data: 98.7% complete (188,100/190,499 rows)
2026-02-05 12:47:15,236 - dq_comparison - INFO - 
======================================================================
2026-02-05 12:47:15,239 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-05 12:47:15,241 - dq_comparison - INFO - ======================================================================
2026-02-05 12:47:15,242 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-05 12:47:15,243 - dq_comparison - INFO - Column 'phone' ‚Üí 'phone':
2026-02-05 12:47:15,245 - dq_comparison - INFO -   Source: '212-127-8383' (type: str) ‚Üí '2121278383'
2026-02-05 12:47:15,246 - dq_comparison - INFO -   Target: '212-127-8383' (type: str) ‚Üí '2121278383'
2026-02-05 12:47:15,247 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-05 12:47:15,250 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-05 12:47:15,251 - dq_comparison - INFO -   Source: '04-10-2023' (type: str) ‚Üí '2023-10-04'
2026-02-05 12:47:15,252 - dq_comparison - INFO -   Target: '2023-10-04 00:00:00' (type: datetime) ‚Üí '2023-04-10'
2026-02-05 12:47:15,253 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,254 - dq_comparison - INFO -   ‚ö†Ô∏è DATE MISMATCH DETECTED!
2026-02-05 12:47:15,256 - dq_comparison - INFO -     Source appears to be: 04-10-2023
2026-02-05 12:47:15,257 - dq_comparison - INFO -     Target appears to be (timestamp): 2023-10-04 00:00:00
2026-02-05 12:47:15,257 - dq_comparison - INFO - Column 'email' ‚Üí 'email':
2026-02-05 12:47:15,259 - dq_comparison - INFO -   Source: 'david.jones@company' (type: str) ‚Üí 'david.jones@company'
2026-02-05 12:47:15,259 - dq_comparison - INFO -   Target: 'david.jones@company.com' (type: str) ‚Üí 'david.jones@company.com'
2026-02-05 12:47:15,260 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,261 - dq_comparison - INFO - Column 'description' ‚Üí 'description':
2026-02-05 12:47:15,263 - dq_comparison - INFO -   Source: 'Text with& ampersands' (type: str) ‚Üí 'text with& ampersands'
2026-02-05 12:47:15,264 - dq_comparison - INFO -   Target: 'Text with& ampersands' (type: str) ‚Üí 'text with& ampersands'
2026-02-05 12:47:15,264 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-05 12:47:15,265 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-05 12:47:15,266 - dq_comparison - INFO -   Source: '9999999.99' (type: str) ‚Üí '9999999.9900000002'
2026-02-05 12:47:15,267 - dq_comparison - INFO -   Target: '8653.56' (type: float64) ‚Üí '8653.56'
2026-02-05 12:47:15,267 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,269 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-05 12:47:15,273 - dq_comparison - INFO - Source hash string start: 2121278383|2023-10-04|david.jones@company...
2026-02-05 12:47:15,275 - dq_comparison - INFO - Target hash string start: 2121278383|2023-04-10|david.jones@company.com...
2026-02-05 12:47:15,275 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-05 12:47:15,276 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-05 12:47:15,278 - dq_comparison - INFO - Column 'phone' ‚Üí 'phone':
2026-02-05 12:47:15,279 - dq_comparison - INFO -   Source: 'None' (type: NoneType) ‚Üí 'NULL'
2026-02-05 12:47:15,280 - dq_comparison - INFO -   Target: '(212) 706-7216' (type: str) ‚Üí '2127067216'
2026-02-05 12:47:15,281 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,285 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-05 12:47:15,285 - dq_comparison - INFO -   Source: '04-07-2023' (type: str) ‚Üí '2023-07-04'
2026-02-05 12:47:15,287 - dq_comparison - INFO -   Target: '2023-07-04 00:00:00' (type: datetime) ‚Üí '2023-04-07'
2026-02-05 12:47:15,288 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,289 - dq_comparison - INFO -   ‚ö†Ô∏è DATE MISMATCH DETECTED!
2026-02-05 12:47:15,290 - dq_comparison - INFO -     Source appears to be: 04-07-2023
2026-02-05 12:47:15,290 - dq_comparison - INFO -     Target appears to be (timestamp): 2023-07-04 00:00:00
2026-02-05 12:47:15,292 - dq_comparison - INFO - Column 'email' ‚Üí 'email':
2026-02-05 12:47:15,292 - dq_comparison - INFO -   Source: 'duplicate.email@gmail.com' (type: str) ‚Üí 'duplicate.email@gmail.com'
2026-02-05 12:47:15,293 - dq_comparison - INFO -   Target: 'jennifer.williams@gmail.com' (type: str) ‚Üí 'jennifer.williams@gmail.com'
2026-02-05 12:47:15,293 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,295 - dq_comparison - INFO - Column 'description' ‚Üí 'description':
2026-02-05 12:47:15,295 - dq_comparison - INFO -   Source: 'Text with. periods' (type: str) ‚Üí 'text with. periods'
2026-02-05 12:47:15,296 - dq_comparison - INFO -   Target: 'Text with. periods' (type: str) ‚Üí 'text with. periods'
2026-02-05 12:47:15,297 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-05 12:47:15,298 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-05 12:47:15,300 - dq_comparison - INFO -   Source: '1948.44' (type: str) ‚Üí '1948.44'
2026-02-05 12:47:15,301 - dq_comparison - INFO -   Target: '1948.44' (type: float64) ‚Üí '1948.44'
2026-02-05 12:47:15,301 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-05 12:47:15,302 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-05 12:47:15,304 - dq_comparison - INFO - Source hash string start: NULL|2023-07-04|duplicate.email@gmail.com...
2026-02-05 12:47:15,305 - dq_comparison - INFO - Target hash string start: 2127067216|2023-04-07|jennifer.williams@gmail.com...
2026-02-05 12:47:15,307 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-05 12:47:15,307 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-05 12:47:15,309 - dq_comparison - INFO - Column 'phone' ‚Üí 'phone':
2026-02-05 12:47:15,309 - dq_comparison - INFO -   Source: '1212392873A' (type: str) ‚Üí '1212392873a'
2026-02-05 12:47:15,311 - dq_comparison - INFO -   Target: '12123928735' (type: int) ‚Üí '12123928735'
2026-02-05 12:47:15,312 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,314 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-05 12:47:15,316 - dq_comparison - INFO -   Source: '10-03-2023' (type: str) ‚Üí '2023-03-10'
2026-02-05 12:47:15,317 - dq_comparison - INFO -   Target: '2023-03-10 00:00:00' (type: datetime) ‚Üí '2023-10-03'
2026-02-05 12:47:15,317 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,318 - dq_comparison - INFO -   ‚ö†Ô∏è DATE MISMATCH DETECTED!
2026-02-05 12:47:15,319 - dq_comparison - INFO -     Source appears to be: 10-03-2023
2026-02-05 12:47:15,320 - dq_comparison - INFO -     Target appears to be (timestamp): 2023-03-10 00:00:00
2026-02-05 12:47:15,321 - dq_comparison - INFO - Column 'email' ‚Üí 'email':
2026-02-05 12:47:15,322 - dq_comparison - INFO -   Source: 'nan' (type: float) ‚Üí 'NULL'
2026-02-05 12:47:15,322 - dq_comparison - INFO -   Target: 'james.davis@hotmail.com' (type: str) ‚Üí 'james.davis@hotmail.com'
2026-02-05 12:47:15,323 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-05 12:47:15,325 - dq_comparison - INFO - Column 'description' ‚Üí 'description':
2026-02-05 12:47:15,326 - dq_comparison - INFO -   Source: 'Text with{braces}' (type: str) ‚Üí 'text with{braces}'
2026-02-05 12:47:15,327 - dq_comparison - INFO -   Target: 'Text with{braces}' (type: str) ‚Üí 'text with{braces}'
2026-02-05 12:47:15,328 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-05 12:47:15,330 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-05 12:47:15,331 - dq_comparison - INFO -   Source: '237.49' (type: str) ‚Üí '237.49'
2026-02-05 12:47:15,332 - dq_comparison - INFO -   Target: '237.49' (type: float64) ‚Üí '237.49'
2026-02-05 12:47:15,333 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-05 12:47:15,334 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-05 12:47:15,337 - dq_comparison - INFO - Source hash string start: 1212392873a|2023-03-10|NULL...
2026-02-05 12:47:15,338 - dq_comparison - INFO - Target hash string start: 12123928735|2023-10-03|james.davis@hotmail.com...
2026-02-05 12:47:15,339 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-05 12:47:15,339 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-05 12:47:15,341 - dq_comparison - INFO - Column 1: 'phone' (object) ‚Üî 'phone' (object)
2026-02-05 12:47:15,341 - dq_comparison - INFO -   Sample: Source='212-127-8383', Target='212-127-8383'
2026-02-05 12:47:15,342 - dq_comparison - INFO - Column 2: 'transaction_date' (category) ‚Üî 'transaction_date' (object)
2026-02-05 12:47:15,343 - dq_comparison - INFO -   Sample: Source='04-10-2023', Target='2023-10-04 00:00:00'
2026-02-05 12:47:15,344 - dq_comparison - INFO - Column 3: 'email' (category) ‚Üî 'email' (object)
2026-02-05 12:47:15,345 - dq_comparison - INFO -   Sample: Source='david.jones@company', Target='david.jones@company.com'
2026-02-05 12:47:15,346 - dq_comparison - INFO - Column 4: 'description' (category) ‚Üî 'description' (object)
2026-02-05 12:47:15,346 - dq_comparison - INFO -   Sample: Source='Text with& ampersands', Target='Text with& ampersands'
2026-02-05 12:47:15,348 - dq_comparison - INFO - Column 5: 'amount' (object) ‚Üî 'amount' (float64)
2026-02-05 12:47:15,348 - dq_comparison - INFO -   Sample: Source='9999999.99', Target='8653.56'
2026-02-05 12:47:15,349 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-05 12:47:15,450 - dq_comparison - INFO - Found 75,654 total mismatches
2026-02-05 12:47:15,451 - dq_comparison - INFO - Will process detailed comparisons for first 5,000 rows
2026-02-05 12:47:24,749 - dq_comparison - INFO - Progress: 500/5,000 rows (9.4s)
2026-02-05 12:47:33,805 - dq_comparison - INFO - Progress: 1,000/5,000 rows (18.5s)
2026-02-05 12:47:42,766 - dq_comparison - INFO - Progress: 1,500/5,000 rows (27.4s)
2026-02-05 12:47:51,922 - dq_comparison - INFO - Progress: 2,000/5,000 rows (36.6s)
2026-02-05 12:48:01,211 - dq_comparison - INFO - Progress: 2,500/5,000 rows (45.9s)
2026-02-05 12:48:13,238 - dq_comparison - INFO - Progress: 3,000/5,000 rows (57.9s)
2026-02-05 12:48:23,035 - dq_comparison - INFO - Progress: 3,500/5,000 rows (67.7s)
2026-02-05 12:48:31,954 - dq_comparison - INFO - Progress: 4,000/5,000 rows (76.6s)
2026-02-05 12:48:41,009 - dq_comparison - INFO - Progress: 4,500/5,000 rows (85.7s)
2026-02-05 12:48:48,450 - dq_comparison - INFO - Progress: 5,000/5,000 rows (93.1s)
2026-02-05 12:48:48,511 - dq_comparison - INFO - 
================================================================================
2026-02-05 12:48:48,512 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-05 12:48:48,513 - dq_comparison - INFO -   Total mismatches found: 5000
2026-02-05 12:48:48,513 - dq_comparison - INFO -   Detailed comparisons logged: 5000
2026-02-05 12:48:48,514 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-05 12:48:48,515 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-05 12:48:48,515 - dq_comparison - INFO -   Use API to retrieve all 5000 mismatches
2026-02-05 12:48:48,516 - dq_comparison - INFO - ================================================================================
2026-02-05 12:48:48,585 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-05 12:48:48,586 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 89796
2026-02-05 12:48:48,586 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 100250
2026-02-05 12:48:48,586 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 57277
2026-02-05 12:48:48,587 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 57,406
2026-02-05 12:48:48,587 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 32,593
2026-02-05 12:48:48,588 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 43,094
2026-02-05 12:48:48,659 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-05 12:48:48,659 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-05 12:48:48,660 - dq_comparison - INFO -   Common rows: 57,406
2026-02-05 12:48:48,661 - dq_comparison - INFO -   Unique to source: 32,593
2026-02-05 12:48:48,662 - dq_comparison - INFO -   Unique to target: 43,094
2026-02-05 12:48:48,662 - dq_comparison - INFO -   Value mismatches: 908244
2026-02-05 12:48:48,663 - dq_comparison - INFO -   Missing rows: 32,593
2026-02-05 12:48:48,665 - dq_comparison - INFO -   Extra rows: 43,094
2026-02-05 12:48:48,672 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Mysql Database vs Excel (20260205_124104_Target_data_100k.xlsx (Target_data_100k))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
2     | 3          | phone: 212-127-8383                      | phone: 212-127-8383                     
3     | 3          | phone: NULL                              | phone: (212) 706-7216                   
4     | 4          | phone: 1212392873A                       | phone: 12123928735                      
5     | 2          | phone: 2125-982-408                      | phone: 2125982408                       
6     | 1          | phone: (212) 876-9757                    | phone: (212) 876-9757                   
7     | 3          | phone: NULL                              | phone: 212-752-8338                     
8     | 2          | phone: 212-648-2980                      | phone: 212-648-2980                     
9     | 3          | phone: 12128295968                       | phone: 12128295968                      
10    | 2          | phone: 2126087878                        | phone: 2126087878                       
11    | 1          | phone: 212-716-1479                      | phone: 212-716-1479                     
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 5000 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-05 12:48:48,673 - dq_comparison - INFO - Returning enhanced mismatch structure with 5000 detailed mismatches
2026-02-05 12:48:48,734 - dq_comparison - INFO - New structure: 100 detailed mismatches
2026-02-05 12:48:48,735 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-05 12:50:00,959 - dq_comparison - INFO - Null values - Source: 7442 (0.69%), Target: 8315 (0.69%)
2026-02-05 12:50:01,216 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 203, Target: 250
2026-02-05 12:50:01,325 - dq_comparison - INFO - Source duplicate samples: ['Row 169', 'Row 383', 'Row 639']
2026-02-05 12:50:01,465 - dq_comparison - INFO - Target duplicate samples: ['Row 169', 'Row 383', 'Row 639']
2026-02-05 12:50:01,568 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260205_124127
2026-02-05 12:50:01,569 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-05 12:50:01,570 - dq_comparison - INFO -   Source rows: 89999
2026-02-05 12:50:01,571 - dq_comparison - INFO -   Common rows (matched): 57406
2026-02-05 12:50:01,571 - dq_comparison - INFO -   Calculation: (57406 / 89999) * 100 = 63.79%
2026-02-05 12:50:01,572 - dq_comparison - INFO -   Explanation: 57406 matched rows out of 89999 total source rows
2026-02-05 12:50:01,573 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-05 12:50:01,573 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-05 12:50:01,574 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-05 12:50:01,575 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260205_124127
2026-02-05 12:50:01,575 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-05 12:50:01,599 - dq_audit - INFO - Inserted comparison record with ID: 888
2026-02-05 12:50:01,600 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 888)
2026-02-05 12:50:01,662 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260205_124127
2026-02-05 12:50:01,713 - dq_error_log - INFO - Retrieved summary: 5001 total errors for session CMP_20260205_124127
2026-02-05 12:50:01,714 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-05 12:50:01,730 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260205_124127
2026-02-05 12:50:01,730 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-05 12:50:01,731 - dq_comparison - INFO -    Session ID: CMP_20260205_124127
2026-02-05 12:50:01,732 - dq_comparison - INFO -    DQ Score (Simple %): 63.79%
2026-02-05 12:50:01,732 - dq_comparison - INFO -    Source rows: 89999
2026-02-05 12:50:01,733 - dq_comparison - INFO -    Matched rows: 57406
2026-02-05 12:50:01,733 - dq_comparison - INFO -    Calculation: (57406 / 89999) * 100
2026-02-05 12:50:01,735 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-05 12:50:01,792 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260205_124127
2026-02-05 12:50:01,865 - dq_error_log - INFO - Retrieved 200 error logs for session CMP_20260205_124127
2026-02-05 12:50:01,921 - dq_error_log - INFO - Retrieved summary: 5001 total errors for session CMP_20260205_124127
2026-02-05 12:50:01,939 - __main__ - INFO - Completed with status 200 in 536.466s
