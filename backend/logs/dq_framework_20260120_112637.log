2026-01-20 11:26:37,219 - root - INFO - CLI Mode Logging Initialized
2026-01-20 11:26:37,219 - root - INFO - CLI logs will be saved to: logs/dq_framework_20260120_112637.log
2026-01-20 11:26:37,219 - __main__ - INFO - ðŸš€ UNIVERSAL DATA QUALITY FRAMEWORK INITIALIZED
2026-01-20 11:26:37,220 - __main__ - INFO - Starting system resource check
2026-01-20 11:26:37,229 - __main__ - INFO - Total RAM: 15.7 GB
2026-01-20 11:26:37,231 - __main__ - INFO - Available RAM: 4.2 GB
2026-01-20 11:26:37,231 - __main__ - INFO - Memory used: 73.2%
2026-01-20 11:26:37,233 - __main__ - INFO - Memory status: OK
2026-01-20 11:26:37,234 - __main__ - INFO - Free disk space: 259.1 GB
2026-01-20 11:26:37,234 - __main__ - INFO - Disk used: 45.6%
2026-01-20 11:26:37,234 - __main__ - INFO - Disk space: OK
2026-01-20 11:26:37,735 - __main__ - INFO - CPU cores: 8
2026-01-20 11:26:37,735 - __main__ - INFO - CPU usage: 27.4%
2026-01-20 11:26:37,736 - __main__ - INFO - Python version: 3.12.4
2026-01-20 11:26:37,736 - __main__ - INFO - System platform: win32
2026-01-20 11:26:37,737 - __main__ - INFO - User session started at: 2026-01-20 11:26:37.737049
2026-01-20 11:26:37,737 - __main__ - INFO - Displaying main menu options to user
2026-01-20 11:26:44,131 - __main__ - INFO - User selected option: 4
2026-01-20 11:26:44,131 - __main__ - INFO - Starting Business Rules Engine module
2026-01-20 11:26:44,136 - dq_rules - INFO - STARTING BUSINESS RULES VALIDATION
2026-01-20 11:27:01,259 - dq_rules - INFO - Running quick test of dq_rules functionality
2026-01-20 11:27:01,279 - dq_rules - INFO - Column analysis completed for 6 columns
2026-01-20 11:27:01,279 - dq_rules - INFO - Generated 10 rule suggestions based on column analysis
2026-01-20 11:27:01,388 - dq_rules - INFO - Quick test completed: 5 passed, 0 failed
2026-01-20 11:28:08,753 - dq_rules - INFO - Starting complete DQ pipeline
2026-01-20 11:28:08,773 - dq_rules - INFO - Index already exists: idx_session_check
2026-01-20 11:28:08,774 - dq_rules - INFO - Index already exists: idx_error_type
2026-01-20 11:28:08,775 - dq_rules - INFO - Index already exists: idx_timestamp
2026-01-20 11:28:08,777 - dq_rules - INFO - Index already exists: idx_column_name
2026-01-20 11:28:08,780 - dq_rules - ERROR - Error optimizing database: 1146 (42S02): Table 'dq_checks.dq_audit_log' doesn't exist
2026-01-20 11:28:08,781 - dq_rules - INFO - LOADING DATA FOR BUSINESS RULES
2026-01-20 11:28:08,781 - dq_rules - INFO - === DEBUG load_data_for_rules ===
2026-01-20 11:28:08,782 - dq_rules - INFO - UI data type: <class 'NoneType'>
2026-01-20 11:28:08,782 - dq_rules - INFO - ===============================
2026-01-20 11:28:08,782 - dq_rules - INFO - Prompting user for data source type for rules
2026-01-20 11:29:29,145 - dq_rules - INFO - User selected source type: 3
2026-01-20 11:29:29,146 - dq_rules - INFO - Getting database configuration for rules - with navigator support
2026-01-20 11:29:30,947 - dq_rules - INFO - User selected Browse and Select mode
2026-01-20 11:29:30,956 - database_navigator - INFO - DatabaseNavigator initialized
2026-01-20 11:29:30,957 - database_navigator - INFO - Starting database navigation...
2026-01-20 11:29:37,797 - database_navigator - INFO - Database type: postgres
2026-01-20 11:29:37,799 - database_navigator - INFO - Getting database configuration...
2026-01-20 11:29:42,096 - database_navigator - INFO - Connecting to POSTGRES...
2026-01-20 11:29:42,097 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-20 11:29:42,099 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-01-20 11:29:42,210 - database_navigator - INFO - Connection object created: <connection object at 0x000001E03E1E79A0; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-01-20 11:29:42,224 - database_navigator - INFO - âœ… PostgreSQL connection successful to database: postgres
2026-01-20 11:29:42,226 - database_navigator - INFO - get_databases() called. db_type: postgres, connection exists: True
2026-01-20 11:29:42,340 - database_navigator - INFO - Raw rows: [('dq_checks',), ('finewise-testdb',), ('postgres',)]
2026-01-20 11:29:42,340 - database_navigator - INFO - Found 3 databases
2026-01-20 11:29:45,800 - database_navigator - INFO - Selected database: dq_checks
2026-01-20 11:29:45,801 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-01-20 11:29:45,802 - database_navigator - INFO - Connecting to POSTGRES...
2026-01-20 11:29:45,803 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-20 11:29:45,804 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-01-20 11:29:45,915 - database_navigator - INFO - Connection object created: <connection object at 0x000001E03E1E7890; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-01-20 11:29:45,925 - database_navigator - INFO - âœ… PostgreSQL connection successful to database: dq_checks
2026-01-20 11:29:46,038 - database_navigator - INFO - Found 4 schemas
2026-01-20 11:29:48,516 - database_navigator - INFO - Selected schema: public
2026-01-20 11:29:48,520 - database_navigator - INFO - Ensuring connection to database: dq_checks for table list
2026-01-20 11:29:48,521 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-01-20 11:29:48,521 - database_navigator - INFO - Connecting to POSTGRES...
2026-01-20 11:29:48,522 - database_navigator - INFO - Connecting to PostgreSQL...
2026-01-20 11:29:48,523 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-01-20 11:29:48,622 - database_navigator - INFO - Connection object created: <connection object at 0x000001E03E1E7AB0; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-01-20 11:29:48,623 - database_navigator - INFO - âœ… PostgreSQL connection successful to database: dq_checks
2026-01-20 11:29:48,630 - database_navigator - INFO - Connected to database: dq_checks, schema: public
2026-01-20 11:29:48,709 - database_navigator - INFO - Found 5 tables in dq_checks.public: ['comparison_small_target13', 'customers', 'customers_bkp', 'employee', 'stg_transactions']
2026-01-20 11:29:48,710 - database_navigator - INFO - Found 5 tables in schema 'public'
2026-01-20 11:29:54,193 - database_navigator - INFO - Selected table: customers
2026-01-20 11:29:54,201 - database_navigator - INFO - Selection complete: {'type': 'postgresql', 'database': 'dq_checks', 'schema': 'public', 'table': 'customers', 'selection_mode': 'hierarchical', 'host': 'localhost', 'port': '5432', 'user': 'postgres', 'password': 'postgres'}
2026-01-20 11:29:54,202 - dq_rules - INFO - Selected via navigation: dq_checks.public.customers
2026-01-20 11:29:54,202 - dq_rules - INFO - Source type: database, Source config: {'type': 'postgresql', 'host': 'localhost', 'port': '5432', 'database': 'dq_checks', 'schema': 'public', 'table': 'customers', 'user': 'postgres', 'password': 'postgres', 'selection_mode': 'hierarchical'}
2026-01-20 11:29:54,202 - dq_unified - INFO - Loading data from DATABASE
2026-01-20 11:29:54,202 - dq_unified - INFO - Loading large database table: customers
2026-01-20 11:29:54,203 - dq_unified - INFO - Normalized DB config with schema: public
2026-01-20 11:29:54,312 - dq_unified - INFO - PostgreSQL table public.customers has 15 rows
2026-01-20 11:29:54,312 - dq_unified - INFO - Loading 15 rows from PostgreSQL...
2026-01-20 11:29:55,284 - dq_unified - INFO - Loaded 15 rows from PostgreSQL
2026-01-20 11:29:55,289 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-01-20 11:29:55,290 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 110.7MB total, 0.0MB for dataframe
2026-01-20 11:29:55,290 - dq_rules - INFO - Loaded data: 15 rows, 10 columns
2026-01-20 11:29:55,291 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-01-20 11:29:55,291 - dq_rules - INFO - DEFINING CUSTOM BUSINESS RULES
2026-01-20 11:29:55,291 - dq_rules - INFO - Available columns: ['customername', 'email', 'phone', 'salary', 'department', 'joindate', 'postalcode', 'city', 'country', 'state']
2026-01-20 11:29:55,292 - dq_rules - INFO - Available columns: ['customername', 'email', 'phone', 'salary', 'department', 'joindate', 'postalcode', 'city', 'country', 'state']
2026-01-20 11:30:11,388 - dq_rules - INFO - Loading rules from metadata database...
2026-01-20 11:30:11,439 - dq_rules - INFO - Loaded 1 rules from metadata
2026-01-20 11:30:11,441 - dq_rules - INFO - Converted enhanced metadata rule: Test Email Rule (pattern)
2026-01-20 11:30:11,442 - dq_rules - INFO - Successfully converted 1 metadata rules
2026-01-20 11:30:11,443 - dq_rules - INFO - EXECUTING 1 BUSINESS RULES
2026-01-20 11:30:11,445 - dq_rules - INFO - Executing rule: Test Email Rule
2026-01-20 11:30:11,445 - dq_rules - INFO - Safe executing enhanced rule: Test Email Rule (pattern)
2026-01-20 11:30:11,446 - dq_rules - INFO - Executing pattern rule: Test email validation
2026-01-20 11:30:11,448 - dq_rules - INFO - Pattern rule 'Test email validation': 2 pattern violations found
2026-01-20 11:30:11,449 - dq_error_log - INFO - Starting batch logging for 2 errors, session: DQ_PIPELINE_20260120_112955
2026-01-20 11:30:11,472 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-01-20 11:30:11,472 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-01-20 11:30:11,472 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session DQ_PIPELINE_20260120_112955
2026-01-20 11:30:11,473 - dq_rules - WARNING - 2 pattern violations found
2026-01-20 11:30:11,497 - dq_rules - INFO - Logged rule execution: Test Email Rule - FAIL (ID: 1)
2026-01-20 11:30:11,500 - dq_rules - INFO - Rule 'Test email validation' completed with status: FAIL
2026-01-20 11:30:11,500 - dq_rules - INFO - TOTAL VIOLATIONS ACROSS ALL RULES: 2
2026-01-20 11:30:11,501 - dq_rules - INFO - GENERATING BUSINESS RULES VALIDATION REPORT
2026-01-20 11:30:11,501 - dq_rules - INFO - Report for: Database: postgresql - Table: customers, Records: 15, Columns: 10
2026-01-20 11:30:11,511 - dq_error_log - INFO - Retrieved 2 errors for session DQ_PIPELINE_20260120_112955
2026-01-20 11:30:11,512 - dq_rules - INFO - DQ Score Calculation: Total=15, Bad=2, Good=13, Score=86.67%, Grade=B
2026-01-20 11:30:11,515 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-01-20 11:30:11,515 - dq_audit - INFO - Starting database insertion for rules...
2026-01-20 11:30:11,534 - dq_audit - INFO - Inserted rules record with ID: 804
2026-01-20 11:30:11,535 - dq_rules - INFO - Audit record logged with ID: 804
2026-01-20 11:30:11,543 - dq_rules - INFO - RULES SUMMARY: Total Rules: 1, Passed: 0, Failed: 1, Errors: 0, Total Violations: 2
2026-01-20 11:30:11,557 - dq_error_log - INFO - Retrieved 2 errors for session DQ_PIPELINE_20260120_112955
2026-01-20 11:30:11,574 - dq_rules - INFO - ERROR LOGGING: Session ID: DQ_PIPELINE_20260120_112955, Total errors logged: 2
2026-01-20 11:30:11,576 - dq_rules - INFO - Complete DQ pipeline completed for session: DQ_PIPELINE_20260120_112955
2026-01-20 11:30:11,582 - __main__ - INFO - Business Rules Engine completed successfully
2026-01-20 11:30:11,582 - __main__ - INFO - Displaying main menu options to user
2026-01-20 11:30:17,147 - __main__ - INFO - User selected option: 6
2026-01-20 11:30:17,148 - __main__ - INFO - User session ended. Duration: 0:03:39.410345
2026-01-20 11:30:17,149 - __main__ - INFO - ðŸ‘‹ Thank you for using Universal Data Quality Framework!
