2026-02-14 15:13:43,552 - __main__ - INFO - üåê API Server Logging Initialized
2026-02-14 15:13:43,553 - __main__ - INFO - üìù Logs saved to: logs/dq_api_20260214_151343.log
2026-02-14 15:13:43,713 - __main__ - INFO - APP_SETTINGS loaded. Audit enabled: True
2026-02-14 15:13:43,715 - __main__ - INFO - ‚úÖ All DQ modules loaded successfully
2026-02-14 15:13:43,717 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:13:43,717 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:13:43,718 - __main__ - INFO - ‚úÖ ErrorLogger and DataQualityAudit initialized
2026-02-14 15:13:43,730 - __main__ - INFO - üöÄ Starting Data Quality Framework API
2026-02-14 15:13:43,731 - __main__ - INFO - üìä Modules available: True
2026-02-14 15:13:43,731 - __main__ - INFO - üîß Config file mode: False
2026-02-14 15:13:43,732 - __main__ - INFO - üìã Available endpoints:
2026-02-14 15:13:43,733 - __main__ - INFO -   GET  /              - API status
2026-02-14 15:13:43,733 - __main__ - INFO -   GET  /api/health    - Health check
2026-02-14 15:13:43,734 - __main__ - INFO -   POST /api/check-single - Single source analysis
2026-02-14 15:13:43,735 - __main__ - INFO -   POST /api/compare   - Source-target comparison
2026-02-14 15:13:43,735 - __main__ - INFO -   GET  /api/compare/{id} - Get comparison results
2026-02-14 15:13:43,736 - __main__ - INFO -   GET  /api/compare/{id}/mismatches - Paginated mismatches
2026-02-14 15:13:43,736 - __main__ - INFO -   GET  /api/compare/{id}/rows/count - Row counts
2026-02-14 15:13:43,737 - __main__ - INFO -   POST /api/upload    - File upload
2026-02-14 15:13:43,737 - __main__ - INFO -   GET  /api/sessions  - List sessions
2026-02-14 15:13:43,738 - __main__ - INFO -   GET  /api/sessions/<id> - Get session data
2026-02-14 15:13:43,738 - __main__ - INFO -   GET  /api/debug-db  - Database debug
2026-02-14 15:13:43,739 - __main__ - INFO - üåç Server starting on 0.0.0.0:5000 (debug=False)
2026-02-14 15:14:11,782 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:14:11,793 - __main__ - INFO - File uploaded: 20260214_151411_SINGLE_SOURCE_15.csv (csv)
2026-02-14 15:14:11,794 - __main__ - INFO - Completed with status 200 in 0.013s
2026-02-14 15:14:12,125 - __main__ - INFO - POST /api/check-single - Request started
2026-02-14 15:14:12,127 - __main__ - INFO - Single source analysis request received
2026-02-14 15:14:12,128 - __main__ - INFO - Starting analysis for session SINGLE_20260214_151412_ff051a9d
2026-02-14 15:14:12,130 - __main__ - INFO - UI Data being passed to dq_unified:
2026-02-14 15:14:12,131 - __main__ - INFO -   source_type: csv
2026-02-14 15:14:12,132 - __main__ - INFO -   file_path: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151411_SINGLE_SOURCE_15.csv
2026-02-14 15:14:12,133 - __main__ - INFO -   sheet_name: None
2026-02-14 15:14:12,134 - __main__ - INFO -   mandatory_fields: all
2026-02-14 15:14:12,135 - dq_unified - INFO - ==================================================
2026-02-14 15:14:12,135 - dq_unified - INFO - RUN_SINGLE_SOURCE_ANALYSIS_UI - START
2026-02-14 15:14:12,136 - dq_unified - INFO - Prompting user for data source type
2026-02-14 15:14:12,137 - dq_unified - INFO - UI Data source_type: csv
2026-02-14 15:14:12,137 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-14 15:14:12,137 - dq_unified - INFO - Loading data from CSV...
2026-02-14 15:14:12,138 - dq_unified - INFO - Loading data from CSV
2026-02-14 15:14:12,138 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151411_SINGLE_SOURCE_15.csv
2026-02-14 15:14:12,141 - dq_unified - INFO - CSV file has 27 rows
2026-02-14 15:14:12,141 - dq_unified - INFO - Loading 27 rows from CSV...
2026-02-14 15:14:12,150 - dq_unified - INFO - Loaded 27 rows from CSV
2026-02-14 15:14:12,156 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:14:12,157 - dq_unified - INFO - Loaded 27 rows, 9 columns. Memory: 103.8MB total, 0.0MB for dataframe
2026-02-14 15:14:12,158 - dq_unified - INFO - Data loaded: 27 rows, 9 columns
2026-02-14 15:14:12,158 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:14:12,158 - dq_unified - INFO - Session ID: SINGLE_20260214_151412
2026-02-14 15:14:12,159 - dq_unified - INFO - Column data types collected: 9 columns
2026-02-14 15:14:12,160 - dq_unified - INFO - ==================================================
2026-02-14 15:14:12,160 - dq_unified - INFO - Starting quality checks...
2026-02-14 15:14:12,161 - dq_unified - INFO - ==================================================
2026-02-14 15:14:12,161 - dq_unified - INFO - 1. Checking for null/empty values...
2026-02-14 15:14:12,162 - dq_unified - INFO - Checking for null/empty values
2026-02-14 15:14:12,162 - dq_unified - INFO - DataFrame shape: (27, 9)
2026-02-14 15:14:12,163 - dq_unified - INFO - Columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:12,163 - dq_unified - INFO - Data source: CSV: 20260214_151411_SINGLE_SOURCE_15.csv
2026-02-14 15:14:12,164 - dq_unified - INFO - DataFrame dtypes: {'transaction_id': dtype('O'), 'account_id': dtype('O'), 'customer_email': dtype('O'), 'transaction_date': CategoricalDtype(categories=['1/1/2024', '2024/31/12', '31-12-2024'], ordered=False, categories_dtype=object), 'amount': dtype('O'), 'currency': CategoricalDtype(categories=['USD'], ordered=False, categories_dtype=object), 'country': CategoricalDtype(categories=['US'], ordered=False, categories_dtype=object), 'status': CategoricalDtype(categories=['SUCCESS'], ordered=False, categories_dtype=object), 'remarks': CategoricalDtype(categories=['OK'], ordered=False, categories_dtype=object)}
2026-02-14 15:14:12,165 - dq_unified - INFO - First 2 rows (first 3 columns only):
2026-02-14 15:14:12,166 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': "'AC000001'", 'customer_email': "'user1@bank.com'"}
2026-02-14 15:14:12,167 - dq_unified - INFO -   Row 1: {'transaction_id': "'TXN2'", 'account_id': "'AC000002'", 'customer_email': "'user2@bank.com'"}
2026-02-14 15:14:12,178 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:12,179 - dq_unified - INFO -   Not missing samples: ["'TXN2'", "'TXN3'", "'TXN4'"]
2026-02-14 15:14:12,180 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (3.7%)
2026-02-14 15:14:12,180 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (3.7%)
2026-02-14 15:14:12,181 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151412
2026-02-14 15:14:12,412 - mysql.connector - INFO - package: mysql.connector.plugins
2026-02-14 15:14:12,413 - mysql.connector - INFO - plugin_name: caching_sha2_password
2026-02-14 15:14:12,414 - mysql.connector - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLCachingSHA2PasswordAuthPlugin
2026-02-14 15:14:12,415 - mysql.connector - INFO - package: mysql.connector.plugins
2026-02-14 15:14:12,416 - mysql.connector - INFO - plugin_name: mysql_native_password
2026-02-14 15:14:12,421 - mysql.connector - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2026-02-14 15:14:12,432 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:12,433 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:12,434 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151412
2026-02-14 15:14:12,443 - dq_unified - INFO - Column 'account_id': No missing cells
2026-02-14 15:14:12,451 - dq_unified - INFO - Column 'customer_email': No missing cells
2026-02-14 15:14:12,458 - dq_unified - INFO - Column 'transaction_date': No missing cells
2026-02-14 15:14:12,467 - dq_unified - INFO - Column 'amount': No missing cells
2026-02-14 15:14:12,476 - dq_unified - INFO - Column 'currency': No missing cells
2026-02-14 15:14:12,482 - dq_unified - INFO - Column 'country': No missing cells
2026-02-14 15:14:12,492 - dq_unified - INFO - Column 'status': No missing cells
2026-02-14 15:14:12,500 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:12,501 - dq_unified - INFO -   Not missing samples: ["'OK'", "'OK'", "'OK'"]
2026-02-14 15:14:12,501 - dq_unified - WARNING - Column 'remarks': 1 missing cells (3.7%)
2026-02-14 15:14:12,502 - dq_unified - WARNING - Column 'remarks': 1 missing cells (3.7%)
2026-02-14 15:14:12,502 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151412
2026-02-14 15:14:12,584 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:12,585 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:12,586 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151412
2026-02-14 15:14:12,587 - dq_unified - INFO - Total missing cells found: 2
2026-02-14 15:14:12,587 - dq_unified - INFO - ============================================================
2026-02-14 15:14:12,588 - dq_unified - INFO - MISSING VALUE SUMMARY
2026-02-14 15:14:12,588 - dq_unified - INFO - ============================================================
2026-02-14 15:14:12,588 - dq_unified - INFO - transaction_id: 1 missing (3.7%)
2026-02-14 15:14:12,589 - dq_unified - INFO - remarks: 1 missing (3.7%)
2026-02-14 15:14:12,589 - dq_unified - INFO - ============================================================
2026-02-14 15:14:12,589 - dq_unified - INFO -    Found 2 empty cells
2026-02-14 15:14:12,590 - dq_unified - INFO - 2. Checking for duplicate rows...
2026-02-14 15:14:12,590 - dq_unified - INFO - Checking for duplicate rows
2026-02-14 15:14:12,590 - dq_unified - INFO - Cleaning data (removing whitespace)...
2026-02-14 15:14:12,591 - dq_unified - INFO - Columns after cleaning: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:12,596 - dq_unified - INFO - Sample of first column after cleaning: 'nan'
2026-02-14 15:14:12,596 - dq_unified - INFO - Sample of row 6 first column: 'TXN6'
2026-02-14 15:14:12,597 - dq_unified - INFO - Total rows to check: 27
2026-02-14 15:14:12,597 - dq_unified - INFO - Checking first column 'transaction_id' for serial numbers
2026-02-14 15:14:12,598 - dq_unified - INFO - First 5 values: ['nan', 'TXN2', 'TXN3', 'TXN4', 'TXN5']
2026-02-14 15:14:12,598 - dq_unified - INFO -   Row 1: 'nan' ‚Üí nan (numeric)
2026-02-14 15:14:12,599 - dq_unified - INFO -   Row 2: 'TXN2' ‚Üí Not numeric
2026-02-14 15:14:12,599 - dq_unified - INFO -   Row 3: 'TXN3' ‚Üí Not numeric
2026-02-14 15:14:12,599 - dq_unified - INFO - Not enough numeric values to be serial: [nan]
2026-02-14 15:14:12,600 - dq_unified - INFO - Checking duplicates on ALL columns
2026-02-14 15:14:12,600 - dq_unified - INFO - First few rows for comparison:
2026-02-14 15:14:12,601 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': 'AC000001', 'customer_email': 'user1@bank.com'}
2026-02-14 15:14:12,601 - dq_unified - INFO -   Row 1: {'transaction_id': 'TXN2', 'account_id': 'AC000002', 'customer_email': 'user2@bank.com'}
2026-02-14 15:14:12,602 - dq_unified - INFO -   Row 2: {'transaction_id': 'TXN3', 'account_id': 'AC000003', 'customer_email': 'bademail.com'}
2026-02-14 15:14:12,603 - dq_unified - INFO - Duplicate mask found 24 rows
2026-02-14 15:14:12,604 - dq_unified - INFO - Found 24 potential duplicate rows
2026-02-14 15:14:12,605 - dq_unified - INFO - Unique duplicate groups: 12
2026-02-14 15:14:12,605 - dq_unified - INFO - Duplicate groups found:
2026-02-14 15:14:12,606 - dq_unified - INFO -   Group sample: Pandas(Index=3, transaction_id='TXN4', account_id='AC000004', customer_email='user4@bank.com', transaction_date='2024/31/12', amount='1003', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:14:12,607 - dq_unified - INFO -   Group sample: Pandas(Index=4, transaction_id='TXN5', account_id='AC000005', customer_email='user5@bank.com', transaction_date='1/1/2024', amount='12,000$', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:14:12,607 - dq_unified - INFO -   Group sample: Pandas(Index=5, transaction_id='TXN6', account_id='AC000006', customer_email='user6@bank.com', transaction_date='31-12-2024', amount='1005', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:14:12,608 - dq_unified - INFO - Processing 24 duplicate indices
2026-02-14 15:14:12,609 - dq_unified - INFO - FINAL RESULT: Found 24 duplicate groups
2026-02-14 15:14:12,610 - dq_error_log - INFO - Starting batch logging for 24 errors, session: SINGLE_20260214_151412
2026-02-14 15:14:12,687 - dq_error_log - INFO - Batch 1: Successfully logged 24 errors
2026-02-14 15:14:12,689 - dq_error_log - INFO - Progress: 24/24 errors processed
2026-02-14 15:14:12,689 - dq_error_log - INFO - COMPLETE: Logged 24/24 errors for session SINGLE_20260214_151412
2026-02-14 15:14:12,690 - dq_unified - INFO -    Found 24 duplicate rows
2026-02-14 15:14:12,691 - dq_unified - INFO - 3. Checking data formats...
2026-02-14 15:14:12,691 - dq_unified - INFO - Checking data formats
2026-02-14 15:14:12,695 - dq_unified - INFO - Detected customer_email as email type
2026-02-14 15:14:12,696 - dq_unified - WARNING -   Row 3: 'bademail.com...' doesn't match Valid email format (user@domain.com)
2026-02-14 15:14:12,698 - dq_unified - INFO - Detected amount as numeric type
2026-02-14 15:14:12,699 - dq_unified - WARNING -   Row 5: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 15:14:12,699 - dq_unified - WARNING -   Row 17: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 15:14:12,706 - dq_unified - INFO - Total format issues found: 3
2026-02-14 15:14:12,707 - dq_error_log - INFO - Starting batch logging for 3 errors, session: SINGLE_20260214_151412
2026-02-14 15:14:12,789 - dq_error_log - INFO - Batch 1: Successfully logged 3 errors
2026-02-14 15:14:12,790 - dq_error_log - INFO - Progress: 3/3 errors processed
2026-02-14 15:14:12,790 - dq_error_log - INFO - COMPLETE: Logged 3/3 errors for session SINGLE_20260214_151412
2026-02-14 15:14:12,791 - dq_unified - INFO -    Found 3 format issues
2026-02-14 15:14:12,792 - dq_unified - INFO - 4. Checking mandatory fields...
2026-02-14 15:14:12,792 - dq_unified - INFO - Checking mandatory fields
2026-02-14 15:14:12,792 - dq_unified - INFO - Available columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:12,793 - dq_unified - INFO - Checking ALL columns as mandatory: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:12,800 - dq_unified - WARNING - Mandatory field 'transaction_id': 1 missing values (96.3% filled)
2026-02-14 15:14:12,807 - dq_unified - INFO - Mandatory field 'account_id': 100.0% filled
2026-02-14 15:14:12,814 - dq_unified - INFO - Mandatory field 'customer_email': 100.0% filled
2026-02-14 15:14:12,823 - dq_unified - INFO - Mandatory field 'transaction_date': 100.0% filled
2026-02-14 15:14:12,830 - dq_unified - INFO - Mandatory field 'amount': 100.0% filled
2026-02-14 15:14:12,837 - dq_unified - INFO - Mandatory field 'currency': 100.0% filled
2026-02-14 15:14:12,843 - dq_unified - INFO - Mandatory field 'country': 100.0% filled
2026-02-14 15:14:12,849 - dq_unified - INFO - Mandatory field 'status': 100.0% filled
2026-02-14 15:14:12,856 - dq_unified - WARNING - Mandatory field 'remarks': 1 missing values (96.3% filled)
2026-02-14 15:14:12,921 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_151412
2026-02-14 15:14:13,001 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 15:14:13,002 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 15:14:13,003 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_151412
2026-02-14 15:14:13,004 - dq_unified - INFO - All columns mandatory: 2 unique rows with missing values
2026-02-14 15:14:13,004 - dq_unified - INFO -    Found 2 missing mandatory values
2026-02-14 15:14:13,005 - dq_unified - INFO - 5. Calculating quality score...
2026-02-14 15:14:13,005 - dq_unified - INFO - Calculating quality score
2026-02-14 15:14:13,006 - dq_unified - INFO - Quality Score Calculation:
2026-02-14 15:14:13,006 - dq_unified - INFO -   Total rows: 27
2026-02-14 15:14:13,006 - dq_unified - INFO -   Bad Rows: 27
2026-02-14 15:14:13,007 - dq_unified - INFO -   Good rows (no issues): 0
2026-02-14 15:14:13,007 - dq_unified - INFO -   Quality Score: 0.0%
2026-02-14 15:14:13,095 - dq_error_log - INFO - Retrieved 31 error logs for session SINGLE_20260214_151412
2026-02-14 15:14:13,184 - dq_error_log - INFO - Retrieved summary: 31 total errors for session SINGLE_20260214_151412
2026-02-14 15:14:13,185 - dq_unified - INFO - Added 31 error logs to results
2026-02-14 15:14:13,186 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:14:13,187 - dq_audit - INFO - Starting database insertion for single_source...
2026-02-14 15:14:13,274 - dq_audit - INFO - Inserted single_source record with ID: 556
2026-02-14 15:14:13,360 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151412
2026-02-14 15:14:13,362 - dq_unified - INFO - Added 1 audit logs to results
2026-02-14 15:14:13,362 - dq_unified - INFO - Analysis completed successfully for CSV: 20260214_151411_SINGLE_SOURCE_15.csv
2026-02-14 15:14:13,363 - dq_unified - INFO - Final quality score: 0.0%
2026-02-14 15:14:13,455 - dq_error_log - INFO - Retrieved 31 error logs for session SINGLE_20260214_151412
2026-02-14 15:14:13,535 - dq_error_log - INFO - Retrieved summary: 31 total errors for session SINGLE_20260214_151412
2026-02-14 15:14:13,628 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151412
2026-02-14 15:14:13,630 - __main__ - INFO - Analysis completed for session SINGLE_20260214_151412
2026-02-14 15:14:13,633 - __main__ - INFO - Completed with status 200 in 1.508s
2026-02-14 15:14:13,686 - __main__ - INFO - GET /api/single/SINGLE_20260214_151412/errors - Request started
2026-02-14 15:14:13,691 - __main__ - INFO - Completed with status 200 in 0.004s
2026-02-14 15:14:14,013 - __main__ - INFO - GET /api/single/SINGLE_20260214_151412/errors - Request started
2026-02-14 15:14:14,014 - __main__ - INFO - Completed with status 200 in 0.001s
2026-02-14 15:14:41,281 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:14:41,296 - __main__ - INFO - File uploaded: 20260214_151441_SINGLE_SOURCE_100.csv (csv)
2026-02-14 15:14:41,301 - __main__ - INFO - Completed with status 200 in 0.021s
2026-02-14 15:14:41,320 - __main__ - INFO - POST /api/check-single - Request started
2026-02-14 15:14:41,322 - __main__ - INFO - Single source analysis request received
2026-02-14 15:14:41,323 - __main__ - INFO - Starting analysis for session SINGLE_20260214_151441_67bc2e14
2026-02-14 15:14:41,324 - __main__ - INFO - UI Data being passed to dq_unified:
2026-02-14 15:14:41,326 - __main__ - INFO -   source_type: csv
2026-02-14 15:14:41,327 - __main__ - INFO -   file_path: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151441_SINGLE_SOURCE_100.csv
2026-02-14 15:14:41,327 - __main__ - INFO -   sheet_name: None
2026-02-14 15:14:41,329 - __main__ - INFO -   mandatory_fields: all
2026-02-14 15:14:41,331 - dq_unified - INFO - ==================================================
2026-02-14 15:14:41,332 - dq_unified - INFO - RUN_SINGLE_SOURCE_ANALYSIS_UI - START
2026-02-14 15:14:41,333 - dq_unified - INFO - Prompting user for data source type
2026-02-14 15:14:41,334 - dq_unified - INFO - UI Data source_type: csv
2026-02-14 15:14:41,334 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-14 15:14:41,335 - dq_unified - INFO - Loading data from CSV...
2026-02-14 15:14:41,335 - dq_unified - INFO - Loading data from CSV
2026-02-14 15:14:41,336 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151441_SINGLE_SOURCE_100.csv
2026-02-14 15:14:41,338 - dq_unified - INFO - CSV file has 101 rows
2026-02-14 15:14:41,339 - dq_unified - INFO - Loading 101 rows from CSV...
2026-02-14 15:14:41,344 - dq_unified - INFO - Loaded 101 rows from CSV
2026-02-14 15:14:41,351 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:14:41,353 - dq_unified - INFO - Loaded 101 rows, 9 columns. Memory: 111.3MB total, 0.0MB for dataframe
2026-02-14 15:14:41,355 - dq_unified - INFO - Data loaded: 101 rows, 9 columns
2026-02-14 15:14:41,356 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:14:41,356 - dq_unified - INFO - Session ID: SINGLE_20260214_151441
2026-02-14 15:14:41,357 - dq_unified - INFO - Column data types collected: 9 columns
2026-02-14 15:14:41,357 - dq_unified - INFO - ==================================================
2026-02-14 15:14:41,358 - dq_unified - INFO - Starting quality checks...
2026-02-14 15:14:41,358 - dq_unified - INFO - ==================================================
2026-02-14 15:14:41,359 - dq_unified - INFO - 1. Checking for null/empty values...
2026-02-14 15:14:41,359 - dq_unified - INFO - Checking for null/empty values
2026-02-14 15:14:41,359 - dq_unified - INFO - DataFrame shape: (101, 9)
2026-02-14 15:14:41,360 - dq_unified - INFO - Columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:41,361 - dq_unified - INFO - Data source: CSV: 20260214_151441_SINGLE_SOURCE_100.csv
2026-02-14 15:14:41,362 - dq_unified - INFO - DataFrame dtypes: {'transaction_id': dtype('O'), 'account_id': dtype('O'), 'customer_email': dtype('O'), 'transaction_date': CategoricalDtype(categories=['1/1/2024', '2024/31/12', '31-12-2024'], ordered=False, categories_dtype=object), 'amount': dtype('O'), 'currency': CategoricalDtype(categories=['USD'], ordered=False, categories_dtype=object), 'country': CategoricalDtype(categories=['US'], ordered=False, categories_dtype=object), 'status': CategoricalDtype(categories=['SUCCESS'], ordered=False, categories_dtype=object), 'remarks': CategoricalDtype(categories=['OK'], ordered=False, categories_dtype=object)}
2026-02-14 15:14:41,362 - dq_unified - INFO - First 2 rows (first 3 columns only):
2026-02-14 15:14:41,364 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': "'AC000001'", 'customer_email': "'user1@bank.com'"}
2026-02-14 15:14:41,365 - dq_unified - INFO -   Row 1: {'transaction_id': "'TXN2'", 'account_id': "'AC000002'", 'customer_email': "'user2@bank.com'"}
2026-02-14 15:14:41,376 - dq_unified - INFO -   Missing samples: ['nan', 'nan']
2026-02-14 15:14:41,377 - dq_unified - INFO -   Not missing samples: ["'TXN2'", "'TXN3'", "'TXN4'"]
2026-02-14 15:14:41,377 - dq_unified - WARNING - Column 'transaction_id': 2 missing cells (2.0%)
2026-02-14 15:14:41,378 - dq_unified - WARNING - Column 'transaction_id': 2 missing cells (2.0%)
2026-02-14 15:14:41,379 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:41,477 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 15:14:41,479 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 15:14:41,480 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_151441
2026-02-14 15:14:41,489 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:41,490 - dq_unified - INFO -   Not missing samples: ["'AC000001'", "'AC000002'", "'AC000003'"]
2026-02-14 15:14:41,490 - dq_unified - WARNING - Column 'account_id': 1 missing cells (1.0%)
2026-02-14 15:14:41,491 - dq_unified - WARNING - Column 'account_id': 1 missing cells (1.0%)
2026-02-14 15:14:41,491 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:41,586 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:41,587 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:41,588 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151441
2026-02-14 15:14:41,597 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:41,598 - dq_unified - INFO -   Not missing samples: ["'user1@bank.com'", "'user2@bank.com'", "'bademail.com'"]
2026-02-14 15:14:41,598 - dq_unified - WARNING - Column 'customer_email': 1 missing cells (1.0%)
2026-02-14 15:14:41,599 - dq_unified - WARNING - Column 'customer_email': 1 missing cells (1.0%)
2026-02-14 15:14:41,600 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:41,685 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:41,686 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:41,687 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151441
2026-02-14 15:14:41,695 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:41,696 - dq_unified - INFO -   Not missing samples: ["'1/1/2024'", "'1/1/2024'", "'1/1/2024'"]
2026-02-14 15:14:41,696 - dq_unified - WARNING - Column 'transaction_date': 1 missing cells (1.0%)
2026-02-14 15:14:41,697 - dq_unified - WARNING - Column 'transaction_date': 1 missing cells (1.0%)
2026-02-14 15:14:41,697 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:41,780 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:41,782 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:41,783 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151441
2026-02-14 15:14:41,792 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:41,793 - dq_unified - INFO -   Not missing samples: ["'1000'", "'1001'", "'1002'"]
2026-02-14 15:14:41,795 - dq_unified - WARNING - Column 'amount': 1 missing cells (1.0%)
2026-02-14 15:14:41,796 - dq_unified - WARNING - Column 'amount': 1 missing cells (1.0%)
2026-02-14 15:14:41,797 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:41,888 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:41,889 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:41,890 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151441
2026-02-14 15:14:41,900 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:41,901 - dq_unified - INFO -   Not missing samples: ["'USD'", "'USD'", "'USD'"]
2026-02-14 15:14:41,901 - dq_unified - WARNING - Column 'currency': 1 missing cells (1.0%)
2026-02-14 15:14:41,902 - dq_unified - WARNING - Column 'currency': 1 missing cells (1.0%)
2026-02-14 15:14:41,903 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:41,987 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:41,988 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:41,989 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151441
2026-02-14 15:14:42,000 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:42,001 - dq_unified - INFO -   Not missing samples: ["'US'", "'US'", "'US'"]
2026-02-14 15:14:42,002 - dq_unified - WARNING - Column 'country': 1 missing cells (1.0%)
2026-02-14 15:14:42,003 - dq_unified - WARNING - Column 'country': 1 missing cells (1.0%)
2026-02-14 15:14:42,004 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:42,084 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:42,085 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:42,086 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151441
2026-02-14 15:14:42,093 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:14:42,095 - dq_unified - INFO -   Not missing samples: ["'SUCCESS'", "'SUCCESS'", "'SUCCESS'"]
2026-02-14 15:14:42,096 - dq_unified - WARNING - Column 'status': 1 missing cells (1.0%)
2026-02-14 15:14:42,096 - dq_unified - WARNING - Column 'status': 1 missing cells (1.0%)
2026-02-14 15:14:42,097 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:42,177 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:14:42,179 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:14:42,179 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151441
2026-02-14 15:14:42,187 - dq_unified - INFO -   Missing samples: ['nan', 'nan']
2026-02-14 15:14:42,188 - dq_unified - INFO -   Not missing samples: ["'OK'", "'OK'", "'OK'"]
2026-02-14 15:14:42,188 - dq_unified - WARNING - Column 'remarks': 2 missing cells (2.0%)
2026-02-14 15:14:42,189 - dq_unified - WARNING - Column 'remarks': 2 missing cells (2.0%)
2026-02-14 15:14:42,189 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:42,272 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 15:14:42,274 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 15:14:42,274 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_151441
2026-02-14 15:14:42,275 - dq_unified - INFO - Total missing cells found: 11
2026-02-14 15:14:42,276 - dq_unified - INFO - ============================================================
2026-02-14 15:14:42,276 - dq_unified - INFO - MISSING VALUE SUMMARY
2026-02-14 15:14:42,276 - dq_unified - INFO - ============================================================
2026-02-14 15:14:42,278 - dq_unified - INFO - transaction_id: 2 missing (2.0%)
2026-02-14 15:14:42,279 - dq_unified - INFO - account_id: 1 missing (1.0%)
2026-02-14 15:14:42,279 - dq_unified - INFO - customer_email: 1 missing (1.0%)
2026-02-14 15:14:42,280 - dq_unified - INFO - transaction_date: 1 missing (1.0%)
2026-02-14 15:14:42,280 - dq_unified - INFO - amount: 1 missing (1.0%)
2026-02-14 15:14:42,281 - dq_unified - INFO - currency: 1 missing (1.0%)
2026-02-14 15:14:42,281 - dq_unified - INFO - country: 1 missing (1.0%)
2026-02-14 15:14:42,282 - dq_unified - INFO - status: 1 missing (1.0%)
2026-02-14 15:14:42,282 - dq_unified - INFO - remarks: 2 missing (2.0%)
2026-02-14 15:14:42,283 - dq_unified - INFO - ============================================================
2026-02-14 15:14:42,283 - dq_unified - INFO -    Found 11 empty cells
2026-02-14 15:14:42,284 - dq_unified - INFO - 2. Checking for duplicate rows...
2026-02-14 15:14:42,285 - dq_unified - INFO - Checking for duplicate rows
2026-02-14 15:14:42,285 - dq_unified - INFO - Cleaning data (removing whitespace)...
2026-02-14 15:14:42,286 - dq_unified - INFO - Columns after cleaning: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:42,293 - dq_unified - INFO - Sample of first column after cleaning: 'nan'
2026-02-14 15:14:42,294 - dq_unified - INFO - Sample of row 6 first column: 'TXN6'
2026-02-14 15:14:42,295 - dq_unified - INFO - Total rows to check: 101
2026-02-14 15:14:42,296 - dq_unified - INFO - Checking first column 'transaction_id' for serial numbers
2026-02-14 15:14:42,297 - dq_unified - INFO - First 5 values: ['nan', 'TXN2', 'TXN3', 'TXN4', 'TXN5']
2026-02-14 15:14:42,297 - dq_unified - INFO -   Row 1: 'nan' ‚Üí nan (numeric)
2026-02-14 15:14:42,298 - dq_unified - INFO -   Row 2: 'TXN2' ‚Üí Not numeric
2026-02-14 15:14:42,298 - dq_unified - INFO -   Row 3: 'TXN3' ‚Üí Not numeric
2026-02-14 15:14:42,299 - dq_unified - INFO - Not enough numeric values to be serial: [nan]
2026-02-14 15:14:42,299 - dq_unified - INFO - Checking duplicates on ALL columns
2026-02-14 15:14:42,299 - dq_unified - INFO - First few rows for comparison:
2026-02-14 15:14:42,300 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': 'AC000001', 'customer_email': 'user1@bank.com'}
2026-02-14 15:14:42,300 - dq_unified - INFO -   Row 1: {'transaction_id': 'TXN2', 'account_id': 'AC000002', 'customer_email': 'user2@bank.com'}
2026-02-14 15:14:42,301 - dq_unified - INFO -   Row 2: {'transaction_id': 'TXN3', 'account_id': 'AC000003', 'customer_email': 'bademail.com'}
2026-02-14 15:14:42,302 - dq_unified - INFO - Duplicate mask found 0 rows
2026-02-14 15:14:42,303 - dq_unified - INFO - No duplicate rows found
2026-02-14 15:14:42,303 - dq_unified - INFO - FINAL RESULT: Found 0 duplicate groups
2026-02-14 15:14:42,304 - dq_unified - INFO -    Found 0 duplicate rows
2026-02-14 15:14:42,304 - dq_unified - INFO - 3. Checking data formats...
2026-02-14 15:14:42,304 - dq_unified - INFO - Checking data formats
2026-02-14 15:14:42,309 - dq_unified - INFO - Detected customer_email as email type
2026-02-14 15:14:42,310 - dq_unified - WARNING -   Row 3: 'bademail.com...' doesn't match Valid email format (user@domain.com)
2026-02-14 15:14:42,315 - dq_unified - INFO - Detected amount as numeric type
2026-02-14 15:14:42,316 - dq_unified - WARNING -   Row 5: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 15:14:42,322 - dq_unified - INFO - Total format issues found: 2
2026-02-14 15:14:42,323 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:42,414 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 15:14:42,415 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 15:14:42,415 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_151441
2026-02-14 15:14:42,416 - dq_unified - INFO -    Found 2 format issues
2026-02-14 15:14:42,417 - dq_unified - INFO - 4. Checking mandatory fields...
2026-02-14 15:14:42,417 - dq_unified - INFO - Checking mandatory fields
2026-02-14 15:14:42,418 - dq_unified - INFO - Available columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:42,418 - dq_unified - INFO - Checking ALL columns as mandatory: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:14:42,425 - dq_unified - WARNING - Mandatory field 'transaction_id': 2 missing values (98.0% filled)
2026-02-14 15:14:42,432 - dq_unified - WARNING - Mandatory field 'account_id': 1 missing values (99.0% filled)
2026-02-14 15:14:42,442 - dq_unified - WARNING - Mandatory field 'customer_email': 1 missing values (99.0% filled)
2026-02-14 15:14:42,451 - dq_unified - WARNING - Mandatory field 'transaction_date': 1 missing values (99.0% filled)
2026-02-14 15:14:42,461 - dq_unified - WARNING - Mandatory field 'amount': 1 missing values (99.0% filled)
2026-02-14 15:14:42,470 - dq_unified - WARNING - Mandatory field 'currency': 1 missing values (99.0% filled)
2026-02-14 15:14:42,477 - dq_unified - WARNING - Mandatory field 'country': 1 missing values (99.0% filled)
2026-02-14 15:14:42,486 - dq_unified - WARNING - Mandatory field 'status': 1 missing values (99.0% filled)
2026-02-14 15:14:42,492 - dq_unified - WARNING - Mandatory field 'remarks': 2 missing values (98.0% filled)
2026-02-14 15:14:42,561 - dq_error_log - INFO - Starting batch logging for 11 errors, session: SINGLE_20260214_151441
2026-02-14 15:14:42,639 - dq_error_log - INFO - Batch 1: Successfully logged 11 errors
2026-02-14 15:14:42,640 - dq_error_log - INFO - Progress: 11/11 errors processed
2026-02-14 15:14:42,640 - dq_error_log - INFO - COMPLETE: Logged 11/11 errors for session SINGLE_20260214_151441
2026-02-14 15:14:42,641 - dq_unified - INFO - All columns mandatory: 3 unique rows with missing values
2026-02-14 15:14:42,642 - dq_unified - INFO -    Found 3 missing mandatory values
2026-02-14 15:14:42,642 - dq_unified - INFO - 5. Calculating quality score...
2026-02-14 15:14:42,642 - dq_unified - INFO - Calculating quality score
2026-02-14 15:14:42,643 - dq_unified - INFO - Quality Score Calculation:
2026-02-14 15:14:42,643 - dq_unified - INFO -   Total rows: 101
2026-02-14 15:14:42,644 - dq_unified - INFO -   Bad Rows: 5
2026-02-14 15:14:42,644 - dq_unified - INFO -   Good rows (no issues): 96
2026-02-14 15:14:42,645 - dq_unified - INFO -   Quality Score: 95.05%
2026-02-14 15:14:42,735 - dq_error_log - INFO - Retrieved 24 error logs for session SINGLE_20260214_151441
2026-02-14 15:14:42,816 - dq_error_log - INFO - Retrieved summary: 24 total errors for session SINGLE_20260214_151441
2026-02-14 15:14:42,817 - dq_unified - INFO - Added 24 error logs to results
2026-02-14 15:14:42,818 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:14:42,818 - dq_audit - INFO - Starting database insertion for single_source...
2026-02-14 15:14:42,905 - dq_audit - INFO - Inserted single_source record with ID: 557
2026-02-14 15:14:42,989 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151441
2026-02-14 15:14:42,991 - dq_unified - INFO - Added 1 audit logs to results
2026-02-14 15:14:42,991 - dq_unified - INFO - Analysis completed successfully for CSV: 20260214_151441_SINGLE_SOURCE_100.csv
2026-02-14 15:14:42,992 - dq_unified - INFO - Final quality score: 95.05%
2026-02-14 15:14:43,072 - dq_error_log - INFO - Retrieved 24 error logs for session SINGLE_20260214_151441
2026-02-14 15:14:43,159 - dq_error_log - INFO - Retrieved summary: 24 total errors for session SINGLE_20260214_151441
2026-02-14 15:14:43,242 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151441
2026-02-14 15:14:43,243 - __main__ - INFO - Analysis completed for session SINGLE_20260214_151441
2026-02-14 15:14:43,247 - __main__ - INFO - Completed with status 200 in 1.926s
2026-02-14 15:14:43,286 - __main__ - INFO - GET /api/single/SINGLE_20260214_151441/errors - Request started
2026-02-14 15:14:43,288 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-14 15:14:43,312 - __main__ - INFO - GET /api/single/SINGLE_20260214_151441/errors - Request started
2026-02-14 15:14:43,315 - __main__ - INFO - Completed with status 200 in 0.003s
2026-02-14 15:15:00,547 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:15:00,562 - __main__ - INFO - File uploaded: 20260214_151500_SINGLE_SOURCE_1000.csv (csv)
2026-02-14 15:15:00,563 - __main__ - INFO - Completed with status 200 in 0.017s
2026-02-14 15:15:00,580 - __main__ - INFO - POST /api/check-single - Request started
2026-02-14 15:15:00,582 - __main__ - INFO - Single source analysis request received
2026-02-14 15:15:00,584 - __main__ - INFO - Starting analysis for session SINGLE_20260214_151500_8e97343e
2026-02-14 15:15:00,585 - __main__ - INFO - UI Data being passed to dq_unified:
2026-02-14 15:15:00,586 - __main__ - INFO -   source_type: csv
2026-02-14 15:15:00,586 - __main__ - INFO -   file_path: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151500_SINGLE_SOURCE_1000.csv
2026-02-14 15:15:00,587 - __main__ - INFO -   sheet_name: None
2026-02-14 15:15:00,589 - __main__ - INFO -   mandatory_fields: all
2026-02-14 15:15:00,589 - dq_unified - INFO - ==================================================
2026-02-14 15:15:00,590 - dq_unified - INFO - RUN_SINGLE_SOURCE_ANALYSIS_UI - START
2026-02-14 15:15:00,590 - dq_unified - INFO - Prompting user for data source type
2026-02-14 15:15:00,591 - dq_unified - INFO - UI Data source_type: csv
2026-02-14 15:15:00,591 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-14 15:15:00,591 - dq_unified - INFO - Loading data from CSV...
2026-02-14 15:15:00,592 - dq_unified - INFO - Loading data from CSV
2026-02-14 15:15:00,592 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151500_SINGLE_SOURCE_1000.csv
2026-02-14 15:15:00,594 - dq_unified - INFO - CSV file has 1,116 rows
2026-02-14 15:15:00,595 - dq_unified - INFO - Loading 1,116 rows from CSV...
2026-02-14 15:15:00,601 - dq_unified - INFO - Loaded 1,116 rows from CSV
2026-02-14 15:15:00,608 - dq_unified - INFO - Memory optimization: 0.5MB -> 0.3MB (Saved: 0.3MB)
2026-02-14 15:15:00,610 - dq_unified - INFO - Loaded 1,116 rows, 9 columns. Memory: 111.1MB total, 0.3MB for dataframe
2026-02-14 15:15:00,610 - dq_unified - INFO - Data loaded: 1,116 rows, 9 columns
2026-02-14 15:15:00,611 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:15:00,611 - dq_unified - INFO - Session ID: SINGLE_20260214_151500
2026-02-14 15:15:00,612 - dq_unified - INFO - Column data types collected: 9 columns
2026-02-14 15:15:00,612 - dq_unified - INFO - ==================================================
2026-02-14 15:15:00,613 - dq_unified - INFO - Starting quality checks...
2026-02-14 15:15:00,614 - dq_unified - INFO - ==================================================
2026-02-14 15:15:00,615 - dq_unified - INFO - 1. Checking for null/empty values...
2026-02-14 15:15:00,615 - dq_unified - INFO - Checking for null/empty values
2026-02-14 15:15:00,616 - dq_unified - INFO - DataFrame shape: (1116, 9)
2026-02-14 15:15:00,616 - dq_unified - INFO - Columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:00,617 - dq_unified - INFO - Data source: CSV: 20260214_151500_SINGLE_SOURCE_1000.csv
2026-02-14 15:15:00,618 - dq_unified - INFO - DataFrame dtypes: {'transaction_id': dtype('O'), 'account_id': dtype('O'), 'customer_email': dtype('O'), 'transaction_date': CategoricalDtype(categories=['1/1/2024', '2024/31/12', '31-12-2024'], ordered=False, categories_dtype=object), 'amount': dtype('O'), 'currency': CategoricalDtype(categories=['USD'], ordered=False, categories_dtype=object), 'country': CategoricalDtype(categories=['US'], ordered=False, categories_dtype=object), 'status': CategoricalDtype(categories=['SUCCESS'], ordered=False, categories_dtype=object), 'remarks': CategoricalDtype(categories=['OK'], ordered=False, categories_dtype=object)}
2026-02-14 15:15:00,618 - dq_unified - INFO - First 2 rows (first 3 columns only):
2026-02-14 15:15:00,619 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': "'AC000001'", 'customer_email': "'user1@bank.com'"}
2026-02-14 15:15:00,619 - dq_unified - INFO -   Row 1: {'transaction_id': "'TXN2'", 'account_id': "'AC000002'", 'customer_email': "'user2@bank.com'"}
2026-02-14 15:15:00,636 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:15:00,637 - dq_unified - INFO -   Not missing samples: ["'TXN2'", "'TXN3'", "'TXN4'"]
2026-02-14 15:15:00,637 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (0.1%)
2026-02-14 15:15:00,638 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (0.1%)
2026-02-14 15:15:00,639 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151500
2026-02-14 15:15:00,731 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:15:00,733 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:15:00,734 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151500
2026-02-14 15:15:00,751 - dq_unified - INFO - Column 'account_id': No missing cells
2026-02-14 15:15:00,764 - dq_unified - INFO - Column 'customer_email': No missing cells
2026-02-14 15:15:00,776 - dq_unified - INFO - Column 'transaction_date': No missing cells
2026-02-14 15:15:00,787 - dq_unified - INFO - Column 'amount': No missing cells
2026-02-14 15:15:00,798 - dq_unified - INFO - Column 'currency': No missing cells
2026-02-14 15:15:00,811 - dq_unified - INFO - Column 'country': No missing cells
2026-02-14 15:15:00,822 - dq_unified - INFO - Column 'status': No missing cells
2026-02-14 15:15:00,834 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:15:00,834 - dq_unified - INFO -   Not missing samples: ["'OK'", "'OK'", "'OK'"]
2026-02-14 15:15:00,835 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.1%)
2026-02-14 15:15:00,835 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.1%)
2026-02-14 15:15:00,836 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151500
2026-02-14 15:15:00,929 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:15:00,931 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:15:00,931 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151500
2026-02-14 15:15:00,932 - dq_unified - INFO - Total missing cells found: 2
2026-02-14 15:15:00,932 - dq_unified - INFO - ============================================================
2026-02-14 15:15:00,933 - dq_unified - INFO - MISSING VALUE SUMMARY
2026-02-14 15:15:00,933 - dq_unified - INFO - ============================================================
2026-02-14 15:15:00,934 - dq_unified - INFO - transaction_id: 1 missing (0.1%)
2026-02-14 15:15:00,934 - dq_unified - INFO - remarks: 1 missing (0.1%)
2026-02-14 15:15:00,934 - dq_unified - INFO - ============================================================
2026-02-14 15:15:00,935 - dq_unified - INFO -    Found 2 empty cells
2026-02-14 15:15:00,935 - dq_unified - INFO - 2. Checking for duplicate rows...
2026-02-14 15:15:00,935 - dq_unified - INFO - Checking for duplicate rows
2026-02-14 15:15:00,936 - dq_unified - INFO - Cleaning data (removing whitespace)...
2026-02-14 15:15:00,937 - dq_unified - INFO - Columns after cleaning: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:00,949 - dq_unified - INFO - Sample of first column after cleaning: 'nan'
2026-02-14 15:15:00,950 - dq_unified - INFO - Sample of row 6 first column: 'TXN6'
2026-02-14 15:15:00,950 - dq_unified - INFO - Total rows to check: 1116
2026-02-14 15:15:00,951 - dq_unified - INFO - Checking first column 'transaction_id' for serial numbers
2026-02-14 15:15:00,951 - dq_unified - INFO - First 5 values: ['nan', 'TXN2', 'TXN3', 'TXN4', 'TXN5']
2026-02-14 15:15:00,952 - dq_unified - INFO -   Row 1: 'nan' ‚Üí nan (numeric)
2026-02-14 15:15:00,952 - dq_unified - INFO -   Row 2: 'TXN2' ‚Üí Not numeric
2026-02-14 15:15:00,952 - dq_unified - INFO -   Row 3: 'TXN3' ‚Üí Not numeric
2026-02-14 15:15:00,953 - dq_unified - INFO - Not enough numeric values to be serial: [nan]
2026-02-14 15:15:00,953 - dq_unified - INFO - Checking duplicates on ALL columns
2026-02-14 15:15:00,953 - dq_unified - INFO - First few rows for comparison:
2026-02-14 15:15:00,954 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': 'AC000001', 'customer_email': 'user1@bank.com'}
2026-02-14 15:15:00,955 - dq_unified - INFO -   Row 1: {'transaction_id': 'TXN2', 'account_id': 'AC000002', 'customer_email': 'user2@bank.com'}
2026-02-14 15:15:00,955 - dq_unified - INFO -   Row 2: {'transaction_id': 'TXN3', 'account_id': 'AC000003', 'customer_email': 'bademail.com'}
2026-02-14 15:15:00,958 - dq_unified - INFO - Duplicate mask found 232 rows
2026-02-14 15:15:00,958 - dq_unified - INFO - Found 232 potential duplicate rows
2026-02-14 15:15:00,960 - dq_unified - INFO - Unique duplicate groups: 116
2026-02-14 15:15:00,960 - dq_unified - INFO - Duplicate groups found:
2026-02-14 15:15:00,961 - dq_unified - INFO -   Group sample: Pandas(Index=884, transaction_id='TXN885', account_id='AC000885', customer_email='user885@bank.com', transaction_date='1/1/2024', amount='1884', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:15:00,962 - dq_unified - INFO -   Group sample: Pandas(Index=885, transaction_id='TXN886', account_id='AC000886', customer_email='user886@bank.com', transaction_date='1/1/2024', amount='1885', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:15:00,962 - dq_unified - INFO -   Group sample: Pandas(Index=886, transaction_id='TXN887', account_id='AC000887', customer_email='user887@bank.com', transaction_date='1/1/2024', amount='1886', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:15:00,963 - dq_unified - INFO - Processing 232 duplicate indices
2026-02-14 15:15:00,969 - dq_unified - INFO - FINAL RESULT: Found 232 duplicate groups
2026-02-14 15:15:00,970 - dq_error_log - INFO - Starting batch logging for 232 errors, session: SINGLE_20260214_151500
2026-02-14 15:15:01,080 - dq_error_log - INFO - Batch 1: Successfully logged 232 errors
2026-02-14 15:15:01,081 - dq_error_log - INFO - Progress: 232/232 errors processed
2026-02-14 15:15:01,082 - dq_error_log - INFO - COMPLETE: Logged 232/232 errors for session SINGLE_20260214_151500
2026-02-14 15:15:01,084 - dq_unified - INFO -    Found 232 duplicate rows
2026-02-14 15:15:01,084 - dq_unified - INFO - 3. Checking data formats...
2026-02-14 15:15:01,085 - dq_unified - INFO - Checking data formats
2026-02-14 15:15:01,090 - dq_unified - INFO - Detected customer_email as email type
2026-02-14 15:15:01,091 - dq_unified - WARNING -   Row 3: 'bademail.com...' doesn't match Valid email format (user@domain.com)
2026-02-14 15:15:01,096 - dq_unified - INFO - Detected amount as numeric type
2026-02-14 15:15:01,097 - dq_unified - WARNING -   Row 5: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 15:15:01,107 - dq_unified - INFO - Total format issues found: 2
2026-02-14 15:15:01,107 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_151500
2026-02-14 15:15:01,201 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 15:15:01,202 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 15:15:01,203 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_151500
2026-02-14 15:15:01,204 - dq_unified - INFO -    Found 2 format issues
2026-02-14 15:15:01,204 - dq_unified - INFO - 4. Checking mandatory fields...
2026-02-14 15:15:01,205 - dq_unified - INFO - Checking mandatory fields
2026-02-14 15:15:01,205 - dq_unified - INFO - Available columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:01,205 - dq_unified - INFO - Checking ALL columns as mandatory: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:01,216 - dq_unified - WARNING - Mandatory field 'transaction_id': 1 missing values (99.9% filled)
2026-02-14 15:15:01,229 - dq_unified - INFO - Mandatory field 'account_id': 100.0% filled
2026-02-14 15:15:01,240 - dq_unified - INFO - Mandatory field 'customer_email': 100.0% filled
2026-02-14 15:15:01,252 - dq_unified - INFO - Mandatory field 'transaction_date': 100.0% filled
2026-02-14 15:15:01,264 - dq_unified - INFO - Mandatory field 'amount': 100.0% filled
2026-02-14 15:15:01,275 - dq_unified - INFO - Mandatory field 'currency': 100.0% filled
2026-02-14 15:15:01,291 - dq_unified - INFO - Mandatory field 'country': 100.0% filled
2026-02-14 15:15:01,307 - dq_unified - INFO - Mandatory field 'status': 100.0% filled
2026-02-14 15:15:01,325 - dq_unified - WARNING - Mandatory field 'remarks': 1 missing values (99.9% filled)
2026-02-14 15:15:01,443 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_151500
2026-02-14 15:15:01,529 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 15:15:01,530 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 15:15:01,531 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_151500
2026-02-14 15:15:01,531 - dq_unified - INFO - All columns mandatory: 2 unique rows with missing values
2026-02-14 15:15:01,532 - dq_unified - INFO -    Found 2 missing mandatory values
2026-02-14 15:15:01,533 - dq_unified - INFO - 5. Calculating quality score...
2026-02-14 15:15:01,533 - dq_unified - INFO - Calculating quality score
2026-02-14 15:15:01,534 - dq_unified - INFO - Quality Score Calculation:
2026-02-14 15:15:01,534 - dq_unified - INFO -   Total rows: 1,116
2026-02-14 15:15:01,535 - dq_unified - INFO -   Bad Rows: 236
2026-02-14 15:15:01,535 - dq_unified - INFO -   Good rows (no issues): 880
2026-02-14 15:15:01,535 - dq_unified - INFO -   Quality Score: 78.85%
2026-02-14 15:15:01,660 - dq_error_log - INFO - Retrieved 200 error logs for session SINGLE_20260214_151500
2026-02-14 15:15:01,742 - dq_error_log - INFO - Retrieved summary: 238 total errors for session SINGLE_20260214_151500
2026-02-14 15:15:01,745 - dq_unified - INFO - Added 200 error logs to results
2026-02-14 15:15:01,745 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:15:01,746 - dq_audit - INFO - Starting database insertion for single_source...
2026-02-14 15:15:01,838 - dq_audit - INFO - Inserted single_source record with ID: 558
2026-02-14 15:15:01,926 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151500
2026-02-14 15:15:01,928 - dq_unified - INFO - Added 1 audit logs to results
2026-02-14 15:15:01,929 - dq_unified - INFO - Analysis completed successfully for CSV: 20260214_151500_SINGLE_SOURCE_1000.csv
2026-02-14 15:15:01,929 - dq_unified - INFO - Final quality score: 78.85%
2026-02-14 15:15:02,058 - dq_error_log - INFO - Retrieved 200 error logs for session SINGLE_20260214_151500
2026-02-14 15:15:02,141 - dq_error_log - INFO - Retrieved summary: 238 total errors for session SINGLE_20260214_151500
2026-02-14 15:15:02,230 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151500
2026-02-14 15:15:02,231 - __main__ - INFO - Analysis completed for session SINGLE_20260214_151500
2026-02-14 15:15:02,246 - __main__ - INFO - Completed with status 200 in 1.666s
2026-02-14 15:15:02,287 - __main__ - INFO - GET /api/single/SINGLE_20260214_151500/errors - Request started
2026-02-14 15:15:02,289 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-14 15:15:02,305 - __main__ - INFO - GET /api/single/SINGLE_20260214_151500/errors - Request started
2026-02-14 15:15:02,306 - __main__ - INFO - Completed with status 200 in 0.001s
2026-02-14 15:15:06,483 - __main__ - INFO - GET /api/single/SINGLE_20260214_151500/errors - Request started
2026-02-14 15:15:06,486 - __main__ - INFO - Completed with status 200 in 0.003s
2026-02-14 15:15:09,803 - __main__ - INFO - GET /api/single/SINGLE_20260214_151500/errors - Request started
2026-02-14 15:15:09,805 - __main__ - INFO - Completed with status 200 in 0.003s
2026-02-14 15:15:41,628 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:15:41,671 - __main__ - INFO - File uploaded: 20260214_151541_SINGLE_SOURCE_1000.xlsx (excel)
2026-02-14 15:15:41,672 - __main__ - INFO - Completed with status 200 in 0.044s
2026-02-14 15:15:41,752 - __main__ - INFO - POST /api/check-single - Request started
2026-02-14 15:15:41,753 - __main__ - INFO - Single source analysis request received
2026-02-14 15:15:41,754 - __main__ - INFO - Starting analysis for session SINGLE_20260214_151541_a53e8264
2026-02-14 15:15:41,755 - __main__ - INFO - UI Data being passed to dq_unified:
2026-02-14 15:15:41,755 - __main__ - INFO -   source_type: excel
2026-02-14 15:15:41,757 - __main__ - INFO -   file_path: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151541_SINGLE_SOURCE_1000.xlsx
2026-02-14 15:15:41,758 - __main__ - INFO -   sheet_name: None
2026-02-14 15:15:41,759 - __main__ - INFO -   mandatory_fields: all
2026-02-14 15:15:41,759 - dq_unified - INFO - ==================================================
2026-02-14 15:15:41,760 - dq_unified - INFO - RUN_SINGLE_SOURCE_ANALYSIS_UI - START
2026-02-14 15:15:41,761 - dq_unified - INFO - Prompting user for data source type
2026-02-14 15:15:41,762 - dq_unified - INFO - UI Data source_type: excel
2026-02-14 15:15:41,763 - dq_unified - INFO - Using source_type from UI data: excel
2026-02-14 15:15:41,764 - dq_unified - INFO - Loading data from EXCEL...
2026-02-14 15:15:41,764 - dq_unified - INFO - Loading data from EXCEL
2026-02-14 15:15:41,765 - dq_unified - INFO - Loading large Excel: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151541_SINGLE_SOURCE_1000.xlsx
2026-02-14 15:15:43,468 - dq_unified - INFO - Loading Excel file...
2026-02-14 15:15:43,580 - dq_unified - INFO - Loaded 1,059 rows from Excel
2026-02-14 15:15:43,587 - dq_unified - INFO - Memory optimization: 0.5MB -> 0.2MB (Saved: 0.3MB)
2026-02-14 15:15:43,589 - dq_unified - INFO - Loaded 1,059 rows, 9 columns. Memory: 121.6MB total, 0.2MB for dataframe
2026-02-14 15:15:43,589 - dq_unified - INFO - Data loaded: 1,059 rows, 9 columns
2026-02-14 15:15:43,590 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:15:43,590 - dq_unified - INFO - Session ID: SINGLE_20260214_151543
2026-02-14 15:15:43,591 - dq_unified - INFO - Column data types collected: 9 columns
2026-02-14 15:15:43,591 - dq_unified - INFO - ==================================================
2026-02-14 15:15:43,591 - dq_unified - INFO - Starting quality checks...
2026-02-14 15:15:43,592 - dq_unified - INFO - ==================================================
2026-02-14 15:15:43,592 - dq_unified - INFO - 1. Checking for null/empty values...
2026-02-14 15:15:43,592 - dq_unified - INFO - Checking for null/empty values
2026-02-14 15:15:43,593 - dq_unified - INFO - DataFrame shape: (1059, 9)
2026-02-14 15:15:43,593 - dq_unified - INFO - Columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:43,594 - dq_unified - INFO - Data source: EXCEL: 20260214_151541_SINGLE_SOURCE_1000.xlsx
2026-02-14 15:15:43,595 - dq_unified - INFO - DataFrame dtypes: {'transaction_id': dtype('O'), 'account_id': dtype('O'), 'customer_email': dtype('O'), 'transaction_date': CategoricalDtype(categories=['2024-01-01', '2024/31/12', '31-12-2024'], ordered=False, categories_dtype=object), 'amount': dtype('O'), 'currency': CategoricalDtype(categories=['USD'], ordered=False, categories_dtype=object), 'country': CategoricalDtype(categories=['US'], ordered=False, categories_dtype=object), 'status': CategoricalDtype(categories=['SUCCESS'], ordered=False, categories_dtype=object), 'remarks': CategoricalDtype(categories=['OK'], ordered=False, categories_dtype=object)}
2026-02-14 15:15:43,595 - dq_unified - INFO - First 2 rows (first 3 columns only):
2026-02-14 15:15:43,596 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': "'AC000001'", 'customer_email': "'user1@bank.com'"}
2026-02-14 15:15:43,597 - dq_unified - INFO -   Row 1: {'transaction_id': "'TXN2'", 'account_id': "'AC000002'", 'customer_email': "'user2@bank.com'"}
2026-02-14 15:15:43,610 - dq_unified - INFO -   Missing samples: ['nan', 'nan', 'nan']
2026-02-14 15:15:43,611 - dq_unified - INFO -   Not missing samples: ["'TXN2'", "'TXN3'", "'TXN4'"]
2026-02-14 15:15:43,611 - dq_unified - WARNING - Column 'transaction_id': 3 missing cells (0.3%)
2026-02-14 15:15:43,611 - dq_unified - WARNING - Column 'transaction_id': 3 missing cells (0.3%)
2026-02-14 15:15:43,612 - dq_error_log - INFO - Starting batch logging for 3 errors, session: SINGLE_20260214_151543
2026-02-14 15:15:43,700 - dq_error_log - INFO - Batch 1: Successfully logged 3 errors
2026-02-14 15:15:43,701 - dq_error_log - INFO - Progress: 3/3 errors processed
2026-02-14 15:15:43,701 - dq_error_log - INFO - COMPLETE: Logged 3/3 errors for session SINGLE_20260214_151543
2026-02-14 15:15:43,714 - dq_unified - INFO - Column 'account_id': No missing cells
2026-02-14 15:15:43,727 - dq_unified - INFO - Column 'customer_email': No missing cells
2026-02-14 15:15:43,738 - dq_unified - INFO - Column 'transaction_date': No missing cells
2026-02-14 15:15:43,749 - dq_unified - INFO - Column 'amount': No missing cells
2026-02-14 15:15:43,762 - dq_unified - INFO - Column 'currency': No missing cells
2026-02-14 15:15:43,772 - dq_unified - INFO - Column 'country': No missing cells
2026-02-14 15:15:43,783 - dq_unified - INFO - Column 'status': No missing cells
2026-02-14 15:15:43,795 - dq_unified - INFO -   Missing samples: ['nan']
2026-02-14 15:15:43,796 - dq_unified - INFO -   Not missing samples: ["'OK'", "'OK'", "'OK'"]
2026-02-14 15:15:43,796 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.1%)
2026-02-14 15:15:43,796 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.1%)
2026-02-14 15:15:43,797 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151543
2026-02-14 15:15:43,879 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:15:43,880 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:15:43,880 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151543
2026-02-14 15:15:43,881 - dq_unified - INFO - Total missing cells found: 4
2026-02-14 15:15:43,882 - dq_unified - INFO - ============================================================
2026-02-14 15:15:43,882 - dq_unified - INFO - MISSING VALUE SUMMARY
2026-02-14 15:15:43,882 - dq_unified - INFO - ============================================================
2026-02-14 15:15:43,883 - dq_unified - INFO - transaction_id: 3 missing (0.3%)
2026-02-14 15:15:43,884 - dq_unified - INFO - remarks: 1 missing (0.1%)
2026-02-14 15:15:43,884 - dq_unified - INFO - ============================================================
2026-02-14 15:15:43,885 - dq_unified - INFO -    Found 4 empty cells
2026-02-14 15:15:43,885 - dq_unified - INFO - 2. Checking for duplicate rows...
2026-02-14 15:15:43,885 - dq_unified - INFO - Checking for duplicate rows
2026-02-14 15:15:43,886 - dq_unified - INFO - Cleaning data (removing whitespace)...
2026-02-14 15:15:43,886 - dq_unified - INFO - Columns after cleaning: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:43,897 - dq_unified - INFO - Sample of first column after cleaning: 'nan'
2026-02-14 15:15:43,898 - dq_unified - INFO - Sample of row 6 first column: 'TXN6'
2026-02-14 15:15:43,898 - dq_unified - INFO - Total rows to check: 1059
2026-02-14 15:15:43,899 - dq_unified - INFO - Checking first column 'transaction_id' for serial numbers
2026-02-14 15:15:43,899 - dq_unified - INFO - First 5 values: ['nan', 'TXN2', 'TXN3', 'TXN4', 'TXN5']
2026-02-14 15:15:43,900 - dq_unified - INFO -   Row 1: 'nan' ‚Üí nan (numeric)
2026-02-14 15:15:43,900 - dq_unified - INFO -   Row 2: 'TXN2' ‚Üí Not numeric
2026-02-14 15:15:43,901 - dq_unified - INFO -   Row 3: 'TXN3' ‚Üí Not numeric
2026-02-14 15:15:43,901 - dq_unified - INFO - Not enough numeric values to be serial: [nan]
2026-02-14 15:15:43,902 - dq_unified - INFO - Checking duplicates on ALL columns
2026-02-14 15:15:43,903 - dq_unified - INFO - First few rows for comparison:
2026-02-14 15:15:43,903 - dq_unified - INFO -   Row 0: {'transaction_id': 'nan', 'account_id': 'AC000001', 'customer_email': 'user1@bank.com'}
2026-02-14 15:15:43,904 - dq_unified - INFO -   Row 1: {'transaction_id': 'TXN2', 'account_id': 'AC000002', 'customer_email': 'user2@bank.com'}
2026-02-14 15:15:43,905 - dq_unified - INFO -   Row 2: {'transaction_id': 'TXN3', 'account_id': 'AC000003', 'customer_email': 'bademail.com'}
2026-02-14 15:15:43,908 - dq_unified - INFO - Duplicate mask found 117 rows
2026-02-14 15:15:43,909 - dq_unified - INFO - Found 117 potential duplicate rows
2026-02-14 15:15:43,910 - dq_unified - INFO - Unique duplicate groups: 58
2026-02-14 15:15:43,910 - dq_unified - INFO - Duplicate groups found:
2026-02-14 15:15:43,911 - dq_unified - INFO -   Group sample: Pandas(Index=0, transaction_id='nan', account_id='AC000001', customer_email='user1@bank.com', transaction_date='2024-01-01', amount='1000', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:15:43,912 - dq_unified - INFO -   Group sample: Pandas(Index=943, transaction_id='TXN944', account_id='AC000944', customer_email='user944@bank.com', transaction_date='2024-01-01', amount='1943', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:15:43,912 - dq_unified - INFO -   Group sample: Pandas(Index=944, transaction_id='TXN945', account_id='AC000945', customer_email='user945@bank.com', transaction_date='2024-01-01', amount='1944', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:15:43,913 - dq_unified - INFO - Processing 117 duplicate indices
2026-02-14 15:15:43,918 - dq_unified - INFO - FINAL RESULT: Found 117 duplicate groups
2026-02-14 15:15:43,919 - dq_error_log - INFO - Starting batch logging for 117 errors, session: SINGLE_20260214_151543
2026-02-14 15:15:44,012 - dq_error_log - INFO - Batch 1: Successfully logged 117 errors
2026-02-14 15:15:44,014 - dq_error_log - INFO - Progress: 117/117 errors processed
2026-02-14 15:15:44,014 - dq_error_log - INFO - COMPLETE: Logged 117/117 errors for session SINGLE_20260214_151543
2026-02-14 15:15:44,016 - dq_unified - INFO -    Found 117 duplicate rows
2026-02-14 15:15:44,016 - dq_unified - INFO - 3. Checking data formats...
2026-02-14 15:15:44,016 - dq_unified - INFO - Checking data formats
2026-02-14 15:15:44,021 - dq_unified - INFO - Detected customer_email as email type
2026-02-14 15:15:44,022 - dq_unified - WARNING -   Row 3: 'bademail.com...' doesn't match Valid email format (user@domain.com)
2026-02-14 15:15:44,026 - dq_unified - INFO - Detected transaction_date as date type
2026-02-14 15:15:44,028 - dq_unified - INFO -   Date format check for transaction_date: Consistent=False, Format=['YYYY/MM/DD', 'YYYY-MM-DD', 'DD-MM-YYYY or MM-DD-YYYY']
2026-02-14 15:15:44,029 - dq_unified - WARNING -   transaction_date: Inconsistent date formats: ['YYYY/MM/DD', 'YYYY-MM-DD', 'DD-MM-YYYY or MM-DD-YYYY']
2026-02-14 15:15:44,036 - dq_unified - INFO - Detected amount as numeric type
2026-02-14 15:15:44,036 - dq_unified - WARNING -   Row 5: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 15:15:44,049 - dq_unified - INFO - Total format issues found: 3
2026-02-14 15:15:44,050 - dq_error_log - INFO - Starting batch logging for 3 errors, session: SINGLE_20260214_151543
2026-02-14 15:15:44,131 - dq_error_log - INFO - Batch 1: Successfully logged 3 errors
2026-02-14 15:15:44,132 - dq_error_log - INFO - Progress: 3/3 errors processed
2026-02-14 15:15:44,132 - dq_error_log - INFO - COMPLETE: Logged 3/3 errors for session SINGLE_20260214_151543
2026-02-14 15:15:44,133 - dq_unified - INFO -    Found 3 format issues
2026-02-14 15:15:44,134 - dq_unified - INFO - 4. Checking mandatory fields...
2026-02-14 15:15:44,135 - dq_unified - INFO - Checking mandatory fields
2026-02-14 15:15:44,135 - dq_unified - INFO - Available columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:44,136 - dq_unified - INFO - Checking ALL columns as mandatory: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:15:44,147 - dq_unified - WARNING - Mandatory field 'transaction_id': 3 missing values (99.7% filled)
2026-02-14 15:15:44,162 - dq_unified - INFO - Mandatory field 'account_id': 100.0% filled
2026-02-14 15:15:44,176 - dq_unified - INFO - Mandatory field 'customer_email': 100.0% filled
2026-02-14 15:15:44,187 - dq_unified - INFO - Mandatory field 'transaction_date': 100.0% filled
2026-02-14 15:15:44,198 - dq_unified - INFO - Mandatory field 'amount': 100.0% filled
2026-02-14 15:15:44,209 - dq_unified - INFO - Mandatory field 'currency': 100.0% filled
2026-02-14 15:15:44,222 - dq_unified - INFO - Mandatory field 'country': 100.0% filled
2026-02-14 15:15:44,233 - dq_unified - INFO - Mandatory field 'status': 100.0% filled
2026-02-14 15:15:44,244 - dq_unified - WARNING - Mandatory field 'remarks': 1 missing values (99.9% filled)
2026-02-14 15:15:44,347 - dq_error_log - INFO - Starting batch logging for 4 errors, session: SINGLE_20260214_151543
2026-02-14 15:15:44,433 - dq_error_log - INFO - Batch 1: Successfully logged 4 errors
2026-02-14 15:15:44,434 - dq_error_log - INFO - Progress: 4/4 errors processed
2026-02-14 15:15:44,435 - dq_error_log - INFO - COMPLETE: Logged 4/4 errors for session SINGLE_20260214_151543
2026-02-14 15:15:44,436 - dq_unified - INFO - All columns mandatory: 4 unique rows with missing values
2026-02-14 15:15:44,436 - dq_unified - INFO -    Found 4 missing mandatory values
2026-02-14 15:15:44,438 - dq_unified - INFO - 5. Calculating quality score...
2026-02-14 15:15:44,438 - dq_unified - INFO - Calculating quality score
2026-02-14 15:15:44,439 - dq_unified - INFO - Quality Score Calculation:
2026-02-14 15:15:44,439 - dq_unified - INFO -   Total rows: 1,059
2026-02-14 15:15:44,440 - dq_unified - INFO -   Bad Rows: 121
2026-02-14 15:15:44,440 - dq_unified - INFO -   Good rows (no issues): 938
2026-02-14 15:15:44,440 - dq_unified - INFO -   Quality Score: 88.57%
2026-02-14 15:15:44,552 - dq_error_log - INFO - Retrieved 128 error logs for session SINGLE_20260214_151543
2026-02-14 15:15:44,685 - dq_error_log - INFO - Retrieved summary: 128 total errors for session SINGLE_20260214_151543
2026-02-14 15:15:44,688 - dq_unified - INFO - Added 128 error logs to results
2026-02-14 15:15:44,688 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:15:44,689 - dq_audit - INFO - Starting database insertion for single_source...
2026-02-14 15:15:44,768 - dq_audit - INFO - Inserted single_source record with ID: 559
2026-02-14 15:15:44,849 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151543
2026-02-14 15:15:44,851 - dq_unified - INFO - Added 1 audit logs to results
2026-02-14 15:15:44,851 - dq_unified - INFO - Analysis completed successfully for EXCEL: 20260214_151541_SINGLE_SOURCE_1000.xlsx
2026-02-14 15:15:44,851 - dq_unified - INFO - Final quality score: 88.57%
2026-02-14 15:15:44,963 - dq_error_log - INFO - Retrieved 128 error logs for session SINGLE_20260214_151543
2026-02-14 15:15:45,069 - dq_error_log - INFO - Retrieved summary: 128 total errors for session SINGLE_20260214_151543
2026-02-14 15:15:45,163 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151543
2026-02-14 15:15:45,164 - __main__ - INFO - Analysis completed for session SINGLE_20260214_151543
2026-02-14 15:15:45,177 - __main__ - INFO - Completed with status 200 in 3.425s
2026-02-14 15:15:45,203 - __main__ - INFO - GET /api/single/SINGLE_20260214_151543/errors - Request started
2026-02-14 15:15:45,206 - __main__ - INFO - Completed with status 200 in 0.003s
2026-02-14 15:15:45,224 - __main__ - INFO - GET /api/single/SINGLE_20260214_151543/errors - Request started
2026-02-14 15:15:45,228 - __main__ - INFO - Completed with status 200 in 0.004s
2026-02-14 15:15:48,300 - __main__ - INFO - GET /api/single/SINGLE_20260214_151543/errors - Request started
2026-02-14 15:15:48,302 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-14 15:15:51,243 - __main__ - INFO - GET /api/single/SINGLE_20260214_151543/errors - Request started
2026-02-14 15:15:51,244 - __main__ - INFO - Completed with status 200 in 0.001s
2026-02-14 15:16:12,146 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:16:12,147 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:16:12,148 - __main__ - INFO - Database: Not provided
2026-02-14 15:16:12,148 - __main__ - INFO - Schema: Not provided
2026-02-14 15:16:12,149 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:16:12,150 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:16:12,150 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:16:12,260 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:16:12,261 - __main__ - INFO - Getting databases list...
2026-02-14 15:16:12,261 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-14 15:16:12,267 - database_navigator - INFO - Found 7 databases
2026-02-14 15:16:12,268 - __main__ - INFO - Found 7 databases
2026-02-14 15:16:12,271 - __main__ - INFO - Completed with status 200 in 0.125s
2026-02-14 15:16:13,904 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:16:13,906 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:16:13,907 - __main__ - INFO - Database: dq_checks
2026-02-14 15:16:13,909 - __main__ - INFO - Schema: Not provided
2026-02-14 15:16:13,909 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:16:13,910 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:16:13,912 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:16:14,027 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:16:14,028 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-14 15:16:14,032 - database_navigator - INFO - Found 1 schemas
2026-02-14 15:16:14,033 - __main__ - INFO - Found 1 schemas
2026-02-14 15:16:14,035 - __main__ - INFO - Completed with status 200 in 0.131s
2026-02-14 15:16:15,831 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:16:15,861 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:16:15,864 - __main__ - INFO - Database: dq_checks
2026-02-14 15:16:15,865 - __main__ - INFO - Schema: dq_checks
2026-02-14 15:16:15,869 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:16:15,871 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:16:15,872 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:16:15,987 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:16:15,988 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-14 15:16:15,999 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-14 15:16:16,001 - __main__ - INFO - Found 28 tables
2026-02-14 15:16:16,005 - __main__ - INFO - Completed with status 200 in 0.174s
2026-02-14 15:16:22,904 - __main__ - INFO - POST /api/check-single - Request started
2026-02-14 15:16:22,905 - __main__ - INFO - Single source analysis request received
2026-02-14 15:16:22,906 - __main__ - INFO - Starting analysis for session SINGLE_20260214_151622_e07e0504
2026-02-14 15:16:22,906 - __main__ - INFO - UI Data being passed to dq_unified:
2026-02-14 15:16:22,907 - __main__ - INFO -   source_type: database
2026-02-14 15:16:22,907 - __main__ - INFO -   db_config: {'type': 'mysql', 'host': 'localhost', 'port': 3306, 'database': 'dq_checks', 'schema': 'dq_checks', 'table': 'single1000', 'user': 'root', 'password': 'root'}
2026-02-14 15:16:22,908 - __main__ - INFO -   mandatory_fields: None
2026-02-14 15:16:22,909 - dq_unified - INFO - ==================================================
2026-02-14 15:16:22,909 - dq_unified - INFO - RUN_SINGLE_SOURCE_ANALYSIS_UI - START
2026-02-14 15:16:22,910 - dq_unified - INFO - Prompting user for data source type
2026-02-14 15:16:22,910 - dq_unified - INFO - UI Data source_type: database
2026-02-14 15:16:22,911 - dq_unified - INFO - Using source_type from UI data: database
2026-02-14 15:16:22,915 - dq_unified - INFO - Loading data from DATABASE...
2026-02-14 15:16:22,917 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:16:22,918 - dq_unified - INFO - Loading large database table: single1000
2026-02-14 15:16:22,919 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-14 15:16:23,017 - dq_unified - INFO - MySQL table single1000 has 1,116 rows
2026-02-14 15:16:23,018 - dq_unified - INFO - Loading 1,116 rows from MySQL...
2026-02-14 15:16:24,465 - dq_unified - INFO - Loaded 1,116 rows from MySQL
2026-02-14 15:16:24,473 - dq_unified - INFO - Memory optimization: 0.5MB -> 0.3MB (Saved: 0.3MB)
2026-02-14 15:16:24,474 - dq_unified - INFO - Loaded 1,116 rows, 9 columns. Memory: 134.2MB total, 0.3MB for dataframe
2026-02-14 15:16:24,475 - dq_unified - INFO - Data loaded: 1,116 rows, 9 columns
2026-02-14 15:16:24,475 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:16:24,476 - dq_unified - INFO - Session ID: SINGLE_20260214_151624
2026-02-14 15:16:24,477 - dq_unified - INFO - Column data types collected: 9 columns
2026-02-14 15:16:24,477 - dq_unified - INFO - ==================================================
2026-02-14 15:16:24,478 - dq_unified - INFO - Starting quality checks...
2026-02-14 15:16:24,478 - dq_unified - INFO - ==================================================
2026-02-14 15:16:24,478 - dq_unified - INFO - 1. Checking for null/empty values...
2026-02-14 15:16:24,479 - dq_unified - INFO - Checking for null/empty values
2026-02-14 15:16:24,479 - dq_unified - INFO - DataFrame shape: (1116, 9)
2026-02-14 15:16:24,479 - dq_unified - INFO - Columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:16:24,481 - dq_unified - INFO - Data source: Database: mysql - Table: single1000
2026-02-14 15:16:24,482 - dq_unified - INFO - DataFrame dtypes: {'transaction_id': dtype('O'), 'account_id': dtype('O'), 'customer_email': dtype('O'), 'transaction_date': CategoricalDtype(categories=['1/1/2024', '2024/31/12', '31-12-2024'], ordered=False, categories_dtype=object), 'amount': dtype('O'), 'currency': CategoricalDtype(categories=['USD'], ordered=False, categories_dtype=object), 'country': CategoricalDtype(categories=['US'], ordered=False, categories_dtype=object), 'status': CategoricalDtype(categories=['SUCCESS'], ordered=False, categories_dtype=object), 'remarks': CategoricalDtype(categories=['\r', 'OK\r'], ordered=False, categories_dtype=object)}
2026-02-14 15:16:24,482 - dq_unified - INFO - First 2 rows (first 3 columns only):
2026-02-14 15:16:24,484 - dq_unified - INFO -   Row 0: {'transaction_id': "''", 'account_id': "'AC000001'", 'customer_email': "'user1@bank.com'"}
2026-02-14 15:16:24,484 - dq_unified - INFO -   Row 1: {'transaction_id': "'TXN2'", 'account_id': "'AC000002'", 'customer_email': "'user2@bank.com'"}
2026-02-14 15:16:24,498 - dq_unified - INFO -   Missing samples: ["''"]
2026-02-14 15:16:24,498 - dq_unified - INFO -   Not missing samples: ["'TXN2'", "'TXN3'", "'TXN4'"]
2026-02-14 15:16:24,499 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (0.1%)
2026-02-14 15:16:24,499 - dq_unified - WARNING - Column 'transaction_id': 1 missing cells (0.1%)
2026-02-14 15:16:24,500 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151624
2026-02-14 15:16:24,581 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:16:24,582 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:16:24,583 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151624
2026-02-14 15:16:24,595 - dq_unified - INFO - Column 'account_id': No missing cells
2026-02-14 15:16:24,606 - dq_unified - INFO - Column 'customer_email': No missing cells
2026-02-14 15:16:24,617 - dq_unified - INFO - Column 'transaction_date': No missing cells
2026-02-14 15:16:24,633 - dq_unified - INFO - Column 'amount': No missing cells
2026-02-14 15:16:24,647 - dq_unified - INFO - Column 'currency': No missing cells
2026-02-14 15:16:24,662 - dq_unified - INFO - Column 'country': No missing cells
2026-02-14 15:16:24,675 - dq_unified - INFO - Column 'status': No missing cells
2026-02-14 15:16:24,688 - dq_unified - INFO -   Missing samples: ["'\\r'"]
2026-02-14 15:16:24,689 - dq_unified - INFO -   Not missing samples: ["'OK\\r'", "'OK\\r'", "'OK\\r'"]
2026-02-14 15:16:24,689 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.1%)
2026-02-14 15:16:24,690 - dq_unified - WARNING - Column 'remarks': 1 missing cells (0.1%)
2026-02-14 15:16:24,690 - dq_error_log - INFO - Starting batch logging for 1 errors, session: SINGLE_20260214_151624
2026-02-14 15:16:24,775 - dq_error_log - INFO - Batch 1: Successfully logged 1 errors
2026-02-14 15:16:24,776 - dq_error_log - INFO - Progress: 1/1 errors processed
2026-02-14 15:16:24,777 - dq_error_log - INFO - COMPLETE: Logged 1/1 errors for session SINGLE_20260214_151624
2026-02-14 15:16:24,777 - dq_unified - INFO - Total missing cells found: 2
2026-02-14 15:16:24,778 - dq_unified - INFO - === Analyzing MySQL database ===
2026-02-14 15:16:24,779 - dq_unified - INFO - First column 'transaction_id' samples: ["''", "'TXN2'", "'TXN3'"]
2026-02-14 15:16:24,779 - dq_unified - INFO - ============================================================
2026-02-14 15:16:24,779 - dq_unified - INFO - MISSING VALUE SUMMARY
2026-02-14 15:16:24,780 - dq_unified - INFO - ============================================================
2026-02-14 15:16:24,780 - dq_unified - INFO - transaction_id: 1 missing (0.1%)
2026-02-14 15:16:24,781 - dq_unified - INFO - remarks: 1 missing (0.1%)
2026-02-14 15:16:24,781 - dq_unified - INFO - ============================================================
2026-02-14 15:16:24,781 - dq_unified - INFO -    Found 2 empty cells
2026-02-14 15:16:24,782 - dq_unified - INFO - 2. Checking for duplicate rows...
2026-02-14 15:16:24,782 - dq_unified - INFO - Checking for duplicate rows
2026-02-14 15:16:24,782 - dq_unified - INFO - Cleaning data (removing whitespace)...
2026-02-14 15:16:24,783 - dq_unified - INFO - Columns after cleaning: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:16:24,794 - dq_unified - INFO - Sample of first column after cleaning: ''
2026-02-14 15:16:24,795 - dq_unified - INFO - Sample of row 6 first column: 'TXN6'
2026-02-14 15:16:24,795 - dq_unified - INFO - Total rows to check: 1116
2026-02-14 15:16:24,796 - dq_unified - INFO - Checking first column 'transaction_id' for serial numbers
2026-02-14 15:16:24,796 - dq_unified - INFO - First 5 values: ['', 'TXN2', 'TXN3', 'TXN4', 'TXN5']
2026-02-14 15:16:24,797 - dq_unified - INFO -   Row 1: '' ‚Üí Not numeric
2026-02-14 15:16:24,797 - dq_unified - INFO -   Row 2: 'TXN2' ‚Üí Not numeric
2026-02-14 15:16:24,798 - dq_unified - INFO -   Row 3: 'TXN3' ‚Üí Not numeric
2026-02-14 15:16:24,798 - dq_unified - INFO - Not enough numeric values to be serial: []
2026-02-14 15:16:24,798 - dq_unified - INFO - Checking duplicates on ALL columns
2026-02-14 15:16:24,799 - dq_unified - INFO - First few rows for comparison:
2026-02-14 15:16:24,799 - dq_unified - INFO -   Row 0: {'transaction_id': '', 'account_id': 'AC000001', 'customer_email': 'user1@bank.com'}
2026-02-14 15:16:24,800 - dq_unified - INFO -   Row 1: {'transaction_id': 'TXN2', 'account_id': 'AC000002', 'customer_email': 'user2@bank.com'}
2026-02-14 15:16:24,800 - dq_unified - INFO -   Row 2: {'transaction_id': 'TXN3', 'account_id': 'AC000003', 'customer_email': 'bademail.com'}
2026-02-14 15:16:24,802 - dq_unified - INFO - Duplicate mask found 232 rows
2026-02-14 15:16:24,803 - dq_unified - INFO - Found 232 potential duplicate rows
2026-02-14 15:16:24,804 - dq_unified - INFO - Unique duplicate groups: 116
2026-02-14 15:16:24,804 - dq_unified - INFO - Duplicate groups found:
2026-02-14 15:16:24,805 - dq_unified - INFO -   Group sample: Pandas(Index=884, transaction_id='TXN885', account_id='AC000885', customer_email='user885@bank.com', transaction_date='1/1/2024', amount='1884', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:16:24,806 - dq_unified - INFO -   Group sample: Pandas(Index=885, transaction_id='TXN886', account_id='AC000886', customer_email='user886@bank.com', transaction_date='1/1/2024', amount='1885', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:16:24,806 - dq_unified - INFO -   Group sample: Pandas(Index=886, transaction_id='TXN887', account_id='AC000887', customer_email='user887@bank.com', transaction_date='1/1/2024', amount='1886', currency='USD', country='US', status='SUCCESS', remarks='OK')
2026-02-14 15:16:24,806 - dq_unified - INFO - Processing 232 duplicate indices
2026-02-14 15:16:24,813 - dq_unified - INFO - FINAL RESULT: Found 232 duplicate groups
2026-02-14 15:16:24,813 - dq_error_log - INFO - Starting batch logging for 232 errors, session: SINGLE_20260214_151624
2026-02-14 15:16:24,922 - dq_error_log - INFO - Batch 1: Successfully logged 232 errors
2026-02-14 15:16:24,923 - dq_error_log - INFO - Progress: 232/232 errors processed
2026-02-14 15:16:24,924 - dq_error_log - INFO - COMPLETE: Logged 232/232 errors for session SINGLE_20260214_151624
2026-02-14 15:16:24,925 - dq_unified - INFO -    Found 232 duplicate rows
2026-02-14 15:16:24,925 - dq_unified - INFO - 3. Checking data formats...
2026-02-14 15:16:24,926 - dq_unified - INFO - Checking data formats
2026-02-14 15:16:24,931 - dq_unified - INFO - Detected customer_email as email type
2026-02-14 15:16:24,931 - dq_unified - WARNING -   Row 3: 'bademail.com...' doesn't match Valid email format (user@domain.com)
2026-02-14 15:16:24,936 - dq_unified - INFO - Detected amount as numeric type
2026-02-14 15:16:24,936 - dq_unified - WARNING -   Row 5: '12,000$...' doesn't match Numeric value (no leading zeros, no alphabets)
2026-02-14 15:16:24,945 - dq_unified - INFO - Total format issues found: 2
2026-02-14 15:16:24,945 - dq_error_log - INFO - Starting batch logging for 2 errors, session: SINGLE_20260214_151624
2026-02-14 15:16:25,022 - dq_error_log - INFO - Batch 1: Successfully logged 2 errors
2026-02-14 15:16:25,023 - dq_error_log - INFO - Progress: 2/2 errors processed
2026-02-14 15:16:25,023 - dq_error_log - INFO - COMPLETE: Logged 2/2 errors for session SINGLE_20260214_151624
2026-02-14 15:16:25,024 - dq_unified - INFO -    Found 2 format issues
2026-02-14 15:16:25,024 - dq_unified - INFO - 4. Checking mandatory fields...
2026-02-14 15:16:25,025 - dq_unified - INFO - Checking mandatory fields
2026-02-14 15:16:25,025 - dq_unified - INFO - Available columns: ['transaction_id', 'account_id', 'customer_email', 'transaction_date', 'amount', 'currency', 'country', 'status', 'remarks']
2026-02-14 15:16:25,026 - dq_unified - INFO - Mandatory field check completed: 0 columns with issues, 0 total missing values
2026-02-14 15:16:25,026 - dq_unified - INFO -    Found 0 missing mandatory values
2026-02-14 15:16:25,026 - dq_unified - INFO - 5. Calculating quality score...
2026-02-14 15:16:25,027 - dq_unified - INFO - Calculating quality score
2026-02-14 15:16:25,027 - dq_unified - INFO - Quality Score Calculation:
2026-02-14 15:16:25,027 - dq_unified - INFO -   Total rows: 1,116
2026-02-14 15:16:25,028 - dq_unified - INFO -   Bad Rows: 236
2026-02-14 15:16:25,028 - dq_unified - INFO -   Good rows (no issues): 880
2026-02-14 15:16:25,028 - dq_unified - INFO -   Quality Score: 78.85%
2026-02-14 15:16:25,126 - dq_error_log - INFO - Retrieved 200 error logs for session SINGLE_20260214_151624
2026-02-14 15:16:25,205 - dq_error_log - INFO - Retrieved summary: 236 total errors for session SINGLE_20260214_151624
2026-02-14 15:16:25,207 - dq_unified - INFO - Added 200 error logs to results
2026-02-14 15:16:25,207 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:16:25,208 - dq_audit - INFO - Starting database insertion for single_source...
2026-02-14 15:16:25,293 - dq_audit - INFO - Inserted single_source record with ID: 560
2026-02-14 15:16:25,372 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151624
2026-02-14 15:16:25,374 - dq_unified - INFO - Added 1 audit logs to results
2026-02-14 15:16:25,375 - dq_unified - INFO - Analysis completed successfully for Database: mysql - Table: single1000
2026-02-14 15:16:25,375 - dq_unified - INFO - Final quality score: 78.85%
2026-02-14 15:16:25,480 - dq_error_log - INFO - Retrieved 200 error logs for session SINGLE_20260214_151624
2026-02-14 15:16:25,554 - dq_error_log - INFO - Retrieved summary: 236 total errors for session SINGLE_20260214_151624
2026-02-14 15:16:25,629 - dq_audit - INFO - Retrieved 1 audit logs for session SINGLE_20260214_151624
2026-02-14 15:16:25,631 - __main__ - INFO - Analysis completed for session SINGLE_20260214_151624
2026-02-14 15:16:25,646 - __main__ - INFO - Completed with status 200 in 2.742s
2026-02-14 15:16:25,678 - __main__ - INFO - GET /api/single/SINGLE_20260214_151624/errors - Request started
2026-02-14 15:16:25,680 - __main__ - INFO - Completed with status 200 in 0.003s
2026-02-14 15:16:26,002 - __main__ - INFO - GET /api/single/SINGLE_20260214_151624/errors - Request started
2026-02-14 15:16:26,004 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-14 15:16:29,576 - __main__ - INFO - GET /api/single/SINGLE_20260214_151624/errors - Request started
2026-02-14 15:16:29,579 - __main__ - INFO - Completed with status 200 in 0.004s
2026-02-14 15:16:31,655 - __main__ - INFO - GET /api/single/SINGLE_20260214_151624/errors - Request started
2026-02-14 15:16:31,659 - __main__ - INFO - Completed with status 200 in 0.004s
2026-02-14 15:16:34,188 - __main__ - INFO - GET /api/single/SINGLE_20260214_151624/errors - Request started
2026-02-14 15:16:34,190 - __main__ - INFO - Completed with status 200 in 0.002s
2026-02-14 15:17:37,491 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:17:37,512 - __main__ - INFO - File uploaded: 20260214_151737_source15.csv (csv)
2026-02-14 15:17:37,514 - __main__ - INFO - Completed with status 200 in 0.023s
2026-02-14 15:17:37,530 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:17:37,546 - __main__ - INFO - File uploaded: 20260214_151737_target13.csv (csv)
2026-02-14 15:17:37,546 - __main__ - INFO - Completed with status 200 in 0.015s
2026-02-14 15:17:37,560 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:17:37,562 - __main__ - INFO - Comparison request - Source: csv, Target: csv
2026-02-14 15:17:37,563 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:17:37,565 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151737_source15.csv'}
2026-02-14 15:17:37,566 - __main__ - INFO - Starting comparison for session CMP_20260214_151737
2026-02-14 15:17:37,568 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:17:37,568 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:17:37,570 - dq_comparison - INFO - 
==================================================
2026-02-14 15:17:37,570 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:17:37,571 - dq_comparison - INFO - ==================================================
2026-02-14 15:17:37,572 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-14 15:17:37,572 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151737_source15.csv
2026-02-14 15:17:37,577 - dq_comparison - INFO - SOURCE CSV loaded: 15 rows, 8 columns
2026-02-14 15:17:37,578 - dq_comparison - INFO - 
==================================================
2026-02-14 15:17:37,578 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:17:37,579 - dq_comparison - INFO - ==================================================
2026-02-14 15:17:37,580 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-14 15:17:37,580 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151737_target13.csv
2026-02-14 15:17:37,585 - dq_comparison - INFO - TARGET CSV loaded: 13 rows, 8 columns
2026-02-14 15:17:37,586 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:17:37,587 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:17:37,587 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:17:37,588 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:17:37,588 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:17:37,590 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:17:37,590 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:17:37,591 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:17:37,591 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:17:37,592 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:17:37,593 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:17:37,593 - dq_comparison - INFO - Report details - Source: CSV: 20260214_151737_source15.csv, Target: CSV: 20260214_151737_target13.csv, Selected columns: 8
2026-02-14 15:17:37,594 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:17:37,594 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:17:37,699 - dq_error_log - INFO - Database connection successful
2026-02-14 15:17:37,700 - dq_comparison - INFO - Session ID: CMP_20260214_151737
2026-02-14 15:17:37,701 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:17:37,701 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:17:37,703 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:17:37,703 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-14 15:17:37,704 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:17:37,704 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:17:37,708 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:17:37,710 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:17:37,710 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:17:37,710 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:17:37,716 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:17:37,717 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:17:37,761 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:17:37,762 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:17:37,762 - dq_comparison - INFO - Column: amount
2026-02-14 15:17:37,763 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:17:37,763 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:17:37,764 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:17:37,765 - dq_comparison - INFO -   Match: True
2026-02-14 15:17:37,765 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:17:37,765 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-14 15:17:37,766 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-14 15:17:37,768 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:17:37,768 - dq_comparison - INFO -   Match: True
2026-02-14 15:17:37,769 - dq_comparison - INFO - Column: account_id
2026-02-14 15:17:37,769 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:17:37,769 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:17:37,770 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:17:37,770 - dq_comparison - INFO -   Match: True
2026-02-14 15:17:37,771 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:17:37,771 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:17:37,771 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:17:37,772 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:17:37,772 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:17:37,772 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:17:37,773 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:17:37,775 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:17:37,777 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:17:37,779 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:17:37,782 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:17:37,784 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:17:37,785 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:17:37,787 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:17:37,787 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:17:37,787 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:17:37,788 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:17:37,789 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:17:37,791 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:17:37,793 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:17:37,796 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:17:37,798 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:17:37,798 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:17:37,799 - dq_comparison - INFO - ======================================================================
2026-02-14 15:17:37,799 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:17:37,800 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:17:37,800 - dq_comparison - INFO -   Source: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:17:37,800 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:17:37,801 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,802 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:17:37,802 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:17:37,803 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:17:37,803 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,804 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:17:37,804 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:17:37,805 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:17:37,805 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,805 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:17:37,806 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:17:37,806 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:17:37,807 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,807 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:17:37,807 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:17:37,808 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:17:37,808 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,808 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:17:37,810 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:17:37,810 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:17:37,811 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:17:37,811 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:17:37,812 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:17:37,812 - dq_comparison - INFO -   Source: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:17:37,812 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:17:37,813 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,815 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:17:37,815 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:17:37,816 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:17:37,816 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,816 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:17:37,818 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:17:37,818 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:17:37,818 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,819 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:17:37,819 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:17:37,820 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:17:37,820 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,821 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:17:37,821 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:17:37,822 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:17:37,822 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,822 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:17:37,823 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:17:37,824 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:17:37,825 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:17:37,825 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:17:37,826 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:17:37,826 - dq_comparison - INFO -   Source: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:17:37,827 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:17:37,827 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,828 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:17:37,829 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:17:37,829 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:17:37,829 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,830 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:17:37,830 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:17:37,831 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:17:37,831 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,831 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:17:37,832 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:17:37,832 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:17:37,833 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,833 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:17:37,834 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:17:37,834 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:17:37,835 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:17:37,835 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:17:37,837 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:17:37,837 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:17:37,838 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:17:37,838 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:17:37,839 - dq_comparison - INFO - Column 1: 'amount' (float64) ‚Üî 'amount' (float64)
2026-02-14 15:17:37,839 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:17:37,840 - dq_comparison - INFO - Column 2: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-02-14 15:17:37,840 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='1/2/2024'
2026-02-14 15:17:37,840 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:17:37,841 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:17:37,841 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:17:37,842 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:17:37,842 - dq_comparison - INFO - Column 5: 'currency' (object) ‚Üî 'currency' (object)
2026-02-14 15:17:37,842 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:17:37,843 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:17:37,843 - dq_comparison - INFO - Found 6 total mismatches
2026-02-14 15:17:37,844 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-14 15:17:38,202 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:17:38,203 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:17:38,204 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-14 15:17:38,204 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-14 15:17:38,204 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:17:38,205 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:17:38,205 - dq_comparison - INFO - ================================================================================
2026-02-14 15:17:38,205 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:17:38,206 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:17:38,206 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:17:38,206 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-14 15:17:38,207 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-14 15:17:38,207 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-14 15:17:38,207 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:17:38,208 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:17:38,209 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:17:38,209 - dq_comparison - INFO -   Common rows: 11
2026-02-14 15:17:38,210 - dq_comparison - INFO -   Unique to source: 4
2026-02-14 15:17:38,211 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:17:38,211 - dq_comparison - INFO -   Value mismatches: 48
2026-02-14 15:17:38,212 - dq_comparison - INFO -   Missing rows: 4
2026-02-14 15:17:38,212 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:17:38,213 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260214_151737_source15.csv) vs CSV (20260214_151737_target13.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | amount: 1015.0                           | amount: 10115.0                         
14    | 2          | amount: 1016.25                          | amount: 10116.25                        
15    | 8          | amount: 1017.5                           | amount: NULL                            
16    | 8          | amount: 1018.75                          | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-14 15:17:38,214 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-14 15:17:38,214 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-14 15:17:38,215 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:17:38,232 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:17:38,234 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:17:38,313 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151737
2026-02-14 15:17:38,315 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:17:38,316 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:17:38,316 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-14 15:17:38,317 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-14 15:17:38,317 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-14 15:17:38,318 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:17:38,318 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:17:38,319 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:17:38,319 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_151737
2026-02-14 15:17:38,320 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:17:38,408 - dq_audit - INFO - Inserted comparison record with ID: 561
2026-02-14 15:17:38,410 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 561)
2026-02-14 15:17:38,486 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151737
2026-02-14 15:17:38,580 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151737
2026-02-14 15:17:38,582 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:17:38,665 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151737
2026-02-14 15:17:38,667 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:17:38,668 - dq_comparison - INFO -    Session ID: CMP_20260214_151737
2026-02-14 15:17:38,669 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-14 15:17:38,669 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:17:38,670 - dq_comparison - INFO -    Matched rows: 11
2026-02-14 15:17:38,670 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-14 15:17:38,670 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:17:38,781 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151737
2026-02-14 15:17:38,865 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151737
2026-02-14 15:17:38,938 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151737
2026-02-14 15:17:38,941 - __main__ - INFO - Completed with status 200 in 1.381s
2026-02-14 15:17:39,297 - __main__ - INFO - GET /api/compare/CMP_20260214_151737/mismatches - Request started
2026-02-14 15:17:39,465 - __main__ - INFO - Completed with status 200 in 0.167s
2026-02-14 15:17:39,559 - __main__ - INFO - GET /api/compare/CMP_20260214_151737/mismatches - Request started
2026-02-14 15:17:39,733 - __main__ - INFO - Completed with status 200 in 0.175s
2026-02-14 15:18:07,652 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:18:07,669 - __main__ - INFO - File uploaded: 20260214_151807_source15.csv (csv)
2026-02-14 15:18:07,671 - __main__ - INFO - Completed with status 200 in 0.019s
2026-02-14 15:18:07,688 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:18:07,732 - __main__ - INFO - File uploaded: 20260214_151807_target13.xlsx (excel)
2026-02-14 15:18:07,734 - __main__ - INFO - Completed with status 200 in 0.045s
2026-02-14 15:18:07,750 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:18:07,752 - __main__ - INFO - Comparison request - Source: csv, Target: excel
2026-02-14 15:18:07,754 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:18:07,754 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151807_source15.csv'}
2026-02-14 15:18:07,756 - __main__ - INFO - Starting comparison for session CMP_20260214_151807
2026-02-14 15:18:07,757 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:18:07,758 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:18:07,759 - dq_comparison - INFO - 
==================================================
2026-02-14 15:18:07,760 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:18:07,760 - dq_comparison - INFO - ==================================================
2026-02-14 15:18:07,760 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-14 15:18:07,762 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151807_source15.csv
2026-02-14 15:18:07,767 - dq_comparison - INFO - SOURCE CSV loaded: 15 rows, 8 columns
2026-02-14 15:18:07,768 - dq_comparison - INFO - 
==================================================
2026-02-14 15:18:07,768 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:18:07,769 - dq_comparison - INFO - ==================================================
2026-02-14 15:18:07,769 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-14 15:18:07,770 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151807_target13.xlsx'}
2026-02-14 15:18:07,770 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-14 15:18:07,771 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151807_target13.xlsx
2026-02-14 15:18:07,803 - dq_comparison - INFO - TARGET Excel loaded: 13 rows, 8 columns
2026-02-14 15:18:07,804 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:18:07,804 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:18:07,805 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:18:07,806 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:07,806 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:07,806 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:07,807 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:18:07,807 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:18:07,808 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:18:07,809 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:18:07,809 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:18:07,811 - dq_comparison - INFO - Report details - Source: CSV: 20260214_151807_source15.csv, Target: Excel: 20260214_151807_target13.xlsx (target13), Selected columns: 8
2026-02-14 15:18:07,811 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:18:07,812 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:18:07,894 - dq_error_log - INFO - Database connection successful
2026-02-14 15:18:07,895 - dq_comparison - INFO - Session ID: CMP_20260214_151807
2026-02-14 15:18:07,896 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:18:07,896 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:18:07,897 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:18:07,897 - dq_comparison - WARNING - Found 1 incompatible data type mismatches
2026-02-14 15:18:07,898 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-14 15:18:07,898 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:18:07,899 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:18:07,902 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:18:07,905 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:18:07,905 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:18:07,906 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:18:07,911 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:18:07,912 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:18:07,914 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:18:07,914 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:18:07,915 - dq_comparison - INFO - Column: amount
2026-02-14 15:18:07,915 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:18:07,916 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:18:07,916 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:18:07,917 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:07,917 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:18:07,917 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-14 15:18:07,918 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:18:07,921 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:18:07,922 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:07,922 - dq_comparison - INFO - Column: account_id
2026-02-14 15:18:07,923 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:18:07,923 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:18:07,923 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:18:07,924 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:07,924 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:07,925 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:07,925 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:07,926 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:18:07,926 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:07,926 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:07,927 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:18:07,928 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:18:07,930 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:18:07,932 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:18:07,935 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:18:07,937 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:18:07,938 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:18:07,939 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:18:07,939 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:18:07,939 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:18:07,940 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:18:07,942 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:18:07,944 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:18:07,946 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:18:07,950 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:18:07,952 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:18:07,952 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:18:07,953 - dq_comparison - INFO - ======================================================================
2026-02-14 15:18:07,953 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:18:07,954 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:07,954 - dq_comparison - INFO -   Source: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:18:07,954 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:18:07,955 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,956 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:07,957 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:18:07,957 - dq_comparison - INFO -   Target: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:18:07,957 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,958 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:07,958 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:18:07,959 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:18:07,959 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,960 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:07,960 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:18:07,960 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:18:07,961 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,961 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:07,961 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:07,962 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:07,962 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,963 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:18:07,964 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:18:07,965 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:18:07,965 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:07,966 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:18:07,966 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:07,967 - dq_comparison - INFO -   Source: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:18:07,967 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:18:07,968 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,969 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:07,969 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:18:07,970 - dq_comparison - INFO -   Target: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:18:07,970 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,970 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:07,971 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:18:07,971 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:18:07,972 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,972 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:07,972 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:18:07,973 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:18:07,973 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,974 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:07,974 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:07,975 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:07,975 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,976 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:18:07,977 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:18:07,978 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:18:07,978 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:07,978 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:18:07,979 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:07,980 - dq_comparison - INFO -   Source: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:18:07,980 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:18:07,981 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,982 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:07,982 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:18:07,983 - dq_comparison - INFO -   Target: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:18:07,983 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,983 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:07,984 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:18:07,984 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:18:07,985 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,985 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:07,986 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:18:07,986 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:18:07,986 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,987 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:07,987 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:07,988 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:07,988 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:07,988 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:18:07,990 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:18:07,990 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:18:07,990 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:07,991 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:18:07,992 - dq_comparison - INFO - Column 1: 'amount' (float64) ‚Üî 'amount' (float64)
2026-02-14 15:18:07,992 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:18:07,992 - dq_comparison - INFO - Column 2: 'transaction_date' (object) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-14 15:18:07,993 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='2024-01-02 00:00:00'
2026-02-14 15:18:07,993 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:18:07,994 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:18:07,994 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:18:07,995 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:18:07,995 - dq_comparison - INFO - Column 5: 'currency' (object) ‚Üî 'currency' (object)
2026-02-14 15:18:07,996 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:18:07,996 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:18:07,997 - dq_comparison - INFO - Found 6 total mismatches
2026-02-14 15:18:07,997 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-14 15:18:08,325 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:18:08,326 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:18:08,326 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-14 15:18:08,326 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-14 15:18:08,327 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:18:08,327 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:18:08,328 - dq_comparison - INFO - ================================================================================
2026-02-14 15:18:08,328 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:18:08,328 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:18:08,329 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:18:08,329 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-14 15:18:08,329 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-14 15:18:08,330 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-14 15:18:08,330 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:18:08,331 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:18:08,331 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:18:08,332 - dq_comparison - INFO -   Common rows: 11
2026-02-14 15:18:08,332 - dq_comparison - INFO -   Unique to source: 4
2026-02-14 15:18:08,333 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:18:08,333 - dq_comparison - INFO -   Value mismatches: 48
2026-02-14 15:18:08,334 - dq_comparison - INFO -   Missing rows: 4
2026-02-14 15:18:08,334 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:18:08,335 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260214_151807_source15.csv) vs Excel (20260214_151807_target13.xlsx (target13))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | amount: 1015.0                           | amount: 10115.0                         
14    | 2          | amount: 1016.25                          | amount: 10116.25                        
15    | 8          | amount: 1017.5                           | amount: NULL                            
16    | 8          | amount: 1018.75                          | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-14 15:18:08,336 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-14 15:18:08,336 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-14 15:18:08,336 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:18:08,357 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:18:08,359 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:18:08,431 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151807
2026-02-14 15:18:08,433 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:18:08,433 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:18:08,434 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-14 15:18:08,434 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-14 15:18:08,435 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-14 15:18:08,435 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:18:08,435 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:18:08,436 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:18:08,436 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_151807
2026-02-14 15:18:08,437 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:18:08,512 - dq_audit - INFO - Inserted comparison record with ID: 562
2026-02-14 15:18:08,514 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 562)
2026-02-14 15:18:08,585 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151807
2026-02-14 15:18:08,656 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151807
2026-02-14 15:18:08,657 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:18:08,750 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151807
2026-02-14 15:18:08,752 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:18:08,753 - dq_comparison - INFO -    Session ID: CMP_20260214_151807
2026-02-14 15:18:08,753 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-14 15:18:08,754 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:18:08,754 - dq_comparison - INFO -    Matched rows: 11
2026-02-14 15:18:08,754 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-14 15:18:08,755 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:18:08,846 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151807
2026-02-14 15:18:08,932 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151807
2026-02-14 15:18:09,005 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151807
2026-02-14 15:18:09,008 - __main__ - INFO - Completed with status 200 in 1.258s
2026-02-14 15:18:09,075 - __main__ - INFO - GET /api/compare/CMP_20260214_151807/mismatches - Request started
2026-02-14 15:18:09,243 - __main__ - INFO - Completed with status 200 in 0.168s
2026-02-14 15:18:09,252 - __main__ - INFO - GET /api/compare/CMP_20260214_151807/mismatches - Request started
2026-02-14 15:18:09,448 - __main__ - INFO - Completed with status 200 in 0.196s
2026-02-14 15:18:34,817 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:18:34,861 - __main__ - INFO - File uploaded: 20260214_151834_source15.xlsx (excel)
2026-02-14 15:18:34,862 - __main__ - INFO - Completed with status 200 in 0.046s
2026-02-14 15:18:35,086 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:18:35,097 - __main__ - INFO - File uploaded: 20260214_151835_target13.csv (csv)
2026-02-14 15:18:35,098 - __main__ - INFO - Completed with status 200 in 0.013s
2026-02-14 15:18:35,191 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:18:35,192 - __main__ - INFO - Comparison request - Source: excel, Target: csv
2026-02-14 15:18:35,193 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:18:35,194 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'excel', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151834_source15.xlsx'}
2026-02-14 15:18:35,195 - __main__ - INFO - Starting comparison for session CMP_20260214_151835
2026-02-14 15:18:35,195 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:18:35,196 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:18:35,196 - dq_comparison - INFO - 
==================================================
2026-02-14 15:18:35,197 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:18:35,197 - dq_comparison - INFO - ==================================================
2026-02-14 15:18:35,198 - dq_comparison - INFO - DEBUG load_excel_source called for SOURCE
2026-02-14 15:18:35,198 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151834_source15.xlsx', 'file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151834_source15.xlsx', 'sheet_name': None}
2026-02-14 15:18:35,199 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-14 15:18:35,199 - dq_comparison - INFO - DEBUG Found file_path in ui_data: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151834_source15.xlsx
2026-02-14 15:18:35,240 - dq_comparison - INFO - SOURCE Excel loaded: 15 rows, 8 columns
2026-02-14 15:18:35,241 - dq_comparison - INFO - 
==================================================
2026-02-14 15:18:35,241 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:18:35,242 - dq_comparison - INFO - ==================================================
2026-02-14 15:18:35,242 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-14 15:18:35,242 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151835_target13.csv
2026-02-14 15:18:35,247 - dq_comparison - INFO - TARGET CSV loaded: 13 rows, 8 columns
2026-02-14 15:18:35,247 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:18:35,248 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:18:35,248 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:18:35,250 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:35,250 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:35,251 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:35,251 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:18:35,252 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:18:35,252 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:18:35,253 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:18:35,253 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:18:35,254 - dq_comparison - INFO - Report details - Source: Excel: 20260214_151834_source15.xlsx (source15), Target: CSV: 20260214_151835_target13.csv, Selected columns: 8
2026-02-14 15:18:35,254 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:18:35,254 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:18:35,334 - dq_error_log - INFO - Database connection successful
2026-02-14 15:18:35,335 - dq_comparison - INFO - Session ID: CMP_20260214_151835
2026-02-14 15:18:35,336 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:18:35,337 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:18:35,337 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:18:35,338 - dq_comparison - INFO - Found 1 data type mismatches (all compatible)
2026-02-14 15:18:35,338 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-14 15:18:35,339 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:18:35,339 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:18:35,343 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:18:35,345 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:18:35,346 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:18:35,346 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:18:35,351 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:18:35,351 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:18:35,353 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:18:35,354 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:18:35,354 - dq_comparison - INFO - Column: amount
2026-02-14 15:18:35,354 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:18:35,355 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:18:35,356 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:18:35,357 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:35,357 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:18:35,358 - dq_comparison - INFO -   Source type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:18:35,358 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-14 15:18:35,360 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:18:35,360 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:35,361 - dq_comparison - INFO - Column: account_id
2026-02-14 15:18:35,361 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:18:35,361 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:18:35,362 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:18:35,362 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:35,363 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:35,363 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:35,363 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:35,364 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:18:35,364 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:35,364 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:35,365 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:18:35,367 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:18:35,371 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:18:35,373 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:18:35,375 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:18:35,378 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:18:35,379 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:18:35,379 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:18:35,380 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:18:35,380 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:18:35,381 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:18:35,382 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:18:35,384 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:18:35,387 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:18:35,389 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:18:35,391 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:18:35,391 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:18:35,392 - dq_comparison - INFO - ======================================================================
2026-02-14 15:18:35,392 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:18:35,393 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:35,393 - dq_comparison - INFO -   Source: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:18:35,394 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:18:35,394 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,395 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:35,396 - dq_comparison - INFO -   Source: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:18:35,396 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:18:35,396 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,396 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:35,398 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:18:35,399 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:18:35,399 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,400 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:35,400 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:18:35,401 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:18:35,401 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,401 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:35,403 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:35,404 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:35,404 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,405 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:18:35,407 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:18:35,407 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:18:35,407 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:35,408 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:18:35,409 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:35,409 - dq_comparison - INFO -   Source: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:18:35,410 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:18:35,410 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,412 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:35,413 - dq_comparison - INFO -   Source: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:18:35,414 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:18:35,414 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,415 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:35,416 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:18:35,416 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:18:35,416 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,417 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:35,419 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:18:35,420 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:18:35,420 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,421 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:35,421 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:35,422 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:35,422 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,423 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:18:35,424 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:18:35,424 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:18:35,425 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:35,425 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:18:35,426 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:35,426 - dq_comparison - INFO -   Source: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:18:35,427 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:18:35,427 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,428 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:35,429 - dq_comparison - INFO -   Source: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:18:35,429 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:18:35,430 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,430 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:35,431 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:18:35,431 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:18:35,431 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,432 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:35,432 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:18:35,432 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:18:35,433 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,433 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:35,434 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:35,434 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:35,434 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:35,434 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:18:35,437 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:18:35,437 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:18:35,438 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:35,438 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:18:35,438 - dq_comparison - INFO - Column 1: 'amount' (float64) ‚Üî 'amount' (float64)
2026-02-14 15:18:35,439 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:18:35,439 - dq_comparison - INFO - Column 2: 'transaction_date' (datetime64[ns]) ‚Üî 'transaction_date' (object)
2026-02-14 15:18:35,440 - dq_comparison - INFO -   Sample: Source='2024-01-02 00:00:00', Target='1/2/2024'
2026-02-14 15:18:35,440 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:18:35,440 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:18:35,441 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:18:35,441 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:18:35,442 - dq_comparison - INFO - Column 5: 'currency' (object) ‚Üî 'currency' (object)
2026-02-14 15:18:35,442 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:18:35,442 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:18:35,443 - dq_comparison - INFO - Found 6 total mismatches
2026-02-14 15:18:35,443 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-14 15:18:35,756 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:18:35,757 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:18:35,757 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-14 15:18:35,758 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-14 15:18:35,758 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:18:35,758 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:18:35,759 - dq_comparison - INFO - ================================================================================
2026-02-14 15:18:35,759 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:18:35,759 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:18:35,760 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:18:35,760 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-14 15:18:35,760 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-14 15:18:35,760 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-14 15:18:35,761 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:18:35,761 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:18:35,763 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:18:35,763 - dq_comparison - INFO -   Common rows: 11
2026-02-14 15:18:35,763 - dq_comparison - INFO -   Unique to source: 4
2026-02-14 15:18:35,764 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:18:35,764 - dq_comparison - INFO -   Value mismatches: 48
2026-02-14 15:18:35,764 - dq_comparison - INFO -   Missing rows: 4
2026-02-14 15:18:35,764 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:18:35,766 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Excel (20260214_151834_source15.xlsx (source15)) vs CSV (20260214_151835_target13.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | amount: 1015.0                           | amount: 10115.0                         
14    | 2          | amount: 1016.25                          | amount: 10116.25                        
15    | 8          | amount: 1017.5                           | amount: NULL                            
16    | 8          | amount: 1018.75                          | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-14 15:18:35,766 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-14 15:18:35,766 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-14 15:18:35,767 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:18:35,784 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:18:35,785 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:18:35,865 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151835
2026-02-14 15:18:35,867 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:18:35,868 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:18:35,869 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-14 15:18:35,869 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-14 15:18:35,870 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-14 15:18:35,871 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:18:35,871 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:18:35,872 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:18:35,873 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_151835
2026-02-14 15:18:35,874 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:18:35,960 - dq_audit - INFO - Inserted comparison record with ID: 563
2026-02-14 15:18:35,961 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 563)
2026-02-14 15:18:36,038 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151835
2026-02-14 15:18:36,116 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151835
2026-02-14 15:18:36,118 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:18:36,198 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151835
2026-02-14 15:18:36,200 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:18:36,200 - dq_comparison - INFO -    Session ID: CMP_20260214_151835
2026-02-14 15:18:36,201 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-14 15:18:36,201 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:18:36,201 - dq_comparison - INFO -    Matched rows: 11
2026-02-14 15:18:36,202 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-14 15:18:36,202 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:18:36,278 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151835
2026-02-14 15:18:36,356 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151835
2026-02-14 15:18:36,433 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151835
2026-02-14 15:18:36,436 - __main__ - INFO - Completed with status 200 in 1.245s
2026-02-14 15:18:36,476 - __main__ - INFO - GET /api/compare/CMP_20260214_151835/mismatches - Request started
2026-02-14 15:18:36,643 - __main__ - INFO - Completed with status 200 in 0.167s
2026-02-14 15:18:36,970 - __main__ - INFO - GET /api/compare/CMP_20260214_151835/mismatches - Request started
2026-02-14 15:18:37,150 - __main__ - INFO - Completed with status 200 in 0.180s
2026-02-14 15:18:58,988 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:18:59,035 - __main__ - INFO - File uploaded: 20260214_151858_source15.xlsx (excel)
2026-02-14 15:18:59,037 - __main__ - INFO - Completed with status 200 in 0.048s
2026-02-14 15:18:59,247 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:18:59,288 - __main__ - INFO - File uploaded: 20260214_151859_target13.xlsx (excel)
2026-02-14 15:18:59,289 - __main__ - INFO - Completed with status 200 in 0.042s
2026-02-14 15:18:59,355 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:18:59,356 - __main__ - INFO - Comparison request - Source: excel, Target: excel
2026-02-14 15:18:59,357 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:18:59,358 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'excel', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151858_source15.xlsx'}
2026-02-14 15:18:59,358 - __main__ - INFO - Starting comparison for session CMP_20260214_151859
2026-02-14 15:18:59,359 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:18:59,359 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:18:59,360 - dq_comparison - INFO - 
==================================================
2026-02-14 15:18:59,360 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:18:59,361 - dq_comparison - INFO - ==================================================
2026-02-14 15:18:59,361 - dq_comparison - INFO - DEBUG load_excel_source called for SOURCE
2026-02-14 15:18:59,361 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151858_source15.xlsx', 'file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151858_source15.xlsx', 'sheet_name': None}
2026-02-14 15:18:59,362 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-14 15:18:59,362 - dq_comparison - INFO - DEBUG Found file_path in ui_data: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151858_source15.xlsx
2026-02-14 15:18:59,395 - dq_comparison - INFO - SOURCE Excel loaded: 15 rows, 8 columns
2026-02-14 15:18:59,396 - dq_comparison - INFO - 
==================================================
2026-02-14 15:18:59,396 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:18:59,397 - dq_comparison - INFO - ==================================================
2026-02-14 15:18:59,397 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-14 15:18:59,397 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151859_target13.xlsx'}
2026-02-14 15:18:59,398 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-14 15:18:59,398 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_151859_target13.xlsx
2026-02-14 15:18:59,426 - dq_comparison - INFO - TARGET Excel loaded: 13 rows, 8 columns
2026-02-14 15:18:59,427 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:18:59,427 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:18:59,428 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:18:59,428 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:59,429 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:59,429 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:59,429 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:18:59,430 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:18:59,430 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:18:59,430 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:18:59,431 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:18:59,431 - dq_comparison - INFO - Report details - Source: Excel: 20260214_151858_source15.xlsx (source15), Target: Excel: 20260214_151859_target13.xlsx (target13), Selected columns: 8
2026-02-14 15:18:59,432 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:18:59,432 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:18:59,515 - dq_error_log - INFO - Database connection successful
2026-02-14 15:18:59,517 - dq_comparison - INFO - Session ID: CMP_20260214_151859
2026-02-14 15:18:59,517 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:18:59,518 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:18:59,518 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:18:59,519 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-14 15:18:59,520 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:18:59,520 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:18:59,524 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:18:59,527 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:18:59,527 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:18:59,528 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:18:59,534 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:18:59,535 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:18:59,539 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:18:59,539 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:18:59,541 - dq_comparison - INFO - Column: amount
2026-02-14 15:18:59,541 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:18:59,541 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:18:59,542 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:18:59,542 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:59,543 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:18:59,543 - dq_comparison - INFO -   Source type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:18:59,543 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:18:59,546 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:18:59,546 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:59,547 - dq_comparison - INFO - Column: account_id
2026-02-14 15:18:59,547 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:18:59,548 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:18:59,548 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:18:59,549 - dq_comparison - INFO -   Match: True
2026-02-14 15:18:59,549 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:59,550 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:18:59,550 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:59,551 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:18:59,551 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:59,552 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:18:59,552 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:18:59,554 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:18:59,556 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:18:59,559 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:18:59,561 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:18:59,563 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:18:59,565 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:18:59,565 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:18:59,566 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:18:59,567 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:18:59,567 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:18:59,569 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:18:59,571 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:18:59,574 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:18:59,576 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:18:59,578 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:18:59,578 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:18:59,579 - dq_comparison - INFO - ======================================================================
2026-02-14 15:18:59,579 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:18:59,580 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:59,580 - dq_comparison - INFO -   Source: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:18:59,580 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:18:59,581 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,583 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:59,584 - dq_comparison - INFO -   Source: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:18:59,584 - dq_comparison - INFO -   Target: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:18:59,585 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,586 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:59,586 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:18:59,587 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:18:59,587 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,588 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:59,589 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:18:59,589 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:18:59,590 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,590 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:59,591 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:59,592 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:59,592 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,593 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:18:59,595 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:18:59,596 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:18:59,596 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:59,597 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:18:59,599 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:59,600 - dq_comparison - INFO -   Source: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:18:59,601 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:18:59,602 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,603 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:59,604 - dq_comparison - INFO -   Source: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:18:59,604 - dq_comparison - INFO -   Target: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:18:59,605 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,605 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:59,606 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:18:59,606 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:18:59,606 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,607 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:59,607 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:18:59,608 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:18:59,608 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,608 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:59,609 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:59,609 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:59,609 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,610 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:18:59,611 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:18:59,612 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:18:59,612 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:59,612 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:18:59,613 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:18:59,614 - dq_comparison - INFO -   Source: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:18:59,614 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:18:59,615 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,616 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:18:59,617 - dq_comparison - INFO -   Source: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:18:59,617 - dq_comparison - INFO -   Target: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:18:59,617 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,618 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:18:59,618 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:18:59,619 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:18:59,619 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,619 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:18:59,620 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:18:59,620 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:18:59,621 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,621 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:18:59,621 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:59,622 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:18:59,622 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:18:59,622 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:18:59,624 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:18:59,624 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:18:59,625 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:18:59,625 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:18:59,625 - dq_comparison - INFO - Column 1: 'amount' (float64) ‚Üî 'amount' (float64)
2026-02-14 15:18:59,625 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:18:59,626 - dq_comparison - INFO - Column 2: 'transaction_date' (datetime64[ns]) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-14 15:18:59,626 - dq_comparison - INFO -   Sample: Source='2024-01-02 00:00:00', Target='2024-01-02 00:00:00'
2026-02-14 15:18:59,627 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:18:59,627 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:18:59,628 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:18:59,629 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:18:59,629 - dq_comparison - INFO - Column 5: 'currency' (object) ‚Üî 'currency' (object)
2026-02-14 15:18:59,630 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:18:59,630 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:18:59,630 - dq_comparison - INFO - Found 6 total mismatches
2026-02-14 15:18:59,631 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-14 15:18:59,960 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:18:59,961 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:18:59,961 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-14 15:18:59,962 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-14 15:18:59,962 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:18:59,962 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:18:59,963 - dq_comparison - INFO - ================================================================================
2026-02-14 15:18:59,963 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:18:59,963 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:18:59,964 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:18:59,964 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-14 15:18:59,964 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-14 15:18:59,965 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-14 15:18:59,965 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:18:59,966 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:18:59,966 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:18:59,967 - dq_comparison - INFO -   Common rows: 11
2026-02-14 15:18:59,967 - dq_comparison - INFO -   Unique to source: 4
2026-02-14 15:18:59,967 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:18:59,969 - dq_comparison - INFO -   Value mismatches: 48
2026-02-14 15:18:59,969 - dq_comparison - INFO -   Missing rows: 4
2026-02-14 15:18:59,969 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:18:59,969 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Excel (20260214_151858_source15.xlsx (source15)) vs Excel (20260214_151859_target13.xlsx (target13))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | amount: 1015.0                           | amount: 10115.0                         
14    | 2          | amount: 1016.25                          | amount: 10116.25                        
15    | 8          | amount: 1017.5                           | amount: NULL                            
16    | 8          | amount: 1018.75                          | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-14 15:18:59,969 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-14 15:18:59,969 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-14 15:18:59,971 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:18:59,990 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:18:59,993 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:19:00,100 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151859
2026-02-14 15:19:00,102 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:19:00,102 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:19:00,103 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-14 15:19:00,103 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-14 15:19:00,104 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-14 15:19:00,104 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:19:00,104 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:19:00,105 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:19:00,105 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_151859
2026-02-14 15:19:00,106 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:19:00,195 - dq_audit - INFO - Inserted comparison record with ID: 564
2026-02-14 15:19:00,197 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 564)
2026-02-14 15:19:00,277 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151859
2026-02-14 15:19:00,361 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151859
2026-02-14 15:19:00,362 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:19:00,457 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151859
2026-02-14 15:19:00,459 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:19:00,459 - dq_comparison - INFO -    Session ID: CMP_20260214_151859
2026-02-14 15:19:00,460 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-14 15:19:00,460 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:19:00,461 - dq_comparison - INFO -    Matched rows: 11
2026-02-14 15:19:00,461 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-14 15:19:00,462 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:19:00,551 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_151859
2026-02-14 15:19:00,640 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_151859
2026-02-14 15:19:00,727 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_151859
2026-02-14 15:19:00,730 - __main__ - INFO - Completed with status 200 in 1.375s
2026-02-14 15:19:00,768 - __main__ - INFO - GET /api/compare/CMP_20260214_151859/mismatches - Request started
2026-02-14 15:19:00,928 - __main__ - INFO - Completed with status 200 in 0.161s
2026-02-14 15:19:01,245 - __main__ - INFO - GET /api/compare/CMP_20260214_151859/mismatches - Request started
2026-02-14 15:19:01,437 - __main__ - INFO - Completed with status 200 in 0.192s
2026-02-14 15:19:41,889 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:19:41,890 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:19:41,891 - __main__ - INFO - Database: Not provided
2026-02-14 15:19:41,896 - __main__ - INFO - Schema: Not provided
2026-02-14 15:19:41,896 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:19:41,899 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:19:41,900 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:19:42,025 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:19:42,027 - __main__ - INFO - Getting databases list...
2026-02-14 15:19:42,028 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-14 15:19:42,040 - database_navigator - INFO - Found 7 databases
2026-02-14 15:19:42,042 - __main__ - INFO - Found 7 databases
2026-02-14 15:19:42,044 - __main__ - INFO - Completed with status 200 in 0.155s
2026-02-14 15:19:44,484 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:19:44,494 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:19:44,500 - __main__ - INFO - Database: dq_checks
2026-02-14 15:19:44,502 - __main__ - INFO - Schema: Not provided
2026-02-14 15:19:44,506 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:19:44,510 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:19:44,511 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:19:44,651 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:19:44,652 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-14 15:19:44,654 - database_navigator - INFO - Found 1 schemas
2026-02-14 15:19:44,655 - __main__ - INFO - Found 1 schemas
2026-02-14 15:19:44,657 - __main__ - INFO - Completed with status 200 in 0.173s
2026-02-14 15:19:45,974 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:19:45,975 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:19:45,976 - __main__ - INFO - Database: Not provided
2026-02-14 15:19:45,976 - __main__ - INFO - Schema: Not provided
2026-02-14 15:19:45,977 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:19:45,978 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:19:45,978 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:19:45,979 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:19:45,980 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:19:46,222 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC3670; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:19:46,225 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:19:46,226 - __main__ - INFO - Getting databases list...
2026-02-14 15:19:46,227 - database_navigator - INFO - get_databases() called. db_type: postgresql, connection exists: True
2026-02-14 15:19:46,257 - database_navigator - INFO - Raw rows: [('dq_checks',), ('postgres',), ('test',)]
2026-02-14 15:19:46,258 - database_navigator - INFO - Found 3 databases
2026-02-14 15:19:46,259 - __main__ - INFO - Found 3 databases
2026-02-14 15:19:46,260 - __main__ - INFO - Completed with status 200 in 0.286s
2026-02-14 15:19:48,317 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:19:48,319 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:19:48,320 - __main__ - INFO - Database: dq_checks
2026-02-14 15:19:48,322 - __main__ - INFO - Schema: Not provided
2026-02-14 15:19:48,322 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:19:48,324 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:19:48,325 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:19:48,326 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:19:48,327 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:19:48,582 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC3670; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:19:48,584 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:19:48,585 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-14 15:19:48,586 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-02-14 15:19:48,587 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:19:48,588 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:19:48,589 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-02-14 15:19:48,813 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC2570; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-02-14 15:19:48,815 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-02-14 15:19:48,871 - database_navigator - INFO - Found 4 schemas
2026-02-14 15:19:48,872 - __main__ - INFO - Found 4 schemas
2026-02-14 15:19:48,872 - __main__ - INFO - Completed with status 200 in 0.554s
2026-02-14 15:19:51,670 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:19:51,671 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:19:51,672 - __main__ - INFO - Database: dq_checks
2026-02-14 15:19:51,672 - __main__ - INFO - Schema: public
2026-02-14 15:19:51,673 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:19:51,674 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:19:51,675 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:19:51,675 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:19:51,676 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:19:51,868 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC2570; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:19:51,869 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:19:51,870 - __main__ - INFO - Getting tables for database: dq_checks, schema: public
2026-02-14 15:19:51,870 - database_navigator - INFO - Ensuring connection to database: dq_checks for table list
2026-02-14 15:19:51,871 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-02-14 15:19:51,872 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:19:51,873 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:19:51,874 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-02-14 15:19:52,066 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC09D0; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-02-14 15:19:52,067 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-02-14 15:19:52,068 - database_navigator - INFO - Connected to database: dq_checks, schema: public
2026-02-14 15:19:52,155 - database_navigator - INFO - Found 20 tables in dq_checks.public: ['advanced100', 'advanced1000', 'advanced10000', 'advanced100000', 'advanced15', 'customers', 'employee', 'rulesdata', 'single100', 'single1000', 'single10000', 'single100000', 'single15', 'target13', 'target90', 'target900', 'target9000', 'target90000', 'testadv', 'testadv_stage']
2026-02-14 15:19:52,156 - database_navigator - INFO - Found 20 tables in schema 'public'
2026-02-14 15:19:52,158 - __main__ - INFO - Found 20 tables
2026-02-14 15:19:52,159 - __main__ - INFO - Completed with status 200 in 0.490s
2026-02-14 15:20:04,583 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:20:04,585 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:20:04,586 - __main__ - INFO - Database: dq_checks
2026-02-14 15:20:04,586 - __main__ - INFO - Schema: dq_checks
2026-02-14 15:20:04,588 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:20:04,588 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:20:04,591 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:20:04,692 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:20:04,693 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-14 15:20:04,705 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-14 15:20:04,706 - __main__ - INFO - Found 28 tables
2026-02-14 15:20:04,708 - __main__ - INFO - Completed with status 200 in 0.125s
2026-02-14 15:20:09,269 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:20:09,270 - __main__ - INFO - Comparison request - Source: database, Target: database
2026-02-14 15:20:09,271 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:20:09,271 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'mysql', 'host': 'localhost', 'port': 3306, 'database': 'dq_checks', 'schema': 'dq_checks', 'table': 'source15', 'user': 'root', 'password': 'root'}
2026-02-14 15:20:09,272 - __main__ - INFO - Starting comparison for session CMP_20260214_152009
2026-02-14 15:20:09,273 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:20:09,275 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:20:09,276 - dq_comparison - INFO - 
==================================================
2026-02-14 15:20:09,277 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:20:09,277 - dq_comparison - INFO - ==================================================
2026-02-14 15:20:09,278 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-02-14 15:20:09,278 - dq_comparison - INFO - ----------------------------------------
2026-02-14 15:20:09,279 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-02-14 15:20:09,279 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:20:09,279 - dq_unified - INFO - Loading large database table: source15
2026-02-14 15:20:09,280 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-14 15:20:09,395 - dq_unified - INFO - MySQL table source15 has 15 rows
2026-02-14 15:20:09,396 - dq_unified - INFO - Loading 15 rows from MySQL...
2026-02-14 15:20:09,406 - dq_unified - INFO - Loaded 15 rows from MySQL
2026-02-14 15:20:09,415 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:20:09,417 - dq_unified - INFO - Loaded 15 rows, 8 columns. Memory: 140.4MB total, 0.0MB for dataframe
2026-02-14 15:20:09,417 - dq_comparison - INFO - SOURCE database loaded: 15 rows, 8 columns
2026-02-14 15:20:09,418 - dq_comparison - INFO - 
==================================================
2026-02-14 15:20:09,418 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:20:09,419 - dq_comparison - INFO - ==================================================
2026-02-14 15:20:09,419 - dq_comparison - INFO - 
üóÑÔ∏è TARGET DATABASE CONFIGURATION
2026-02-14 15:20:09,419 - dq_comparison - INFO - ----------------------------------------
2026-02-14 15:20:09,420 - dq_comparison - INFO - Converted db_type to numeric code: 1
2026-02-14 15:20:09,421 - dq_comparison - INFO - Selected database type code: postgresql
2026-02-14 15:20:09,422 - dq_unified - INFO - Getting database config from config file
2026-02-14 15:20:09,422 - dq_unified - INFO - Using POSTGRESQL configuration from config file
2026-02-14 15:20:09,423 - dq_unified - INFO - Database configuration from config file: postgresql, Table: target13
2026-02-14 15:20:09,423 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:20:09,423 - dq_unified - INFO - Loading large database table: target13
2026-02-14 15:20:09,424 - dq_unified - INFO - Normalized DB config with schema: public
2026-02-14 15:20:09,619 - dq_unified - INFO - PostgreSQL table public.target13 has 13 rows
2026-02-14 15:20:09,620 - dq_unified - INFO - Loading 13 rows from PostgreSQL...
2026-02-14 15:20:09,623 - dq_unified - INFO - Loaded 13 rows from PostgreSQL
2026-02-14 15:20:09,627 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:20:09,628 - dq_unified - INFO - Loaded 13 rows, 8 columns. Memory: 140.4MB total, 0.0MB for dataframe
2026-02-14 15:20:09,629 - dq_comparison - INFO - TARGET database loaded: 13 rows, 8 columns
2026-02-14 15:20:09,629 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:20:09,629 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:20:09,630 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:20:09,630 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:20:09,631 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:20:09,631 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:20:09,631 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:20:09,632 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:20:09,632 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:20:09,632 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:20:09,633 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:20:09,633 - dq_comparison - INFO - Report details - Source: Database: mysql - dq_checks.source15, Target: Database: postgresql - dq_checks.target13, Selected columns: 8
2026-02-14 15:20:09,633 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:20:09,634 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:20:09,707 - dq_error_log - INFO - Database connection successful
2026-02-14 15:20:09,708 - dq_comparison - INFO - Session ID: CMP_20260214_152009
2026-02-14 15:20:09,708 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:20:09,709 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:20:09,709 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:20:09,710 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-14 15:20:09,710 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:20:09,711 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:20:09,713 - dq_comparison - INFO - Auto-detected common key fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:20:09,717 - dq_comparison - INFO - Primary key validation passed for fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:20:09,717 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:20:09,718 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:20:09,723 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:20:09,723 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:20:09,726 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:20:09,727 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:20:09,727 - dq_comparison - INFO - Column: amount
2026-02-14 15:20:09,728 - dq_comparison - INFO -   Source type: <class 'numpy.float32'>, value: 1001.25
2026-02-14 15:20:09,728 - dq_comparison - INFO -   Target type: <class 'numpy.float32'>, value: 1001.25
2026-02-14 15:20:09,728 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:20:09,729 - dq_comparison - INFO -   Match: True
2026-02-14 15:20:09,729 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:20:09,730 - dq_comparison - INFO -   Source type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:20:09,730 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:20:09,732 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:20:09,733 - dq_comparison - INFO -   Match: True
2026-02-14 15:20:09,734 - dq_comparison - INFO - Column: account_id
2026-02-14 15:20:09,734 - dq_comparison - INFO -   Source type: <class 'numpy.uint8'>, value: 1
2026-02-14 15:20:09,735 - dq_comparison - INFO -   Target type: <class 'numpy.uint8'>, value: 1
2026-02-14 15:20:09,735 - dq_comparison - INFO -   Normalized: '1' vs '1'
2026-02-14 15:20:09,736 - dq_comparison - INFO -   Match: True
2026-02-14 15:20:09,736 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:20:09,736 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:20:09,737 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:20:09,737 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:20:09,738 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:20:09,738 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:20:09,738 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:20:09,741 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:20:09,743 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:20:09,746 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:20:09,748 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:20:09,751 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:20:09,752 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:20:09,752 - dq_comparison - INFO - Hash 1: 524d9ba30607aa88... (sample row 0)
2026-02-14 15:20:09,753 - dq_comparison - INFO - Hash 2: 8e039ce62fbc3c0d... (sample row 1)
2026-02-14 15:20:09,753 - dq_comparison - INFO - Hash 3: 3e951b47b7f65ad8... (sample row 2)
2026-02-14 15:20:09,753 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:20:09,756 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:20:09,758 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:20:09,761 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:20:09,763 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:20:09,765 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:20:09,766 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:20:09,766 - dq_comparison - INFO - ======================================================================
2026-02-14 15:20:09,766 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:20:09,767 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:20:09,768 - dq_comparison - INFO -   Source: '1001.25' (type: float32) ‚Üí '1001.25'
2026-02-14 15:20:09,768 - dq_comparison - INFO -   Target: '1001.25' (type: float32) ‚Üí '1001.25'
2026-02-14 15:20:09,768 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,770 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:20:09,770 - dq_comparison - INFO -   Source: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:20:09,771 - dq_comparison - INFO -   Target: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:20:09,771 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,771 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:20:09,772 - dq_comparison - INFO -   Source: '1' (type: uint8) ‚Üí '1'
2026-02-14 15:20:09,772 - dq_comparison - INFO -   Target: '1' (type: uint8) ‚Üí '1'
2026-02-14 15:20:09,773 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,773 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:20:09,773 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:20:09,774 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:20:09,774 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,775 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:20:09,775 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:20:09,776 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:20:09,777 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,777 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:20:09,779 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|1...
2026-02-14 15:20:09,779 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|1...
2026-02-14 15:20:09,779 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:20:09,780 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:20:09,780 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:20:09,781 - dq_comparison - INFO -   Source: '1002.5' (type: float32) ‚Üí '1002.5'
2026-02-14 15:20:09,781 - dq_comparison - INFO -   Target: '1002.5' (type: float32) ‚Üí '1002.5'
2026-02-14 15:20:09,782 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,783 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:20:09,783 - dq_comparison - INFO -   Source: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:20:09,784 - dq_comparison - INFO -   Target: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:20:09,784 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,784 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:20:09,785 - dq_comparison - INFO -   Source: '2' (type: uint8) ‚Üí '2'
2026-02-14 15:20:09,785 - dq_comparison - INFO -   Target: '2' (type: uint8) ‚Üí '2'
2026-02-14 15:20:09,786 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,786 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:20:09,787 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:20:09,787 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:20:09,788 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,788 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:20:09,789 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:20:09,789 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:20:09,789 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,790 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:20:09,792 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|2...
2026-02-14 15:20:09,792 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|2...
2026-02-14 15:20:09,793 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:20:09,793 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:20:09,794 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:20:09,794 - dq_comparison - INFO -   Source: '1003.75' (type: float32) ‚Üí '1003.75'
2026-02-14 15:20:09,795 - dq_comparison - INFO -   Target: '1003.75' (type: float32) ‚Üí '1003.75'
2026-02-14 15:20:09,795 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,797 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:20:09,797 - dq_comparison - INFO -   Source: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:20:09,798 - dq_comparison - INFO -   Target: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:20:09,798 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,798 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:20:09,799 - dq_comparison - INFO -   Source: '3' (type: uint8) ‚Üí '3'
2026-02-14 15:20:09,799 - dq_comparison - INFO -   Target: '3' (type: uint8) ‚Üí '3'
2026-02-14 15:20:09,799 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,800 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:20:09,800 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:20:09,801 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:20:09,801 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,801 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:20:09,802 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:20:09,802 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:20:09,802 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:20:09,803 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:20:09,804 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|3...
2026-02-14 15:20:09,804 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|3...
2026-02-14 15:20:09,805 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:20:09,805 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:20:09,806 - dq_comparison - INFO - Column 1: 'amount' (float32) ‚Üî 'amount' (float32)
2026-02-14 15:20:09,806 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:20:09,806 - dq_comparison - INFO - Column 2: 'transaction_date' (datetime64[ns]) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-14 15:20:09,807 - dq_comparison - INFO -   Sample: Source='2024-01-02 00:00:00', Target='2024-01-02 00:00:00'
2026-02-14 15:20:09,808 - dq_comparison - INFO - Column 3: 'account_id' (uint8) ‚Üî 'account_id' (uint8)
2026-02-14 15:20:09,808 - dq_comparison - INFO -   Sample: Source='1', Target='1'
2026-02-14 15:20:09,809 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:20:09,809 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:20:09,809 - dq_comparison - INFO - Column 5: 'currency' (category) ‚Üî 'currency' (category)
2026-02-14 15:20:09,810 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:20:09,810 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:20:09,810 - dq_comparison - INFO - Found 6 total mismatches
2026-02-14 15:20:09,811 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-14 15:20:10,123 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:20:10,124 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:20:10,124 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-14 15:20:10,125 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-14 15:20:10,125 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:20:10,126 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:20:10,126 - dq_comparison - INFO - ================================================================================
2026-02-14 15:20:10,126 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:20:10,127 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:20:10,127 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:20:10,128 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-14 15:20:10,128 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-14 15:20:10,128 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-14 15:20:10,129 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:20:10,129 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:20:10,131 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:20:10,131 - dq_comparison - INFO -   Common rows: 11
2026-02-14 15:20:10,131 - dq_comparison - INFO -   Unique to source: 4
2026-02-14 15:20:10,132 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:20:10,132 - dq_comparison - INFO -   Value mismatches: 48
2026-02-14 15:20:10,133 - dq_comparison - INFO -   Missing rows: 4
2026-02-14 15:20:10,133 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:20:10,133 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Mysql Database vs Postgresql Database
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | amount: 1015.0                           | amount: 10115.0                         
14    | 2          | amount: 1016.25                          | amount: 10116.25                        
15    | 8          | amount: 1017.5                           | amount: NULL                            
16    | 8          | amount: 1018.75                          | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-14 15:20:10,134 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-14 15:20:10,135 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-14 15:20:10,135 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:20:10,154 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:20:10,156 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:20:10,231 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152009
2026-02-14 15:20:10,232 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:20:10,233 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:20:10,234 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-14 15:20:10,234 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-14 15:20:10,235 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-14 15:20:10,235 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:20:10,236 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:20:10,236 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:20:10,237 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152009
2026-02-14 15:20:10,238 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:20:10,326 - dq_audit - INFO - Inserted comparison record with ID: 565
2026-02-14 15:20:10,327 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 565)
2026-02-14 15:20:10,409 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152009
2026-02-14 15:20:10,486 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_152009
2026-02-14 15:20:10,487 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:20:10,559 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152009
2026-02-14 15:20:10,560 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:20:10,560 - dq_comparison - INFO -    Session ID: CMP_20260214_152009
2026-02-14 15:20:10,561 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-14 15:20:10,561 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:20:10,562 - dq_comparison - INFO -    Matched rows: 11
2026-02-14 15:20:10,562 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-14 15:20:10,563 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:20:10,642 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152009
2026-02-14 15:20:10,721 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152009
2026-02-14 15:20:10,795 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_152009
2026-02-14 15:20:10,798 - __main__ - INFO - Completed with status 200 in 1.529s
2026-02-14 15:20:10,834 - __main__ - INFO - GET /api/compare/CMP_20260214_152009/mismatches - Request started
2026-02-14 15:20:11,027 - __main__ - INFO - Completed with status 200 in 0.193s
2026-02-14 15:20:11,343 - __main__ - INFO - GET /api/compare/CMP_20260214_152009/mismatches - Request started
2026-02-14 15:20:11,548 - __main__ - INFO - Completed with status 200 in 0.205s
2026-02-14 15:20:46,033 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:20:46,034 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:20:46,035 - __main__ - INFO - Database: Not provided
2026-02-14 15:20:46,036 - __main__ - INFO - Schema: Not provided
2026-02-14 15:20:46,037 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:20:46,037 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:20:46,037 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:20:46,130 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:20:46,131 - __main__ - INFO - Getting databases list...
2026-02-14 15:20:46,133 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-14 15:20:46,145 - database_navigator - INFO - Found 7 databases
2026-02-14 15:20:46,146 - __main__ - INFO - Found 7 databases
2026-02-14 15:20:46,149 - __main__ - INFO - Completed with status 200 in 0.116s
2026-02-14 15:20:47,820 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:20:47,823 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:20:47,837 - __main__ - INFO - Database: dq_checks
2026-02-14 15:20:47,838 - __main__ - INFO - Schema: Not provided
2026-02-14 15:20:47,839 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:20:47,840 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:20:47,842 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:20:47,950 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:20:47,951 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-14 15:20:47,953 - database_navigator - INFO - Found 1 schemas
2026-02-14 15:20:47,954 - __main__ - INFO - Found 1 schemas
2026-02-14 15:20:47,957 - __main__ - INFO - Completed with status 200 in 0.137s
2026-02-14 15:20:50,647 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:20:50,648 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:20:50,649 - __main__ - INFO - Database: dq_checks
2026-02-14 15:20:50,651 - __main__ - INFO - Schema: dq_checks
2026-02-14 15:20:50,652 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:20:50,653 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:20:50,654 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:20:50,735 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:20:50,737 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-14 15:20:50,751 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-14 15:20:50,752 - __main__ - INFO - Found 28 tables
2026-02-14 15:20:50,754 - __main__ - INFO - Completed with status 200 in 0.106s
2026-02-14 15:21:16,196 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:21:16,210 - __main__ - INFO - File uploaded: 20260214_152116_target13.csv (csv)
2026-02-14 15:21:16,211 - __main__ - INFO - Completed with status 200 in 0.015s
2026-02-14 15:21:16,536 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:21:16,537 - __main__ - INFO - Comparison request - Source: database, Target: csv
2026-02-14 15:21:16,537 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:21:16,538 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'mysql', 'host': 'localhost', 'port': 3306, 'database': 'dq_checks', 'schema': 'dq_checks', 'table': 'sourcevarchar15', 'user': 'root', 'password': 'root'}
2026-02-14 15:21:16,539 - __main__ - INFO - Starting comparison for session CMP_20260214_152116
2026-02-14 15:21:16,539 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:21:16,539 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:21:16,541 - dq_comparison - INFO - 
==================================================
2026-02-14 15:21:16,541 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:21:16,542 - dq_comparison - INFO - ==================================================
2026-02-14 15:21:16,542 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-02-14 15:21:16,544 - dq_comparison - INFO - ----------------------------------------
2026-02-14 15:21:16,545 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-02-14 15:21:16,546 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:21:16,547 - dq_unified - INFO - Loading large database table: sourcevarchar15
2026-02-14 15:21:16,548 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-14 15:21:16,675 - dq_unified - INFO - MySQL table sourcevarchar15 has 15 rows
2026-02-14 15:21:16,676 - dq_unified - INFO - Loading 15 rows from MySQL...
2026-02-14 15:21:16,691 - dq_unified - INFO - Loaded 15 rows from MySQL
2026-02-14 15:21:16,700 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:21:16,703 - dq_unified - INFO - Loaded 15 rows, 8 columns. Memory: 140.6MB total, 0.0MB for dataframe
2026-02-14 15:21:16,704 - dq_comparison - INFO - SOURCE database loaded: 15 rows, 8 columns
2026-02-14 15:21:16,707 - dq_comparison - INFO - 
==================================================
2026-02-14 15:21:16,708 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:21:16,709 - dq_comparison - INFO - ==================================================
2026-02-14 15:21:16,710 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-14 15:21:16,710 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152116_target13.csv
2026-02-14 15:21:16,719 - dq_comparison - INFO - TARGET CSV loaded: 13 rows, 8 columns
2026-02-14 15:21:16,721 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:21:16,722 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:21:16,723 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:21:16,725 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:21:16,725 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:21:16,726 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:21:16,727 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:21:16,727 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:21:16,728 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:21:16,729 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:21:16,730 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:21:16,731 - dq_comparison - INFO - Report details - Source: Database: mysql - dq_checks.sourcevarchar15, Target: CSV: 20260214_152116_target13.csv, Selected columns: 8
2026-02-14 15:21:16,732 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:21:16,734 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:21:16,852 - dq_error_log - INFO - Database connection successful
2026-02-14 15:21:16,854 - dq_comparison - INFO - Session ID: CMP_20260214_152116
2026-02-14 15:21:16,856 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:21:16,856 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:21:16,857 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:21:16,858 - dq_comparison - WARNING - Found 8 incompatible data type mismatches
2026-02-14 15:21:16,858 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-14 15:21:16,859 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:21:16,859 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:21:16,863 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'transaction_date', 'amount']
2026-02-14 15:21:16,866 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'transaction_date', 'amount']
2026-02-14 15:21:16,866 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:21:16,867 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:21:16,875 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:21:16,876 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:21:16,878 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:21:16,879 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:21:16,879 - dq_comparison - INFO - Column: amount
2026-02-14 15:21:16,880 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1001.25
2026-02-14 15:21:16,880 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:21:16,881 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:21:16,881 - dq_comparison - INFO -   Match: True
2026-02-14 15:21:16,882 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:21:16,882 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-14 15:21:16,883 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-14 15:21:16,884 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:21:16,885 - dq_comparison - INFO -   Match: True
2026-02-14 15:21:16,886 - dq_comparison - INFO - Column: account_id
2026-02-14 15:21:16,886 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:21:16,888 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:21:16,888 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:21:16,889 - dq_comparison - INFO -   Match: True
2026-02-14 15:21:16,889 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:21:16,890 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:21:16,890 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:21:16,891 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:21:16,891 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:21:16,891 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:21:16,892 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:21:16,894 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:21:16,897 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:21:16,899 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:21:16,903 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:21:16,909 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:21:16,912 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:21:16,913 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:21:16,914 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:21:16,915 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:21:16,916 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:21:16,919 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:21:16,922 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:21:16,925 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:21:16,927 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:21:16,929 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:21:16,930 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:21:16,930 - dq_comparison - INFO - ======================================================================
2026-02-14 15:21:16,931 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:21:16,931 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:21:16,932 - dq_comparison - INFO -   Source: '1001.25' (type: str) ‚Üí '1001.25'
2026-02-14 15:21:16,932 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:21:16,933 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,934 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:21:16,935 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:21:16,937 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:21:16,938 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,939 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:21:16,940 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:21:16,941 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:21:16,942 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,943 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:21:16,943 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:21:16,944 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:21:16,944 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,944 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:21:16,945 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:21:16,945 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:21:16,946 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,946 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:21:16,948 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:21:16,949 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:21:16,949 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:21:16,950 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:21:16,951 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:21:16,953 - dq_comparison - INFO -   Source: '1002.50' (type: str) ‚Üí '1002.5'
2026-02-14 15:21:16,954 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:21:16,955 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,958 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:21:16,959 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:21:16,960 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:21:16,960 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,961 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:21:16,961 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:21:16,962 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:21:16,962 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,963 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:21:16,963 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:21:16,964 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:21:16,964 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,965 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:21:16,965 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:21:16,966 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:21:16,967 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,968 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:21:16,970 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:21:16,972 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:21:16,972 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:21:16,973 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:21:16,973 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:21:16,974 - dq_comparison - INFO -   Source: '1003.75' (type: str) ‚Üí '1003.75'
2026-02-14 15:21:16,974 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:21:16,975 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,976 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:21:16,977 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:21:16,977 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:21:16,978 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,978 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:21:16,979 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:21:16,979 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:21:16,979 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,980 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:21:16,980 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:21:16,981 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:21:16,981 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,982 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:21:16,983 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:21:16,983 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:21:16,984 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:21:16,984 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:21:16,987 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:21:16,988 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:21:16,988 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:21:16,989 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:21:16,989 - dq_comparison - INFO - Column 1: 'amount' (object) ‚Üî 'amount' (float64)
2026-02-14 15:21:16,990 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:21:16,990 - dq_comparison - INFO - Column 2: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-02-14 15:21:16,991 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='1/2/2024'
2026-02-14 15:21:16,992 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:21:16,992 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:21:16,993 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:21:16,993 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:21:16,994 - dq_comparison - INFO - Column 5: 'currency' (category) ‚Üî 'currency' (object)
2026-02-14 15:21:16,994 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:21:16,995 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:21:16,995 - dq_comparison - INFO - Found 6 total mismatches
2026-02-14 15:21:16,996 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-14 15:21:17,499 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:21:17,501 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:21:17,502 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-14 15:21:17,502 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-14 15:21:17,503 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:21:17,503 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:21:17,504 - dq_comparison - INFO - ================================================================================
2026-02-14 15:21:17,504 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:21:17,505 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:21:17,505 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:21:17,505 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-14 15:21:17,506 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-14 15:21:17,506 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-14 15:21:17,506 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:21:17,508 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:21:17,508 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:21:17,509 - dq_comparison - INFO -   Common rows: 11
2026-02-14 15:21:17,509 - dq_comparison - INFO -   Unique to source: 4
2026-02-14 15:21:17,509 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:21:17,510 - dq_comparison - INFO -   Value mismatches: 48
2026-02-14 15:21:17,510 - dq_comparison - INFO -   Missing rows: 4
2026-02-14 15:21:17,511 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:21:17,511 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Mysql Database vs CSV (20260214_152116_target13.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | amount: 1015.00                          | amount: 10115.0                         
14    | 2          | amount: 1016.25                          | amount: 10116.25                        
15    | 8          | amount: 1017.50                          | amount: NULL                            
16    | 8          | amount: 1018.75                          | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-14 15:21:17,512 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-14 15:21:17,512 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-14 15:21:17,512 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:21:17,529 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:21:17,533 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:21:17,627 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152116
2026-02-14 15:21:17,629 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:21:17,630 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:21:17,630 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-14 15:21:17,631 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-14 15:21:17,631 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-14 15:21:17,631 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:21:17,632 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:21:17,632 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:21:17,633 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152116
2026-02-14 15:21:17,633 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:21:17,762 - dq_audit - INFO - Inserted comparison record with ID: 566
2026-02-14 15:21:17,764 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 566)
2026-02-14 15:21:17,876 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152116
2026-02-14 15:21:17,975 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_152116
2026-02-14 15:21:17,977 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:21:18,067 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152116
2026-02-14 15:21:18,071 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:21:18,072 - dq_comparison - INFO -    Session ID: CMP_20260214_152116
2026-02-14 15:21:18,072 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-14 15:21:18,073 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:21:18,074 - dq_comparison - INFO -    Matched rows: 11
2026-02-14 15:21:18,074 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-14 15:21:18,075 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:21:18,172 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152116
2026-02-14 15:21:18,277 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152116
2026-02-14 15:21:18,399 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_152116
2026-02-14 15:21:18,405 - __main__ - INFO - Completed with status 200 in 1.869s
2026-02-14 15:21:18,447 - __main__ - INFO - GET /api/compare/CMP_20260214_152116/mismatches - Request started
2026-02-14 15:21:18,675 - __main__ - INFO - Completed with status 200 in 0.228s
2026-02-14 15:21:19,008 - __main__ - INFO - GET /api/compare/CMP_20260214_152116/mismatches - Request started
2026-02-14 15:21:19,380 - __main__ - INFO - Completed with status 200 in 0.373s
2026-02-14 15:21:50,202 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:21:50,204 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:21:50,205 - __main__ - INFO - Database: Not provided
2026-02-14 15:21:50,206 - __main__ - INFO - Schema: Not provided
2026-02-14 15:21:50,207 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:21:50,208 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:21:50,208 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:21:50,297 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:21:50,298 - __main__ - INFO - Getting databases list...
2026-02-14 15:21:50,300 - database_navigator - INFO - get_databases() called. db_type: mysql, connection exists: True
2026-02-14 15:21:50,306 - database_navigator - INFO - Found 7 databases
2026-02-14 15:21:50,308 - __main__ - INFO - Found 7 databases
2026-02-14 15:21:50,309 - __main__ - INFO - Completed with status 200 in 0.107s
2026-02-14 15:21:52,703 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:21:52,710 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:21:52,711 - __main__ - INFO - Database: dq_checks
2026-02-14 15:21:52,712 - __main__ - INFO - Schema: Not provided
2026-02-14 15:21:52,713 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:21:52,714 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:21:52,715 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:21:52,828 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:21:52,829 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-14 15:21:52,831 - database_navigator - INFO - Found 1 schemas
2026-02-14 15:21:52,832 - __main__ - INFO - Found 1 schemas
2026-02-14 15:21:52,834 - __main__ - INFO - Completed with status 200 in 0.131s
2026-02-14 15:21:54,915 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:21:54,916 - __main__ - INFO - Getting database hierarchy for mysql
2026-02-14 15:21:54,916 - __main__ - INFO - Database: dq_checks
2026-02-14 15:21:54,917 - __main__ - INFO - Schema: dq_checks
2026-02-14 15:21:54,918 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:21:54,918 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'root'}
2026-02-14 15:21:54,919 - database_navigator - INFO - Connecting to MYSQL...
2026-02-14 15:21:55,010 - database_navigator - INFO - Successfully connected to MYSQL!
2026-02-14 15:21:55,012 - __main__ - INFO - Getting tables for database: dq_checks, schema: dq_checks
2026-02-14 15:21:55,027 - database_navigator - INFO - Found 28 tables in schema 'dq_checks'
2026-02-14 15:21:55,028 - __main__ - INFO - Found 28 tables
2026-02-14 15:21:55,031 - __main__ - INFO - Completed with status 200 in 0.116s
2026-02-14 15:22:01,813 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:22:01,860 - __main__ - INFO - File uploaded: 20260214_152201_target13.xlsx (excel)
2026-02-14 15:22:01,861 - __main__ - INFO - Completed with status 200 in 0.048s
2026-02-14 15:22:02,177 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:22:02,178 - __main__ - INFO - Comparison request - Source: database, Target: excel
2026-02-14 15:22:02,179 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:22:02,180 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'mysql', 'host': 'localhost', 'port': 3306, 'database': 'dq_checks', 'schema': 'dq_checks', 'table': 'source15', 'user': 'root', 'password': 'root'}
2026-02-14 15:22:02,181 - __main__ - INFO - Starting comparison for session CMP_20260214_152202
2026-02-14 15:22:02,182 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:22:02,183 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:22:02,183 - dq_comparison - INFO - 
==================================================
2026-02-14 15:22:02,185 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:22:02,185 - dq_comparison - INFO - ==================================================
2026-02-14 15:22:02,187 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-02-14 15:22:02,188 - dq_comparison - INFO - ----------------------------------------
2026-02-14 15:22:02,188 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-02-14 15:22:02,189 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:22:02,189 - dq_unified - INFO - Loading large database table: source15
2026-02-14 15:22:02,190 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-14 15:22:02,302 - dq_unified - INFO - MySQL table source15 has 15 rows
2026-02-14 15:22:02,303 - dq_unified - INFO - Loading 15 rows from MySQL...
2026-02-14 15:22:02,315 - dq_unified - INFO - Loaded 15 rows from MySQL
2026-02-14 15:22:02,323 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:22:02,324 - dq_unified - INFO - Loaded 15 rows, 8 columns. Memory: 140.6MB total, 0.0MB for dataframe
2026-02-14 15:22:02,325 - dq_comparison - INFO - SOURCE database loaded: 15 rows, 8 columns
2026-02-14 15:22:02,326 - dq_comparison - INFO - 
==================================================
2026-02-14 15:22:02,327 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:22:02,328 - dq_comparison - INFO - ==================================================
2026-02-14 15:22:02,328 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-14 15:22:02,329 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152201_target13.xlsx'}
2026-02-14 15:22:02,329 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-14 15:22:02,330 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152201_target13.xlsx
2026-02-14 15:22:02,359 - dq_comparison - INFO - TARGET Excel loaded: 13 rows, 8 columns
2026-02-14 15:22:02,360 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:22:02,360 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:22:02,360 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:22:02,362 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:02,362 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:02,362 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:02,363 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:22:02,363 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:22:02,363 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:22:02,363 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:22:02,364 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:22:02,364 - dq_comparison - INFO - Report details - Source: Database: mysql - dq_checks.source15, Target: Excel: 20260214_152201_target13.xlsx (target13), Selected columns: 8
2026-02-14 15:22:02,364 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:22:02,365 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:22:02,437 - dq_error_log - INFO - Database connection successful
2026-02-14 15:22:02,439 - dq_comparison - INFO - Session ID: CMP_20260214_152202
2026-02-14 15:22:02,440 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:22:02,440 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:22:02,441 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:22:02,441 - dq_comparison - WARNING - Found 5 incompatible data type mismatches
2026-02-14 15:22:02,442 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-14 15:22:02,442 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:22:02,443 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:22:02,446 - dq_comparison - INFO - Auto-detected common key fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:22:02,449 - dq_comparison - INFO - Primary key validation passed for fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:22:02,450 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:22:02,450 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:22:02,456 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:22:02,457 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:22:02,459 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:22:02,459 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:22:02,459 - dq_comparison - INFO - Column: amount
2026-02-14 15:22:02,460 - dq_comparison - INFO -   Source type: <class 'numpy.float32'>, value: 1001.25
2026-02-14 15:22:02,460 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:22:02,461 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:22:02,461 - dq_comparison - INFO -   Match: True
2026-02-14 15:22:02,461 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:22:02,462 - dq_comparison - INFO -   Source type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:22:02,462 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:22:02,463 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:22:02,463 - dq_comparison - INFO -   Match: True
2026-02-14 15:22:02,464 - dq_comparison - INFO - Column: account_id
2026-02-14 15:22:02,464 - dq_comparison - INFO -   Source type: <class 'numpy.uint8'>, value: 1
2026-02-14 15:22:02,465 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:22:02,466 - dq_comparison - INFO -   Normalized: '1' vs 'acc000001'
2026-02-14 15:22:02,466 - dq_comparison - INFO -   Match: False
2026-02-14 15:22:02,467 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:02,467 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:02,467 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:02,468 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:22:02,469 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:02,469 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:02,470 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:22:02,474 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:22:02,478 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:22:02,480 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:22:02,483 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:22:02,487 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:22:02,488 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:22:02,489 - dq_comparison - INFO - Hash 1: 524d9ba30607aa88... (sample row 0)
2026-02-14 15:22:02,489 - dq_comparison - INFO - Hash 2: 8e039ce62fbc3c0d... (sample row 1)
2026-02-14 15:22:02,490 - dq_comparison - INFO - Hash 3: 3e951b47b7f65ad8... (sample row 2)
2026-02-14 15:22:02,490 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:22:02,492 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:22:02,495 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:22:02,497 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:22:02,500 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:22:02,502 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:22:02,503 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:22:02,504 - dq_comparison - INFO - ======================================================================
2026-02-14 15:22:02,504 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:22:02,506 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:22:02,506 - dq_comparison - INFO -   Source: '1001.25' (type: float32) ‚Üí '1001.25'
2026-02-14 15:22:02,507 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:22:02,507 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,508 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:22:02,509 - dq_comparison - INFO -   Source: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:22:02,509 - dq_comparison - INFO -   Target: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:22:02,510 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,511 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:22:02,511 - dq_comparison - INFO -   Source: '1' (type: uint8) ‚Üí '1'
2026-02-14 15:22:02,512 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:22:02,512 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:22:02,513 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:22:02,513 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:22:02,514 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:22:02,514 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,515 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:22:02,516 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:02,517 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:02,518 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,518 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:22:02,520 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|1...
2026-02-14 15:22:02,520 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:22:02,521 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:22:02,521 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:22:02,522 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:22:02,522 - dq_comparison - INFO -   Source: '1002.5' (type: float32) ‚Üí '1002.5'
2026-02-14 15:22:02,523 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:22:02,523 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,524 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:22:02,525 - dq_comparison - INFO -   Source: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:22:02,525 - dq_comparison - INFO -   Target: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:22:02,526 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,526 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:22:02,527 - dq_comparison - INFO -   Source: '2' (type: uint8) ‚Üí '2'
2026-02-14 15:22:02,527 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:22:02,528 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:22:02,528 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:22:02,529 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:22:02,529 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:22:02,529 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,530 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:22:02,530 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:02,531 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:02,532 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,532 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:22:02,534 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|2...
2026-02-14 15:22:02,534 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:22:02,535 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:22:02,535 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:22:02,536 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:22:02,537 - dq_comparison - INFO -   Source: '1003.75' (type: float32) ‚Üí '1003.75'
2026-02-14 15:22:02,537 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:22:02,538 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,539 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:22:02,539 - dq_comparison - INFO -   Source: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:22:02,540 - dq_comparison - INFO -   Target: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:22:02,540 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,541 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:22:02,541 - dq_comparison - INFO -   Source: '3' (type: uint8) ‚Üí '3'
2026-02-14 15:22:02,542 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:22:02,542 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:22:02,542 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:22:02,543 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:22:02,543 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:22:02,544 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,544 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:22:02,544 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:02,545 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:02,545 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:02,545 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:22:02,547 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|3...
2026-02-14 15:22:02,548 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:22:02,548 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:22:02,549 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:22:02,549 - dq_comparison - INFO - Column 1: 'amount' (float32) ‚Üî 'amount' (float64)
2026-02-14 15:22:02,551 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:22:02,551 - dq_comparison - INFO - Column 2: 'transaction_date' (datetime64[ns]) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-14 15:22:02,551 - dq_comparison - INFO -   Sample: Source='2024-01-02 00:00:00', Target='2024-01-02 00:00:00'
2026-02-14 15:22:02,552 - dq_comparison - INFO - Column 3: 'account_id' (uint8) ‚Üî 'account_id' (object)
2026-02-14 15:22:02,552 - dq_comparison - INFO -   Sample: Source='1', Target='ACC000001'
2026-02-14 15:22:02,553 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:22:02,553 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:22:02,554 - dq_comparison - INFO - Column 5: 'currency' (category) ‚Üî 'currency' (object)
2026-02-14 15:22:02,554 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:22:02,554 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:22:02,555 - dq_comparison - INFO - Found 28 total mismatches
2026-02-14 15:22:02,555 - dq_comparison - INFO - Will process detailed comparisons for first 28 rows
2026-02-14 15:22:03,758 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:22:03,758 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:22:03,759 - dq_comparison - INFO -   Total mismatches found: 15
2026-02-14 15:22:03,759 - dq_comparison - INFO -   Detailed comparisons logged: 15
2026-02-14 15:22:03,760 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:22:03,760 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:22:03,760 - dq_comparison - INFO -   Use API to retrieve all 15 mismatches
2026-02-14 15:22:03,761 - dq_comparison - INFO - ================================================================================
2026-02-14 15:22:03,761 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:22:03,761 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:22:03,762 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:22:03,762 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 0
2026-02-14 15:22:03,762 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 0
2026-02-14 15:22:03,763 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 15
2026-02-14 15:22:03,763 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 13
2026-02-14 15:22:03,764 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:22:03,764 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:22:03,765 - dq_comparison - INFO -   Common rows: 0
2026-02-14 15:22:03,765 - dq_comparison - INFO -   Unique to source: 15
2026-02-14 15:22:03,765 - dq_comparison - INFO -   Unique to target: 13
2026-02-14 15:22:03,766 - dq_comparison - INFO -   Value mismatches: 224
2026-02-14 15:22:03,766 - dq_comparison - INFO -   Missing rows: 15
2026-02-14 15:22:03,766 - dq_comparison - INFO -   Extra rows: 13
2026-02-14 15:22:03,768 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Mysql Database vs Excel (20260214_152201_target13.xlsx (target13))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
2     | 1          | amount: 1001.25                          | amount: 1001.25                         
3     | 1          | amount: 1002.5                           | amount: 1002.5                          
4     | 1          | amount: 1003.75                          | amount: 1003.75                         
5     | 1          | amount: 1005.0                           | amount: 1005.0                          
6     | 1          | amount: 1006.25                          | amount: 1006.25                         
7     | 1          | amount: 1007.5                           | amount: 1007.5                          
8     | 1          | amount: 1008.75                          | amount: 1008.75                         
9     | 1          | amount: 1010.0                           | amount: 1010.0                          
10    | 1          | amount: 1011.25                          | amount: 1011.25                         
11    | 1          | amount: 1012.5                           | amount: 1012.5                          
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 15 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-14 15:22:03,768 - dq_comparison - INFO - Returning enhanced mismatch structure with 15 detailed mismatches
2026-02-14 15:22:03,768 - dq_comparison - INFO - New structure: 15 detailed mismatches
2026-02-14 15:22:03,769 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:22:03,792 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:22:03,794 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:22:03,864 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152202
2026-02-14 15:22:03,865 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:22:03,866 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:22:03,867 - dq_comparison - INFO -   Common rows (matched): 0
2026-02-14 15:22:03,867 - dq_comparison - INFO -   Calculation: (0 / 15) * 100 = 0.00%
2026-02-14 15:22:03,867 - dq_comparison - INFO -   Explanation: 0 matched rows out of 15 total source rows
2026-02-14 15:22:03,868 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:22:03,868 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:22:03,869 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:22:03,869 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152202
2026-02-14 15:22:03,869 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:22:03,949 - dq_audit - INFO - Inserted comparison record with ID: 567
2026-02-14 15:22:03,950 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 567)
2026-02-14 15:22:04,027 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152202
2026-02-14 15:22:04,107 - dq_error_log - INFO - Retrieved summary: 15 total errors for session CMP_20260214_152202
2026-02-14 15:22:04,108 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:22:04,193 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152202
2026-02-14 15:22:04,195 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:22:04,196 - dq_comparison - INFO -    Session ID: CMP_20260214_152202
2026-02-14 15:22:04,196 - dq_comparison - INFO -    DQ Score (Simple %): 0.00%
2026-02-14 15:22:04,197 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:22:04,198 - dq_comparison - INFO -    Matched rows: 0
2026-02-14 15:22:04,198 - dq_comparison - INFO -    Calculation: (0 / 15) * 100
2026-02-14 15:22:04,199 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:22:04,278 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152202
2026-02-14 15:22:04,354 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152202
2026-02-14 15:22:04,430 - dq_error_log - INFO - Retrieved summary: 15 total errors for session CMP_20260214_152202
2026-02-14 15:22:04,435 - __main__ - INFO - Completed with status 200 in 2.258s
2026-02-14 15:22:04,474 - __main__ - INFO - GET /api/compare/CMP_20260214_152202/mismatches - Request started
2026-02-14 15:22:04,666 - __main__ - INFO - Completed with status 200 in 0.193s
2026-02-14 15:22:04,983 - __main__ - INFO - GET /api/compare/CMP_20260214_152202/mismatches - Request started
2026-02-14 15:22:05,161 - __main__ - INFO - Completed with status 200 in 0.178s
2026-02-14 15:22:19,226 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:22:19,267 - __main__ - INFO - File uploaded: 20260214_152219_target13.xlsx (excel)
2026-02-14 15:22:19,269 - __main__ - INFO - Completed with status 200 in 0.044s
2026-02-14 15:22:19,488 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:22:19,489 - __main__ - INFO - Comparison request - Source: database, Target: excel
2026-02-14 15:22:19,490 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:22:19,491 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'mysql', 'host': 'localhost', 'port': 3306, 'database': 'dq_checks', 'schema': 'dq_checks', 'table': 'sourcevarchar15', 'user': 'root', 'password': 'root'}
2026-02-14 15:22:19,492 - __main__ - INFO - Starting comparison for session CMP_20260214_152219
2026-02-14 15:22:19,493 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:22:19,493 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:22:19,494 - dq_comparison - INFO - 
==================================================
2026-02-14 15:22:19,495 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:22:19,496 - dq_comparison - INFO - ==================================================
2026-02-14 15:22:19,496 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-02-14 15:22:19,496 - dq_comparison - INFO - ----------------------------------------
2026-02-14 15:22:19,497 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-02-14 15:22:19,497 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:22:19,498 - dq_unified - INFO - Loading large database table: sourcevarchar15
2026-02-14 15:22:19,498 - dq_unified - INFO - Normalized DB config with schema: dq_checks
2026-02-14 15:22:19,578 - dq_unified - INFO - MySQL table sourcevarchar15 has 15 rows
2026-02-14 15:22:19,579 - dq_unified - INFO - Loading 15 rows from MySQL...
2026-02-14 15:22:19,590 - dq_unified - INFO - Loaded 15 rows from MySQL
2026-02-14 15:22:19,596 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:22:19,597 - dq_unified - INFO - Loaded 15 rows, 8 columns. Memory: 140.7MB total, 0.0MB for dataframe
2026-02-14 15:22:19,598 - dq_comparison - INFO - SOURCE database loaded: 15 rows, 8 columns
2026-02-14 15:22:19,599 - dq_comparison - INFO - 
==================================================
2026-02-14 15:22:19,599 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:22:19,600 - dq_comparison - INFO - ==================================================
2026-02-14 15:22:19,601 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-14 15:22:19,601 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152219_target13.xlsx'}
2026-02-14 15:22:19,603 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-14 15:22:19,604 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152219_target13.xlsx
2026-02-14 15:22:19,636 - dq_comparison - INFO - TARGET Excel loaded: 13 rows, 8 columns
2026-02-14 15:22:19,637 - dq_comparison - INFO - Source data loaded: 15 rows, 8 columns
2026-02-14 15:22:19,637 - dq_comparison - INFO - Target data loaded: 13 rows, 8 columns
2026-02-14 15:22:19,638 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:22:19,638 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:19,639 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:19,639 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:19,640 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:22:19,641 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:22:19,641 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:22:19,642 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:22:19,642 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:22:19,642 - dq_comparison - INFO - Report details - Source: Database: mysql - dq_checks.sourcevarchar15, Target: Excel: 20260214_152219_target13.xlsx (target13), Selected columns: 8
2026-02-14 15:22:19,643 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:22:19,643 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:22:19,727 - dq_error_log - INFO - Database connection successful
2026-02-14 15:22:19,729 - dq_comparison - INFO - Session ID: CMP_20260214_152219
2026-02-14 15:22:19,729 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=15, Target=13, Difference=2
2026-02-14 15:22:19,730 - dq_comparison - WARNING -    Missing in target: 2 rows
2026-02-14 15:22:19,730 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:22:19,731 - dq_comparison - WARNING - Found 8 incompatible data type mismatches
2026-02-14 15:22:19,732 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-14 15:22:19,732 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:22:19,733 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:22:19,737 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'transaction_date', 'amount']
2026-02-14 15:22:19,739 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'transaction_date', 'amount']
2026-02-14 15:22:19,740 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:22:19,740 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:22:19,747 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:22:19,748 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:22:19,750 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:22:19,750 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:22:19,751 - dq_comparison - INFO - Column: amount
2026-02-14 15:22:19,751 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1001.25
2026-02-14 15:22:19,752 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:22:19,752 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:22:19,753 - dq_comparison - INFO -   Match: True
2026-02-14 15:22:19,753 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:22:19,754 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-14 15:22:19,754 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:22:19,755 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:22:19,756 - dq_comparison - INFO -   Match: True
2026-02-14 15:22:19,757 - dq_comparison - INFO - Column: account_id
2026-02-14 15:22:19,757 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:22:19,758 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:22:19,758 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:22:19,759 - dq_comparison - INFO -   Match: True
2026-02-14 15:22:19,759 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:19,760 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:22:19,760 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:19,761 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:22:19,761 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:19,761 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:22:19,762 - dq_comparison - INFO - Generating hashes for source data (15 rows)...
2026-02-14 15:22:19,764 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:22:19,767 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:22:19,770 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:22:19,773 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:22:19,775 - dq_comparison - INFO -    Hashing source data: 53.6% complete (15/28 rows)
2026-02-14 15:22:19,776 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:22:19,777 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:22:19,777 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:22:19,778 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:22:19,778 - dq_comparison - INFO - Generating hashes for target data (13 rows)...
2026-02-14 15:22:19,780 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:22:19,783 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:22:19,785 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:22:19,788 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:22:19,790 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:22:19,790 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:22:19,791 - dq_comparison - INFO - ======================================================================
2026-02-14 15:22:19,791 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:22:19,792 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:22:19,793 - dq_comparison - INFO -   Source: '1001.25' (type: str) ‚Üí '1001.25'
2026-02-14 15:22:19,793 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:22:19,793 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,795 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:22:19,795 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:22:19,796 - dq_comparison - INFO -   Target: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:22:19,796 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,797 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:22:19,797 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:22:19,797 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:22:19,798 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,798 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:22:19,799 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:22:19,799 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:22:19,800 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,800 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:22:19,801 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:19,801 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:19,801 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,802 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:22:19,803 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:22:19,804 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:22:19,805 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:22:19,805 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:22:19,806 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:22:19,806 - dq_comparison - INFO -   Source: '1002.50' (type: str) ‚Üí '1002.5'
2026-02-14 15:22:19,807 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:22:19,807 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,809 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:22:19,809 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:22:19,810 - dq_comparison - INFO -   Target: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:22:19,810 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,810 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:22:19,811 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:22:19,811 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:22:19,812 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,812 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:22:19,812 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:22:19,813 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:22:19,813 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,814 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:22:19,814 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:19,815 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:19,815 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,815 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:22:19,817 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:22:19,818 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:22:19,819 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:22:19,820 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:22:19,820 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:22:19,821 - dq_comparison - INFO -   Source: '1003.75' (type: str) ‚Üí '1003.75'
2026-02-14 15:22:19,821 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:22:19,822 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,823 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:22:19,824 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:22:19,824 - dq_comparison - INFO -   Target: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:22:19,825 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,825 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:22:19,826 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:22:19,827 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:22:19,827 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,828 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:22:19,828 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:22:19,828 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:22:19,829 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,829 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:22:19,830 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:19,830 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:22:19,831 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:22:19,831 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:22:19,832 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:22:19,833 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:22:19,833 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:22:19,834 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:22:19,835 - dq_comparison - INFO - Column 1: 'amount' (object) ‚Üî 'amount' (float64)
2026-02-14 15:22:19,836 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:22:19,836 - dq_comparison - INFO - Column 2: 'transaction_date' (object) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-14 15:22:19,837 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='2024-01-02 00:00:00'
2026-02-14 15:22:19,837 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:22:19,838 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:22:19,838 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:22:19,839 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:22:19,839 - dq_comparison - INFO - Column 5: 'currency' (category) ‚Üî 'currency' (object)
2026-02-14 15:22:19,840 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:22:19,840 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:22:19,840 - dq_comparison - INFO - Found 6 total mismatches
2026-02-14 15:22:19,841 - dq_comparison - INFO - Will process detailed comparisons for first 6 rows
2026-02-14 15:22:20,190 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:22:20,191 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:22:20,192 - dq_comparison - INFO -   Total mismatches found: 4
2026-02-14 15:22:20,192 - dq_comparison - INFO -   Detailed comparisons logged: 4
2026-02-14 15:22:20,193 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:22:20,193 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:22:20,194 - dq_comparison - INFO - ================================================================================
2026-02-14 15:22:20,194 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:22:20,195 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 15
2026-02-14 15:22:20,196 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 13
2026-02-14 15:22:20,196 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 11
2026-02-14 15:22:20,197 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 11
2026-02-14 15:22:20,197 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 4
2026-02-14 15:22:20,198 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:22:20,199 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:22:20,200 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:22:20,201 - dq_comparison - INFO -   Common rows: 11
2026-02-14 15:22:20,201 - dq_comparison - INFO -   Unique to source: 4
2026-02-14 15:22:20,202 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:22:20,203 - dq_comparison - INFO -   Value mismatches: 48
2026-02-14 15:22:20,203 - dq_comparison - INFO -   Missing rows: 4
2026-02-14 15:22:20,204 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:22:20,204 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Mysql Database vs Excel (20260214_152219_target13.xlsx (target13))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
13    | 2          | amount: 1015.00                          | amount: 10115.0                         
14    | 2          | amount: 1016.25                          | amount: 10116.25                        
15    | 8          | amount: 1017.50                          | amount: NULL                            
16    | 8          | amount: 1018.75                          | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing all 4 mismatched rows.
========================================================================================================================
2026-02-14 15:22:20,205 - dq_comparison - INFO - Returning enhanced mismatch structure with 4 detailed mismatches
2026-02-14 15:22:20,205 - dq_comparison - INFO - New structure: 4 detailed mismatches
2026-02-14 15:22:20,206 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:22:20,232 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:22:20,242 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:22:20,353 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152219
2026-02-14 15:22:20,354 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:22:20,355 - dq_comparison - INFO -   Source rows: 15
2026-02-14 15:22:20,355 - dq_comparison - INFO -   Common rows (matched): 11
2026-02-14 15:22:20,356 - dq_comparison - INFO -   Calculation: (11 / 15) * 100 = 73.33%
2026-02-14 15:22:20,356 - dq_comparison - INFO -   Explanation: 11 matched rows out of 15 total source rows
2026-02-14 15:22:20,357 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:22:20,358 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:22:20,358 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:22:20,359 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152219
2026-02-14 15:22:20,359 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:22:20,442 - dq_audit - INFO - Inserted comparison record with ID: 568
2026-02-14 15:22:20,444 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 568)
2026-02-14 15:22:20,532 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152219
2026-02-14 15:22:20,616 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_152219
2026-02-14 15:22:20,618 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:22:20,700 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152219
2026-02-14 15:22:20,703 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:22:20,703 - dq_comparison - INFO -    Session ID: CMP_20260214_152219
2026-02-14 15:22:20,704 - dq_comparison - INFO -    DQ Score (Simple %): 73.33%
2026-02-14 15:22:20,704 - dq_comparison - INFO -    Source rows: 15
2026-02-14 15:22:20,705 - dq_comparison - INFO -    Matched rows: 11
2026-02-14 15:22:20,705 - dq_comparison - INFO -    Calculation: (11 / 15) * 100
2026-02-14 15:22:20,706 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:22:20,795 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152219
2026-02-14 15:22:20,895 - dq_error_log - INFO - Retrieved 4 error logs for session CMP_20260214_152219
2026-02-14 15:22:20,982 - dq_error_log - INFO - Retrieved summary: 4 total errors for session CMP_20260214_152219
2026-02-14 15:22:20,986 - __main__ - INFO - Completed with status 200 in 1.498s
2026-02-14 15:22:21,030 - __main__ - INFO - GET /api/compare/CMP_20260214_152219/mismatches - Request started
2026-02-14 15:22:21,270 - __main__ - INFO - Completed with status 200 in 0.240s
2026-02-14 15:23:07,698 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:23:07,700 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:23:07,701 - __main__ - INFO - Database: Not provided
2026-02-14 15:23:07,704 - __main__ - INFO - Schema: Not provided
2026-02-14 15:23:07,706 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:23:07,707 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:23:07,708 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:23:07,708 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:23:07,709 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:23:07,936 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC1F10; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:23:07,938 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:23:07,939 - __main__ - INFO - Getting databases list...
2026-02-14 15:23:07,939 - database_navigator - INFO - get_databases() called. db_type: postgresql, connection exists: True
2026-02-14 15:23:07,950 - database_navigator - INFO - Raw rows: [('dq_checks',), ('postgres',), ('test',)]
2026-02-14 15:23:07,950 - database_navigator - INFO - Found 3 databases
2026-02-14 15:23:07,951 - __main__ - INFO - Found 3 databases
2026-02-14 15:23:07,956 - __main__ - INFO - Completed with status 200 in 0.258s
2026-02-14 15:23:09,816 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:23:09,823 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:23:09,824 - __main__ - INFO - Database: dq_checks
2026-02-14 15:23:09,828 - __main__ - INFO - Schema: Not provided
2026-02-14 15:23:09,830 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:23:09,831 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:23:09,832 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:23:09,833 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:23:09,836 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:23:10,081 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC1F10; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:23:10,083 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:23:10,084 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-14 15:23:10,085 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-02-14 15:23:10,087 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:23:10,088 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:23:10,089 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-02-14 15:23:10,351 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC3670; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-02-14 15:23:10,352 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-02-14 15:23:10,371 - database_navigator - INFO - Found 4 schemas
2026-02-14 15:23:10,372 - __main__ - INFO - Found 4 schemas
2026-02-14 15:23:10,373 - __main__ - INFO - Completed with status 200 in 0.557s
2026-02-14 15:23:13,293 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:23:13,294 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:23:13,296 - __main__ - INFO - Database: dq_checks
2026-02-14 15:23:13,297 - __main__ - INFO - Schema: public
2026-02-14 15:23:13,298 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:23:13,299 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:23:13,300 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:23:13,300 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:23:13,302 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:23:13,495 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC3670; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:23:13,496 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:23:13,497 - __main__ - INFO - Getting tables for database: dq_checks, schema: public
2026-02-14 15:23:13,498 - database_navigator - INFO - Ensuring connection to database: dq_checks for table list
2026-02-14 15:23:13,498 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-02-14 15:23:13,499 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:23:13,499 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:23:13,500 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-02-14 15:23:13,692 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC2570; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-02-14 15:23:13,694 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-02-14 15:23:13,695 - database_navigator - INFO - Connected to database: dq_checks, schema: public
2026-02-14 15:23:13,729 - database_navigator - INFO - Found 20 tables in dq_checks.public: ['advanced100', 'advanced1000', 'advanced10000', 'advanced100000', 'advanced15', 'customers', 'employee', 'rulesdata', 'single100', 'single1000', 'single10000', 'single100000', 'single15', 'target13', 'target90', 'target900', 'target9000', 'target90000', 'testadv', 'testadv_stage']
2026-02-14 15:23:13,729 - database_navigator - INFO - Found 20 tables in schema 'public'
2026-02-14 15:23:13,731 - __main__ - INFO - Found 20 tables
2026-02-14 15:23:13,732 - __main__ - INFO - Completed with status 200 in 0.439s
2026-02-14 15:23:24,895 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:23:24,913 - __main__ - INFO - File uploaded: 20260214_152324_source15.csv (csv)
2026-02-14 15:23:24,915 - __main__ - INFO - Completed with status 200 in 0.019s
2026-02-14 15:23:25,235 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:23:25,236 - __main__ - INFO - Comparison request - Source: database, Target: csv
2026-02-14 15:23:25,237 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:23:25,238 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'postgresql', 'host': 'localhost', 'port': 5432, 'database': 'dq_checks', 'schema': 'public', 'table': 'target13', 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:23:25,240 - __main__ - INFO - Starting comparison for session CMP_20260214_152325
2026-02-14 15:23:25,240 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:23:25,241 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:23:25,241 - dq_comparison - INFO - 
==================================================
2026-02-14 15:23:25,242 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:23:25,242 - dq_comparison - INFO - ==================================================
2026-02-14 15:23:25,243 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-02-14 15:23:25,243 - dq_comparison - INFO - ----------------------------------------
2026-02-14 15:23:25,243 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-02-14 15:23:25,244 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:23:25,244 - dq_unified - INFO - Loading large database table: target13
2026-02-14 15:23:25,245 - dq_unified - INFO - Normalized DB config with schema: public
2026-02-14 15:23:25,410 - dq_unified - INFO - PostgreSQL table public.target13 has 13 rows
2026-02-14 15:23:25,410 - dq_unified - INFO - Loading 13 rows from PostgreSQL...
2026-02-14 15:23:25,415 - dq_unified - INFO - Loaded 13 rows from PostgreSQL
2026-02-14 15:23:25,420 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:23:25,421 - dq_unified - INFO - Loaded 13 rows, 8 columns. Memory: 140.9MB total, 0.0MB for dataframe
2026-02-14 15:23:25,422 - dq_comparison - INFO - SOURCE database loaded: 13 rows, 8 columns
2026-02-14 15:23:25,422 - dq_comparison - INFO - 
==================================================
2026-02-14 15:23:25,423 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:23:25,423 - dq_comparison - INFO - ==================================================
2026-02-14 15:23:25,424 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-14 15:23:25,424 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152324_source15.csv
2026-02-14 15:23:25,428 - dq_comparison - INFO - TARGET CSV loaded: 15 rows, 8 columns
2026-02-14 15:23:25,429 - dq_comparison - INFO - Source data loaded: 13 rows, 8 columns
2026-02-14 15:23:25,429 - dq_comparison - INFO - Target data loaded: 15 rows, 8 columns
2026-02-14 15:23:25,429 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:23:25,430 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:23:25,431 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:23:25,431 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:23:25,432 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:23:25,432 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:23:25,432 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:23:25,433 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:23:25,433 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:23:25,434 - dq_comparison - INFO - Report details - Source: Database: postgresql - dq_checks.target13, Target: CSV: 20260214_152324_source15.csv, Selected columns: 8
2026-02-14 15:23:25,434 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:23:25,434 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:23:25,507 - dq_error_log - INFO - Database connection successful
2026-02-14 15:23:25,509 - dq_comparison - INFO - Session ID: CMP_20260214_152325
2026-02-14 15:23:25,509 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=13, Target=15, Difference=2
2026-02-14 15:23:25,509 - dq_comparison - WARNING -    Extra in target: 2 rows
2026-02-14 15:23:25,510 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:23:25,511 - dq_comparison - WARNING - Found 5 incompatible data type mismatches
2026-02-14 15:23:25,511 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-14 15:23:25,511 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:23:25,512 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:23:25,515 - dq_comparison - INFO - Auto-detected common key fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:23:25,518 - dq_comparison - INFO - Primary key validation passed for fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:23:25,518 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:23:25,519 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:23:25,526 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:23:25,527 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:23:25,529 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:23:25,530 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:23:25,531 - dq_comparison - INFO - Column: amount
2026-02-14 15:23:25,532 - dq_comparison - INFO -   Source type: <class 'numpy.float32'>, value: 1001.25
2026-02-14 15:23:25,532 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:23:25,533 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:23:25,534 - dq_comparison - INFO -   Match: True
2026-02-14 15:23:25,534 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:23:25,535 - dq_comparison - INFO -   Source type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:23:25,536 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-14 15:23:25,538 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:23:25,538 - dq_comparison - INFO -   Match: True
2026-02-14 15:23:25,539 - dq_comparison - INFO - Column: account_id
2026-02-14 15:23:25,539 - dq_comparison - INFO -   Source type: <class 'numpy.uint8'>, value: 1
2026-02-14 15:23:25,540 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:23:25,541 - dq_comparison - INFO -   Normalized: '1' vs 'acc000001'
2026-02-14 15:23:25,541 - dq_comparison - INFO -   Match: False
2026-02-14 15:23:25,542 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:23:25,542 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:23:25,543 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:23:25,543 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:23:25,543 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:23:25,544 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:23:25,544 - dq_comparison - INFO - Generating hashes for source data (13 rows)...
2026-02-14 15:23:25,548 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:23:25,552 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:23:25,555 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:23:25,558 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:23:25,560 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:23:25,561 - dq_comparison - INFO - Hash 1: 524d9ba30607aa88... (sample row 0)
2026-02-14 15:23:25,561 - dq_comparison - INFO - Hash 2: 8e039ce62fbc3c0d... (sample row 1)
2026-02-14 15:23:25,561 - dq_comparison - INFO - Hash 3: 3e951b47b7f65ad8... (sample row 2)
2026-02-14 15:23:25,562 - dq_comparison - INFO - Generating hashes for target data (15 rows)...
2026-02-14 15:23:25,563 - dq_comparison - INFO -    Hashing target data: 53.6% complete (15/28 rows)
2026-02-14 15:23:25,565 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:23:25,570 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:23:25,573 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:23:25,576 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:23:25,579 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:23:25,580 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:23:25,581 - dq_comparison - INFO - ======================================================================
2026-02-14 15:23:25,582 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:23:25,584 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:23:25,584 - dq_comparison - INFO -   Source: '1001.25' (type: float32) ‚Üí '1001.25'
2026-02-14 15:23:25,585 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:23:25,585 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,590 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:23:25,591 - dq_comparison - INFO -   Source: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:23:25,592 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:23:25,592 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,593 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:23:25,594 - dq_comparison - INFO -   Source: '1' (type: uint8) ‚Üí '1'
2026-02-14 15:23:25,594 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:23:25,595 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:23:25,596 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:23:25,597 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:23:25,597 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:23:25,598 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,599 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:23:25,600 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:23:25,601 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:23:25,601 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,602 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:23:25,606 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|1...
2026-02-14 15:23:25,606 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:23:25,607 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:23:25,608 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:23:25,609 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:23:25,609 - dq_comparison - INFO -   Source: '1002.5' (type: float32) ‚Üí '1002.5'
2026-02-14 15:23:25,610 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:23:25,610 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,612 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:23:25,612 - dq_comparison - INFO -   Source: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:23:25,613 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:23:25,614 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,615 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:23:25,615 - dq_comparison - INFO -   Source: '2' (type: uint8) ‚Üí '2'
2026-02-14 15:23:25,616 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:23:25,616 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:23:25,617 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:23:25,618 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:23:25,618 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:23:25,619 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,619 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:23:25,620 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:23:25,620 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:23:25,620 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,621 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:23:25,622 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|2...
2026-02-14 15:23:25,623 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:23:25,623 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:23:25,623 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:23:25,624 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:23:25,625 - dq_comparison - INFO -   Source: '1003.75' (type: float32) ‚Üí '1003.75'
2026-02-14 15:23:25,625 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:23:25,625 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,627 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:23:25,627 - dq_comparison - INFO -   Source: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:23:25,627 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:23:25,628 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,628 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:23:25,629 - dq_comparison - INFO -   Source: '3' (type: uint8) ‚Üí '3'
2026-02-14 15:23:25,629 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:23:25,629 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:23:25,630 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:23:25,630 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:23:25,631 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:23:25,632 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,632 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:23:25,633 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:23:25,633 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:23:25,634 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:23:25,634 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:23:25,635 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|3...
2026-02-14 15:23:25,636 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:23:25,636 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:23:25,637 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:23:25,637 - dq_comparison - INFO - Column 1: 'amount' (float32) ‚Üî 'amount' (float64)
2026-02-14 15:23:25,638 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:23:25,638 - dq_comparison - INFO - Column 2: 'transaction_date' (datetime64[ns]) ‚Üî 'transaction_date' (object)
2026-02-14 15:23:25,639 - dq_comparison - INFO -   Sample: Source='2024-01-02 00:00:00', Target='1/2/2024'
2026-02-14 15:23:25,639 - dq_comparison - INFO - Column 3: 'account_id' (uint8) ‚Üî 'account_id' (object)
2026-02-14 15:23:25,640 - dq_comparison - INFO -   Sample: Source='1', Target='ACC000001'
2026-02-14 15:23:25,640 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:23:25,640 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:23:25,641 - dq_comparison - INFO - Column 5: 'currency' (category) ‚Üî 'currency' (object)
2026-02-14 15:23:25,641 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:23:25,642 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:23:25,642 - dq_comparison - INFO - Found 28 total mismatches
2026-02-14 15:23:25,642 - dq_comparison - INFO - Will process detailed comparisons for first 28 rows
2026-02-14 15:23:26,889 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:23:26,890 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:23:26,891 - dq_comparison - INFO -   Total mismatches found: 15
2026-02-14 15:23:26,891 - dq_comparison - INFO -   Detailed comparisons logged: 15
2026-02-14 15:23:26,891 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:23:26,892 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:23:26,892 - dq_comparison - INFO -   Use API to retrieve all 15 mismatches
2026-02-14 15:23:26,892 - dq_comparison - INFO - ================================================================================
2026-02-14 15:23:26,893 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:23:26,893 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 13
2026-02-14 15:23:26,894 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 15
2026-02-14 15:23:26,894 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 0
2026-02-14 15:23:26,894 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 0
2026-02-14 15:23:26,895 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 13
2026-02-14 15:23:26,896 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 15
2026-02-14 15:23:26,897 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:23:26,899 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:23:26,899 - dq_comparison - INFO -   Common rows: 0
2026-02-14 15:23:26,899 - dq_comparison - INFO -   Unique to source: 13
2026-02-14 15:23:26,900 - dq_comparison - INFO -   Unique to target: 15
2026-02-14 15:23:26,900 - dq_comparison - INFO -   Value mismatches: 224
2026-02-14 15:23:26,901 - dq_comparison - INFO -   Missing rows: 13
2026-02-14 15:23:26,901 - dq_comparison - INFO -   Extra rows: 15
2026-02-14 15:23:26,901 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Postgresql Database vs CSV (20260214_152324_source15.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
2     | 1          | amount: 1001.25                          | amount: 1001.25                         
3     | 1          | amount: 1002.5                           | amount: 1002.5                          
4     | 1          | amount: 1003.75                          | amount: 1003.75                         
5     | 1          | amount: 1005.0                           | amount: 1005.0                          
6     | 1          | amount: 1006.25                          | amount: 1006.25                         
7     | 1          | amount: 1007.5                           | amount: 1007.5                          
8     | 1          | amount: 1008.75                          | amount: 1008.75                         
9     | 1          | amount: 1010.0                           | amount: 1010.0                          
10    | 1          | amount: 1011.25                          | amount: 1011.25                         
11    | 1          | amount: 1012.5                           | amount: 1012.5                          
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 15 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-14 15:23:26,902 - dq_comparison - INFO - Returning enhanced mismatch structure with 15 detailed mismatches
2026-02-14 15:23:26,902 - dq_comparison - INFO - New structure: 15 detailed mismatches
2026-02-14 15:23:26,903 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:23:26,920 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:23:26,922 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:23:27,003 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152325
2026-02-14 15:23:27,006 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:23:27,007 - dq_comparison - INFO -   Source rows: 13
2026-02-14 15:23:27,008 - dq_comparison - INFO -   Common rows (matched): 0
2026-02-14 15:23:27,008 - dq_comparison - INFO -   Calculation: (0 / 13) * 100 = 0.00%
2026-02-14 15:23:27,009 - dq_comparison - INFO -   Explanation: 0 matched rows out of 13 total source rows
2026-02-14 15:23:27,009 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:23:27,010 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:23:27,010 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:23:27,010 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152325
2026-02-14 15:23:27,011 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:23:27,093 - dq_audit - INFO - Inserted comparison record with ID: 569
2026-02-14 15:23:27,094 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 569)
2026-02-14 15:23:27,179 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152325
2026-02-14 15:23:27,257 - dq_error_log - INFO - Retrieved summary: 15 total errors for session CMP_20260214_152325
2026-02-14 15:23:27,258 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:23:27,335 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152325
2026-02-14 15:23:27,337 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:23:27,337 - dq_comparison - INFO -    Session ID: CMP_20260214_152325
2026-02-14 15:23:27,338 - dq_comparison - INFO -    DQ Score (Simple %): 0.00%
2026-02-14 15:23:27,338 - dq_comparison - INFO -    Source rows: 13
2026-02-14 15:23:27,339 - dq_comparison - INFO -    Matched rows: 0
2026-02-14 15:23:27,339 - dq_comparison - INFO -    Calculation: (0 / 13) * 100
2026-02-14 15:23:27,339 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:23:27,418 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152325
2026-02-14 15:23:27,496 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152325
2026-02-14 15:23:27,573 - dq_error_log - INFO - Retrieved summary: 15 total errors for session CMP_20260214_152325
2026-02-14 15:23:27,580 - __main__ - INFO - Completed with status 200 in 2.345s
2026-02-14 15:23:27,621 - __main__ - INFO - GET /api/compare/CMP_20260214_152325/mismatches - Request started
2026-02-14 15:23:27,789 - __main__ - INFO - Completed with status 200 in 0.168s
2026-02-14 15:23:28,113 - __main__ - INFO - GET /api/compare/CMP_20260214_152325/mismatches - Request started
2026-02-14 15:23:28,319 - __main__ - INFO - Completed with status 200 in 0.205s
2026-02-14 15:24:19,051 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:24:19,055 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:24:19,061 - __main__ - INFO - Database: Not provided
2026-02-14 15:24:19,062 - __main__ - INFO - Schema: Not provided
2026-02-14 15:24:19,063 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:24:19,064 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:24:19,064 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:24:19,065 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:24:19,066 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:24:19,266 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC1250; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:24:19,267 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:24:19,269 - __main__ - INFO - Getting databases list...
2026-02-14 15:24:19,269 - database_navigator - INFO - get_databases() called. db_type: postgresql, connection exists: True
2026-02-14 15:24:19,278 - database_navigator - INFO - Raw rows: [('dq_checks',), ('postgres',), ('test',)]
2026-02-14 15:24:19,279 - database_navigator - INFO - Found 3 databases
2026-02-14 15:24:19,279 - __main__ - INFO - Found 3 databases
2026-02-14 15:24:19,281 - __main__ - INFO - Completed with status 200 in 0.230s
2026-02-14 15:24:21,257 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:24:21,258 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:24:21,259 - __main__ - INFO - Database: dq_checks
2026-02-14 15:24:21,261 - __main__ - INFO - Schema: Not provided
2026-02-14 15:24:21,262 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:24:21,263 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:24:21,263 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:24:21,265 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:24:21,266 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:24:21,479 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC1250; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:24:21,481 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:24:21,482 - __main__ - INFO - Getting schemas for database: dq_checks
2026-02-14 15:24:21,482 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-02-14 15:24:21,486 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:24:21,487 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:24:21,488 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-02-14 15:24:21,695 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC3EF0; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-02-14 15:24:21,696 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-02-14 15:24:21,714 - database_navigator - INFO - Found 4 schemas
2026-02-14 15:24:21,716 - __main__ - INFO - Found 4 schemas
2026-02-14 15:24:21,716 - __main__ - INFO - Completed with status 200 in 0.459s
2026-02-14 15:24:23,512 - __main__ - INFO - POST /api/database-hierarchy - Request started
2026-02-14 15:24:23,520 - __main__ - INFO - Getting database hierarchy for postgresql
2026-02-14 15:24:23,529 - __main__ - INFO - Database: dq_checks
2026-02-14 15:24:23,534 - __main__ - INFO - Schema: public
2026-02-14 15:24:23,536 - database_navigator - INFO - DatabaseNavigator initialized
2026-02-14 15:24:23,536 - __main__ - INFO - Connecting with config: {'host': 'localhost', 'port': 5432, 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:24:23,537 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:24:23,539 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:24:23,540 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=postgres, user=postgres
2026-02-14 15:24:23,774 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC3EF0; dsn: 'user=postgres password=xxx dbname=postgres host=localhost port=5432', closed: 0>
2026-02-14 15:24:23,776 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: postgres
2026-02-14 15:24:23,777 - __main__ - INFO - Getting tables for database: dq_checks, schema: public
2026-02-14 15:24:23,777 - database_navigator - INFO - Ensuring connection to database: dq_checks for table list
2026-02-14 15:24:23,778 - database_navigator - INFO - Reconnecting to PostgreSQL database: dq_checks
2026-02-14 15:24:23,779 - database_navigator - INFO - Connecting to POSTGRESQL...
2026-02-14 15:24:23,780 - database_navigator - INFO - Connecting to PostgreSQL...
2026-02-14 15:24:23,780 - database_navigator - INFO - Connecting to PostgreSQL: host=localhost, port=5432, database=dq_checks, user=postgres
2026-02-14 15:24:23,973 - database_navigator - INFO - Connection object created: <connection object at 0x00000186BBBC2020; dsn: 'user=postgres password=xxx dbname=dq_checks host=localhost port=5432', closed: 0>
2026-02-14 15:24:23,975 - database_navigator - INFO - ‚úÖ PostgreSQL connection successful to database: dq_checks
2026-02-14 15:24:23,976 - database_navigator - INFO - Connected to database: dq_checks, schema: public
2026-02-14 15:24:24,008 - database_navigator - INFO - Found 20 tables in dq_checks.public: ['advanced100', 'advanced1000', 'advanced10000', 'advanced100000', 'advanced15', 'customers', 'employee', 'rulesdata', 'single100', 'single1000', 'single10000', 'single100000', 'single15', 'target13', 'target90', 'target900', 'target9000', 'target90000', 'testadv', 'testadv_stage']
2026-02-14 15:24:24,009 - database_navigator - INFO - Found 20 tables in schema 'public'
2026-02-14 15:24:24,010 - __main__ - INFO - Found 20 tables
2026-02-14 15:24:24,011 - __main__ - INFO - Completed with status 200 in 0.499s
2026-02-14 15:24:29,114 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:24:29,155 - __main__ - INFO - File uploaded: 20260214_152429_source15.xlsx (excel)
2026-02-14 15:24:29,156 - __main__ - INFO - Completed with status 200 in 0.042s
2026-02-14 15:24:29,379 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:24:29,381 - __main__ - INFO - Comparison request - Source: database, Target: excel
2026-02-14 15:24:29,382 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:24:29,384 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'database', 'db_type': 'postgresql', 'host': 'localhost', 'port': 5432, 'database': 'dq_checks', 'schema': 'public', 'table': 'target13', 'user': 'postgres', 'password': 'postgres'}
2026-02-14 15:24:29,385 - __main__ - INFO - Starting comparison for session CMP_20260214_152429
2026-02-14 15:24:29,386 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:24:29,386 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:24:29,387 - dq_comparison - INFO - 
==================================================
2026-02-14 15:24:29,388 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:24:29,388 - dq_comparison - INFO - ==================================================
2026-02-14 15:24:29,389 - dq_comparison - INFO - 
üóÑÔ∏è SOURCE DATABASE CONFIGURATION
2026-02-14 15:24:29,390 - dq_comparison - INFO - ----------------------------------------
2026-02-14 15:24:29,390 - dq_comparison - INFO - UI mode: Using provided database configuration for SOURCE
2026-02-14 15:24:29,391 - dq_unified - INFO - Loading data from DATABASE
2026-02-14 15:24:29,391 - dq_unified - INFO - Loading large database table: target13
2026-02-14 15:24:29,392 - dq_unified - INFO - Normalized DB config with schema: public
2026-02-14 15:24:29,584 - dq_unified - INFO - PostgreSQL table public.target13 has 13 rows
2026-02-14 15:24:29,585 - dq_unified - INFO - Loading 13 rows from PostgreSQL...
2026-02-14 15:24:29,588 - dq_unified - INFO - Loaded 13 rows from PostgreSQL
2026-02-14 15:24:29,592 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:24:29,594 - dq_unified - INFO - Loaded 13 rows, 8 columns. Memory: 141.0MB total, 0.0MB for dataframe
2026-02-14 15:24:29,595 - dq_comparison - INFO - SOURCE database loaded: 13 rows, 8 columns
2026-02-14 15:24:29,595 - dq_comparison - INFO - 
==================================================
2026-02-14 15:24:29,595 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:24:29,596 - dq_comparison - INFO - ==================================================
2026-02-14 15:24:29,596 - dq_comparison - INFO - DEBUG load_excel_source called for TARGET
2026-02-14 15:24:29,596 - dq_comparison - INFO - DEBUG ui_data: {'source_type': 'excel', 'target_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152429_source15.xlsx'}
2026-02-14 15:24:29,597 - dq_comparison - INFO - DEBUG ui_data type: <class 'dict'>
2026-02-14 15:24:29,597 - dq_comparison - INFO - DEBUG Found target_file_path in ui_data: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152429_source15.xlsx
2026-02-14 15:24:29,622 - dq_comparison - INFO - TARGET Excel loaded: 15 rows, 8 columns
2026-02-14 15:24:29,623 - dq_comparison - INFO - Source data loaded: 13 rows, 8 columns
2026-02-14 15:24:29,623 - dq_comparison - INFO - Target data loaded: 15 rows, 8 columns
2026-02-14 15:24:29,623 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:24:29,624 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:24:29,624 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:24:29,625 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:24:29,625 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:24:29,625 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:24:29,626 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:24:29,626 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:24:29,626 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:24:29,627 - dq_comparison - INFO - Report details - Source: Database: postgresql - dq_checks.target13, Target: Excel: 20260214_152429_source15.xlsx (source15), Selected columns: 8
2026-02-14 15:24:29,627 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:24:29,628 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:24:29,703 - dq_error_log - INFO - Database connection successful
2026-02-14 15:24:29,704 - dq_comparison - INFO - Session ID: CMP_20260214_152429
2026-02-14 15:24:29,705 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=13, Target=15, Difference=2
2026-02-14 15:24:29,705 - dq_comparison - WARNING -    Extra in target: 2 rows
2026-02-14 15:24:29,706 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:24:29,707 - dq_comparison - WARNING - Found 5 incompatible data type mismatches
2026-02-14 15:24:29,707 - dq_comparison - INFO - Column structure comparison complete. Match: False
2026-02-14 15:24:29,708 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:24:29,708 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:24:29,714 - dq_comparison - INFO - Auto-detected common key fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:24:29,718 - dq_comparison - INFO - Primary key validation passed for fields: ['account_id', 'transaction_id', 'amount', 'transaction_date']
2026-02-14 15:24:29,718 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:24:29,719 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:24:29,724 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:24:29,724 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:24:29,726 - dq_comparison - INFO - Starting comparison of 28 total rows...
2026-02-14 15:24:29,727 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:24:29,728 - dq_comparison - INFO - Column: amount
2026-02-14 15:24:29,728 - dq_comparison - INFO -   Source type: <class 'numpy.float32'>, value: 1001.25
2026-02-14 15:24:29,729 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:24:29,729 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:24:29,730 - dq_comparison - INFO -   Match: True
2026-02-14 15:24:29,730 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:24:29,730 - dq_comparison - INFO -   Source type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:24:29,731 - dq_comparison - INFO -   Target type: <class 'pandas._libs.tslibs.timestamps.Timestamp'>, value: 2024-01-02 00:00:00
2026-02-14 15:24:29,732 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:24:29,733 - dq_comparison - INFO -   Match: True
2026-02-14 15:24:29,733 - dq_comparison - INFO - Column: account_id
2026-02-14 15:24:29,733 - dq_comparison - INFO -   Source type: <class 'numpy.uint8'>, value: 1
2026-02-14 15:24:29,734 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:24:29,734 - dq_comparison - INFO -   Normalized: '1' vs 'acc000001'
2026-02-14 15:24:29,735 - dq_comparison - INFO -   Match: False
2026-02-14 15:24:29,735 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:24:29,735 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:24:29,736 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:24:29,736 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:24:29,736 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:24:29,737 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:24:29,737 - dq_comparison - INFO - Generating hashes for source data (13 rows)...
2026-02-14 15:24:29,740 - dq_comparison - INFO -    Hashing source data: 10.7% complete (3/28 rows)
2026-02-14 15:24:29,743 - dq_comparison - INFO -    Hashing source data: 21.4% complete (6/28 rows)
2026-02-14 15:24:29,746 - dq_comparison - INFO -    Hashing source data: 32.1% complete (9/28 rows)
2026-02-14 15:24:29,748 - dq_comparison - INFO -    Hashing source data: 42.9% complete (12/28 rows)
2026-02-14 15:24:29,751 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:24:29,751 - dq_comparison - INFO - Hash 1: 524d9ba30607aa88... (sample row 0)
2026-02-14 15:24:29,752 - dq_comparison - INFO - Hash 2: 8e039ce62fbc3c0d... (sample row 1)
2026-02-14 15:24:29,752 - dq_comparison - INFO - Hash 3: 3e951b47b7f65ad8... (sample row 2)
2026-02-14 15:24:29,752 - dq_comparison - INFO - Generating hashes for target data (15 rows)...
2026-02-14 15:24:29,754 - dq_comparison - INFO -    Hashing target data: 53.6% complete (15/28 rows)
2026-02-14 15:24:29,756 - dq_comparison - INFO -    Hashing target data: 64.3% complete (18/28 rows)
2026-02-14 15:24:29,759 - dq_comparison - INFO -    Hashing target data: 75.0% complete (21/28 rows)
2026-02-14 15:24:29,761 - dq_comparison - INFO -    Hashing target data: 85.7% complete (24/28 rows)
2026-02-14 15:24:29,764 - dq_comparison - INFO -    Hashing target data: 96.4% complete (27/28 rows)
2026-02-14 15:24:29,766 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:24:29,766 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:24:29,767 - dq_comparison - INFO - ======================================================================
2026-02-14 15:24:29,767 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:24:29,768 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:24:29,768 - dq_comparison - INFO -   Source: '1001.25' (type: float32) ‚Üí '1001.25'
2026-02-14 15:24:29,768 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:24:29,769 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,770 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:24:29,770 - dq_comparison - INFO -   Source: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:24:29,771 - dq_comparison - INFO -   Target: '2024-01-02 00:00:00' (type: Timestamp) ‚Üí '2024-02-01'
2026-02-14 15:24:29,771 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,772 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:24:29,772 - dq_comparison - INFO -   Source: '1' (type: uint8) ‚Üí '1'
2026-02-14 15:24:29,772 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:24:29,773 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:24:29,773 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:24:29,773 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:24:29,774 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:24:29,774 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,774 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:24:29,775 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:24:29,775 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:24:29,775 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,776 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:24:29,777 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|1...
2026-02-14 15:24:29,778 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:24:29,778 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:24:29,778 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:24:29,779 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:24:29,780 - dq_comparison - INFO -   Source: '1002.5' (type: float32) ‚Üí '1002.5'
2026-02-14 15:24:29,780 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:24:29,780 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,781 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:24:29,782 - dq_comparison - INFO -   Source: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:24:29,782 - dq_comparison - INFO -   Target: '2024-01-03 00:00:00' (type: Timestamp) ‚Üí '2024-03-01'
2026-02-14 15:24:29,783 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,783 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:24:29,784 - dq_comparison - INFO -   Source: '2' (type: uint8) ‚Üí '2'
2026-02-14 15:24:29,784 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:24:29,784 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:24:29,784 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:24:29,786 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:24:29,786 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:24:29,786 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,787 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:24:29,787 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:24:29,787 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:24:29,789 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,789 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:24:29,791 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|2...
2026-02-14 15:24:29,792 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:24:29,792 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:24:29,792 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:24:29,793 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:24:29,794 - dq_comparison - INFO -   Source: '1003.75' (type: float32) ‚Üí '1003.75'
2026-02-14 15:24:29,794 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:24:29,795 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,796 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:24:29,796 - dq_comparison - INFO -   Source: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:24:29,797 - dq_comparison - INFO -   Target: '2024-01-04 00:00:00' (type: Timestamp) ‚Üí '2024-04-01'
2026-02-14 15:24:29,797 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,798 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:24:29,798 - dq_comparison - INFO -   Source: '3' (type: uint8) ‚Üí '3'
2026-02-14 15:24:29,799 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:24:29,799 - dq_comparison - INFO -   Match after normalization: ‚ùå NO
2026-02-14 15:24:29,799 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:24:29,800 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:24:29,800 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:24:29,801 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,801 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:24:29,802 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:24:29,802 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:24:29,803 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:24:29,803 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:24:29,805 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|3...
2026-02-14 15:24:29,805 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:24:29,805 - dq_comparison - INFO - Same? ‚ùå NO
2026-02-14 15:24:29,806 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:24:29,806 - dq_comparison - INFO - Column 1: 'amount' (float32) ‚Üî 'amount' (float64)
2026-02-14 15:24:29,808 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:24:29,808 - dq_comparison - INFO - Column 2: 'transaction_date' (datetime64[ns]) ‚Üî 'transaction_date' (datetime64[ns])
2026-02-14 15:24:29,808 - dq_comparison - INFO -   Sample: Source='2024-01-02 00:00:00', Target='2024-01-02 00:00:00'
2026-02-14 15:24:29,809 - dq_comparison - INFO - Column 3: 'account_id' (uint8) ‚Üî 'account_id' (object)
2026-02-14 15:24:29,809 - dq_comparison - INFO -   Sample: Source='1', Target='ACC000001'
2026-02-14 15:24:29,810 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:24:29,810 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:24:29,810 - dq_comparison - INFO - Column 5: 'currency' (category) ‚Üî 'currency' (object)
2026-02-14 15:24:29,811 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:24:29,811 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:24:29,812 - dq_comparison - INFO - Found 28 total mismatches
2026-02-14 15:24:29,812 - dq_comparison - INFO - Will process detailed comparisons for first 28 rows
2026-02-14 15:24:31,037 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:24:31,037 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:24:31,038 - dq_comparison - INFO -   Total mismatches found: 15
2026-02-14 15:24:31,038 - dq_comparison - INFO -   Detailed comparisons logged: 15
2026-02-14 15:24:31,039 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:24:31,039 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:24:31,039 - dq_comparison - INFO -   Use API to retrieve all 15 mismatches
2026-02-14 15:24:31,040 - dq_comparison - INFO - ================================================================================
2026-02-14 15:24:31,040 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:24:31,040 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 13
2026-02-14 15:24:31,041 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 15
2026-02-14 15:24:31,041 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 0
2026-02-14 15:24:31,041 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 0
2026-02-14 15:24:31,042 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 13
2026-02-14 15:24:31,042 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 15
2026-02-14 15:24:31,043 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:24:31,044 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:24:31,044 - dq_comparison - INFO -   Common rows: 0
2026-02-14 15:24:31,045 - dq_comparison - INFO -   Unique to source: 13
2026-02-14 15:24:31,045 - dq_comparison - INFO -   Unique to target: 15
2026-02-14 15:24:31,045 - dq_comparison - INFO -   Value mismatches: 224
2026-02-14 15:24:31,045 - dq_comparison - INFO -   Missing rows: 13
2026-02-14 15:24:31,046 - dq_comparison - INFO -   Extra rows: 15
2026-02-14 15:24:31,046 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: Postgresql Database vs Excel (20260214_152429_source15.xlsx (source15))
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
2     | 1          | amount: 1001.25                          | amount: 1001.25                         
3     | 1          | amount: 1002.5                           | amount: 1002.5                          
4     | 1          | amount: 1003.75                          | amount: 1003.75                         
5     | 1          | amount: 1005.0                           | amount: 1005.0                          
6     | 1          | amount: 1006.25                          | amount: 1006.25                         
7     | 1          | amount: 1007.5                           | amount: 1007.5                          
8     | 1          | amount: 1008.75                          | amount: 1008.75                         
9     | 1          | amount: 1010.0                           | amount: 1010.0                          
10    | 1          | amount: 1011.25                          | amount: 1011.25                         
11    | 1          | amount: 1012.5                           | amount: 1012.5                          
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 15 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-14 15:24:31,046 - dq_comparison - INFO - Returning enhanced mismatch structure with 15 detailed mismatches
2026-02-14 15:24:31,047 - dq_comparison - INFO - New structure: 15 detailed mismatches
2026-02-14 15:24:31,047 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:24:31,065 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:24:31,067 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:24:31,143 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152429
2026-02-14 15:24:31,146 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:24:31,147 - dq_comparison - INFO -   Source rows: 13
2026-02-14 15:24:31,147 - dq_comparison - INFO -   Common rows (matched): 0
2026-02-14 15:24:31,147 - dq_comparison - INFO -   Calculation: (0 / 13) * 100 = 0.00%
2026-02-14 15:24:31,148 - dq_comparison - INFO -   Explanation: 0 matched rows out of 13 total source rows
2026-02-14 15:24:31,148 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:24:31,149 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:24:31,149 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:24:31,149 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152429
2026-02-14 15:24:31,150 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:24:31,223 - dq_audit - INFO - Inserted comparison record with ID: 570
2026-02-14 15:24:31,225 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 570)
2026-02-14 15:24:31,298 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152429
2026-02-14 15:24:31,373 - dq_error_log - INFO - Retrieved summary: 15 total errors for session CMP_20260214_152429
2026-02-14 15:24:31,375 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:24:31,448 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152429
2026-02-14 15:24:31,451 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:24:31,452 - dq_comparison - INFO -    Session ID: CMP_20260214_152429
2026-02-14 15:24:31,452 - dq_comparison - INFO -    DQ Score (Simple %): 0.00%
2026-02-14 15:24:31,453 - dq_comparison - INFO -    Source rows: 13
2026-02-14 15:24:31,453 - dq_comparison - INFO -    Matched rows: 0
2026-02-14 15:24:31,454 - dq_comparison - INFO -    Calculation: (0 / 13) * 100
2026-02-14 15:24:31,454 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:24:31,530 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152429
2026-02-14 15:24:31,601 - dq_error_log - INFO - Retrieved 15 error logs for session CMP_20260214_152429
2026-02-14 15:24:31,676 - dq_error_log - INFO - Retrieved summary: 15 total errors for session CMP_20260214_152429
2026-02-14 15:24:31,682 - __main__ - INFO - Completed with status 200 in 2.302s
2026-02-14 15:24:31,726 - __main__ - INFO - GET /api/compare/CMP_20260214_152429/mismatches - Request started
2026-02-14 15:24:31,882 - __main__ - INFO - Completed with status 200 in 0.156s
2026-02-14 15:24:32,206 - __main__ - INFO - GET /api/compare/CMP_20260214_152429/mismatches - Request started
2026-02-14 15:24:32,391 - __main__ - INFO - Completed with status 200 in 0.186s
2026-02-14 15:25:33,633 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:25:33,651 - __main__ - INFO - File uploaded: 20260214_152533_source100.csv (csv)
2026-02-14 15:25:33,654 - __main__ - INFO - Completed with status 200 in 0.021s
2026-02-14 15:25:33,896 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:25:33,909 - __main__ - INFO - File uploaded: 20260214_152533_target90.csv (csv)
2026-02-14 15:25:33,910 - __main__ - INFO - Completed with status 200 in 0.014s
2026-02-14 15:25:33,988 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:25:33,989 - __main__ - INFO - Comparison request - Source: csv, Target: csv
2026-02-14 15:25:33,990 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:25:33,991 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152533_source100.csv'}
2026-02-14 15:25:33,991 - __main__ - INFO - Starting comparison for session CMP_20260214_152533
2026-02-14 15:25:33,992 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:25:33,993 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:25:33,993 - dq_comparison - INFO - 
==================================================
2026-02-14 15:25:33,994 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:25:33,995 - dq_comparison - INFO - ==================================================
2026-02-14 15:25:33,996 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-14 15:25:33,996 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152533_source100.csv
2026-02-14 15:25:34,000 - dq_comparison - INFO - SOURCE CSV loaded: 100 rows, 8 columns
2026-02-14 15:25:34,001 - dq_comparison - INFO - 
==================================================
2026-02-14 15:25:34,001 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:25:34,001 - dq_comparison - INFO - ==================================================
2026-02-14 15:25:34,002 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-14 15:25:34,002 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152533_target90.csv
2026-02-14 15:25:34,005 - dq_comparison - INFO - TARGET CSV loaded: 90 rows, 8 columns
2026-02-14 15:25:34,006 - dq_comparison - INFO - Source data loaded: 100 rows, 8 columns
2026-02-14 15:25:34,006 - dq_comparison - INFO - Target data loaded: 90 rows, 8 columns
2026-02-14 15:25:34,007 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:25:34,007 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:34,008 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:34,008 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:34,009 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:25:34,009 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:25:34,010 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:25:34,010 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:25:34,011 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:25:34,011 - dq_comparison - INFO - Report details - Source: CSV: 20260214_152533_source100.csv, Target: CSV: 20260214_152533_target90.csv, Selected columns: 8
2026-02-14 15:25:34,012 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:25:34,012 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:25:34,087 - dq_error_log - INFO - Database connection successful
2026-02-14 15:25:34,089 - dq_comparison - INFO - Session ID: CMP_20260214_152534
2026-02-14 15:25:34,089 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=100, Target=90, Difference=10
2026-02-14 15:25:34,090 - dq_comparison - WARNING -    Missing in target: 10 rows
2026-02-14 15:25:34,090 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:25:34,091 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-14 15:25:34,092 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:25:34,092 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:25:34,096 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:25:34,098 - dq_comparison - WARNING - Primary key validation failed - duplicates in: ['amount']
2026-02-14 15:25:34,098 - dq_comparison - INFO - Primary key validation complete. Status: DUPLICATE_VALUES
2026-02-14 15:25:34,186 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:25:34,193 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:25:34,193 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:25:34,195 - dq_comparison - INFO - Starting comparison of 190 total rows...
2026-02-14 15:25:34,196 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:25:34,196 - dq_comparison - INFO - Column: amount
2026-02-14 15:25:34,196 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:25:34,197 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:25:34,197 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:25:34,198 - dq_comparison - INFO -   Match: True
2026-02-14 15:25:34,198 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:25:34,198 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-14 15:25:34,199 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-14 15:25:34,200 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:25:34,200 - dq_comparison - INFO -   Match: True
2026-02-14 15:25:34,201 - dq_comparison - INFO - Column: account_id
2026-02-14 15:25:34,201 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:25:34,202 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:25:34,202 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:25:34,202 - dq_comparison - INFO -   Match: True
2026-02-14 15:25:34,203 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:34,203 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:34,203 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:34,204 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:25:34,204 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:34,204 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:34,205 - dq_comparison - INFO - Generating hashes for source data (100 rows)...
2026-02-14 15:25:34,216 - dq_comparison - INFO -    Hashing source data: 10.0% complete (19/190 rows)
2026-02-14 15:25:34,227 - dq_comparison - INFO -    Hashing source data: 20.0% complete (38/190 rows)
2026-02-14 15:25:34,239 - dq_comparison - INFO -    Hashing source data: 30.0% complete (57/190 rows)
2026-02-14 15:25:34,250 - dq_comparison - INFO -    Hashing source data: 40.0% complete (76/190 rows)
2026-02-14 15:25:34,260 - dq_comparison - INFO -    Hashing source data: 50.0% complete (95/190 rows)
2026-02-14 15:25:34,264 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:25:34,265 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:25:34,265 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:25:34,266 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:25:34,266 - dq_comparison - INFO - Generating hashes for target data (90 rows)...
2026-02-14 15:25:34,273 - dq_comparison - INFO -    Hashing target data: 60.0% complete (114/190 rows)
2026-02-14 15:25:34,285 - dq_comparison - INFO -    Hashing target data: 70.0% complete (133/190 rows)
2026-02-14 15:25:34,295 - dq_comparison - INFO -    Hashing target data: 80.0% complete (152/190 rows)
2026-02-14 15:25:34,306 - dq_comparison - INFO -    Hashing target data: 90.0% complete (171/190 rows)
2026-02-14 15:25:34,326 - dq_comparison - INFO -    Hashing target data: 100.0% complete (190/190 rows)
2026-02-14 15:25:34,330 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:25:34,331 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:25:34,333 - dq_comparison - INFO - ======================================================================
2026-02-14 15:25:34,333 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:25:34,334 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:25:34,335 - dq_comparison - INFO -   Source: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:25:34,335 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:25:34,335 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,337 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:25:34,337 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:25:34,338 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:25:34,339 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,339 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:25:34,340 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:25:34,341 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:25:34,341 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,342 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:25:34,343 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:25:34,343 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:25:34,343 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,344 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:25:34,344 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:34,345 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:34,345 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,345 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:25:34,347 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:25:34,347 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:25:34,348 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:25:34,348 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:25:34,349 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:25:34,350 - dq_comparison - INFO -   Source: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:25:34,350 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:25:34,350 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,351 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:25:34,352 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:25:34,352 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:25:34,353 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,353 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:25:34,354 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:25:34,354 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:25:34,354 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,354 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:25:34,356 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:25:34,357 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:25:34,357 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,359 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:25:34,360 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:34,360 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:34,361 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,361 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:25:34,363 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:25:34,364 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:25:34,364 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:25:34,365 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:25:34,366 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:25:34,366 - dq_comparison - INFO -   Source: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:25:34,367 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:25:34,367 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,369 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:25:34,369 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:25:34,370 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:25:34,371 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,372 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:25:34,373 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:25:34,374 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:25:34,374 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,376 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:25:34,376 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:25:34,377 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:25:34,377 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,378 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:25:34,378 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:34,378 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:34,379 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:34,380 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:25:34,381 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:25:34,381 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:25:34,382 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:25:34,382 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:25:34,383 - dq_comparison - INFO - Column 1: 'amount' (float64) ‚Üî 'amount' (float64)
2026-02-14 15:25:34,384 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:25:34,384 - dq_comparison - INFO - Column 2: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-02-14 15:25:34,384 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='1/2/2024'
2026-02-14 15:25:34,385 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:25:34,385 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:25:34,385 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:25:34,387 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:25:34,387 - dq_comparison - INFO - Column 5: 'currency' (object) ‚Üî 'currency' (object)
2026-02-14 15:25:34,389 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:25:34,389 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:25:34,389 - dq_comparison - INFO - Found 14 total mismatches
2026-02-14 15:25:34,389 - dq_comparison - INFO - Will process detailed comparisons for first 14 rows
2026-02-14 15:25:35,361 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:25:35,362 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:25:35,362 - dq_comparison - INFO -   Total mismatches found: 12
2026-02-14 15:25:35,363 - dq_comparison - INFO -   Detailed comparisons logged: 12
2026-02-14 15:25:35,363 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:25:35,363 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:25:35,364 - dq_comparison - INFO -   Use API to retrieve all 12 mismatches
2026-02-14 15:25:35,364 - dq_comparison - INFO - ================================================================================
2026-02-14 15:25:35,364 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:25:35,365 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 100
2026-02-14 15:25:35,365 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 90
2026-02-14 15:25:35,366 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 88
2026-02-14 15:25:35,366 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 88
2026-02-14 15:25:35,366 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 12
2026-02-14 15:25:35,367 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:25:35,368 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:25:35,368 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:25:35,369 - dq_comparison - INFO -   Common rows: 88
2026-02-14 15:25:35,370 - dq_comparison - INFO -   Unique to source: 12
2026-02-14 15:25:35,370 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:25:35,371 - dq_comparison - INFO -   Value mismatches: 112
2026-02-14 15:25:35,373 - dq_comparison - INFO -   Missing rows: 12
2026-02-14 15:25:35,373 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:25:35,374 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260214_152533_source100.csv) vs CSV (20260214_152533_target90.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
90    | 2          | amount: 1111.25                          | amount: 1011.25                         
91    | 2          | amount: 1112.5                           | amount: 1012.5                          
92    | 8          | amount: 1113.75                          | amount: NULL                            
93    | 8          | amount: 1115.0                           | amount: NULL                            
94    | 8          | amount: 1116.25                          | amount: NULL                            
95    | 8          | amount: 1117.5                           | amount: NULL                            
96    | 8          | amount: 1118.75                          | amount: NULL                            
97    | 8          | amount: 1120.0                           | amount: NULL                            
98    | 8          | amount: 1121.25                          | amount: NULL                            
99    | 8          | amount: 1122.5                           | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 12 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-14 15:25:35,374 - dq_comparison - INFO - Returning enhanced mismatch structure with 12 detailed mismatches
2026-02-14 15:25:35,375 - dq_comparison - INFO - New structure: 12 detailed mismatches
2026-02-14 15:25:35,376 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:25:35,468 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:25:35,470 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:25:35,550 - dq_error_log - INFO - Retrieved 13 error logs for session CMP_20260214_152534
2026-02-14 15:25:35,551 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:25:35,552 - dq_comparison - INFO -   Source rows: 100
2026-02-14 15:25:35,552 - dq_comparison - INFO -   Common rows (matched): 88
2026-02-14 15:25:35,553 - dq_comparison - INFO -   Calculation: (88 / 100) * 100 = 88.00%
2026-02-14 15:25:35,553 - dq_comparison - INFO -   Explanation: 88 matched rows out of 100 total source rows
2026-02-14 15:25:35,554 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:25:35,554 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:25:35,554 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:25:35,554 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152534
2026-02-14 15:25:35,555 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:25:35,632 - dq_audit - INFO - Inserted comparison record with ID: 571
2026-02-14 15:25:35,634 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 571)
2026-02-14 15:25:35,713 - dq_error_log - INFO - Retrieved 13 error logs for session CMP_20260214_152534
2026-02-14 15:25:35,796 - dq_error_log - INFO - Retrieved summary: 13 total errors for session CMP_20260214_152534
2026-02-14 15:25:35,798 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:25:35,881 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152534
2026-02-14 15:25:35,883 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:25:35,884 - dq_comparison - INFO -    Session ID: CMP_20260214_152534
2026-02-14 15:25:35,884 - dq_comparison - INFO -    DQ Score (Simple %): 88.00%
2026-02-14 15:25:35,885 - dq_comparison - INFO -    Source rows: 100
2026-02-14 15:25:35,885 - dq_comparison - INFO -    Matched rows: 88
2026-02-14 15:25:35,885 - dq_comparison - INFO -    Calculation: (88 / 100) * 100
2026-02-14 15:25:35,886 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:25:35,978 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152534
2026-02-14 15:25:36,056 - dq_error_log - INFO - Retrieved 13 error logs for session CMP_20260214_152534
2026-02-14 15:25:36,128 - dq_error_log - INFO - Retrieved summary: 13 total errors for session CMP_20260214_152534
2026-02-14 15:25:36,133 - __main__ - INFO - Completed with status 200 in 2.145s
2026-02-14 15:25:36,175 - __main__ - INFO - GET /api/compare/CMP_20260214_152533/mismatches - Request started
2026-02-14 15:25:36,325 - __main__ - INFO - Completed with status 200 in 0.150s
2026-02-14 15:25:36,654 - __main__ - INFO - GET /api/compare/CMP_20260214_152533/mismatches - Request started
2026-02-14 15:25:36,829 - __main__ - INFO - Completed with status 200 in 0.175s
2026-02-14 15:25:47,689 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:25:47,706 - __main__ - INFO - File uploaded: 20260214_152547_source100.csv (csv)
2026-02-14 15:25:47,708 - __main__ - INFO - Completed with status 200 in 0.019s
2026-02-14 15:25:47,952 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:25:47,974 - __main__ - INFO - File uploaded: 20260214_152547_target90.csv (csv)
2026-02-14 15:25:47,975 - __main__ - INFO - Completed with status 200 in 0.023s
2026-02-14 15:25:48,032 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:25:48,034 - __main__ - INFO - Comparison request - Source: csv, Target: csv
2026-02-14 15:25:48,037 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:25:48,039 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152547_source100.csv'}
2026-02-14 15:25:48,041 - __main__ - INFO - Starting comparison for session CMP_20260214_152548
2026-02-14 15:25:48,042 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:25:48,043 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:25:48,043 - dq_comparison - INFO - 
==================================================
2026-02-14 15:25:48,044 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:25:48,045 - dq_comparison - INFO - ==================================================
2026-02-14 15:25:48,045 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-14 15:25:48,046 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152547_source100.csv
2026-02-14 15:25:48,051 - dq_comparison - INFO - SOURCE CSV loaded: 100 rows, 8 columns
2026-02-14 15:25:48,052 - dq_comparison - INFO - 
==================================================
2026-02-14 15:25:48,052 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:25:48,053 - dq_comparison - INFO - ==================================================
2026-02-14 15:25:48,053 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-14 15:25:48,054 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152547_target90.csv
2026-02-14 15:25:48,058 - dq_comparison - INFO - TARGET CSV loaded: 90 rows, 8 columns
2026-02-14 15:25:48,058 - dq_comparison - INFO - Source data loaded: 100 rows, 8 columns
2026-02-14 15:25:48,060 - dq_comparison - INFO - Target data loaded: 90 rows, 8 columns
2026-02-14 15:25:48,060 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:25:48,061 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:48,061 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:48,062 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:48,062 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:25:48,063 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:25:48,063 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:25:48,063 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:25:48,063 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:25:48,064 - dq_comparison - INFO - Report details - Source: CSV: 20260214_152547_source100.csv, Target: CSV: 20260214_152547_target90.csv, Selected columns: 8
2026-02-14 15:25:48,065 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:25:48,065 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:25:48,141 - dq_error_log - INFO - Database connection successful
2026-02-14 15:25:48,144 - dq_comparison - INFO - Session ID: CMP_20260214_152548
2026-02-14 15:25:48,144 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=100, Target=90, Difference=10
2026-02-14 15:25:48,145 - dq_comparison - WARNING -    Missing in target: 10 rows
2026-02-14 15:25:48,145 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:25:48,146 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-14 15:25:48,147 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:25:48,147 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:25:48,150 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:25:48,152 - dq_comparison - WARNING - Primary key validation failed - duplicates in: ['amount']
2026-02-14 15:25:48,153 - dq_comparison - INFO - Primary key validation complete. Status: DUPLICATE_VALUES
2026-02-14 15:25:48,232 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:25:48,241 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:25:48,242 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:25:48,244 - dq_comparison - INFO - Starting comparison of 190 total rows...
2026-02-14 15:25:48,244 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:25:48,245 - dq_comparison - INFO - Column: amount
2026-02-14 15:25:48,245 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:25:48,246 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:25:48,246 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:25:48,247 - dq_comparison - INFO -   Match: True
2026-02-14 15:25:48,247 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:25:48,248 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-14 15:25:48,248 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-14 15:25:48,249 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:25:48,250 - dq_comparison - INFO -   Match: True
2026-02-14 15:25:48,250 - dq_comparison - INFO - Column: account_id
2026-02-14 15:25:48,251 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:25:48,252 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:25:48,252 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:25:48,253 - dq_comparison - INFO -   Match: True
2026-02-14 15:25:48,253 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:48,253 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:25:48,254 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:48,254 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:25:48,255 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:48,255 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:25:48,255 - dq_comparison - INFO - Generating hashes for source data (100 rows)...
2026-02-14 15:25:48,266 - dq_comparison - INFO -    Hashing source data: 10.0% complete (19/190 rows)
2026-02-14 15:25:48,275 - dq_comparison - INFO -    Hashing source data: 20.0% complete (38/190 rows)
2026-02-14 15:25:48,290 - dq_comparison - INFO -    Hashing source data: 30.0% complete (57/190 rows)
2026-02-14 15:25:48,306 - dq_comparison - INFO -    Hashing source data: 40.0% complete (76/190 rows)
2026-02-14 15:25:48,319 - dq_comparison - INFO -    Hashing source data: 50.0% complete (95/190 rows)
2026-02-14 15:25:48,323 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:25:48,324 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:25:48,324 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:25:48,324 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:25:48,325 - dq_comparison - INFO - Generating hashes for target data (90 rows)...
2026-02-14 15:25:48,335 - dq_comparison - INFO -    Hashing target data: 60.0% complete (114/190 rows)
2026-02-14 15:25:48,346 - dq_comparison - INFO -    Hashing target data: 70.0% complete (133/190 rows)
2026-02-14 15:25:48,357 - dq_comparison - INFO -    Hashing target data: 80.0% complete (152/190 rows)
2026-02-14 15:25:48,370 - dq_comparison - INFO -    Hashing target data: 90.0% complete (171/190 rows)
2026-02-14 15:25:48,381 - dq_comparison - INFO -    Hashing target data: 100.0% complete (190/190 rows)
2026-02-14 15:25:48,383 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:25:48,383 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:25:48,384 - dq_comparison - INFO - ======================================================================
2026-02-14 15:25:48,384 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:25:48,385 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:25:48,385 - dq_comparison - INFO -   Source: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:25:48,386 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:25:48,386 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,387 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:25:48,388 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:25:48,388 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:25:48,389 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,389 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:25:48,390 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:25:48,390 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:25:48,391 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,391 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:25:48,392 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:25:48,393 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:25:48,393 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,394 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:25:48,394 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:48,394 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:48,395 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,395 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:25:48,397 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:25:48,397 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:25:48,398 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:25:48,398 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:25:48,399 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:25:48,399 - dq_comparison - INFO -   Source: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:25:48,400 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:25:48,400 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,401 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:25:48,402 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:25:48,402 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:25:48,402 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,403 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:25:48,403 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:25:48,403 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:25:48,404 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,404 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:25:48,405 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:25:48,405 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:25:48,405 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,406 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:25:48,407 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:48,407 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:48,407 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,408 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:25:48,409 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:25:48,410 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:25:48,410 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:25:48,411 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:25:48,412 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:25:48,412 - dq_comparison - INFO -   Source: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:25:48,413 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:25:48,414 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,415 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:25:48,416 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:25:48,416 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:25:48,417 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,417 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:25:48,418 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:25:48,418 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:25:48,419 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,419 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:25:48,420 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:25:48,420 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:25:48,420 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,421 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:25:48,422 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:48,422 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:25:48,423 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:25:48,423 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:25:48,424 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:25:48,425 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:25:48,425 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:25:48,426 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:25:48,426 - dq_comparison - INFO - Column 1: 'amount' (float64) ‚Üî 'amount' (float64)
2026-02-14 15:25:48,427 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:25:48,427 - dq_comparison - INFO - Column 2: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-02-14 15:25:48,428 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='1/2/2024'
2026-02-14 15:25:48,428 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:25:48,429 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:25:48,430 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:25:48,430 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:25:48,431 - dq_comparison - INFO - Column 5: 'currency' (object) ‚Üî 'currency' (object)
2026-02-14 15:25:48,431 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:25:48,432 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:25:48,432 - dq_comparison - INFO - Found 14 total mismatches
2026-02-14 15:25:48,432 - dq_comparison - INFO - Will process detailed comparisons for first 14 rows
2026-02-14 15:25:49,340 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:25:49,341 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:25:49,341 - dq_comparison - INFO -   Total mismatches found: 12
2026-02-14 15:25:49,342 - dq_comparison - INFO -   Detailed comparisons logged: 12
2026-02-14 15:25:49,342 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:25:49,342 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:25:49,343 - dq_comparison - INFO -   Use API to retrieve all 12 mismatches
2026-02-14 15:25:49,343 - dq_comparison - INFO - ================================================================================
2026-02-14 15:25:49,343 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:25:49,344 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 100
2026-02-14 15:25:49,344 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 90
2026-02-14 15:25:49,345 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 88
2026-02-14 15:25:49,345 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 88
2026-02-14 15:25:49,345 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 12
2026-02-14 15:25:49,346 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:25:49,348 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:25:49,350 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:25:49,350 - dq_comparison - INFO -   Common rows: 88
2026-02-14 15:25:49,350 - dq_comparison - INFO -   Unique to source: 12
2026-02-14 15:25:49,351 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:25:49,351 - dq_comparison - INFO -   Value mismatches: 112
2026-02-14 15:25:49,351 - dq_comparison - INFO -   Missing rows: 12
2026-02-14 15:25:49,352 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:25:49,352 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260214_152547_source100.csv) vs CSV (20260214_152547_target90.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
90    | 2          | amount: 1111.25                          | amount: 1011.25                         
91    | 2          | amount: 1112.5                           | amount: 1012.5                          
92    | 8          | amount: 1113.75                          | amount: NULL                            
93    | 8          | amount: 1115.0                           | amount: NULL                            
94    | 8          | amount: 1116.25                          | amount: NULL                            
95    | 8          | amount: 1117.5                           | amount: NULL                            
96    | 8          | amount: 1118.75                          | amount: NULL                            
97    | 8          | amount: 1120.0                           | amount: NULL                            
98    | 8          | amount: 1121.25                          | amount: NULL                            
99    | 8          | amount: 1122.5                           | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 12 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-14 15:25:49,353 - dq_comparison - INFO - Returning enhanced mismatch structure with 12 detailed mismatches
2026-02-14 15:25:49,353 - dq_comparison - INFO - New structure: 12 detailed mismatches
2026-02-14 15:25:49,353 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:25:49,441 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:25:49,442 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:25:49,515 - dq_error_log - INFO - Retrieved 13 error logs for session CMP_20260214_152548
2026-02-14 15:25:49,517 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:25:49,517 - dq_comparison - INFO -   Source rows: 100
2026-02-14 15:25:49,518 - dq_comparison - INFO -   Common rows (matched): 88
2026-02-14 15:25:49,518 - dq_comparison - INFO -   Calculation: (88 / 100) * 100 = 88.00%
2026-02-14 15:25:49,519 - dq_comparison - INFO -   Explanation: 88 matched rows out of 100 total source rows
2026-02-14 15:25:49,519 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:25:49,520 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:25:49,520 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:25:49,520 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152548
2026-02-14 15:25:49,521 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:25:49,603 - dq_audit - INFO - Inserted comparison record with ID: 572
2026-02-14 15:25:49,604 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 572)
2026-02-14 15:25:49,684 - dq_error_log - INFO - Retrieved 13 error logs for session CMP_20260214_152548
2026-02-14 15:25:49,755 - dq_error_log - INFO - Retrieved summary: 13 total errors for session CMP_20260214_152548
2026-02-14 15:25:49,757 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:25:49,827 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152548
2026-02-14 15:25:49,829 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:25:49,830 - dq_comparison - INFO -    Session ID: CMP_20260214_152548
2026-02-14 15:25:49,830 - dq_comparison - INFO -    DQ Score (Simple %): 88.00%
2026-02-14 15:25:49,830 - dq_comparison - INFO -    Source rows: 100
2026-02-14 15:25:49,831 - dq_comparison - INFO -    Matched rows: 88
2026-02-14 15:25:49,831 - dq_comparison - INFO -    Calculation: (88 / 100) * 100
2026-02-14 15:25:49,832 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:25:49,913 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152548
2026-02-14 15:25:49,987 - dq_error_log - INFO - Retrieved 13 error logs for session CMP_20260214_152548
2026-02-14 15:25:50,064 - dq_error_log - INFO - Retrieved summary: 13 total errors for session CMP_20260214_152548
2026-02-14 15:25:50,070 - __main__ - INFO - Completed with status 200 in 2.038s
2026-02-14 15:25:50,086 - __main__ - INFO - GET /api/compare/CMP_20260214_152548/mismatches - Request started
2026-02-14 15:25:50,245 - __main__ - INFO - Completed with status 200 in 0.159s
2026-02-14 15:26:30,879 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:26:30,890 - __main__ - INFO - File uploaded: 20260214_152630_source1000.csv (csv)
2026-02-14 15:26:30,892 - __main__ - INFO - Completed with status 200 in 0.013s
2026-02-14 15:26:31,126 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:26:31,139 - __main__ - INFO - File uploaded: 20260214_152631_target900.csv (csv)
2026-02-14 15:26:31,140 - __main__ - INFO - Completed with status 200 in 0.015s
2026-02-14 15:26:31,219 - __main__ - INFO - POST /api/compare - Request started
2026-02-14 15:26:31,220 - __main__ - INFO - Comparison request - Source: csv, Target: csv
2026-02-14 15:26:31,221 - __main__ - INFO - Comparison analysis request received
2026-02-14 15:26:31,221 - __main__ - INFO - DEBUG source_data from nested: {'source_type': 'csv', 'source_file_path': 'C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152630_source1000.csv'}
2026-02-14 15:26:31,222 - __main__ - INFO - Starting comparison for session CMP_20260214_152631
2026-02-14 15:26:31,223 - dq_comparison - INFO - Starting comparison analysis in UI mode
2026-02-14 15:26:31,223 - dq_comparison - INFO - LOADING SOURCE AND TARGET DATA
2026-02-14 15:26:31,223 - dq_comparison - INFO - 
==================================================
2026-02-14 15:26:31,224 - dq_comparison - INFO - üîó SOURCE DATA CONFIGURATION
2026-02-14 15:26:31,224 - dq_comparison - INFO - ==================================================
2026-02-14 15:26:31,225 - dq_comparison - INFO - DEBUG load_csv_source called for SOURCE
2026-02-14 15:26:31,225 - dq_comparison - INFO - DEBUG: Using file_path from 'file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152630_source1000.csv
2026-02-14 15:26:31,232 - dq_comparison - INFO - SOURCE CSV loaded: 1,000 rows, 8 columns
2026-02-14 15:26:31,232 - dq_comparison - INFO - 
==================================================
2026-02-14 15:26:31,233 - dq_comparison - INFO - üîó TARGET DATA CONFIGURATION
2026-02-14 15:26:31,233 - dq_comparison - INFO - ==================================================
2026-02-14 15:26:31,234 - dq_comparison - INFO - DEBUG load_csv_source called for TARGET
2026-02-14 15:26:31,234 - dq_comparison - INFO - DEBUG: Using file_path from 'target_file_path': C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152631_target900.csv
2026-02-14 15:26:31,240 - dq_comparison - INFO - TARGET CSV loaded: 900 rows, 8 columns
2026-02-14 15:26:31,241 - dq_comparison - INFO - Source data loaded: 1000 rows, 8 columns
2026-02-14 15:26:31,241 - dq_comparison - INFO - Target data loaded: 900 rows, 8 columns
2026-02-14 15:26:31,241 - dq_comparison - INFO - SELECTING COLUMNS FOR COMPARISON
2026-02-14 15:26:31,242 - dq_comparison - INFO - Source columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:26:31,242 - dq_comparison - INFO - Target columns (original): ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:26:31,243 - dq_comparison - INFO - Common columns lowercased: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:26:31,243 - dq_comparison - INFO - Found 8 common columns between source and target (case-insensitive)
2026-02-14 15:26:31,243 - dq_comparison - INFO - User column selection input: all
2026-02-14 15:26:31,244 - dq_comparison - INFO - User selected ALL common columns for comparison
2026-02-14 15:26:31,244 - dq_comparison - INFO - Selected 8 columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency']...
2026-02-14 15:26:31,245 - dq_comparison - INFO - GENERATING COMPREHENSIVE COMPARISON REPORT
2026-02-14 15:26:31,246 - dq_comparison - INFO - Report details - Source: CSV: 20260214_152630_source1000.csv, Target: CSV: 20260214_152631_target900.csv, Selected columns: 8
2026-02-14 15:26:31,246 - dq_comparison - INFO - Initializing Error Logger...
2026-02-14 15:26:31,246 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:26:31,322 - dq_error_log - INFO - Database connection successful
2026-02-14 15:26:31,323 - dq_comparison - INFO - Session ID: CMP_20260214_152631
2026-02-14 15:26:31,324 - dq_comparison - WARNING - ‚ùå Row count mismatch: Source=1,000, Target=900, Difference=100
2026-02-14 15:26:31,325 - dq_comparison - WARNING -    Missing in target: 100 rows
2026-02-14 15:26:31,325 - dq_comparison - INFO - Comparing column structures...
2026-02-14 15:26:31,326 - dq_comparison - INFO - Column structure comparison complete. Match: True
2026-02-14 15:26:31,326 - dq_comparison - INFO - Validating primary key/unique fields...
2026-02-14 15:26:31,326 - dq_comparison - INFO - Auto-detecting key fields from data...
2026-02-14 15:26:31,333 - dq_comparison - INFO - Auto-detected common key fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:26:31,335 - dq_comparison - INFO - Primary key validation passed for fields: ['transaction_id', 'account_id', 'amount', 'transaction_date']
2026-02-14 15:26:31,335 - dq_comparison - INFO - Primary key validation complete. Status: VALIDATION_PASSED
2026-02-14 15:26:31,336 - dq_comparison - INFO - Comparing table-level metadata...
2026-02-14 15:26:31,347 - dq_comparison - INFO - Table metadata comparison complete. Match: False
2026-02-14 15:26:31,348 - dq_comparison - INFO - SECOND CHECK: HASH-BASED COMPARISON WITH PERFECT NORMALIZATION
2026-02-14 15:26:31,350 - dq_comparison - INFO - Starting comparison of 1,900 total rows...
2026-02-14 15:26:31,350 - dq_comparison - INFO - === DEBUG: DATA TYPE CHECK ===
2026-02-14 15:26:31,351 - dq_comparison - INFO - Column: amount
2026-02-14 15:26:31,351 - dq_comparison - INFO -   Source type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:26:31,351 - dq_comparison - INFO -   Target type: <class 'numpy.float64'>, value: 1001.25
2026-02-14 15:26:31,352 - dq_comparison - INFO -   Normalized: '1001.25' vs '1001.25'
2026-02-14 15:26:31,352 - dq_comparison - INFO -   Match: True
2026-02-14 15:26:31,353 - dq_comparison - INFO - Column: transaction_date
2026-02-14 15:26:31,354 - dq_comparison - INFO -   Source type: <class 'str'>, value: 1/2/2024
2026-02-14 15:26:31,354 - dq_comparison - INFO -   Target type: <class 'str'>, value: 1/2/2024
2026-02-14 15:26:31,355 - dq_comparison - INFO -   Normalized: '2024-02-01' vs '2024-02-01'
2026-02-14 15:26:31,356 - dq_comparison - INFO -   Match: True
2026-02-14 15:26:31,356 - dq_comparison - INFO - Column: account_id
2026-02-14 15:26:31,357 - dq_comparison - INFO -   Source type: <class 'str'>, value: ACC000001
2026-02-14 15:26:31,357 - dq_comparison - INFO -   Target type: <class 'str'>, value: ACC000001
2026-02-14 15:26:31,357 - dq_comparison - INFO -   Normalized: 'acc000001' vs 'acc000001'
2026-02-14 15:26:31,358 - dq_comparison - INFO -   Match: True
2026-02-14 15:26:31,358 - dq_comparison - INFO - Source DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:26:31,359 - dq_comparison - INFO - Target DF columns: ['transaction_id', 'account_id', 'transaction_date', 'transaction_type', 'amount', 'currency', 'status', 'source_system']
2026-02-14 15:26:31,359 - dq_comparison - INFO - Selected columns for comparison: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:26:31,359 - dq_comparison - INFO - Using 8 common columns for hash comparison
2026-02-14 15:26:31,360 - dq_comparison - INFO - Source columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:26:31,360 - dq_comparison - INFO - Target columns: ['amount', 'transaction_date', 'account_id', 'transaction_id', 'currency', 'source_system', 'transaction_type', 'status']
2026-02-14 15:26:31,360 - dq_comparison - INFO - Generating hashes for source data (1000 rows)...
2026-02-14 15:26:31,473 - dq_comparison - INFO -    Hashing source data: 10.0% complete (190/1,900 rows)
2026-02-14 15:26:31,583 - dq_comparison - INFO -    Hashing source data: 20.0% complete (380/1,900 rows)
2026-02-14 15:26:31,692 - dq_comparison - INFO -    Hashing source data: 30.0% complete (570/1,900 rows)
2026-02-14 15:26:31,804 - dq_comparison - INFO -    Hashing source data: 40.0% complete (760/1,900 rows)
2026-02-14 15:26:31,912 - dq_comparison - INFO -    Hashing source data: 50.0% complete (950/1,900 rows)
2026-02-14 15:26:31,940 - dq_comparison - INFO - === DEBUG: SAMPLE HASHES ===
2026-02-14 15:26:31,940 - dq_comparison - INFO - Hash 1: e22babc60ebca5d1... (sample row 0)
2026-02-14 15:26:31,940 - dq_comparison - INFO - Hash 2: 07aa9f0a8ee4f380... (sample row 1)
2026-02-14 15:26:31,941 - dq_comparison - INFO - Hash 3: 239f9d402c5d9d46... (sample row 2)
2026-02-14 15:26:31,941 - dq_comparison - INFO - Generating hashes for target data (900 rows)...
2026-02-14 15:26:32,018 - dq_comparison - INFO -    Hashing target data: 60.0% complete (1,140/1,900 rows)
2026-02-14 15:26:32,140 - dq_comparison - INFO -    Hashing target data: 70.0% complete (1,330/1,900 rows)
2026-02-14 15:26:32,244 - dq_comparison - INFO -    Hashing target data: 80.0% complete (1,520/1,900 rows)
2026-02-14 15:26:32,383 - dq_comparison - INFO -    Hashing target data: 90.0% complete (1,710/1,900 rows)
2026-02-14 15:26:32,506 - dq_comparison - INFO -    Hashing target data: 100.0% complete (1,900/1,900 rows)
2026-02-14 15:26:32,508 - dq_comparison - INFO - 
======================================================================
2026-02-14 15:26:32,509 - dq_comparison - INFO - üîç DEBUG: ANALYZING WHY HASHES DON'T MATCH
2026-02-14 15:26:32,510 - dq_comparison - INFO - ======================================================================
2026-02-14 15:26:32,510 - dq_comparison - INFO - 
--- Analyzing Row 0 ---
2026-02-14 15:26:32,511 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:26:32,511 - dq_comparison - INFO -   Source: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:26:32,512 - dq_comparison - INFO -   Target: '1001.25' (type: float64) ‚Üí '1001.25'
2026-02-14 15:26:32,512 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,514 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:26:32,514 - dq_comparison - INFO -   Source: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:26:32,515 - dq_comparison - INFO -   Target: '1/2/2024' (type: str) ‚Üí '2024-02-01'
2026-02-14 15:26:32,515 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,516 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:26:32,516 - dq_comparison - INFO -   Source: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:26:32,517 - dq_comparison - INFO -   Target: 'ACC000001' (type: str) ‚Üí 'acc000001'
2026-02-14 15:26:32,517 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,518 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:26:32,518 - dq_comparison - INFO -   Source: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:26:32,519 - dq_comparison - INFO -   Target: 'TXN0000001' (type: str) ‚Üí 'txn0000001'
2026-02-14 15:26:32,519 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,520 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:26:32,520 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:26:32,520 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:26:32,521 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,521 - dq_comparison - INFO - 
Hash components for Row 0:
2026-02-14 15:26:32,522 - dq_comparison - INFO - Source hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:26:32,523 - dq_comparison - INFO - Target hash string start: 1001.25|2024-02-01|acc000001...
2026-02-14 15:26:32,525 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:26:32,525 - dq_comparison - INFO - 
--- Analyzing Row 1 ---
2026-02-14 15:26:32,528 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:26:32,528 - dq_comparison - INFO -   Source: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:26:32,529 - dq_comparison - INFO -   Target: '1002.5' (type: float64) ‚Üí '1002.5'
2026-02-14 15:26:32,529 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,531 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:26:32,531 - dq_comparison - INFO -   Source: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:26:32,532 - dq_comparison - INFO -   Target: '1/3/2024' (type: str) ‚Üí '2024-03-01'
2026-02-14 15:26:32,532 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,533 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:26:32,534 - dq_comparison - INFO -   Source: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:26:32,534 - dq_comparison - INFO -   Target: 'ACC000002' (type: str) ‚Üí 'acc000002'
2026-02-14 15:26:32,534 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,535 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:26:32,536 - dq_comparison - INFO -   Source: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:26:32,536 - dq_comparison - INFO -   Target: 'TXN0000002' (type: str) ‚Üí 'txn0000002'
2026-02-14 15:26:32,536 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,537 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:26:32,538 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:26:32,538 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:26:32,538 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,539 - dq_comparison - INFO - 
Hash components for Row 1:
2026-02-14 15:26:32,542 - dq_comparison - INFO - Source hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:26:32,542 - dq_comparison - INFO - Target hash string start: 1002.5|2024-03-01|acc000002...
2026-02-14 15:26:32,543 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:26:32,544 - dq_comparison - INFO - 
--- Analyzing Row 2 ---
2026-02-14 15:26:32,545 - dq_comparison - INFO - Column 'amount' ‚Üí 'amount':
2026-02-14 15:26:32,545 - dq_comparison - INFO -   Source: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:26:32,546 - dq_comparison - INFO -   Target: '1003.75' (type: float64) ‚Üí '1003.75'
2026-02-14 15:26:32,547 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,548 - dq_comparison - INFO - Column 'transaction_date' ‚Üí 'transaction_date':
2026-02-14 15:26:32,549 - dq_comparison - INFO -   Source: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:26:32,550 - dq_comparison - INFO -   Target: '1/4/2024' (type: str) ‚Üí '2024-04-01'
2026-02-14 15:26:32,550 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,551 - dq_comparison - INFO - Column 'account_id' ‚Üí 'account_id':
2026-02-14 15:26:32,552 - dq_comparison - INFO -   Source: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:26:32,552 - dq_comparison - INFO -   Target: 'ACC000003' (type: str) ‚Üí 'acc000003'
2026-02-14 15:26:32,553 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,554 - dq_comparison - INFO - Column 'transaction_id' ‚Üí 'transaction_id':
2026-02-14 15:26:32,554 - dq_comparison - INFO -   Source: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:26:32,555 - dq_comparison - INFO -   Target: 'TXN0000003' (type: str) ‚Üí 'txn0000003'
2026-02-14 15:26:32,555 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,556 - dq_comparison - INFO - Column 'currency' ‚Üí 'currency':
2026-02-14 15:26:32,557 - dq_comparison - INFO -   Source: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:26:32,558 - dq_comparison - INFO -   Target: 'USD' (type: str) ‚Üí 'usd'
2026-02-14 15:26:32,558 - dq_comparison - INFO -   Match after normalization: ‚úÖ YES
2026-02-14 15:26:32,559 - dq_comparison - INFO - 
Hash components for Row 2:
2026-02-14 15:26:32,560 - dq_comparison - INFO - Source hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:26:32,561 - dq_comparison - INFO - Target hash string start: 1003.75|2024-04-01|acc000003...
2026-02-14 15:26:32,561 - dq_comparison - INFO - Same? ‚úÖ YES
2026-02-14 15:26:32,562 - dq_comparison - INFO - 
--- Column Data Types Analysis ---
2026-02-14 15:26:32,562 - dq_comparison - INFO - Column 1: 'amount' (float64) ‚Üî 'amount' (float64)
2026-02-14 15:26:32,563 - dq_comparison - INFO -   Sample: Source='1001.25', Target='1001.25'
2026-02-14 15:26:32,564 - dq_comparison - INFO - Column 2: 'transaction_date' (object) ‚Üî 'transaction_date' (object)
2026-02-14 15:26:32,564 - dq_comparison - INFO -   Sample: Source='1/2/2024', Target='1/2/2024'
2026-02-14 15:26:32,565 - dq_comparison - INFO - Column 3: 'account_id' (object) ‚Üî 'account_id' (object)
2026-02-14 15:26:32,565 - dq_comparison - INFO -   Sample: Source='ACC000001', Target='ACC000001'
2026-02-14 15:26:32,566 - dq_comparison - INFO - Column 4: 'transaction_id' (object) ‚Üî 'transaction_id' (object)
2026-02-14 15:26:32,566 - dq_comparison - INFO -   Sample: Source='TXN0000001', Target='TXN0000001'
2026-02-14 15:26:32,567 - dq_comparison - INFO - Column 5: 'currency' (object) ‚Üî 'currency' (object)
2026-02-14 15:26:32,567 - dq_comparison - INFO -   Sample: Source='USD', Target='USD'
2026-02-14 15:26:32,568 - dq_comparison - INFO - PERFORMING DETAILED ROW-LEVEL COMPARISON WITH PAGINATION...
2026-02-14 15:26:32,568 - dq_comparison - INFO - Found 104 total mismatches
2026-02-14 15:26:32,569 - dq_comparison - INFO - Will process detailed comparisons for first 104 rows
2026-02-14 15:26:41,321 - dq_comparison - INFO - 
================================================================================
2026-02-14 15:26:41,322 - dq_comparison - INFO - DETAILED MISMATCH SUMMARY:
2026-02-14 15:26:41,322 - dq_comparison - INFO -   Total mismatches found: 102
2026-02-14 15:26:41,323 - dq_comparison - INFO -   Detailed comparisons logged: 102
2026-02-14 15:26:41,323 - dq_comparison - INFO -   First 10 rows displayed above
2026-02-14 15:26:41,324 - dq_comparison - INFO -   All mismatches stored in database with complete data
2026-02-14 15:26:41,324 - dq_comparison - INFO -   Use API to retrieve all 102 mismatches
2026-02-14 15:26:41,325 - dq_comparison - INFO - ================================================================================
2026-02-14 15:26:41,325 - dq_comparison - INFO - Hash-based Comparison Results (with duplicate handling):
2026-02-14 15:26:41,326 - dq_comparison - INFO -   ‚Ä¢ Unique source hashes: 1000
2026-02-14 15:26:41,326 - dq_comparison - INFO -   ‚Ä¢ Unique target hashes: 900
2026-02-14 15:26:41,326 - dq_comparison - INFO -   ‚Ä¢ Common hashes: 898
2026-02-14 15:26:41,327 - dq_comparison - INFO -   ‚Ä¢ Common rows (counting duplicates): 898
2026-02-14 15:26:41,328 - dq_comparison - INFO -   ‚Ä¢ Rows only in source (counting duplicates): 102
2026-02-14 15:26:41,328 - dq_comparison - INFO -   ‚Ä¢ Rows only in target (counting duplicates): 2
2026-02-14 15:26:41,330 - dq_comparison - INFO - HASH-ONLY COMPARISON COMPLETED
2026-02-14 15:26:41,331 - dq_comparison - INFO - Returning counts for simple scoring:
2026-02-14 15:26:41,331 - dq_comparison - INFO -   Common rows: 898
2026-02-14 15:26:41,332 - dq_comparison - INFO -   Unique to source: 102
2026-02-14 15:26:41,332 - dq_comparison - INFO -   Unique to target: 2
2026-02-14 15:26:41,333 - dq_comparison - INFO -   Value mismatches: 832
2026-02-14 15:26:41,334 - dq_comparison - INFO -   Missing rows: 102
2026-02-14 15:26:41,334 - dq_comparison - INFO -   Extra rows: 2
2026-02-14 15:26:41,335 - dq_comparison - INFO - 
========================================================================================================================
COMPARISON: CSV (20260214_152630_source1000.csv) vs CSV (20260214_152631_target900.csv)
========================================================================================================================
Row   | Diff Count | Source (Sample)                          | Target (Sample)                         
------------------------------------------------------------------------------------------------------------------------
900   | 2          | amount: 2123.75                          | amount: 2133.75                         
901   | 2          | amount: 2125.0                           | amount: 2225.0                          
902   | 8          | amount: 2126.25                          | amount: NULL                            
903   | 8          | amount: 2127.5                           | amount: NULL                            
904   | 8          | amount: 2128.75                          | amount: NULL                            
905   | 8          | amount: 2130.0                           | amount: NULL                            
906   | 8          | amount: 2131.25                          | amount: NULL                            
907   | 8          | amount: 2132.5                           | amount: NULL                            
908   | 8          | amount: 2133.75                          | amount: NULL                            
909   | 8          | amount: 2135.0                           | amount: NULL                            
------------------------------------------------------------------------------------------------------------------------
Showing 1-10 of 102 mismatched rows. Use API for complete data.
========================================================================================================================
2026-02-14 15:26:41,335 - dq_comparison - INFO - Returning enhanced mismatch structure with 102 detailed mismatches
2026-02-14 15:26:41,336 - dq_comparison - INFO - New structure: 100 detailed mismatches
2026-02-14 15:26:41,337 - dq_comparison - INFO - Analyzing data quality metrics...
2026-02-14 15:26:42,212 - dq_comparison - INFO - Null values - Source: 0 (0.00%), Target: 0 (0.00%)
2026-02-14 15:26:42,215 - dq_comparison - INFO - Duplicate rows (normalized) - Source: 0, Target: 0
2026-02-14 15:26:42,323 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260214_152631
2026-02-14 15:26:42,324 - dq_comparison - INFO - 
üìä SIMPLE SCORING CALCULATION:
2026-02-14 15:26:42,325 - dq_comparison - INFO -   Source rows: 1000
2026-02-14 15:26:42,326 - dq_comparison - INFO -   Common rows (matched): 898
2026-02-14 15:26:42,326 - dq_comparison - INFO -   Calculation: (898 / 1000) * 100 = 89.80%
2026-02-14 15:26:42,328 - dq_comparison - INFO -   Explanation: 898 matched rows out of 1000 total source rows
2026-02-14 15:26:42,329 - dq_comparison - INFO - 
=== AUDIT LOGGING SECTION ===
2026-02-14 15:26:42,329 - dq_comparison - INFO - üîç Audit logging is ENABLED in APP_SETTINGS
2026-02-14 15:26:42,330 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:26:42,330 - dq_comparison - INFO - Attempting to log audit record for session: CMP_20260214_152631
2026-02-14 15:26:42,332 - dq_audit - INFO - Starting database insertion for comparison...
2026-02-14 15:26:42,419 - dq_audit - INFO - Inserted comparison record with ID: 573
2026-02-14 15:26:42,422 - dq_comparison - INFO - ‚úÖ Audit record logged successfully (ID: 573)
2026-02-14 15:26:42,520 - dq_error_log - INFO - Retrieved 100 error logs for session CMP_20260214_152631
2026-02-14 15:26:42,627 - dq_error_log - INFO - Retrieved summary: 102 total errors for session CMP_20260214_152631
2026-02-14 15:26:42,629 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:26:42,708 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152631
2026-02-14 15:26:42,710 - dq_comparison - INFO - 
üîç Final results verification:
2026-02-14 15:26:42,710 - dq_comparison - INFO -    Session ID: CMP_20260214_152631
2026-02-14 15:26:42,711 - dq_comparison - INFO -    DQ Score (Simple %): 89.80%
2026-02-14 15:26:42,712 - dq_comparison - INFO -    Source rows: 1000
2026-02-14 15:26:42,712 - dq_comparison - INFO -    Matched rows: 898
2026-02-14 15:26:42,712 - dq_comparison - INFO -    Calculation: (898 / 1000) * 100
2026-02-14 15:26:42,713 - dq_comparison - INFO - Comparison analysis completed successfully
2026-02-14 15:26:42,805 - dq_audit - INFO - Retrieved 1 audit logs for session CMP_20260214_152631
2026-02-14 15:26:42,910 - dq_error_log - INFO - Retrieved 102 error logs for session CMP_20260214_152631
2026-02-14 15:26:42,997 - dq_error_log - INFO - Retrieved summary: 102 total errors for session CMP_20260214_152631
2026-02-14 15:26:43,011 - __main__ - INFO - Completed with status 200 in 11.792s
2026-02-14 15:26:43,052 - __main__ - INFO - GET /api/compare/CMP_20260214_152631/mismatches - Request started
2026-02-14 15:26:43,233 - __main__ - INFO - Completed with status 200 in 0.181s
2026-02-14 15:26:43,552 - __main__ - INFO - GET /api/compare/CMP_20260214_152631/mismatches - Request started
2026-02-14 15:26:43,738 - __main__ - INFO - Completed with status 200 in 0.186s
2026-02-14 15:26:59,188 - __main__ - INFO - GET /api/compare/CMP_20260214_152631/mismatches - Request started
2026-02-14 15:26:59,367 - __main__ - INFO - Completed with status 200 in 0.180s
2026-02-14 15:27:52,849 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:27:52,868 - __main__ - INFO - File uploaded: 20260214_152752_finance100.csv (csv)
2026-02-14 15:27:52,870 - __main__ - INFO - Completed with status 200 in 0.020s
2026-02-14 15:27:52,885 - __main__ - INFO - POST /api/advanced - Request started
2026-02-14 15:27:52,886 - __main__ - INFO - Advanced checks request received
2026-02-14 15:27:52,886 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-14 15:27:52,887 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-14 15:27:52,887 - __main__ - INFO - Starting advanced checks for session ADV_20260214_152752_ed2d992d
2026-02-14 15:27:52,889 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-14 15:27:52,891 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-14 15:27:52,891 - dq_unified - INFO - Prompting user for data source type
2026-02-14 15:27:52,893 - dq_unified - INFO - UI Data source_type: csv
2026-02-14 15:27:52,893 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-14 15:27:52,894 - dq_unified - INFO - Loading data from CSV
2026-02-14 15:27:52,895 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152752_finance100.csv
2026-02-14 15:27:52,897 - dq_unified - INFO - CSV file has 100 rows
2026-02-14 15:27:52,897 - dq_unified - INFO - Loading 100 rows from CSV...
2026-02-14 15:27:52,903 - dq_unified - INFO - Loaded 100 rows from CSV
2026-02-14 15:27:52,910 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:27:52,911 - dq_unified - INFO - Loaded 100 rows, 10 columns. Memory: 143.5MB total, 0.0MB for dataframe
2026-02-14 15:27:52,912 - dq_advanced - INFO - Data loaded: 100 rows, 10 columns from CSV: 20260214_152752_finance100.csv
2026-02-14 15:27:52,912 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:27:53,001 - dq_error_log - INFO - Database connection successful
2026-02-14 15:27:53,004 - dq_advanced - INFO - Session ID: ADV_20260214_152753_4305
2026-02-14 15:27:53,005 - dq_advanced - INFO - Starting comprehensive validations on 100 rows, 10 columns
2026-02-14 15:27:53,016 - dq_advanced - INFO - Memory: 3855MB available, 0.0002MB/row, Optimal batch: 50000 rows
2026-02-14 15:27:53,018 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-14 15:27:53,019 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-14 15:27:53,025 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-14 15:27:53,028 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 3 patterns
2026-02-14 15:27:53,032 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-14 15:27:53,035 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-14 15:27:53,038 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-14 15:27:53,041 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-14 15:27:53,044 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-14 15:27:53,047 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-14 15:27:53,050 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-14 15:27:53,052 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-14 15:27:53,088 - dq_error_log - INFO - Starting batch logging for 158 errors, session: ADV_20260214_152753_4305
2026-02-14 15:27:53,195 - dq_error_log - INFO - Batch 1: Successfully logged 158 errors
2026-02-14 15:27:53,196 - dq_error_log - INFO - Progress: 158/158 errors processed
2026-02-14 15:27:53,197 - dq_error_log - INFO - COMPLETE: Logged 158/158 errors for session ADV_20260214_152753_4305
2026-02-14 15:27:53,199 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:27:53,199 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-14 15:27:53,284 - dq_audit - INFO - Inserted advanced record with ID: 574
2026-02-14 15:27:53,287 - dq_advanced - INFO - Audit record logged with ID: 574
2026-02-14 15:27:53,390 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260214_152753_4305
2026-02-14 15:27:53,476 - dq_error_log - INFO - Retrieved summary: 158 total errors for session ADV_20260214_152753_4305
2026-02-14 15:27:53,478 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:27:53,560 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260214_152753_4305
2026-02-14 15:27:53,561 - dq_advanced - INFO - Advanced checks completed for session ADV_20260214_152753_4305
2026-02-14 15:27:53,656 - dq_error_log - INFO - Retrieved 100 error logs for session ADV_20260214_152753_4305
2026-02-14 15:27:53,752 - dq_error_log - INFO - Retrieved summary: 158 total errors for session ADV_20260214_152753_4305
2026-02-14 15:27:53,834 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260214_152753_4305
2026-02-14 15:27:53,836 - __main__ - INFO - Advanced checks completed for session ADV_20260214_152753_4305
2026-02-14 15:27:53,839 - __main__ - INFO - Completed with status 200 in 0.954s
2026-02-14 15:27:53,925 - __main__ - INFO - GET /api/advanced/ADV_20260214_152752_ed2d992d - Request started
2026-02-14 15:27:54,024 - dq_error_log - INFO - Retrieved 0 error logs for session ADV_20260214_152752_ed2d992d
2026-02-14 15:27:54,026 - __main__ - INFO - Completed with status 200 in 0.101s
2026-02-14 15:27:54,036 - __main__ - INFO - GET /api/advanced/ADV_20260214_152752_ed2d992d - Request started
2026-02-14 15:27:54,134 - dq_error_log - INFO - Retrieved 0 error logs for session ADV_20260214_152752_ed2d992d
2026-02-14 15:27:54,135 - __main__ - INFO - Completed with status 200 in 0.099s
2026-02-14 15:29:20,964 - __main__ - INFO - POST /api/upload - Request started
2026-02-14 15:29:20,977 - __main__ - INFO - File uploaded: 20260214_152920_Advance15.csv (csv)
2026-02-14 15:29:20,978 - __main__ - INFO - Completed with status 200 in 0.013s
2026-02-14 15:29:21,226 - __main__ - INFO - POST /api/advanced - Request started
2026-02-14 15:29:21,227 - __main__ - INFO - Advanced checks request received
2026-02-14 15:29:21,228 - __main__ - INFO - DEBUG: Received columns_input: [] (type: <class 'list'>)
2026-02-14 15:29:21,228 - __main__ - INFO - DEBUG: Using as-is: []
2026-02-14 15:29:21,230 - __main__ - INFO - Starting advanced checks for session ADV_20260214_152921_e085cdc8
2026-02-14 15:29:21,231 - dq_advanced - INFO - Starting advanced checks in UI/API mode
2026-02-14 15:29:21,232 - dq_advanced - INFO - LOADING DATA FOR ADVANCED CHECKS
2026-02-14 15:29:21,233 - dq_unified - INFO - Prompting user for data source type
2026-02-14 15:29:21,234 - dq_unified - INFO - UI Data source_type: csv
2026-02-14 15:29:21,234 - dq_unified - INFO - Using source_type from UI data: csv
2026-02-14 15:29:21,235 - dq_unified - INFO - Loading data from CSV
2026-02-14 15:29:21,236 - dq_unified - INFO - Loading large CSV: C:/Users/006398/Desktop/Accilerator/BACKEND/Data_Quality_Framework/uploads/20260214_152920_Advance15.csv
2026-02-14 15:29:21,239 - dq_unified - INFO - CSV file has 15 rows
2026-02-14 15:29:21,242 - dq_unified - INFO - Loading 15 rows from CSV...
2026-02-14 15:29:21,247 - dq_unified - INFO - Loaded 15 rows from CSV
2026-02-14 15:29:21,254 - dq_unified - INFO - Memory optimization: 0.0MB -> 0.0MB (Saved: 0.0MB)
2026-02-14 15:29:21,256 - dq_unified - INFO - Loaded 15 rows, 10 columns. Memory: 144.6MB total, 0.0MB for dataframe
2026-02-14 15:29:21,257 - dq_advanced - INFO - Data loaded: 15 rows, 10 columns from CSV: 20260214_152920_Advance15.csv
2026-02-14 15:29:21,258 - dq_error_log - INFO - ErrorLogger initialized with database: dq_checks
2026-02-14 15:29:21,374 - dq_error_log - INFO - Database connection successful
2026-02-14 15:29:21,376 - dq_advanced - INFO - Session ID: ADV_20260214_152921_7562
2026-02-14 15:29:21,377 - dq_advanced - INFO - Starting comprehensive validations on 15 rows, 10 columns
2026-02-14 15:29:21,388 - dq_advanced - INFO - Memory: 3906MB available, 0.0003MB/row, Optimal batch: 50000 rows
2026-02-14 15:29:21,389 - dq_advanced - INFO - Auto-calculated batch size: 50000 rows
2026-02-14 15:29:21,390 - dq_advanced - INFO - Analyzing 10 columns...
2026-02-14 15:29:21,392 - dq_advanced - INFO - Analyzed column 'transaction_id': numeric with 1 patterns
2026-02-14 15:29:21,393 - dq_advanced - INFO - Analyzed column 'account_number': numeric with 3 patterns
2026-02-14 15:29:21,395 - dq_advanced - INFO - Analyzed column 'customer_name': text with 0 patterns
2026-02-14 15:29:21,396 - dq_advanced - INFO - Analyzed column 'email': text with 1 patterns
2026-02-14 15:29:21,398 - dq_advanced - INFO - Analyzed column 'transaction_date': date with 2 patterns
2026-02-14 15:29:21,399 - dq_advanced - INFO - Analyzed column 'amount': numeric with 0 patterns
2026-02-14 15:29:21,401 - dq_advanced - INFO - Analyzed column 'currency': text with 1 patterns
2026-02-14 15:29:21,402 - dq_advanced - INFO - Analyzed column 'balance': numeric with 0 patterns
2026-02-14 15:29:21,404 - dq_advanced - INFO - Analyzed column 'status': text with 0 patterns
2026-02-14 15:29:21,405 - dq_advanced - INFO - Analyzed column 'remarks': text with 0 patterns
2026-02-14 15:29:21,411 - dq_error_log - INFO - Starting batch logging for 29 errors, session: ADV_20260214_152921_7562
2026-02-14 15:29:21,500 - dq_error_log - INFO - Batch 1: Successfully logged 29 errors
2026-02-14 15:29:21,502 - dq_error_log - INFO - Progress: 29/29 errors processed
2026-02-14 15:29:21,502 - dq_error_log - INFO - COMPLETE: Logged 29/29 errors for session ADV_20260214_152921_7562
2026-02-14 15:29:21,503 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:29:21,504 - dq_audit - INFO - Starting database insertion for advanced...
2026-02-14 15:29:21,581 - dq_audit - INFO - Inserted advanced record with ID: 575
2026-02-14 15:29:21,583 - dq_advanced - INFO - Audit record logged with ID: 575
2026-02-14 15:29:21,679 - dq_error_log - INFO - Retrieved 29 error logs for session ADV_20260214_152921_7562
2026-02-14 15:29:21,772 - dq_error_log - INFO - Retrieved summary: 29 total errors for session ADV_20260214_152921_7562
2026-02-14 15:29:21,774 - dq_audit - INFO - Audit class initialized with database: dq_checks
2026-02-14 15:29:21,855 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260214_152921_7562
2026-02-14 15:29:21,857 - dq_advanced - INFO - Advanced checks completed for session ADV_20260214_152921_7562
2026-02-14 15:29:21,942 - dq_error_log - INFO - Retrieved 29 error logs for session ADV_20260214_152921_7562
2026-02-14 15:29:22,042 - dq_error_log - INFO - Retrieved summary: 29 total errors for session ADV_20260214_152921_7562
2026-02-14 15:29:22,130 - dq_audit - INFO - Retrieved 1 audit logs for session ADV_20260214_152921_7562
2026-02-14 15:29:22,132 - __main__ - INFO - Advanced checks completed for session ADV_20260214_152921_7562
2026-02-14 15:29:22,135 - __main__ - INFO - Completed with status 200 in 0.909s
2026-02-14 15:29:22,168 - __main__ - INFO - GET /api/advanced/ADV_20260214_152921_e085cdc8 - Request started
2026-02-14 15:29:22,266 - dq_error_log - INFO - Retrieved 0 error logs for session ADV_20260214_152921_e085cdc8
2026-02-14 15:29:22,269 - __main__ - INFO - Completed with status 200 in 0.100s
2026-02-14 15:29:22,596 - __main__ - INFO - GET /api/advanced/ADV_20260214_152921_e085cdc8 - Request started
2026-02-14 15:29:22,707 - dq_error_log - INFO - Retrieved 0 error logs for session ADV_20260214_152921_e085cdc8
2026-02-14 15:29:22,709 - __main__ - INFO - Completed with status 200 in 0.114s
